이메일 환경변수가 설정되지 않았습니다. EMAIL_USER와 EMAIL_PASS를 설정해주세요.
🎥 화상통신 최적화 서버 시작!
🔒 HTTPS 서버가 포트 7000에서 실행 중입니다.
LAN 접속: https://192.168.200.106:7000
WebSocket 접속: wss://192.168.200.106:7000
WebRTC 화상통신: 지원됨
카메라/마이크: HTTPS 환경에서 활성화
✅ PostgreSQL 데이터베이스 연결 성공
📊 데이터베이스에서 입실 중인 사용자 3명 로드
📊 사용자 입실 상태 복원: test1 → 맵 3
📊 사용자 입실 상태 복원: test2 → 맵 3
📊 사용자 입실 상태 복원: whl19810312 → 맵 3
✅ 데이터베이스 테이블 동기화 완료
2025-09-08T18:39:49.866Z - OPTIONS /api/auth/user/me from 192.168.200.108 (HTTPS: true)
2025-09-08T18:39:49.876Z - OPTIONS /api/auth/user/me from 192.168.200.108 (HTTPS: true)
2025-09-08T18:39:49.876Z - GET /api/auth/user/me from 192.168.200.108 (HTTPS: true)
👤 현재 사용자 정보 조회: { userId: 2, username: 'test1' }
2025-09-08T18:39:49.892Z - GET /api/auth/user/me from 192.168.200.108 (HTTPS: true)
👤 현재 사용자 정보 조회: { userId: 2, username: 'test1' }
2025-09-08T18:39:49.956Z - OPTIONS /api/maps/3 from 192.168.200.108 (HTTPS: true)
2025-09-08T18:39:49.966Z - OPTIONS /api/maps from 192.168.200.108 (HTTPS: true)
2025-09-08T18:39:49.983Z - OPTIONS /api/characters from 192.168.200.108 (HTTPS: true)
2025-09-08T18:39:49.990Z - GET /api/maps/3 from 192.168.200.108 (HTTPS: true)
Auth 미들웨어 - Authorization 헤더: 존재
Auth 미들웨어 - 토큰 확인: eyJhbGciOiJIUzI1NiIs...
Auth 미들웨어 - 토큰 디코딩 성공, userId: 2
Auth 미들웨어 - 인증 성공, 사용자: test1
🔍 서버: 맵 조회 요청: { mapId: '3', userId: 2 }
2025-09-08T18:39:49.999Z - OPTIONS /api/characters from 192.168.200.108 (HTTPS: true)
🔍 서버: 맵 조회 결과: 성공
✅ 서버: 맵 조회 성공: { id: 3, name: 'TEST ROOM', creatorId: 1 }
2025-09-08T18:39:50.016Z - GET /api/maps from 192.168.200.108 (HTTPS: true)
Auth 미들웨어 - Authorization 헤더: 존재
Auth 미들웨어 - 토큰 확인: eyJhbGciOiJIUzI1NiIs...
Auth 미들웨어 - 토큰 디코딩 성공, userId: 2
Auth 미들웨어 - 인증 성공, 사용자: test1
2025-09-08T18:39:50.024Z - GET /api/characters from 192.168.200.108 (HTTPS: true)
Auth 미들웨어 - Authorization 헤더: 존재
Auth 미들웨어 - 토큰 확인: eyJhbGciOiJIUzI1NiIs...
Auth 미들웨어 - 토큰 디코딩 성공, userId: 2
Auth 미들웨어 - 인증 성공, 사용자: test1
2025-09-08T18:39:50.073Z - GET /api/maps from 192.168.200.108 (HTTPS: true)
Auth 미들웨어 - Authorization 헤더: 존재
Auth 미들웨어 - 토큰 확인: eyJhbGciOiJIUzI1NiIs...
Auth 미들웨어 - 토큰 디코딩 성공, userId: 2
2025-09-08T18:39:50.076Z - GET /api/characters from 192.168.200.108 (HTTPS: true)
Auth 미들웨어 - Authorization 헤더: 존재
Auth 미들웨어 - 토큰 확인: eyJhbGciOiJIUzI1NiIs...
Auth 미들웨어 - 토큰 디코딩 성공, userId: 2
Auth 미들웨어 - 인증 성공, 사용자: test1
Auth 미들웨어 - 인증 성공, 사용자: test1
2025-09-08T18:39:50.181Z - OPTIONS /api/user/logged-in-users from 192.168.200.108 (HTTPS: true)
2025-09-08T18:39:50.188Z - GET /api/user/logged-in-users from 192.168.200.108 (HTTPS: true)
Auth 미들웨어 - Authorization 헤더: 존재
Auth 미들웨어 - 토큰 확인: eyJhbGciOiJIUzI1NiIs...
Auth 미들웨어 - 토큰 디코딩 성공, userId: 2
Auth 미들웨어 - 인증 성공, 사용자: test1
2025-09-08T18:39:50.253Z - GET /api/user/logged-in-users from 192.168.200.108 (HTTPS: true)
Auth 미들웨어 - Authorization 헤더: 존재
Auth 미들웨어 - 토큰 확인: eyJhbGciOiJIUzI1NiIs...
Auth 미들웨어 - 토큰 디코딩 성공, userId: 2
Auth 미들웨어 - 인증 성공, 사용자: test1
WebSocket 초기 헤더: {
  'Access-Control-Allow-Origin': '*',
  'Access-Control-Allow-Credentials': 'true'
}
WebSocket 요청 정보: {
  method: 'GET',
  url: '/socket.io/?EIO=4&transport=websocket',
  headers: {
    host: '192.168.200.106:7000',
    connection: 'Upgrade',
    pragma: 'no-cache',
    'cache-control': 'no-cache',
    'user-agent': 'Mozilla/5.0 (Linux; Android 10; K) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36',
    upgrade: 'websocket',
    origin: 'https://192.168.200.106:5173',
    'sec-websocket-version': '13',
    'accept-encoding': 'gzip, deflate, br, zstd',
    'accept-language': 'ko-KR,ko;q=0.9,en-US;q=0.8,en;q=0.7',
    'sec-websocket-key': 'qqTU12z27MG4gyTUeulOtA==',
    'sec-websocket-extensions': 'permessage-deflate; client_max_window_bits'
  },
  secure: undefined
}
새로운 WebSocket 연결 (화상통신 준비): W2IgwTgvKzosyQQoAAAB
연결 정보: {
  id: 'W2IgwTgvKzosyQQoAAAB',
  ip: '192.168.200.108',
  userAgent: 'Mozilla/5.0 (Linux; Android 10; K) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36',
  origin: 'https://192.168.200.106:5173',
  secure: true
}
새로운 mini area WebSocket 연결: W2IgwTgvKzosyQQoAAAB IP: 192.168.200.108
새로운 WebSocket 연결: W2IgwTgvKzosyQQoAAAB
WebSocket 초기 헤더: {
  'Access-Control-Allow-Origin': '*',
  'Access-Control-Allow-Credentials': 'true'
}
WebSocket 요청 정보: {
  method: 'GET',
  url: '/socket.io/?EIO=4&transport=websocket',
  headers: {
    host: '192.168.200.106:7000',
    connection: 'Upgrade',
    pragma: 'no-cache',
    'cache-control': 'no-cache',
    'user-agent': 'Mozilla/5.0 (Linux; Android 10; K) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36',
    upgrade: 'websocket',
    origin: 'https://192.168.200.106:5173',
    'sec-websocket-version': '13',
    'accept-encoding': 'gzip, deflate, br, zstd',
    'accept-language': 'ko-KR,ko;q=0.9,en-US;q=0.8,en;q=0.7',
    'sec-websocket-key': 'UFSgskXyMhuSxLdzisKztA==',
    'sec-websocket-extensions': 'permessage-deflate; client_max_window_bits'
  },
  secure: undefined
}
🏓 Ping 전송 완료: 0개 소켓
🏓 Ping 전송 완료: 0개 소켓
🏓 Ping 전송 완료: 0개 소켓
🔌 [오프라인] mini area WebSocket 연결 해제: {
  socketId: 'W2IgwTgvKzosyQQoAAAB',
  userId: undefined,
  username: undefined,
  mapId: undefined,
  privateAreaId: undefined,
  timestamp: '9/9/2025, 3:41:19 AM'
}
WebSocket 연결 해제: W2IgwTgvKzosyQQoAAAB
🏓 Ping 전송 완료: 0개 소켓
🏓 Ping 전송 완료: 0개 소켓
🏓 Ping 전송 완료: 0개 소켓
🏓 Ping 전송 완료: 0개 소켓
🏓 Ping 전송 완료: 0개 소켓
