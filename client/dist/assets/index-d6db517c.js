import{l as cy}from"./webrtc-d9998155.js";function ly(e,t){for(var n=0;n<t.length;n++){const r=t[n];if(typeof r!="string"&&!Array.isArray(r)){for(const s in r)if(s!=="default"&&!(s in e)){const i=Object.getOwnPropertyDescriptor(r,s);i&&Object.defineProperty(e,s,i.get?i:{enumerable:!0,get:()=>r[s]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();var np=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function dy(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Rh={exports:{}},ja={},kh={exports:{}},ge={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Gi=Symbol.for("react.element"),uy=Symbol.for("react.portal"),py=Symbol.for("react.fragment"),fy=Symbol.for("react.strict_mode"),hy=Symbol.for("react.profiler"),my=Symbol.for("react.provider"),gy=Symbol.for("react.context"),vy=Symbol.for("react.forward_ref"),yy=Symbol.for("react.suspense"),wy=Symbol.for("react.memo"),_y=Symbol.for("react.lazy"),rp=Symbol.iterator;function Sy(e){return e===null||typeof e!="object"?null:(e=rp&&e[rp]||e["@@iterator"],typeof e=="function"?e:null)}var Th={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Ph=Object.assign,jh={};function Ls(e,t,n){this.props=e,this.context=t,this.refs=jh,this.updater=n||Th}Ls.prototype.isReactComponent={};Ls.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Ls.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function Lh(){}Lh.prototype=Ls.prototype;function kd(e,t,n){this.props=e,this.context=t,this.refs=jh,this.updater=n||Th}var Td=kd.prototype=new Lh;Td.constructor=kd;Ph(Td,Ls.prototype);Td.isPureReactComponent=!0;var sp=Array.isArray,Dh=Object.prototype.hasOwnProperty,Pd={current:null},Ih={key:!0,ref:!0,__self:!0,__source:!0};function Nh(e,t,n){var r,s={},i=null,o=null;if(t!=null)for(r in t.ref!==void 0&&(o=t.ref),t.key!==void 0&&(i=""+t.key),t)Dh.call(t,r)&&!Ih.hasOwnProperty(r)&&(s[r]=t[r]);var a=arguments.length-2;if(a===1)s.children=n;else if(1<a){for(var c=Array(a),l=0;l<a;l++)c[l]=arguments[l+2];s.children=c}if(e&&e.defaultProps)for(r in a=e.defaultProps,a)s[r]===void 0&&(s[r]=a[r]);return{$$typeof:Gi,type:e,key:i,ref:o,props:s,_owner:Pd.current}}function xy(e,t){return{$$typeof:Gi,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function jd(e){return typeof e=="object"&&e!==null&&e.$$typeof===Gi}function by(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(n){return t[n]})}var ip=/\/+/g;function Tc(e,t){return typeof e=="object"&&e!==null&&e.key!=null?by(""+e.key):t.toString(36)}function Oo(e,t,n,r,s){var i=typeof e;(i==="undefined"||i==="boolean")&&(e=null);var o=!1;if(e===null)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(e.$$typeof){case Gi:case uy:o=!0}}if(o)return o=e,s=s(o),e=r===""?"."+Tc(o,0):r,sp(s)?(n="",e!=null&&(n=e.replace(ip,"$&/")+"/"),Oo(s,t,n,"",function(l){return l})):s!=null&&(jd(s)&&(s=xy(s,n+(!s.key||o&&o.key===s.key?"":(""+s.key).replace(ip,"$&/")+"/")+e)),t.push(s)),1;if(o=0,r=r===""?".":r+":",sp(e))for(var a=0;a<e.length;a++){i=e[a];var c=r+Tc(i,a);o+=Oo(i,t,n,c,s)}else if(c=Sy(e),typeof c=="function")for(e=c.call(e),a=0;!(i=e.next()).done;)i=i.value,c=r+Tc(i,a++),o+=Oo(i,t,n,c,s);else if(i==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return o}function po(e,t,n){if(e==null)return e;var r=[],s=0;return Oo(e,r,"","",function(i){return t.call(n,i,s++)}),r}function Cy(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(n){(e._status===0||e._status===-1)&&(e._status=1,e._result=n)},function(n){(e._status===0||e._status===-1)&&(e._status=2,e._result=n)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var _t={current:null},$o={transition:null},Ey={ReactCurrentDispatcher:_t,ReactCurrentBatchConfig:$o,ReactCurrentOwner:Pd};function Mh(){throw Error("act(...) is not supported in production builds of React.")}ge.Children={map:po,forEach:function(e,t,n){po(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return po(e,function(){t++}),t},toArray:function(e){return po(e,function(t){return t})||[]},only:function(e){if(!jd(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};ge.Component=Ls;ge.Fragment=py;ge.Profiler=hy;ge.PureComponent=kd;ge.StrictMode=fy;ge.Suspense=yy;ge.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Ey;ge.act=Mh;ge.cloneElement=function(e,t,n){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var r=Ph({},e.props),s=e.key,i=e.ref,o=e._owner;if(t!=null){if(t.ref!==void 0&&(i=t.ref,o=Pd.current),t.key!==void 0&&(s=""+t.key),e.type&&e.type.defaultProps)var a=e.type.defaultProps;for(c in t)Dh.call(t,c)&&!Ih.hasOwnProperty(c)&&(r[c]=t[c]===void 0&&a!==void 0?a[c]:t[c])}var c=arguments.length-2;if(c===1)r.children=n;else if(1<c){a=Array(c);for(var l=0;l<c;l++)a[l]=arguments[l+2];r.children=a}return{$$typeof:Gi,type:e.type,key:s,ref:i,props:r,_owner:o}};ge.createContext=function(e){return e={$$typeof:gy,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:my,_context:e},e.Consumer=e};ge.createElement=Nh;ge.createFactory=function(e){var t=Nh.bind(null,e);return t.type=e,t};ge.createRef=function(){return{current:null}};ge.forwardRef=function(e){return{$$typeof:vy,render:e}};ge.isValidElement=jd;ge.lazy=function(e){return{$$typeof:_y,_payload:{_status:-1,_result:e},_init:Cy}};ge.memo=function(e,t){return{$$typeof:wy,type:e,compare:t===void 0?null:t}};ge.startTransition=function(e){var t=$o.transition;$o.transition={};try{e()}finally{$o.transition=t}};ge.unstable_act=Mh;ge.useCallback=function(e,t){return _t.current.useCallback(e,t)};ge.useContext=function(e){return _t.current.useContext(e)};ge.useDebugValue=function(){};ge.useDeferredValue=function(e){return _t.current.useDeferredValue(e)};ge.useEffect=function(e,t){return _t.current.useEffect(e,t)};ge.useId=function(){return _t.current.useId()};ge.useImperativeHandle=function(e,t,n){return _t.current.useImperativeHandle(e,t,n)};ge.useInsertionEffect=function(e,t){return _t.current.useInsertionEffect(e,t)};ge.useLayoutEffect=function(e,t){return _t.current.useLayoutEffect(e,t)};ge.useMemo=function(e,t){return _t.current.useMemo(e,t)};ge.useReducer=function(e,t,n){return _t.current.useReducer(e,t,n)};ge.useRef=function(e){return _t.current.useRef(e)};ge.useState=function(e){return _t.current.useState(e)};ge.useSyncExternalStore=function(e,t,n){return _t.current.useSyncExternalStore(e,t,n)};ge.useTransition=function(){return _t.current.useTransition()};ge.version="18.3.1";kh.exports=ge;var _=kh.exports;const Ah=dy(_),Ry=ly({__proto__:null,default:Ah},[_]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ky=_,Ty=Symbol.for("react.element"),Py=Symbol.for("react.fragment"),jy=Object.prototype.hasOwnProperty,Ly=ky.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Dy={key:!0,ref:!0,__self:!0,__source:!0};function Oh(e,t,n){var r,s={},i=null,o=null;n!==void 0&&(i=""+n),t.key!==void 0&&(i=""+t.key),t.ref!==void 0&&(o=t.ref);for(r in t)jy.call(t,r)&&!Dy.hasOwnProperty(r)&&(s[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps,t)s[r]===void 0&&(s[r]=t[r]);return{$$typeof:Ty,type:e,key:i,ref:o,props:s,_owner:Ly.current}}ja.Fragment=Py;ja.jsx=Oh;ja.jsxs=Oh;Rh.exports=ja;var p=Rh.exports,vl={},$h={exports:{}},$t={},Fh={exports:{}},zh={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(k,U){var Y=k.length;k.push(U);e:for(;0<Y;){var N=Y-1>>>1,T=k[N];if(0<s(T,U))k[N]=U,k[Y]=T,Y=N;else break e}}function n(k){return k.length===0?null:k[0]}function r(k){if(k.length===0)return null;var U=k[0],Y=k.pop();if(Y!==U){k[0]=Y;e:for(var N=0,T=k.length,P=T>>>1;N<P;){var q=2*(N+1)-1,O=k[q],ne=q+1,he=k[ne];if(0>s(O,Y))ne<T&&0>s(he,O)?(k[N]=he,k[ne]=Y,N=ne):(k[N]=O,k[q]=Y,N=q);else if(ne<T&&0>s(he,Y))k[N]=he,k[ne]=Y,N=ne;else break e}}return U}function s(k,U){var Y=k.sortIndex-U.sortIndex;return Y!==0?Y:k.id-U.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;e.unstable_now=function(){return i.now()}}else{var o=Date,a=o.now();e.unstable_now=function(){return o.now()-a}}var c=[],l=[],d=1,u=null,f=3,h=!1,v=!1,y=!1,x=typeof setTimeout=="function"?setTimeout:null,g=typeof clearTimeout=="function"?clearTimeout:null,m=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function w(k){for(var U=n(l);U!==null;){if(U.callback===null)r(l);else if(U.startTime<=k)r(l),U.sortIndex=U.expirationTime,t(c,U);else break;U=n(l)}}function C(k){if(y=!1,w(k),!v)if(n(c)!==null)v=!0,Q(L);else{var U=n(l);U!==null&&W(C,U.startTime-k)}}function L(k,U){v=!1,y&&(y=!1,g(D),D=-1),h=!0;var Y=f;try{for(w(U),u=n(c);u!==null&&(!(u.expirationTime>U)||k&&!X());){var N=u.callback;if(typeof N=="function"){u.callback=null,f=u.priorityLevel;var T=N(u.expirationTime<=U);U=e.unstable_now(),typeof T=="function"?u.callback=T:u===n(c)&&r(c),w(U)}else r(c);u=n(c)}if(u!==null)var P=!0;else{var q=n(l);q!==null&&W(C,q.startTime-U),P=!1}return P}finally{u=null,f=Y,h=!1}}var A=!1,F=null,D=-1,B=5,M=-1;function X(){return!(e.unstable_now()-M<B)}function ee(){if(F!==null){var k=e.unstable_now();M=k;var U=!0;try{U=F(!0,k)}finally{U?V():(A=!1,F=null)}}else A=!1}var V;if(typeof m=="function")V=function(){m(ee)};else if(typeof MessageChannel<"u"){var Z=new MessageChannel,fe=Z.port2;Z.port1.onmessage=ee,V=function(){fe.postMessage(null)}}else V=function(){x(ee,0)};function Q(k){F=k,A||(A=!0,V())}function W(k,U){D=x(function(){k(e.unstable_now())},U)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(k){k.callback=null},e.unstable_continueExecution=function(){v||h||(v=!0,Q(L))},e.unstable_forceFrameRate=function(k){0>k||125<k?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):B=0<k?Math.floor(1e3/k):5},e.unstable_getCurrentPriorityLevel=function(){return f},e.unstable_getFirstCallbackNode=function(){return n(c)},e.unstable_next=function(k){switch(f){case 1:case 2:case 3:var U=3;break;default:U=f}var Y=f;f=U;try{return k()}finally{f=Y}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(k,U){switch(k){case 1:case 2:case 3:case 4:case 5:break;default:k=3}var Y=f;f=k;try{return U()}finally{f=Y}},e.unstable_scheduleCallback=function(k,U,Y){var N=e.unstable_now();switch(typeof Y=="object"&&Y!==null?(Y=Y.delay,Y=typeof Y=="number"&&0<Y?N+Y:N):Y=N,k){case 1:var T=-1;break;case 2:T=250;break;case 5:T=1073741823;break;case 4:T=1e4;break;default:T=5e3}return T=Y+T,k={id:d++,callback:U,priorityLevel:k,startTime:Y,expirationTime:T,sortIndex:-1},Y>N?(k.sortIndex=Y,t(l,k),n(c)===null&&k===n(l)&&(y?(g(D),D=-1):y=!0,W(C,Y-N))):(k.sortIndex=T,t(c,k),v||h||(v=!0,Q(L))),k},e.unstable_shouldYield=X,e.unstable_wrapCallback=function(k){var U=f;return function(){var Y=f;f=U;try{return k.apply(this,arguments)}finally{f=Y}}}})(zh);Fh.exports=zh;var Iy=Fh.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ny=_,Ot=Iy;function $(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Uh=new Set,Pi={};function Ur(e,t){Cs(e,t),Cs(e+"Capture",t)}function Cs(e,t){for(Pi[e]=t,e=0;e<t.length;e++)Uh.add(t[e])}var Mn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),yl=Object.prototype.hasOwnProperty,My=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,op={},ap={};function Ay(e){return yl.call(ap,e)?!0:yl.call(op,e)?!1:My.test(e)?ap[e]=!0:(op[e]=!0,!1)}function Oy(e,t,n,r){if(n!==null&&n.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function $y(e,t,n,r){if(t===null||typeof t>"u"||Oy(e,t,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function St(e,t,n,r,s,i,o){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=i,this.removeEmptyString=o}var nt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){nt[e]=new St(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];nt[t]=new St(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){nt[e]=new St(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){nt[e]=new St(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){nt[e]=new St(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){nt[e]=new St(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){nt[e]=new St(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){nt[e]=new St(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){nt[e]=new St(e,5,!1,e.toLowerCase(),null,!1,!1)});var Ld=/[\-:]([a-z])/g;function Dd(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(Ld,Dd);nt[t]=new St(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(Ld,Dd);nt[t]=new St(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(Ld,Dd);nt[t]=new St(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){nt[e]=new St(e,1,!1,e.toLowerCase(),null,!1,!1)});nt.xlinkHref=new St("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){nt[e]=new St(e,1,!1,e.toLowerCase(),null,!0,!0)});function Id(e,t,n,r){var s=nt.hasOwnProperty(t)?nt[t]:null;(s!==null?s.type!==0:r||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&($y(t,n,s,r)&&(n=null),r||s===null?Ay(t)&&(n===null?e.removeAttribute(t):e.setAttribute(t,""+n)):s.mustUseProperty?e[s.propertyName]=n===null?s.type===3?!1:"":n:(t=s.attributeName,r=s.attributeNamespace,n===null?e.removeAttribute(t):(s=s.type,n=s===3||s===4&&n===!0?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}var zn=Ny.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,fo=Symbol.for("react.element"),ns=Symbol.for("react.portal"),rs=Symbol.for("react.fragment"),Nd=Symbol.for("react.strict_mode"),wl=Symbol.for("react.profiler"),Bh=Symbol.for("react.provider"),Vh=Symbol.for("react.context"),Md=Symbol.for("react.forward_ref"),_l=Symbol.for("react.suspense"),Sl=Symbol.for("react.suspense_list"),Ad=Symbol.for("react.memo"),qn=Symbol.for("react.lazy"),Wh=Symbol.for("react.offscreen"),cp=Symbol.iterator;function Hs(e){return e===null||typeof e!="object"?null:(e=cp&&e[cp]||e["@@iterator"],typeof e=="function"?e:null)}var Ne=Object.assign,Pc;function di(e){if(Pc===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);Pc=t&&t[1]||""}return`
`+Pc+e}var jc=!1;function Lc(e,t){if(!e||jc)return"";jc=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(l){var r=l}Reflect.construct(e,[],t)}else{try{t.call()}catch(l){r=l}e.call(t.prototype)}else{try{throw Error()}catch(l){r=l}e()}}catch(l){if(l&&r&&typeof l.stack=="string"){for(var s=l.stack.split(`
`),i=r.stack.split(`
`),o=s.length-1,a=i.length-1;1<=o&&0<=a&&s[o]!==i[a];)a--;for(;1<=o&&0<=a;o--,a--)if(s[o]!==i[a]){if(o!==1||a!==1)do if(o--,a--,0>a||s[o]!==i[a]){var c=`
`+s[o].replace(" at new "," at ");return e.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",e.displayName)),c}while(1<=o&&0<=a);break}}}finally{jc=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?di(e):""}function Fy(e){switch(e.tag){case 5:return di(e.type);case 16:return di("Lazy");case 13:return di("Suspense");case 19:return di("SuspenseList");case 0:case 2:case 15:return e=Lc(e.type,!1),e;case 11:return e=Lc(e.type.render,!1),e;case 1:return e=Lc(e.type,!0),e;default:return""}}function xl(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case rs:return"Fragment";case ns:return"Portal";case wl:return"Profiler";case Nd:return"StrictMode";case _l:return"Suspense";case Sl:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case Vh:return(e.displayName||"Context")+".Consumer";case Bh:return(e._context.displayName||"Context")+".Provider";case Md:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case Ad:return t=e.displayName||null,t!==null?t:xl(e.type)||"Memo";case qn:t=e._payload,e=e._init;try{return xl(e(t))}catch{}}return null}function zy(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return xl(t);case 8:return t===Nd?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function fr(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function Hh(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function Uy(e){var t=Hh(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,i=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return s.call(this)},set:function(o){r=""+o,i.call(this,o)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function ho(e){e._valueTracker||(e._valueTracker=Uy(e))}function Qh(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=Hh(e)?e.checked?"true":"false":e.value),e=r,e!==n?(t.setValue(e),!0):!1}function ea(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function bl(e,t){var n=t.checked;return Ne({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??e._wrapperState.initialChecked})}function lp(e,t){var n=t.defaultValue==null?"":t.defaultValue,r=t.checked!=null?t.checked:t.defaultChecked;n=fr(t.value!=null?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function Kh(e,t){t=t.checked,t!=null&&Id(e,"checked",t,!1)}function Cl(e,t){Kh(e,t);var n=fr(t.value),r=t.type;if(n!=null)r==="number"?(n===0&&e.value===""||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if(r==="submit"||r==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?El(e,t.type,n):t.hasOwnProperty("defaultValue")&&El(e,t.type,fr(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function dp(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!(r!=="submit"&&r!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}n=e.name,n!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,n!==""&&(e.name=n)}function El(e,t,n){(t!=="number"||ea(e.ownerDocument)!==e)&&(n==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var ui=Array.isArray;function vs(e,t,n,r){if(e=e.options,t){t={};for(var s=0;s<n.length;s++)t["$"+n[s]]=!0;for(n=0;n<e.length;n++)s=t.hasOwnProperty("$"+e[n].value),e[n].selected!==s&&(e[n].selected=s),s&&r&&(e[n].defaultSelected=!0)}else{for(n=""+fr(n),t=null,s=0;s<e.length;s++){if(e[s].value===n){e[s].selected=!0,r&&(e[s].defaultSelected=!0);return}t!==null||e[s].disabled||(t=e[s])}t!==null&&(t.selected=!0)}}function Rl(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error($(91));return Ne({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function up(e,t){var n=t.value;if(n==null){if(n=t.children,t=t.defaultValue,n!=null){if(t!=null)throw Error($(92));if(ui(n)){if(1<n.length)throw Error($(93));n=n[0]}t=n}t==null&&(t=""),n=t}e._wrapperState={initialValue:fr(n)}}function qh(e,t){var n=fr(t.value),r=fr(t.defaultValue);n!=null&&(n=""+n,n!==e.value&&(e.value=n),t.defaultValue==null&&e.defaultValue!==n&&(e.defaultValue=n)),r!=null&&(e.defaultValue=""+r)}function pp(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function Gh(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function kl(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?Gh(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var mo,Xh=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,n,r,s){MSApp.execUnsafeLocalFunction(function(){return e(t,n,r,s)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(mo=mo||document.createElement("div"),mo.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=mo.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function ji(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var hi={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},By=["Webkit","ms","Moz","O"];Object.keys(hi).forEach(function(e){By.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),hi[t]=hi[e]})});function Yh(e,t,n){return t==null||typeof t=="boolean"||t===""?"":n||typeof t!="number"||t===0||hi.hasOwnProperty(e)&&hi[e]?(""+t).trim():t+"px"}function Jh(e,t){e=e.style;for(var n in t)if(t.hasOwnProperty(n)){var r=n.indexOf("--")===0,s=Yh(n,t[n],r);n==="float"&&(n="cssFloat"),r?e.setProperty(n,s):e[n]=s}}var Vy=Ne({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Tl(e,t){if(t){if(Vy[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error($(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error($(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error($(61))}if(t.style!=null&&typeof t.style!="object")throw Error($(62))}}function Pl(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var jl=null;function Od(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Ll=null,ys=null,ws=null;function fp(e){if(e=Ji(e)){if(typeof Ll!="function")throw Error($(280));var t=e.stateNode;t&&(t=Ma(t),Ll(e.stateNode,e.type,t))}}function Zh(e){ys?ws?ws.push(e):ws=[e]:ys=e}function em(){if(ys){var e=ys,t=ws;if(ws=ys=null,fp(e),t)for(e=0;e<t.length;e++)fp(t[e])}}function tm(e,t){return e(t)}function nm(){}var Dc=!1;function rm(e,t,n){if(Dc)return e(t,n);Dc=!0;try{return tm(e,t,n)}finally{Dc=!1,(ys!==null||ws!==null)&&(nm(),em())}}function Li(e,t){var n=e.stateNode;if(n===null)return null;var r=Ma(n);if(r===null)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(e=e.type,r=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!r;break e;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error($(231,t,typeof n));return n}var Dl=!1;if(Mn)try{var Qs={};Object.defineProperty(Qs,"passive",{get:function(){Dl=!0}}),window.addEventListener("test",Qs,Qs),window.removeEventListener("test",Qs,Qs)}catch{Dl=!1}function Wy(e,t,n,r,s,i,o,a,c){var l=Array.prototype.slice.call(arguments,3);try{t.apply(n,l)}catch(d){this.onError(d)}}var mi=!1,ta=null,na=!1,Il=null,Hy={onError:function(e){mi=!0,ta=e}};function Qy(e,t,n,r,s,i,o,a,c){mi=!1,ta=null,Wy.apply(Hy,arguments)}function Ky(e,t,n,r,s,i,o,a,c){if(Qy.apply(this,arguments),mi){if(mi){var l=ta;mi=!1,ta=null}else throw Error($(198));na||(na=!0,Il=l)}}function Br(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function sm(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function hp(e){if(Br(e)!==e)throw Error($(188))}function qy(e){var t=e.alternate;if(!t){if(t=Br(e),t===null)throw Error($(188));return t!==e?null:e}for(var n=e,r=t;;){var s=n.return;if(s===null)break;var i=s.alternate;if(i===null){if(r=s.return,r!==null){n=r;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===n)return hp(s),e;if(i===r)return hp(s),t;i=i.sibling}throw Error($(188))}if(n.return!==r.return)n=s,r=i;else{for(var o=!1,a=s.child;a;){if(a===n){o=!0,n=s,r=i;break}if(a===r){o=!0,r=s,n=i;break}a=a.sibling}if(!o){for(a=i.child;a;){if(a===n){o=!0,n=i,r=s;break}if(a===r){o=!0,r=i,n=s;break}a=a.sibling}if(!o)throw Error($(189))}}if(n.alternate!==r)throw Error($(190))}if(n.tag!==3)throw Error($(188));return n.stateNode.current===n?e:t}function im(e){return e=qy(e),e!==null?om(e):null}function om(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=om(e);if(t!==null)return t;e=e.sibling}return null}var am=Ot.unstable_scheduleCallback,mp=Ot.unstable_cancelCallback,Gy=Ot.unstable_shouldYield,Xy=Ot.unstable_requestPaint,Fe=Ot.unstable_now,Yy=Ot.unstable_getCurrentPriorityLevel,$d=Ot.unstable_ImmediatePriority,cm=Ot.unstable_UserBlockingPriority,ra=Ot.unstable_NormalPriority,Jy=Ot.unstable_LowPriority,lm=Ot.unstable_IdlePriority,La=null,wn=null;function Zy(e){if(wn&&typeof wn.onCommitFiberRoot=="function")try{wn.onCommitFiberRoot(La,e,void 0,(e.current.flags&128)===128)}catch{}}var tn=Math.clz32?Math.clz32:n0,e0=Math.log,t0=Math.LN2;function n0(e){return e>>>=0,e===0?32:31-(e0(e)/t0|0)|0}var go=64,vo=4194304;function pi(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function sa(e,t){var n=e.pendingLanes;if(n===0)return 0;var r=0,s=e.suspendedLanes,i=e.pingedLanes,o=n&268435455;if(o!==0){var a=o&~s;a!==0?r=pi(a):(i&=o,i!==0&&(r=pi(i)))}else o=n&~s,o!==0?r=pi(o):i!==0&&(r=pi(i));if(r===0)return 0;if(t!==0&&t!==r&&!(t&s)&&(s=r&-r,i=t&-t,s>=i||s===16&&(i&4194240)!==0))return t;if(r&4&&(r|=n&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=r;0<t;)n=31-tn(t),s=1<<n,r|=e[n],t&=~s;return r}function r0(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function s0(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,s=e.expirationTimes,i=e.pendingLanes;0<i;){var o=31-tn(i),a=1<<o,c=s[o];c===-1?(!(a&n)||a&r)&&(s[o]=r0(a,t)):c<=t&&(e.expiredLanes|=a),i&=~a}}function Nl(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function dm(){var e=go;return go<<=1,!(go&4194240)&&(go=64),e}function Ic(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function Xi(e,t,n){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-tn(t),e[t]=n}function i0(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var s=31-tn(n),i=1<<s;t[s]=0,r[s]=-1,e[s]=-1,n&=~i}}function Fd(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-tn(n),s=1<<r;s&t|e[r]&t&&(e[r]|=t),n&=~s}}var xe=0;function um(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var pm,zd,fm,hm,mm,Ml=!1,yo=[],rr=null,sr=null,ir=null,Di=new Map,Ii=new Map,Xn=[],o0="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function gp(e,t){switch(e){case"focusin":case"focusout":rr=null;break;case"dragenter":case"dragleave":sr=null;break;case"mouseover":case"mouseout":ir=null;break;case"pointerover":case"pointerout":Di.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ii.delete(t.pointerId)}}function Ks(e,t,n,r,s,i){return e===null||e.nativeEvent!==i?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[s]},t!==null&&(t=Ji(t),t!==null&&zd(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,s!==null&&t.indexOf(s)===-1&&t.push(s),e)}function a0(e,t,n,r,s){switch(t){case"focusin":return rr=Ks(rr,e,t,n,r,s),!0;case"dragenter":return sr=Ks(sr,e,t,n,r,s),!0;case"mouseover":return ir=Ks(ir,e,t,n,r,s),!0;case"pointerover":var i=s.pointerId;return Di.set(i,Ks(Di.get(i)||null,e,t,n,r,s)),!0;case"gotpointercapture":return i=s.pointerId,Ii.set(i,Ks(Ii.get(i)||null,e,t,n,r,s)),!0}return!1}function gm(e){var t=kr(e.target);if(t!==null){var n=Br(t);if(n!==null){if(t=n.tag,t===13){if(t=sm(n),t!==null){e.blockedOn=t,mm(e.priority,function(){fm(n)});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Fo(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=Al(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(n===null){n=e.nativeEvent;var r=new n.constructor(n.type,n);jl=r,n.target.dispatchEvent(r),jl=null}else return t=Ji(n),t!==null&&zd(t),e.blockedOn=n,!1;t.shift()}return!0}function vp(e,t,n){Fo(e)&&n.delete(t)}function c0(){Ml=!1,rr!==null&&Fo(rr)&&(rr=null),sr!==null&&Fo(sr)&&(sr=null),ir!==null&&Fo(ir)&&(ir=null),Di.forEach(vp),Ii.forEach(vp)}function qs(e,t){e.blockedOn===t&&(e.blockedOn=null,Ml||(Ml=!0,Ot.unstable_scheduleCallback(Ot.unstable_NormalPriority,c0)))}function Ni(e){function t(s){return qs(s,e)}if(0<yo.length){qs(yo[0],e);for(var n=1;n<yo.length;n++){var r=yo[n];r.blockedOn===e&&(r.blockedOn=null)}}for(rr!==null&&qs(rr,e),sr!==null&&qs(sr,e),ir!==null&&qs(ir,e),Di.forEach(t),Ii.forEach(t),n=0;n<Xn.length;n++)r=Xn[n],r.blockedOn===e&&(r.blockedOn=null);for(;0<Xn.length&&(n=Xn[0],n.blockedOn===null);)gm(n),n.blockedOn===null&&Xn.shift()}var _s=zn.ReactCurrentBatchConfig,ia=!0;function l0(e,t,n,r){var s=xe,i=_s.transition;_s.transition=null;try{xe=1,Ud(e,t,n,r)}finally{xe=s,_s.transition=i}}function d0(e,t,n,r){var s=xe,i=_s.transition;_s.transition=null;try{xe=4,Ud(e,t,n,r)}finally{xe=s,_s.transition=i}}function Ud(e,t,n,r){if(ia){var s=Al(e,t,n,r);if(s===null)Vc(e,t,r,oa,n),gp(e,r);else if(a0(s,e,t,n,r))r.stopPropagation();else if(gp(e,r),t&4&&-1<o0.indexOf(e)){for(;s!==null;){var i=Ji(s);if(i!==null&&pm(i),i=Al(e,t,n,r),i===null&&Vc(e,t,r,oa,n),i===s)break;s=i}s!==null&&r.stopPropagation()}else Vc(e,t,r,null,n)}}var oa=null;function Al(e,t,n,r){if(oa=null,e=Od(r),e=kr(e),e!==null)if(t=Br(e),t===null)e=null;else if(n=t.tag,n===13){if(e=sm(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return oa=e,null}function vm(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Yy()){case $d:return 1;case cm:return 4;case ra:case Jy:return 16;case lm:return 536870912;default:return 16}default:return 16}}var Zn=null,Bd=null,zo=null;function ym(){if(zo)return zo;var e,t=Bd,n=t.length,r,s="value"in Zn?Zn.value:Zn.textContent,i=s.length;for(e=0;e<n&&t[e]===s[e];e++);var o=n-e;for(r=1;r<=o&&t[n-r]===s[i-r];r++);return zo=s.slice(e,1<r?1-r:void 0)}function Uo(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function wo(){return!0}function yp(){return!1}function Ft(e){function t(n,r,s,i,o){this._reactName=n,this._targetInst=s,this.type=r,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var a in e)e.hasOwnProperty(a)&&(n=e[a],this[a]=n?n(i):i[a]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?wo:yp,this.isPropagationStopped=yp,this}return Ne(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=wo)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=wo)},persist:function(){},isPersistent:wo}),t}var Ds={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Vd=Ft(Ds),Yi=Ne({},Ds,{view:0,detail:0}),u0=Ft(Yi),Nc,Mc,Gs,Da=Ne({},Yi,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Wd,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Gs&&(Gs&&e.type==="mousemove"?(Nc=e.screenX-Gs.screenX,Mc=e.screenY-Gs.screenY):Mc=Nc=0,Gs=e),Nc)},movementY:function(e){return"movementY"in e?e.movementY:Mc}}),wp=Ft(Da),p0=Ne({},Da,{dataTransfer:0}),f0=Ft(p0),h0=Ne({},Yi,{relatedTarget:0}),Ac=Ft(h0),m0=Ne({},Ds,{animationName:0,elapsedTime:0,pseudoElement:0}),g0=Ft(m0),v0=Ne({},Ds,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),y0=Ft(v0),w0=Ne({},Ds,{data:0}),_p=Ft(w0),_0={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},S0={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},x0={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function b0(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=x0[e])?!!t[e]:!1}function Wd(){return b0}var C0=Ne({},Yi,{key:function(e){if(e.key){var t=_0[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Uo(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?S0[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Wd,charCode:function(e){return e.type==="keypress"?Uo(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Uo(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),E0=Ft(C0),R0=Ne({},Da,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Sp=Ft(R0),k0=Ne({},Yi,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Wd}),T0=Ft(k0),P0=Ne({},Ds,{propertyName:0,elapsedTime:0,pseudoElement:0}),j0=Ft(P0),L0=Ne({},Da,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),D0=Ft(L0),I0=[9,13,27,32],Hd=Mn&&"CompositionEvent"in window,gi=null;Mn&&"documentMode"in document&&(gi=document.documentMode);var N0=Mn&&"TextEvent"in window&&!gi,wm=Mn&&(!Hd||gi&&8<gi&&11>=gi),xp=String.fromCharCode(32),bp=!1;function _m(e,t){switch(e){case"keyup":return I0.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Sm(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var ss=!1;function M0(e,t){switch(e){case"compositionend":return Sm(t);case"keypress":return t.which!==32?null:(bp=!0,xp);case"textInput":return e=t.data,e===xp&&bp?null:e;default:return null}}function A0(e,t){if(ss)return e==="compositionend"||!Hd&&_m(e,t)?(e=ym(),zo=Bd=Zn=null,ss=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return wm&&t.locale!=="ko"?null:t.data;default:return null}}var O0={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Cp(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!O0[e.type]:t==="textarea"}function xm(e,t,n,r){Zh(r),t=aa(t,"onChange"),0<t.length&&(n=new Vd("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var vi=null,Mi=null;function $0(e){Im(e,0)}function Ia(e){var t=as(e);if(Qh(t))return e}function F0(e,t){if(e==="change")return t}var bm=!1;if(Mn){var Oc;if(Mn){var $c="oninput"in document;if(!$c){var Ep=document.createElement("div");Ep.setAttribute("oninput","return;"),$c=typeof Ep.oninput=="function"}Oc=$c}else Oc=!1;bm=Oc&&(!document.documentMode||9<document.documentMode)}function Rp(){vi&&(vi.detachEvent("onpropertychange",Cm),Mi=vi=null)}function Cm(e){if(e.propertyName==="value"&&Ia(Mi)){var t=[];xm(t,Mi,e,Od(e)),rm($0,t)}}function z0(e,t,n){e==="focusin"?(Rp(),vi=t,Mi=n,vi.attachEvent("onpropertychange",Cm)):e==="focusout"&&Rp()}function U0(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Ia(Mi)}function B0(e,t){if(e==="click")return Ia(t)}function V0(e,t){if(e==="input"||e==="change")return Ia(t)}function W0(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var on=typeof Object.is=="function"?Object.is:W0;function Ai(e,t){if(on(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!yl.call(t,s)||!on(e[s],t[s]))return!1}return!0}function kp(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Tp(e,t){var n=kp(e);e=0;for(var r;n;){if(n.nodeType===3){if(r=e+n.textContent.length,e<=t&&r>=t)return{node:n,offset:t-e};e=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=kp(n)}}function Em(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?Em(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function Rm(){for(var e=window,t=ea();t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)e=t.contentWindow;else break;t=ea(e.document)}return t}function Qd(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function H0(e){var t=Rm(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&Em(n.ownerDocument.documentElement,n)){if(r!==null&&Qd(n)){if(t=r.start,e=r.end,e===void 0&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if(e=(t=n.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var s=n.textContent.length,i=Math.min(r.start,s);r=r.end===void 0?i:Math.min(r.end,s),!e.extend&&i>r&&(s=r,r=i,i=s),s=Tp(n,i);var o=Tp(n,r);s&&o&&(e.rangeCount!==1||e.anchorNode!==s.node||e.anchorOffset!==s.offset||e.focusNode!==o.node||e.focusOffset!==o.offset)&&(t=t.createRange(),t.setStart(s.node,s.offset),e.removeAllRanges(),i>r?(e.addRange(t),e.extend(o.node,o.offset)):(t.setEnd(o.node,o.offset),e.addRange(t)))}}for(t=[],e=n;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<t.length;n++)e=t[n],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var Q0=Mn&&"documentMode"in document&&11>=document.documentMode,is=null,Ol=null,yi=null,$l=!1;function Pp(e,t,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;$l||is==null||is!==ea(r)||(r=is,"selectionStart"in r&&Qd(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),yi&&Ai(yi,r)||(yi=r,r=aa(Ol,"onSelect"),0<r.length&&(t=new Vd("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=is)))}function _o(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var os={animationend:_o("Animation","AnimationEnd"),animationiteration:_o("Animation","AnimationIteration"),animationstart:_o("Animation","AnimationStart"),transitionend:_o("Transition","TransitionEnd")},Fc={},km={};Mn&&(km=document.createElement("div").style,"AnimationEvent"in window||(delete os.animationend.animation,delete os.animationiteration.animation,delete os.animationstart.animation),"TransitionEvent"in window||delete os.transitionend.transition);function Na(e){if(Fc[e])return Fc[e];if(!os[e])return e;var t=os[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in km)return Fc[e]=t[n];return e}var Tm=Na("animationend"),Pm=Na("animationiteration"),jm=Na("animationstart"),Lm=Na("transitionend"),Dm=new Map,jp="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function mr(e,t){Dm.set(e,t),Ur(t,[e])}for(var zc=0;zc<jp.length;zc++){var Uc=jp[zc],K0=Uc.toLowerCase(),q0=Uc[0].toUpperCase()+Uc.slice(1);mr(K0,"on"+q0)}mr(Tm,"onAnimationEnd");mr(Pm,"onAnimationIteration");mr(jm,"onAnimationStart");mr("dblclick","onDoubleClick");mr("focusin","onFocus");mr("focusout","onBlur");mr(Lm,"onTransitionEnd");Cs("onMouseEnter",["mouseout","mouseover"]);Cs("onMouseLeave",["mouseout","mouseover"]);Cs("onPointerEnter",["pointerout","pointerover"]);Cs("onPointerLeave",["pointerout","pointerover"]);Ur("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Ur("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Ur("onBeforeInput",["compositionend","keypress","textInput","paste"]);Ur("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Ur("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Ur("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var fi="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),G0=new Set("cancel close invalid load scroll toggle".split(" ").concat(fi));function Lp(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,Ky(r,t,void 0,e),e.currentTarget=null}function Im(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var r=e[n],s=r.event;r=r.listeners;e:{var i=void 0;if(t)for(var o=r.length-1;0<=o;o--){var a=r[o],c=a.instance,l=a.currentTarget;if(a=a.listener,c!==i&&s.isPropagationStopped())break e;Lp(s,a,l),i=c}else for(o=0;o<r.length;o++){if(a=r[o],c=a.instance,l=a.currentTarget,a=a.listener,c!==i&&s.isPropagationStopped())break e;Lp(s,a,l),i=c}}}if(na)throw e=Il,na=!1,Il=null,e}function Pe(e,t){var n=t[Vl];n===void 0&&(n=t[Vl]=new Set);var r=e+"__bubble";n.has(r)||(Nm(t,e,2,!1),n.add(r))}function Bc(e,t,n){var r=0;t&&(r|=4),Nm(n,e,r,t)}var So="_reactListening"+Math.random().toString(36).slice(2);function Oi(e){if(!e[So]){e[So]=!0,Uh.forEach(function(n){n!=="selectionchange"&&(G0.has(n)||Bc(n,!1,e),Bc(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[So]||(t[So]=!0,Bc("selectionchange",!1,t))}}function Nm(e,t,n,r){switch(vm(t)){case 1:var s=l0;break;case 4:s=d0;break;default:s=Ud}n=s.bind(null,t,n,e),s=void 0,!Dl||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(s=!0),r?s!==void 0?e.addEventListener(t,n,{capture:!0,passive:s}):e.addEventListener(t,n,!0):s!==void 0?e.addEventListener(t,n,{passive:s}):e.addEventListener(t,n,!1)}function Vc(e,t,n,r,s){var i=r;if(!(t&1)&&!(t&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var a=r.stateNode.containerInfo;if(a===s||a.nodeType===8&&a.parentNode===s)break;if(o===4)for(o=r.return;o!==null;){var c=o.tag;if((c===3||c===4)&&(c=o.stateNode.containerInfo,c===s||c.nodeType===8&&c.parentNode===s))return;o=o.return}for(;a!==null;){if(o=kr(a),o===null)return;if(c=o.tag,c===5||c===6){r=i=o;continue e}a=a.parentNode}}r=r.return}rm(function(){var l=i,d=Od(n),u=[];e:{var f=Dm.get(e);if(f!==void 0){var h=Vd,v=e;switch(e){case"keypress":if(Uo(n)===0)break e;case"keydown":case"keyup":h=E0;break;case"focusin":v="focus",h=Ac;break;case"focusout":v="blur",h=Ac;break;case"beforeblur":case"afterblur":h=Ac;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":h=wp;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":h=f0;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":h=T0;break;case Tm:case Pm:case jm:h=g0;break;case Lm:h=j0;break;case"scroll":h=u0;break;case"wheel":h=D0;break;case"copy":case"cut":case"paste":h=y0;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":h=Sp}var y=(t&4)!==0,x=!y&&e==="scroll",g=y?f!==null?f+"Capture":null:f;y=[];for(var m=l,w;m!==null;){w=m;var C=w.stateNode;if(w.tag===5&&C!==null&&(w=C,g!==null&&(C=Li(m,g),C!=null&&y.push($i(m,C,w)))),x)break;m=m.return}0<y.length&&(f=new h(f,v,null,n,d),u.push({event:f,listeners:y}))}}if(!(t&7)){e:{if(f=e==="mouseover"||e==="pointerover",h=e==="mouseout"||e==="pointerout",f&&n!==jl&&(v=n.relatedTarget||n.fromElement)&&(kr(v)||v[An]))break e;if((h||f)&&(f=d.window===d?d:(f=d.ownerDocument)?f.defaultView||f.parentWindow:window,h?(v=n.relatedTarget||n.toElement,h=l,v=v?kr(v):null,v!==null&&(x=Br(v),v!==x||v.tag!==5&&v.tag!==6)&&(v=null)):(h=null,v=l),h!==v)){if(y=wp,C="onMouseLeave",g="onMouseEnter",m="mouse",(e==="pointerout"||e==="pointerover")&&(y=Sp,C="onPointerLeave",g="onPointerEnter",m="pointer"),x=h==null?f:as(h),w=v==null?f:as(v),f=new y(C,m+"leave",h,n,d),f.target=x,f.relatedTarget=w,C=null,kr(d)===l&&(y=new y(g,m+"enter",v,n,d),y.target=w,y.relatedTarget=x,C=y),x=C,h&&v)t:{for(y=h,g=v,m=0,w=y;w;w=Qr(w))m++;for(w=0,C=g;C;C=Qr(C))w++;for(;0<m-w;)y=Qr(y),m--;for(;0<w-m;)g=Qr(g),w--;for(;m--;){if(y===g||g!==null&&y===g.alternate)break t;y=Qr(y),g=Qr(g)}y=null}else y=null;h!==null&&Dp(u,f,h,y,!1),v!==null&&x!==null&&Dp(u,x,v,y,!0)}}e:{if(f=l?as(l):window,h=f.nodeName&&f.nodeName.toLowerCase(),h==="select"||h==="input"&&f.type==="file")var L=F0;else if(Cp(f))if(bm)L=V0;else{L=U0;var A=z0}else(h=f.nodeName)&&h.toLowerCase()==="input"&&(f.type==="checkbox"||f.type==="radio")&&(L=B0);if(L&&(L=L(e,l))){xm(u,L,n,d);break e}A&&A(e,f,l),e==="focusout"&&(A=f._wrapperState)&&A.controlled&&f.type==="number"&&El(f,"number",f.value)}switch(A=l?as(l):window,e){case"focusin":(Cp(A)||A.contentEditable==="true")&&(is=A,Ol=l,yi=null);break;case"focusout":yi=Ol=is=null;break;case"mousedown":$l=!0;break;case"contextmenu":case"mouseup":case"dragend":$l=!1,Pp(u,n,d);break;case"selectionchange":if(Q0)break;case"keydown":case"keyup":Pp(u,n,d)}var F;if(Hd)e:{switch(e){case"compositionstart":var D="onCompositionStart";break e;case"compositionend":D="onCompositionEnd";break e;case"compositionupdate":D="onCompositionUpdate";break e}D=void 0}else ss?_m(e,n)&&(D="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(D="onCompositionStart");D&&(wm&&n.locale!=="ko"&&(ss||D!=="onCompositionStart"?D==="onCompositionEnd"&&ss&&(F=ym()):(Zn=d,Bd="value"in Zn?Zn.value:Zn.textContent,ss=!0)),A=aa(l,D),0<A.length&&(D=new _p(D,e,null,n,d),u.push({event:D,listeners:A}),F?D.data=F:(F=Sm(n),F!==null&&(D.data=F)))),(F=N0?M0(e,n):A0(e,n))&&(l=aa(l,"onBeforeInput"),0<l.length&&(d=new _p("onBeforeInput","beforeinput",null,n,d),u.push({event:d,listeners:l}),d.data=F))}Im(u,t)})}function $i(e,t,n){return{instance:e,listener:t,currentTarget:n}}function aa(e,t){for(var n=t+"Capture",r=[];e!==null;){var s=e,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=Li(e,n),i!=null&&r.unshift($i(e,i,s)),i=Li(e,t),i!=null&&r.push($i(e,i,s))),e=e.return}return r}function Qr(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function Dp(e,t,n,r,s){for(var i=t._reactName,o=[];n!==null&&n!==r;){var a=n,c=a.alternate,l=a.stateNode;if(c!==null&&c===r)break;a.tag===5&&l!==null&&(a=l,s?(c=Li(n,i),c!=null&&o.unshift($i(n,c,a))):s||(c=Li(n,i),c!=null&&o.push($i(n,c,a)))),n=n.return}o.length!==0&&e.push({event:t,listeners:o})}var X0=/\r\n?/g,Y0=/\u0000|\uFFFD/g;function Ip(e){return(typeof e=="string"?e:""+e).replace(X0,`
`).replace(Y0,"")}function xo(e,t,n){if(t=Ip(t),Ip(e)!==t&&n)throw Error($(425))}function ca(){}var Fl=null,zl=null;function Ul(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Bl=typeof setTimeout=="function"?setTimeout:void 0,J0=typeof clearTimeout=="function"?clearTimeout:void 0,Np=typeof Promise=="function"?Promise:void 0,Z0=typeof queueMicrotask=="function"?queueMicrotask:typeof Np<"u"?function(e){return Np.resolve(null).then(e).catch(ew)}:Bl;function ew(e){setTimeout(function(){throw e})}function Wc(e,t){var n=t,r=0;do{var s=n.nextSibling;if(e.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(r===0){e.removeChild(s),Ni(t);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=s}while(n);Ni(t)}function or(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function Mp(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"){if(t===0)return e;t--}else n==="/$"&&t++}e=e.previousSibling}return null}var Is=Math.random().toString(36).slice(2),yn="__reactFiber$"+Is,Fi="__reactProps$"+Is,An="__reactContainer$"+Is,Vl="__reactEvents$"+Is,tw="__reactListeners$"+Is,nw="__reactHandles$"+Is;function kr(e){var t=e[yn];if(t)return t;for(var n=e.parentNode;n;){if(t=n[An]||n[yn]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=Mp(e);e!==null;){if(n=e[yn])return n;e=Mp(e)}return t}e=n,n=e.parentNode}return null}function Ji(e){return e=e[yn]||e[An],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function as(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error($(33))}function Ma(e){return e[Fi]||null}var Wl=[],cs=-1;function gr(e){return{current:e}}function je(e){0>cs||(e.current=Wl[cs],Wl[cs]=null,cs--)}function Te(e,t){cs++,Wl[cs]=e.current,e.current=t}var hr={},ht=gr(hr),Et=gr(!1),Ir=hr;function Es(e,t){var n=e.type.contextTypes;if(!n)return hr;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in n)s[i]=t[i];return r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=s),s}function Rt(e){return e=e.childContextTypes,e!=null}function la(){je(Et),je(ht)}function Ap(e,t,n){if(ht.current!==hr)throw Error($(168));Te(ht,t),Te(Et,n)}function Mm(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var s in r)if(!(s in t))throw Error($(108,zy(e)||"Unknown",s));return Ne({},n,r)}function da(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||hr,Ir=ht.current,Te(ht,e),Te(Et,Et.current),!0}function Op(e,t,n){var r=e.stateNode;if(!r)throw Error($(169));n?(e=Mm(e,t,Ir),r.__reactInternalMemoizedMergedChildContext=e,je(Et),je(ht),Te(ht,e)):je(Et),Te(Et,n)}var Ln=null,Aa=!1,Hc=!1;function Am(e){Ln===null?Ln=[e]:Ln.push(e)}function rw(e){Aa=!0,Am(e)}function vr(){if(!Hc&&Ln!==null){Hc=!0;var e=0,t=xe;try{var n=Ln;for(xe=1;e<n.length;e++){var r=n[e];do r=r(!0);while(r!==null)}Ln=null,Aa=!1}catch(s){throw Ln!==null&&(Ln=Ln.slice(e+1)),am($d,vr),s}finally{xe=t,Hc=!1}}return null}var ls=[],ds=0,ua=null,pa=0,zt=[],Ut=0,Nr=null,Dn=1,In="";function Er(e,t){ls[ds++]=pa,ls[ds++]=ua,ua=e,pa=t}function Om(e,t,n){zt[Ut++]=Dn,zt[Ut++]=In,zt[Ut++]=Nr,Nr=e;var r=Dn;e=In;var s=32-tn(r)-1;r&=~(1<<s),n+=1;var i=32-tn(t)+s;if(30<i){var o=s-s%5;i=(r&(1<<o)-1).toString(32),r>>=o,s-=o,Dn=1<<32-tn(t)+s|n<<s|r,In=i+e}else Dn=1<<i|n<<s|r,In=e}function Kd(e){e.return!==null&&(Er(e,1),Om(e,1,0))}function qd(e){for(;e===ua;)ua=ls[--ds],ls[ds]=null,pa=ls[--ds],ls[ds]=null;for(;e===Nr;)Nr=zt[--Ut],zt[Ut]=null,In=zt[--Ut],zt[Ut]=null,Dn=zt[--Ut],zt[Ut]=null}var At=null,Mt=null,Le=!1,en=null;function $m(e,t){var n=Bt(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)}function $p(e,t){switch(e.tag){case 5:var n=e.type;return t=t.nodeType!==1||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,At=e,Mt=or(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,At=e,Mt=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(n=Nr!==null?{id:Dn,overflow:In}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},n=Bt(18,null,null,0),n.stateNode=t,n.return=e,e.child=n,At=e,Mt=null,!0):!1;default:return!1}}function Hl(e){return(e.mode&1)!==0&&(e.flags&128)===0}function Ql(e){if(Le){var t=Mt;if(t){var n=t;if(!$p(e,t)){if(Hl(e))throw Error($(418));t=or(n.nextSibling);var r=At;t&&$p(e,t)?$m(r,n):(e.flags=e.flags&-4097|2,Le=!1,At=e)}}else{if(Hl(e))throw Error($(418));e.flags=e.flags&-4097|2,Le=!1,At=e}}}function Fp(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;At=e}function bo(e){if(e!==At)return!1;if(!Le)return Fp(e),Le=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!Ul(e.type,e.memoizedProps)),t&&(t=Mt)){if(Hl(e))throw Fm(),Error($(418));for(;t;)$m(e,t),t=or(t.nextSibling)}if(Fp(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error($(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="/$"){if(t===0){Mt=or(e.nextSibling);break e}t--}else n!=="$"&&n!=="$!"&&n!=="$?"||t++}e=e.nextSibling}Mt=null}}else Mt=At?or(e.stateNode.nextSibling):null;return!0}function Fm(){for(var e=Mt;e;)e=or(e.nextSibling)}function Rs(){Mt=At=null,Le=!1}function Gd(e){en===null?en=[e]:en.push(e)}var sw=zn.ReactCurrentBatchConfig;function Xs(e,t,n){if(e=n.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error($(309));var r=n.stateNode}if(!r)throw Error($(147,e));var s=r,i=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===i?t.ref:(t=function(o){var a=s.refs;o===null?delete a[i]:a[i]=o},t._stringRef=i,t)}if(typeof e!="string")throw Error($(284));if(!n._owner)throw Error($(290,e))}return e}function Co(e,t){throw e=Object.prototype.toString.call(t),Error($(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function zp(e){var t=e._init;return t(e._payload)}function zm(e){function t(g,m){if(e){var w=g.deletions;w===null?(g.deletions=[m],g.flags|=16):w.push(m)}}function n(g,m){if(!e)return null;for(;m!==null;)t(g,m),m=m.sibling;return null}function r(g,m){for(g=new Map;m!==null;)m.key!==null?g.set(m.key,m):g.set(m.index,m),m=m.sibling;return g}function s(g,m){return g=dr(g,m),g.index=0,g.sibling=null,g}function i(g,m,w){return g.index=w,e?(w=g.alternate,w!==null?(w=w.index,w<m?(g.flags|=2,m):w):(g.flags|=2,m)):(g.flags|=1048576,m)}function o(g){return e&&g.alternate===null&&(g.flags|=2),g}function a(g,m,w,C){return m===null||m.tag!==6?(m=Jc(w,g.mode,C),m.return=g,m):(m=s(m,w),m.return=g,m)}function c(g,m,w,C){var L=w.type;return L===rs?d(g,m,w.props.children,C,w.key):m!==null&&(m.elementType===L||typeof L=="object"&&L!==null&&L.$$typeof===qn&&zp(L)===m.type)?(C=s(m,w.props),C.ref=Xs(g,m,w),C.return=g,C):(C=qo(w.type,w.key,w.props,null,g.mode,C),C.ref=Xs(g,m,w),C.return=g,C)}function l(g,m,w,C){return m===null||m.tag!==4||m.stateNode.containerInfo!==w.containerInfo||m.stateNode.implementation!==w.implementation?(m=Zc(w,g.mode,C),m.return=g,m):(m=s(m,w.children||[]),m.return=g,m)}function d(g,m,w,C,L){return m===null||m.tag!==7?(m=Dr(w,g.mode,C,L),m.return=g,m):(m=s(m,w),m.return=g,m)}function u(g,m,w){if(typeof m=="string"&&m!==""||typeof m=="number")return m=Jc(""+m,g.mode,w),m.return=g,m;if(typeof m=="object"&&m!==null){switch(m.$$typeof){case fo:return w=qo(m.type,m.key,m.props,null,g.mode,w),w.ref=Xs(g,null,m),w.return=g,w;case ns:return m=Zc(m,g.mode,w),m.return=g,m;case qn:var C=m._init;return u(g,C(m._payload),w)}if(ui(m)||Hs(m))return m=Dr(m,g.mode,w,null),m.return=g,m;Co(g,m)}return null}function f(g,m,w,C){var L=m!==null?m.key:null;if(typeof w=="string"&&w!==""||typeof w=="number")return L!==null?null:a(g,m,""+w,C);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case fo:return w.key===L?c(g,m,w,C):null;case ns:return w.key===L?l(g,m,w,C):null;case qn:return L=w._init,f(g,m,L(w._payload),C)}if(ui(w)||Hs(w))return L!==null?null:d(g,m,w,C,null);Co(g,w)}return null}function h(g,m,w,C,L){if(typeof C=="string"&&C!==""||typeof C=="number")return g=g.get(w)||null,a(m,g,""+C,L);if(typeof C=="object"&&C!==null){switch(C.$$typeof){case fo:return g=g.get(C.key===null?w:C.key)||null,c(m,g,C,L);case ns:return g=g.get(C.key===null?w:C.key)||null,l(m,g,C,L);case qn:var A=C._init;return h(g,m,w,A(C._payload),L)}if(ui(C)||Hs(C))return g=g.get(w)||null,d(m,g,C,L,null);Co(m,C)}return null}function v(g,m,w,C){for(var L=null,A=null,F=m,D=m=0,B=null;F!==null&&D<w.length;D++){F.index>D?(B=F,F=null):B=F.sibling;var M=f(g,F,w[D],C);if(M===null){F===null&&(F=B);break}e&&F&&M.alternate===null&&t(g,F),m=i(M,m,D),A===null?L=M:A.sibling=M,A=M,F=B}if(D===w.length)return n(g,F),Le&&Er(g,D),L;if(F===null){for(;D<w.length;D++)F=u(g,w[D],C),F!==null&&(m=i(F,m,D),A===null?L=F:A.sibling=F,A=F);return Le&&Er(g,D),L}for(F=r(g,F);D<w.length;D++)B=h(F,g,D,w[D],C),B!==null&&(e&&B.alternate!==null&&F.delete(B.key===null?D:B.key),m=i(B,m,D),A===null?L=B:A.sibling=B,A=B);return e&&F.forEach(function(X){return t(g,X)}),Le&&Er(g,D),L}function y(g,m,w,C){var L=Hs(w);if(typeof L!="function")throw Error($(150));if(w=L.call(w),w==null)throw Error($(151));for(var A=L=null,F=m,D=m=0,B=null,M=w.next();F!==null&&!M.done;D++,M=w.next()){F.index>D?(B=F,F=null):B=F.sibling;var X=f(g,F,M.value,C);if(X===null){F===null&&(F=B);break}e&&F&&X.alternate===null&&t(g,F),m=i(X,m,D),A===null?L=X:A.sibling=X,A=X,F=B}if(M.done)return n(g,F),Le&&Er(g,D),L;if(F===null){for(;!M.done;D++,M=w.next())M=u(g,M.value,C),M!==null&&(m=i(M,m,D),A===null?L=M:A.sibling=M,A=M);return Le&&Er(g,D),L}for(F=r(g,F);!M.done;D++,M=w.next())M=h(F,g,D,M.value,C),M!==null&&(e&&M.alternate!==null&&F.delete(M.key===null?D:M.key),m=i(M,m,D),A===null?L=M:A.sibling=M,A=M);return e&&F.forEach(function(ee){return t(g,ee)}),Le&&Er(g,D),L}function x(g,m,w,C){if(typeof w=="object"&&w!==null&&w.type===rs&&w.key===null&&(w=w.props.children),typeof w=="object"&&w!==null){switch(w.$$typeof){case fo:e:{for(var L=w.key,A=m;A!==null;){if(A.key===L){if(L=w.type,L===rs){if(A.tag===7){n(g,A.sibling),m=s(A,w.props.children),m.return=g,g=m;break e}}else if(A.elementType===L||typeof L=="object"&&L!==null&&L.$$typeof===qn&&zp(L)===A.type){n(g,A.sibling),m=s(A,w.props),m.ref=Xs(g,A,w),m.return=g,g=m;break e}n(g,A);break}else t(g,A);A=A.sibling}w.type===rs?(m=Dr(w.props.children,g.mode,C,w.key),m.return=g,g=m):(C=qo(w.type,w.key,w.props,null,g.mode,C),C.ref=Xs(g,m,w),C.return=g,g=C)}return o(g);case ns:e:{for(A=w.key;m!==null;){if(m.key===A)if(m.tag===4&&m.stateNode.containerInfo===w.containerInfo&&m.stateNode.implementation===w.implementation){n(g,m.sibling),m=s(m,w.children||[]),m.return=g,g=m;break e}else{n(g,m);break}else t(g,m);m=m.sibling}m=Zc(w,g.mode,C),m.return=g,g=m}return o(g);case qn:return A=w._init,x(g,m,A(w._payload),C)}if(ui(w))return v(g,m,w,C);if(Hs(w))return y(g,m,w,C);Co(g,w)}return typeof w=="string"&&w!==""||typeof w=="number"?(w=""+w,m!==null&&m.tag===6?(n(g,m.sibling),m=s(m,w),m.return=g,g=m):(n(g,m),m=Jc(w,g.mode,C),m.return=g,g=m),o(g)):n(g,m)}return x}var ks=zm(!0),Um=zm(!1),fa=gr(null),ha=null,us=null,Xd=null;function Yd(){Xd=us=ha=null}function Jd(e){var t=fa.current;je(fa),e._currentValue=t}function Kl(e,t,n){for(;e!==null;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,r!==null&&(r.childLanes|=t)):r!==null&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function Ss(e,t){ha=e,Xd=us=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(Ct=!0),e.firstContext=null)}function Ht(e){var t=e._currentValue;if(Xd!==e)if(e={context:e,memoizedValue:t,next:null},us===null){if(ha===null)throw Error($(308));us=e,ha.dependencies={lanes:0,firstContext:e}}else us=us.next=e;return t}var Tr=null;function Zd(e){Tr===null?Tr=[e]:Tr.push(e)}function Bm(e,t,n,r){var s=t.interleaved;return s===null?(n.next=n,Zd(t)):(n.next=s.next,s.next=n),t.interleaved=n,On(e,r)}function On(e,t){e.lanes|=t;var n=e.alternate;for(n!==null&&(n.lanes|=t),n=e,e=e.return;e!==null;)e.childLanes|=t,n=e.alternate,n!==null&&(n.childLanes|=t),n=e,e=e.return;return n.tag===3?n.stateNode:null}var Gn=!1;function eu(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Vm(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Nn(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function ar(e,t,n){var r=e.updateQueue;if(r===null)return null;if(r=r.shared,we&2){var s=r.pending;return s===null?t.next=t:(t.next=s.next,s.next=t),r.pending=t,On(e,n)}return s=r.interleaved,s===null?(t.next=t,Zd(r)):(t.next=s.next,s.next=t),r.interleaved=t,On(e,n)}function Bo(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194240)!==0)){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,Fd(e,n)}}function Up(e,t){var n=e.updateQueue,r=e.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var s=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?s=i=o:i=i.next=o,n=n.next}while(n!==null);i===null?s=i=t:i=i.next=t}else s=i=t;n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:r.shared,effects:r.effects},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function ma(e,t,n,r){var s=e.updateQueue;Gn=!1;var i=s.firstBaseUpdate,o=s.lastBaseUpdate,a=s.shared.pending;if(a!==null){s.shared.pending=null;var c=a,l=c.next;c.next=null,o===null?i=l:o.next=l,o=c;var d=e.alternate;d!==null&&(d=d.updateQueue,a=d.lastBaseUpdate,a!==o&&(a===null?d.firstBaseUpdate=l:a.next=l,d.lastBaseUpdate=c))}if(i!==null){var u=s.baseState;o=0,d=l=c=null,a=i;do{var f=a.lane,h=a.eventTime;if((r&f)===f){d!==null&&(d=d.next={eventTime:h,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var v=e,y=a;switch(f=t,h=n,y.tag){case 1:if(v=y.payload,typeof v=="function"){u=v.call(h,u,f);break e}u=v;break e;case 3:v.flags=v.flags&-65537|128;case 0:if(v=y.payload,f=typeof v=="function"?v.call(h,u,f):v,f==null)break e;u=Ne({},u,f);break e;case 2:Gn=!0}}a.callback!==null&&a.lane!==0&&(e.flags|=64,f=s.effects,f===null?s.effects=[a]:f.push(a))}else h={eventTime:h,lane:f,tag:a.tag,payload:a.payload,callback:a.callback,next:null},d===null?(l=d=h,c=u):d=d.next=h,o|=f;if(a=a.next,a===null){if(a=s.shared.pending,a===null)break;f=a,a=f.next,f.next=null,s.lastBaseUpdate=f,s.shared.pending=null}}while(1);if(d===null&&(c=u),s.baseState=c,s.firstBaseUpdate=l,s.lastBaseUpdate=d,t=s.shared.interleaved,t!==null){s=t;do o|=s.lane,s=s.next;while(s!==t)}else i===null&&(s.shared.lanes=0);Ar|=o,e.lanes=o,e.memoizedState=u}}function Bp(e,t,n){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var r=e[t],s=r.callback;if(s!==null){if(r.callback=null,r=n,typeof s!="function")throw Error($(191,s));s.call(r)}}}var Zi={},_n=gr(Zi),zi=gr(Zi),Ui=gr(Zi);function Pr(e){if(e===Zi)throw Error($(174));return e}function tu(e,t){switch(Te(Ui,t),Te(zi,e),Te(_n,Zi),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:kl(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=kl(t,e)}je(_n),Te(_n,t)}function Ts(){je(_n),je(zi),je(Ui)}function Wm(e){Pr(Ui.current);var t=Pr(_n.current),n=kl(t,e.type);t!==n&&(Te(zi,e),Te(_n,n))}function nu(e){zi.current===e&&(je(_n),je(zi))}var De=gr(0);function ga(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Qc=[];function ru(){for(var e=0;e<Qc.length;e++)Qc[e]._workInProgressVersionPrimary=null;Qc.length=0}var Vo=zn.ReactCurrentDispatcher,Kc=zn.ReactCurrentBatchConfig,Mr=0,Ie=null,Qe=null,qe=null,va=!1,wi=!1,Bi=0,iw=0;function ot(){throw Error($(321))}function su(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!on(e[n],t[n]))return!1;return!0}function iu(e,t,n,r,s,i){if(Mr=i,Ie=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Vo.current=e===null||e.memoizedState===null?lw:dw,e=n(r,s),wi){i=0;do{if(wi=!1,Bi=0,25<=i)throw Error($(301));i+=1,qe=Qe=null,t.updateQueue=null,Vo.current=uw,e=n(r,s)}while(wi)}if(Vo.current=ya,t=Qe!==null&&Qe.next!==null,Mr=0,qe=Qe=Ie=null,va=!1,t)throw Error($(300));return e}function ou(){var e=Bi!==0;return Bi=0,e}function vn(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return qe===null?Ie.memoizedState=qe=e:qe=qe.next=e,qe}function Qt(){if(Qe===null){var e=Ie.alternate;e=e!==null?e.memoizedState:null}else e=Qe.next;var t=qe===null?Ie.memoizedState:qe.next;if(t!==null)qe=t,Qe=e;else{if(e===null)throw Error($(310));Qe=e,e={memoizedState:Qe.memoizedState,baseState:Qe.baseState,baseQueue:Qe.baseQueue,queue:Qe.queue,next:null},qe===null?Ie.memoizedState=qe=e:qe=qe.next=e}return qe}function Vi(e,t){return typeof t=="function"?t(e):t}function qc(e){var t=Qt(),n=t.queue;if(n===null)throw Error($(311));n.lastRenderedReducer=e;var r=Qe,s=r.baseQueue,i=n.pending;if(i!==null){if(s!==null){var o=s.next;s.next=i.next,i.next=o}r.baseQueue=s=i,n.pending=null}if(s!==null){i=s.next,r=r.baseState;var a=o=null,c=null,l=i;do{var d=l.lane;if((Mr&d)===d)c!==null&&(c=c.next={lane:0,action:l.action,hasEagerState:l.hasEagerState,eagerState:l.eagerState,next:null}),r=l.hasEagerState?l.eagerState:e(r,l.action);else{var u={lane:d,action:l.action,hasEagerState:l.hasEagerState,eagerState:l.eagerState,next:null};c===null?(a=c=u,o=r):c=c.next=u,Ie.lanes|=d,Ar|=d}l=l.next}while(l!==null&&l!==i);c===null?o=r:c.next=a,on(r,t.memoizedState)||(Ct=!0),t.memoizedState=r,t.baseState=o,t.baseQueue=c,n.lastRenderedState=r}if(e=n.interleaved,e!==null){s=e;do i=s.lane,Ie.lanes|=i,Ar|=i,s=s.next;while(s!==e)}else s===null&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function Gc(e){var t=Qt(),n=t.queue;if(n===null)throw Error($(311));n.lastRenderedReducer=e;var r=n.dispatch,s=n.pending,i=t.memoizedState;if(s!==null){n.pending=null;var o=s=s.next;do i=e(i,o.action),o=o.next;while(o!==s);on(i,t.memoizedState)||(Ct=!0),t.memoizedState=i,t.baseQueue===null&&(t.baseState=i),n.lastRenderedState=i}return[i,r]}function Hm(){}function Qm(e,t){var n=Ie,r=Qt(),s=t(),i=!on(r.memoizedState,s);if(i&&(r.memoizedState=s,Ct=!0),r=r.queue,au(Gm.bind(null,n,r,e),[e]),r.getSnapshot!==t||i||qe!==null&&qe.memoizedState.tag&1){if(n.flags|=2048,Wi(9,qm.bind(null,n,r,s,t),void 0,null),Ge===null)throw Error($(349));Mr&30||Km(n,t,s)}return s}function Km(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=Ie.updateQueue,t===null?(t={lastEffect:null,stores:null},Ie.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function qm(e,t,n,r){t.value=n,t.getSnapshot=r,Xm(t)&&Ym(e)}function Gm(e,t,n){return n(function(){Xm(t)&&Ym(e)})}function Xm(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!on(e,n)}catch{return!0}}function Ym(e){var t=On(e,1);t!==null&&nn(t,e,1,-1)}function Vp(e){var t=vn();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Vi,lastRenderedState:e},t.queue=e,e=e.dispatch=cw.bind(null,Ie,e),[t.memoizedState,e]}function Wi(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},t=Ie.updateQueue,t===null?(t={lastEffect:null,stores:null},Ie.updateQueue=t,t.lastEffect=e.next=e):(n=t.lastEffect,n===null?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e)),e}function Jm(){return Qt().memoizedState}function Wo(e,t,n,r){var s=vn();Ie.flags|=e,s.memoizedState=Wi(1|t,n,void 0,r===void 0?null:r)}function Oa(e,t,n,r){var s=Qt();r=r===void 0?null:r;var i=void 0;if(Qe!==null){var o=Qe.memoizedState;if(i=o.destroy,r!==null&&su(r,o.deps)){s.memoizedState=Wi(t,n,i,r);return}}Ie.flags|=e,s.memoizedState=Wi(1|t,n,i,r)}function Wp(e,t){return Wo(8390656,8,e,t)}function au(e,t){return Oa(2048,8,e,t)}function Zm(e,t){return Oa(4,2,e,t)}function eg(e,t){return Oa(4,4,e,t)}function tg(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function ng(e,t,n){return n=n!=null?n.concat([e]):null,Oa(4,4,tg.bind(null,t,e),n)}function cu(){}function rg(e,t){var n=Qt();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&su(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function sg(e,t){var n=Qt();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&su(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function ig(e,t,n){return Mr&21?(on(n,t)||(n=dm(),Ie.lanes|=n,Ar|=n,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,Ct=!0),e.memoizedState=n)}function ow(e,t){var n=xe;xe=n!==0&&4>n?n:4,e(!0);var r=Kc.transition;Kc.transition={};try{e(!1),t()}finally{xe=n,Kc.transition=r}}function og(){return Qt().memoizedState}function aw(e,t,n){var r=lr(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},ag(e))cg(t,n);else if(n=Bm(e,t,n,r),n!==null){var s=wt();nn(n,e,r,s),lg(n,t,r)}}function cw(e,t,n){var r=lr(e),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(ag(e))cg(t,s);else{var i=e.alternate;if(e.lanes===0&&(i===null||i.lanes===0)&&(i=t.lastRenderedReducer,i!==null))try{var o=t.lastRenderedState,a=i(o,n);if(s.hasEagerState=!0,s.eagerState=a,on(a,o)){var c=t.interleaved;c===null?(s.next=s,Zd(t)):(s.next=c.next,c.next=s),t.interleaved=s;return}}catch{}finally{}n=Bm(e,t,s,r),n!==null&&(s=wt(),nn(n,e,r,s),lg(n,t,r))}}function ag(e){var t=e.alternate;return e===Ie||t!==null&&t===Ie}function cg(e,t){wi=va=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function lg(e,t,n){if(n&4194240){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,Fd(e,n)}}var ya={readContext:Ht,useCallback:ot,useContext:ot,useEffect:ot,useImperativeHandle:ot,useInsertionEffect:ot,useLayoutEffect:ot,useMemo:ot,useReducer:ot,useRef:ot,useState:ot,useDebugValue:ot,useDeferredValue:ot,useTransition:ot,useMutableSource:ot,useSyncExternalStore:ot,useId:ot,unstable_isNewReconciler:!1},lw={readContext:Ht,useCallback:function(e,t){return vn().memoizedState=[e,t===void 0?null:t],e},useContext:Ht,useEffect:Wp,useImperativeHandle:function(e,t,n){return n=n!=null?n.concat([e]):null,Wo(4194308,4,tg.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Wo(4194308,4,e,t)},useInsertionEffect:function(e,t){return Wo(4,2,e,t)},useMemo:function(e,t){var n=vn();return t=t===void 0?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=vn();return t=n!==void 0?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=aw.bind(null,Ie,e),[r.memoizedState,e]},useRef:function(e){var t=vn();return e={current:e},t.memoizedState=e},useState:Vp,useDebugValue:cu,useDeferredValue:function(e){return vn().memoizedState=e},useTransition:function(){var e=Vp(!1),t=e[0];return e=ow.bind(null,e[1]),vn().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=Ie,s=vn();if(Le){if(n===void 0)throw Error($(407));n=n()}else{if(n=t(),Ge===null)throw Error($(349));Mr&30||Km(r,t,n)}s.memoizedState=n;var i={value:n,getSnapshot:t};return s.queue=i,Wp(Gm.bind(null,r,i,e),[e]),r.flags|=2048,Wi(9,qm.bind(null,r,i,n,t),void 0,null),n},useId:function(){var e=vn(),t=Ge.identifierPrefix;if(Le){var n=In,r=Dn;n=(r&~(1<<32-tn(r)-1)).toString(32)+n,t=":"+t+"R"+n,n=Bi++,0<n&&(t+="H"+n.toString(32)),t+=":"}else n=iw++,t=":"+t+"r"+n.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},dw={readContext:Ht,useCallback:rg,useContext:Ht,useEffect:au,useImperativeHandle:ng,useInsertionEffect:Zm,useLayoutEffect:eg,useMemo:sg,useReducer:qc,useRef:Jm,useState:function(){return qc(Vi)},useDebugValue:cu,useDeferredValue:function(e){var t=Qt();return ig(t,Qe.memoizedState,e)},useTransition:function(){var e=qc(Vi)[0],t=Qt().memoizedState;return[e,t]},useMutableSource:Hm,useSyncExternalStore:Qm,useId:og,unstable_isNewReconciler:!1},uw={readContext:Ht,useCallback:rg,useContext:Ht,useEffect:au,useImperativeHandle:ng,useInsertionEffect:Zm,useLayoutEffect:eg,useMemo:sg,useReducer:Gc,useRef:Jm,useState:function(){return Gc(Vi)},useDebugValue:cu,useDeferredValue:function(e){var t=Qt();return Qe===null?t.memoizedState=e:ig(t,Qe.memoizedState,e)},useTransition:function(){var e=Gc(Vi)[0],t=Qt().memoizedState;return[e,t]},useMutableSource:Hm,useSyncExternalStore:Qm,useId:og,unstable_isNewReconciler:!1};function Jt(e,t){if(e&&e.defaultProps){t=Ne({},t),e=e.defaultProps;for(var n in e)t[n]===void 0&&(t[n]=e[n]);return t}return t}function ql(e,t,n,r){t=e.memoizedState,n=n(r,t),n=n==null?t:Ne({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var $a={isMounted:function(e){return(e=e._reactInternals)?Br(e)===e:!1},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=wt(),s=lr(e),i=Nn(r,s);i.payload=t,n!=null&&(i.callback=n),t=ar(e,i,s),t!==null&&(nn(t,e,s,r),Bo(t,e,s))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=wt(),s=lr(e),i=Nn(r,s);i.tag=1,i.payload=t,n!=null&&(i.callback=n),t=ar(e,i,s),t!==null&&(nn(t,e,s,r),Bo(t,e,s))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=wt(),r=lr(e),s=Nn(n,r);s.tag=2,t!=null&&(s.callback=t),t=ar(e,s,r),t!==null&&(nn(t,e,r,n),Bo(t,e,r))}};function Hp(e,t,n,r,s,i,o){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(r,i,o):t.prototype&&t.prototype.isPureReactComponent?!Ai(n,r)||!Ai(s,i):!0}function dg(e,t,n){var r=!1,s=hr,i=t.contextType;return typeof i=="object"&&i!==null?i=Ht(i):(s=Rt(t)?Ir:ht.current,r=t.contextTypes,i=(r=r!=null)?Es(e,s):hr),t=new t(n,i),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=$a,e.stateNode=t,t._reactInternals=e,r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=s,e.__reactInternalMemoizedMaskedChildContext=i),t}function Qp(e,t,n,r){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,r),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&$a.enqueueReplaceState(t,t.state,null)}function Gl(e,t,n,r){var s=e.stateNode;s.props=n,s.state=e.memoizedState,s.refs={},eu(e);var i=t.contextType;typeof i=="object"&&i!==null?s.context=Ht(i):(i=Rt(t)?Ir:ht.current,s.context=Es(e,i)),s.state=e.memoizedState,i=t.getDerivedStateFromProps,typeof i=="function"&&(ql(e,t,i,n),s.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(t=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),t!==s.state&&$a.enqueueReplaceState(s,s.state,null),ma(e,n,s,r),s.state=e.memoizedState),typeof s.componentDidMount=="function"&&(e.flags|=4194308)}function Ps(e,t){try{var n="",r=t;do n+=Fy(r),r=r.return;while(r);var s=n}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:e,source:t,stack:s,digest:null}}function Xc(e,t,n){return{value:e,source:null,stack:n??null,digest:t??null}}function Xl(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var pw=typeof WeakMap=="function"?WeakMap:Map;function ug(e,t,n){n=Nn(-1,n),n.tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){_a||(_a=!0,od=r),Xl(e,t)},n}function pg(e,t,n){n=Nn(-1,n),n.tag=3;var r=e.type.getDerivedStateFromError;if(typeof r=="function"){var s=t.value;n.payload=function(){return r(s)},n.callback=function(){Xl(e,t)}}var i=e.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){Xl(e,t),typeof r!="function"&&(cr===null?cr=new Set([this]):cr.add(this));var o=t.stack;this.componentDidCatch(t.value,{componentStack:o!==null?o:""})}),n}function Kp(e,t,n){var r=e.pingCache;if(r===null){r=e.pingCache=new pw;var s=new Set;r.set(t,s)}else s=r.get(t),s===void 0&&(s=new Set,r.set(t,s));s.has(n)||(s.add(n),e=Rw.bind(null,e,t,n),t.then(e,e))}function qp(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function Gp(e,t,n,r,s){return e.mode&1?(e.flags|=65536,e.lanes=s,e):(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(t=Nn(-1,1),t.tag=2,ar(n,t,1))),n.lanes|=1),e)}var fw=zn.ReactCurrentOwner,Ct=!1;function vt(e,t,n,r){t.child=e===null?Um(t,null,n,r):ks(t,e.child,n,r)}function Xp(e,t,n,r,s){n=n.render;var i=t.ref;return Ss(t,s),r=iu(e,t,n,r,i,s),n=ou(),e!==null&&!Ct?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,$n(e,t,s)):(Le&&n&&Kd(t),t.flags|=1,vt(e,t,r,s),t.child)}function Yp(e,t,n,r,s){if(e===null){var i=n.type;return typeof i=="function"&&!gu(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(t.tag=15,t.type=i,fg(e,t,i,r,s)):(e=qo(n.type,null,r,t,t.mode,s),e.ref=t.ref,e.return=t,t.child=e)}if(i=e.child,!(e.lanes&s)){var o=i.memoizedProps;if(n=n.compare,n=n!==null?n:Ai,n(o,r)&&e.ref===t.ref)return $n(e,t,s)}return t.flags|=1,e=dr(i,r),e.ref=t.ref,e.return=t,t.child=e}function fg(e,t,n,r,s){if(e!==null){var i=e.memoizedProps;if(Ai(i,r)&&e.ref===t.ref)if(Ct=!1,t.pendingProps=r=i,(e.lanes&s)!==0)e.flags&131072&&(Ct=!0);else return t.lanes=e.lanes,$n(e,t,s)}return Yl(e,t,n,r,s)}function hg(e,t,n){var r=t.pendingProps,s=r.children,i=e!==null?e.memoizedState:null;if(r.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Te(fs,Dt),Dt|=n;else{if(!(n&1073741824))return e=i!==null?i.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Te(fs,Dt),Dt|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:n,Te(fs,Dt),Dt|=r}else i!==null?(r=i.baseLanes|n,t.memoizedState=null):r=n,Te(fs,Dt),Dt|=r;return vt(e,t,s,n),t.child}function mg(e,t){var n=t.ref;(e===null&&n!==null||e!==null&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function Yl(e,t,n,r,s){var i=Rt(n)?Ir:ht.current;return i=Es(t,i),Ss(t,s),n=iu(e,t,n,r,i,s),r=ou(),e!==null&&!Ct?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,$n(e,t,s)):(Le&&r&&Kd(t),t.flags|=1,vt(e,t,n,s),t.child)}function Jp(e,t,n,r,s){if(Rt(n)){var i=!0;da(t)}else i=!1;if(Ss(t,s),t.stateNode===null)Ho(e,t),dg(t,n,r),Gl(t,n,r,s),r=!0;else if(e===null){var o=t.stateNode,a=t.memoizedProps;o.props=a;var c=o.context,l=n.contextType;typeof l=="object"&&l!==null?l=Ht(l):(l=Rt(n)?Ir:ht.current,l=Es(t,l));var d=n.getDerivedStateFromProps,u=typeof d=="function"||typeof o.getSnapshotBeforeUpdate=="function";u||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==r||c!==l)&&Qp(t,o,r,l),Gn=!1;var f=t.memoizedState;o.state=f,ma(t,r,o,s),c=t.memoizedState,a!==r||f!==c||Et.current||Gn?(typeof d=="function"&&(ql(t,n,d,r),c=t.memoizedState),(a=Gn||Hp(t,n,a,r,f,c,l))?(u||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(t.flags|=4194308)):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=c),o.props=r,o.state=c,o.context=l,r=a):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),r=!1)}else{o=t.stateNode,Vm(e,t),a=t.memoizedProps,l=t.type===t.elementType?a:Jt(t.type,a),o.props=l,u=t.pendingProps,f=o.context,c=n.contextType,typeof c=="object"&&c!==null?c=Ht(c):(c=Rt(n)?Ir:ht.current,c=Es(t,c));var h=n.getDerivedStateFromProps;(d=typeof h=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==u||f!==c)&&Qp(t,o,r,c),Gn=!1,f=t.memoizedState,o.state=f,ma(t,r,o,s);var v=t.memoizedState;a!==u||f!==v||Et.current||Gn?(typeof h=="function"&&(ql(t,n,h,r),v=t.memoizedState),(l=Gn||Hp(t,n,l,r,f,v,c)||!1)?(d||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,v,c),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,v,c)),typeof o.componentDidUpdate=="function"&&(t.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===e.memoizedProps&&f===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===e.memoizedProps&&f===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=v),o.props=r,o.state=v,o.context=c,r=l):(typeof o.componentDidUpdate!="function"||a===e.memoizedProps&&f===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===e.memoizedProps&&f===e.memoizedState||(t.flags|=1024),r=!1)}return Jl(e,t,n,r,i,s)}function Jl(e,t,n,r,s,i){mg(e,t);var o=(t.flags&128)!==0;if(!r&&!o)return s&&Op(t,n,!1),$n(e,t,i);r=t.stateNode,fw.current=t;var a=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return t.flags|=1,e!==null&&o?(t.child=ks(t,e.child,null,i),t.child=ks(t,null,a,i)):vt(e,t,a,i),t.memoizedState=r.state,s&&Op(t,n,!0),t.child}function gg(e){var t=e.stateNode;t.pendingContext?Ap(e,t.pendingContext,t.pendingContext!==t.context):t.context&&Ap(e,t.context,!1),tu(e,t.containerInfo)}function Zp(e,t,n,r,s){return Rs(),Gd(s),t.flags|=256,vt(e,t,n,r),t.child}var Zl={dehydrated:null,treeContext:null,retryLane:0};function ed(e){return{baseLanes:e,cachePool:null,transitions:null}}function vg(e,t,n){var r=t.pendingProps,s=De.current,i=!1,o=(t.flags&128)!==0,a;if((a=o)||(a=e!==null&&e.memoizedState===null?!1:(s&2)!==0),a?(i=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(s|=1),Te(De,s&1),e===null)return Ql(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(o=r.children,e=r.fallback,i?(r=t.mode,i=t.child,o={mode:"hidden",children:o},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=o):i=Ua(o,r,0,null),e=Dr(e,r,n,null),i.return=t,e.return=t,i.sibling=e,t.child=i,t.child.memoizedState=ed(n),t.memoizedState=Zl,e):lu(t,o));if(s=e.memoizedState,s!==null&&(a=s.dehydrated,a!==null))return hw(e,t,o,r,a,s,n);if(i){i=r.fallback,o=t.mode,s=e.child,a=s.sibling;var c={mode:"hidden",children:r.children};return!(o&1)&&t.child!==s?(r=t.child,r.childLanes=0,r.pendingProps=c,t.deletions=null):(r=dr(s,c),r.subtreeFlags=s.subtreeFlags&14680064),a!==null?i=dr(a,i):(i=Dr(i,o,n,null),i.flags|=2),i.return=t,r.return=t,r.sibling=i,t.child=r,r=i,i=t.child,o=e.child.memoizedState,o=o===null?ed(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=e.childLanes&~n,t.memoizedState=Zl,r}return i=e.child,e=i.sibling,r=dr(i,{mode:"visible",children:r.children}),!(t.mode&1)&&(r.lanes=n),r.return=t,r.sibling=null,e!==null&&(n=t.deletions,n===null?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=r,t.memoizedState=null,r}function lu(e,t){return t=Ua({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function Eo(e,t,n,r){return r!==null&&Gd(r),ks(t,e.child,null,n),e=lu(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function hw(e,t,n,r,s,i,o){if(n)return t.flags&256?(t.flags&=-257,r=Xc(Error($(422))),Eo(e,t,o,r)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(i=r.fallback,s=t.mode,r=Ua({mode:"visible",children:r.children},s,0,null),i=Dr(i,s,o,null),i.flags|=2,r.return=t,i.return=t,r.sibling=i,t.child=r,t.mode&1&&ks(t,e.child,null,o),t.child.memoizedState=ed(o),t.memoizedState=Zl,i);if(!(t.mode&1))return Eo(e,t,o,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var a=r.dgst;return r=a,i=Error($(419)),r=Xc(i,r,void 0),Eo(e,t,o,r)}if(a=(o&e.childLanes)!==0,Ct||a){if(r=Ge,r!==null){switch(o&-o){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|o)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,On(e,s),nn(r,e,s,-1))}return mu(),r=Xc(Error($(421))),Eo(e,t,o,r)}return s.data==="$?"?(t.flags|=128,t.child=e.child,t=kw.bind(null,e),s._reactRetry=t,null):(e=i.treeContext,Mt=or(s.nextSibling),At=t,Le=!0,en=null,e!==null&&(zt[Ut++]=Dn,zt[Ut++]=In,zt[Ut++]=Nr,Dn=e.id,In=e.overflow,Nr=t),t=lu(t,r.children),t.flags|=4096,t)}function ef(e,t,n){e.lanes|=t;var r=e.alternate;r!==null&&(r.lanes|=t),Kl(e.return,t,n)}function Yc(e,t,n,r,s){var i=e.memoizedState;i===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=s)}function yg(e,t,n){var r=t.pendingProps,s=r.revealOrder,i=r.tail;if(vt(e,t,r.children,n),r=De.current,r&2)r=r&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&ef(e,n,t);else if(e.tag===19)ef(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(Te(De,r),!(t.mode&1))t.memoizedState=null;else switch(s){case"forwards":for(n=t.child,s=null;n!==null;)e=n.alternate,e!==null&&ga(e)===null&&(s=n),n=n.sibling;n=s,n===null?(s=t.child,t.child=null):(s=n.sibling,n.sibling=null),Yc(t,!1,s,n,i);break;case"backwards":for(n=null,s=t.child,t.child=null;s!==null;){if(e=s.alternate,e!==null&&ga(e)===null){t.child=s;break}e=s.sibling,s.sibling=n,n=s,s=e}Yc(t,!0,n,null,i);break;case"together":Yc(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Ho(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function $n(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),Ar|=t.lanes,!(n&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error($(153));if(t.child!==null){for(e=t.child,n=dr(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=dr(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function mw(e,t,n){switch(t.tag){case 3:gg(t),Rs();break;case 5:Wm(t);break;case 1:Rt(t.type)&&da(t);break;case 4:tu(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,s=t.memoizedProps.value;Te(fa,r._currentValue),r._currentValue=s;break;case 13:if(r=t.memoizedState,r!==null)return r.dehydrated!==null?(Te(De,De.current&1),t.flags|=128,null):n&t.child.childLanes?vg(e,t,n):(Te(De,De.current&1),e=$n(e,t,n),e!==null?e.sibling:null);Te(De,De.current&1);break;case 19:if(r=(n&t.childLanes)!==0,e.flags&128){if(r)return yg(e,t,n);t.flags|=128}if(s=t.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),Te(De,De.current),r)break;return null;case 22:case 23:return t.lanes=0,hg(e,t,n)}return $n(e,t,n)}var wg,td,_g,Sg;wg=function(e,t){for(var n=t.child;n!==null;){if(n.tag===5||n.tag===6)e.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};td=function(){};_g=function(e,t,n,r){var s=e.memoizedProps;if(s!==r){e=t.stateNode,Pr(_n.current);var i=null;switch(n){case"input":s=bl(e,s),r=bl(e,r),i=[];break;case"select":s=Ne({},s,{value:void 0}),r=Ne({},r,{value:void 0}),i=[];break;case"textarea":s=Rl(e,s),r=Rl(e,r),i=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(e.onclick=ca)}Tl(n,r);var o;n=null;for(l in s)if(!r.hasOwnProperty(l)&&s.hasOwnProperty(l)&&s[l]!=null)if(l==="style"){var a=s[l];for(o in a)a.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else l!=="dangerouslySetInnerHTML"&&l!=="children"&&l!=="suppressContentEditableWarning"&&l!=="suppressHydrationWarning"&&l!=="autoFocus"&&(Pi.hasOwnProperty(l)?i||(i=[]):(i=i||[]).push(l,null));for(l in r){var c=r[l];if(a=s?.[l],r.hasOwnProperty(l)&&c!==a&&(c!=null||a!=null))if(l==="style")if(a){for(o in a)!a.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in c)c.hasOwnProperty(o)&&a[o]!==c[o]&&(n||(n={}),n[o]=c[o])}else n||(i||(i=[]),i.push(l,n)),n=c;else l==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,a=a?a.__html:void 0,c!=null&&a!==c&&(i=i||[]).push(l,c)):l==="children"?typeof c!="string"&&typeof c!="number"||(i=i||[]).push(l,""+c):l!=="suppressContentEditableWarning"&&l!=="suppressHydrationWarning"&&(Pi.hasOwnProperty(l)?(c!=null&&l==="onScroll"&&Pe("scroll",e),i||a===c||(i=[])):(i=i||[]).push(l,c))}n&&(i=i||[]).push("style",n);var l=i;(t.updateQueue=l)&&(t.flags|=4)}};Sg=function(e,t,n,r){n!==r&&(t.flags|=4)};function Ys(e,t){if(!Le)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:r.sibling=null}}function at(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,r=0;if(t)for(var s=e.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=e,s=s.sibling;else for(s=e.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=e,s=s.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function gw(e,t,n){var r=t.pendingProps;switch(qd(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return at(t),null;case 1:return Rt(t.type)&&la(),at(t),null;case 3:return r=t.stateNode,Ts(),je(Et),je(ht),ru(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(e===null||e.child===null)&&(bo(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,en!==null&&(ld(en),en=null))),td(e,t),at(t),null;case 5:nu(t);var s=Pr(Ui.current);if(n=t.type,e!==null&&t.stateNode!=null)_g(e,t,n,r,s),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(t.stateNode===null)throw Error($(166));return at(t),null}if(e=Pr(_n.current),bo(t)){r=t.stateNode,n=t.type;var i=t.memoizedProps;switch(r[yn]=t,r[Fi]=i,e=(t.mode&1)!==0,n){case"dialog":Pe("cancel",r),Pe("close",r);break;case"iframe":case"object":case"embed":Pe("load",r);break;case"video":case"audio":for(s=0;s<fi.length;s++)Pe(fi[s],r);break;case"source":Pe("error",r);break;case"img":case"image":case"link":Pe("error",r),Pe("load",r);break;case"details":Pe("toggle",r);break;case"input":lp(r,i),Pe("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},Pe("invalid",r);break;case"textarea":up(r,i),Pe("invalid",r)}Tl(n,i),s=null;for(var o in i)if(i.hasOwnProperty(o)){var a=i[o];o==="children"?typeof a=="string"?r.textContent!==a&&(i.suppressHydrationWarning!==!0&&xo(r.textContent,a,e),s=["children",a]):typeof a=="number"&&r.textContent!==""+a&&(i.suppressHydrationWarning!==!0&&xo(r.textContent,a,e),s=["children",""+a]):Pi.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&Pe("scroll",r)}switch(n){case"input":ho(r),dp(r,i,!0);break;case"textarea":ho(r),pp(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=ca)}r=s,t.updateQueue=r,r!==null&&(t.flags|=4)}else{o=s.nodeType===9?s:s.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=Gh(n)),e==="http://www.w3.org/1999/xhtml"?n==="script"?(e=o.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof r.is=="string"?e=o.createElement(n,{is:r.is}):(e=o.createElement(n),n==="select"&&(o=e,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):e=o.createElementNS(e,n),e[yn]=t,e[Fi]=r,wg(e,t,!1,!1),t.stateNode=e;e:{switch(o=Pl(n,r),n){case"dialog":Pe("cancel",e),Pe("close",e),s=r;break;case"iframe":case"object":case"embed":Pe("load",e),s=r;break;case"video":case"audio":for(s=0;s<fi.length;s++)Pe(fi[s],e);s=r;break;case"source":Pe("error",e),s=r;break;case"img":case"image":case"link":Pe("error",e),Pe("load",e),s=r;break;case"details":Pe("toggle",e),s=r;break;case"input":lp(e,r),s=bl(e,r),Pe("invalid",e);break;case"option":s=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},s=Ne({},r,{value:void 0}),Pe("invalid",e);break;case"textarea":up(e,r),s=Rl(e,r),Pe("invalid",e);break;default:s=r}Tl(n,s),a=s;for(i in a)if(a.hasOwnProperty(i)){var c=a[i];i==="style"?Jh(e,c):i==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&Xh(e,c)):i==="children"?typeof c=="string"?(n!=="textarea"||c!=="")&&ji(e,c):typeof c=="number"&&ji(e,""+c):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(Pi.hasOwnProperty(i)?c!=null&&i==="onScroll"&&Pe("scroll",e):c!=null&&Id(e,i,c,o))}switch(n){case"input":ho(e),dp(e,r,!1);break;case"textarea":ho(e),pp(e);break;case"option":r.value!=null&&e.setAttribute("value",""+fr(r.value));break;case"select":e.multiple=!!r.multiple,i=r.value,i!=null?vs(e,!!r.multiple,i,!1):r.defaultValue!=null&&vs(e,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(e.onclick=ca)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return at(t),null;case 6:if(e&&t.stateNode!=null)Sg(e,t,e.memoizedProps,r);else{if(typeof r!="string"&&t.stateNode===null)throw Error($(166));if(n=Pr(Ui.current),Pr(_n.current),bo(t)){if(r=t.stateNode,n=t.memoizedProps,r[yn]=t,(i=r.nodeValue!==n)&&(e=At,e!==null))switch(e.tag){case 3:xo(r.nodeValue,n,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&xo(r.nodeValue,n,(e.mode&1)!==0)}i&&(t.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[yn]=t,t.stateNode=r}return at(t),null;case 13:if(je(De),r=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Le&&Mt!==null&&t.mode&1&&!(t.flags&128))Fm(),Rs(),t.flags|=98560,i=!1;else if(i=bo(t),r!==null&&r.dehydrated!==null){if(e===null){if(!i)throw Error($(318));if(i=t.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error($(317));i[yn]=t}else Rs(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;at(t),i=!1}else en!==null&&(ld(en),en=null),i=!0;if(!i)return t.flags&65536?t:null}return t.flags&128?(t.lanes=n,t):(r=r!==null,r!==(e!==null&&e.memoizedState!==null)&&r&&(t.child.flags|=8192,t.mode&1&&(e===null||De.current&1?Ke===0&&(Ke=3):mu())),t.updateQueue!==null&&(t.flags|=4),at(t),null);case 4:return Ts(),td(e,t),e===null&&Oi(t.stateNode.containerInfo),at(t),null;case 10:return Jd(t.type._context),at(t),null;case 17:return Rt(t.type)&&la(),at(t),null;case 19:if(je(De),i=t.memoizedState,i===null)return at(t),null;if(r=(t.flags&128)!==0,o=i.rendering,o===null)if(r)Ys(i,!1);else{if(Ke!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(o=ga(e),o!==null){for(t.flags|=128,Ys(i,!1),r=o.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;n!==null;)i=n,e=r,i.flags&=14680066,o=i.alternate,o===null?(i.childLanes=0,i.lanes=e,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,e=o.dependencies,i.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Te(De,De.current&1|2),t.child}e=e.sibling}i.tail!==null&&Fe()>js&&(t.flags|=128,r=!0,Ys(i,!1),t.lanes=4194304)}else{if(!r)if(e=ga(o),e!==null){if(t.flags|=128,r=!0,n=e.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),Ys(i,!0),i.tail===null&&i.tailMode==="hidden"&&!o.alternate&&!Le)return at(t),null}else 2*Fe()-i.renderingStartTime>js&&n!==1073741824&&(t.flags|=128,r=!0,Ys(i,!1),t.lanes=4194304);i.isBackwards?(o.sibling=t.child,t.child=o):(n=i.last,n!==null?n.sibling=o:t.child=o,i.last=o)}return i.tail!==null?(t=i.tail,i.rendering=t,i.tail=t.sibling,i.renderingStartTime=Fe(),t.sibling=null,n=De.current,Te(De,r?n&1|2:n&1),t):(at(t),null);case 22:case 23:return hu(),r=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==r&&(t.flags|=8192),r&&t.mode&1?Dt&1073741824&&(at(t),t.subtreeFlags&6&&(t.flags|=8192)):at(t),null;case 24:return null;case 25:return null}throw Error($(156,t.tag))}function vw(e,t){switch(qd(t),t.tag){case 1:return Rt(t.type)&&la(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Ts(),je(Et),je(ht),ru(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return nu(t),null;case 13:if(je(De),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error($(340));Rs()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return je(De),null;case 4:return Ts(),null;case 10:return Jd(t.type._context),null;case 22:case 23:return hu(),null;case 24:return null;default:return null}}var Ro=!1,pt=!1,yw=typeof WeakSet=="function"?WeakSet:Set,J=null;function ps(e,t){var n=e.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){Ae(e,t,r)}else n.current=null}function nd(e,t,n){try{n()}catch(r){Ae(e,t,r)}}var tf=!1;function ww(e,t){if(Fl=ia,e=Rm(),Qd(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{n=(n=e.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var s=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var o=0,a=-1,c=-1,l=0,d=0,u=e,f=null;t:for(;;){for(var h;u!==n||s!==0&&u.nodeType!==3||(a=o+s),u!==i||r!==0&&u.nodeType!==3||(c=o+r),u.nodeType===3&&(o+=u.nodeValue.length),(h=u.firstChild)!==null;)f=u,u=h;for(;;){if(u===e)break t;if(f===n&&++l===s&&(a=o),f===i&&++d===r&&(c=o),(h=u.nextSibling)!==null)break;u=f,f=u.parentNode}u=h}n=a===-1||c===-1?null:{start:a,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(zl={focusedElem:e,selectionRange:n},ia=!1,J=t;J!==null;)if(t=J,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,J=e;else for(;J!==null;){t=J;try{var v=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(v!==null){var y=v.memoizedProps,x=v.memoizedState,g=t.stateNode,m=g.getSnapshotBeforeUpdate(t.elementType===t.type?y:Jt(t.type,y),x);g.__reactInternalSnapshotBeforeUpdate=m}break;case 3:var w=t.stateNode.containerInfo;w.nodeType===1?w.textContent="":w.nodeType===9&&w.documentElement&&w.removeChild(w.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error($(163))}}catch(C){Ae(t,t.return,C)}if(e=t.sibling,e!==null){e.return=t.return,J=e;break}J=t.return}return v=tf,tf=!1,v}function _i(e,t,n){var r=t.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&e)===e){var i=s.destroy;s.destroy=void 0,i!==void 0&&nd(t,n,i)}s=s.next}while(s!==r)}}function Fa(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function rd(e){var t=e.ref;if(t!==null){var n=e.stateNode;switch(e.tag){case 5:e=n;break;default:e=n}typeof t=="function"?t(e):t.current=e}}function xg(e){var t=e.alternate;t!==null&&(e.alternate=null,xg(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[yn],delete t[Fi],delete t[Vl],delete t[tw],delete t[nw])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function bg(e){return e.tag===5||e.tag===3||e.tag===4}function nf(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||bg(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function sd(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.nodeType===8?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(n.nodeType===8?(t=n.parentNode,t.insertBefore(e,n)):(t=n,t.appendChild(e)),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=ca));else if(r!==4&&(e=e.child,e!==null))for(sd(e,t,n),e=e.sibling;e!==null;)sd(e,t,n),e=e.sibling}function id(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(r!==4&&(e=e.child,e!==null))for(id(e,t,n),e=e.sibling;e!==null;)id(e,t,n),e=e.sibling}var Je=null,Zt=!1;function Hn(e,t,n){for(n=n.child;n!==null;)Cg(e,t,n),n=n.sibling}function Cg(e,t,n){if(wn&&typeof wn.onCommitFiberUnmount=="function")try{wn.onCommitFiberUnmount(La,n)}catch{}switch(n.tag){case 5:pt||ps(n,t);case 6:var r=Je,s=Zt;Je=null,Hn(e,t,n),Je=r,Zt=s,Je!==null&&(Zt?(e=Je,n=n.stateNode,e.nodeType===8?e.parentNode.removeChild(n):e.removeChild(n)):Je.removeChild(n.stateNode));break;case 18:Je!==null&&(Zt?(e=Je,n=n.stateNode,e.nodeType===8?Wc(e.parentNode,n):e.nodeType===1&&Wc(e,n),Ni(e)):Wc(Je,n.stateNode));break;case 4:r=Je,s=Zt,Je=n.stateNode.containerInfo,Zt=!0,Hn(e,t,n),Je=r,Zt=s;break;case 0:case 11:case 14:case 15:if(!pt&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var i=s,o=i.destroy;i=i.tag,o!==void 0&&(i&2||i&4)&&nd(n,t,o),s=s.next}while(s!==r)}Hn(e,t,n);break;case 1:if(!pt&&(ps(n,t),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(a){Ae(n,t,a)}Hn(e,t,n);break;case 21:Hn(e,t,n);break;case 22:n.mode&1?(pt=(r=pt)||n.memoizedState!==null,Hn(e,t,n),pt=r):Hn(e,t,n);break;default:Hn(e,t,n)}}function rf(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var n=e.stateNode;n===null&&(n=e.stateNode=new yw),t.forEach(function(r){var s=Tw.bind(null,e,r);n.has(r)||(n.add(r),r.then(s,s))})}}function Xt(e,t){var n=t.deletions;if(n!==null)for(var r=0;r<n.length;r++){var s=n[r];try{var i=e,o=t,a=o;e:for(;a!==null;){switch(a.tag){case 5:Je=a.stateNode,Zt=!1;break e;case 3:Je=a.stateNode.containerInfo,Zt=!0;break e;case 4:Je=a.stateNode.containerInfo,Zt=!0;break e}a=a.return}if(Je===null)throw Error($(160));Cg(i,o,s),Je=null,Zt=!1;var c=s.alternate;c!==null&&(c.return=null),s.return=null}catch(l){Ae(s,t,l)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)Eg(t,e),t=t.sibling}function Eg(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Xt(t,e),dn(e),r&4){try{_i(3,e,e.return),Fa(3,e)}catch(y){Ae(e,e.return,y)}try{_i(5,e,e.return)}catch(y){Ae(e,e.return,y)}}break;case 1:Xt(t,e),dn(e),r&512&&n!==null&&ps(n,n.return);break;case 5:if(Xt(t,e),dn(e),r&512&&n!==null&&ps(n,n.return),e.flags&32){var s=e.stateNode;try{ji(s,"")}catch(y){Ae(e,e.return,y)}}if(r&4&&(s=e.stateNode,s!=null)){var i=e.memoizedProps,o=n!==null?n.memoizedProps:i,a=e.type,c=e.updateQueue;if(e.updateQueue=null,c!==null)try{a==="input"&&i.type==="radio"&&i.name!=null&&Kh(s,i),Pl(a,o);var l=Pl(a,i);for(o=0;o<c.length;o+=2){var d=c[o],u=c[o+1];d==="style"?Jh(s,u):d==="dangerouslySetInnerHTML"?Xh(s,u):d==="children"?ji(s,u):Id(s,d,u,l)}switch(a){case"input":Cl(s,i);break;case"textarea":qh(s,i);break;case"select":var f=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var h=i.value;h!=null?vs(s,!!i.multiple,h,!1):f!==!!i.multiple&&(i.defaultValue!=null?vs(s,!!i.multiple,i.defaultValue,!0):vs(s,!!i.multiple,i.multiple?[]:"",!1))}s[Fi]=i}catch(y){Ae(e,e.return,y)}}break;case 6:if(Xt(t,e),dn(e),r&4){if(e.stateNode===null)throw Error($(162));s=e.stateNode,i=e.memoizedProps;try{s.nodeValue=i}catch(y){Ae(e,e.return,y)}}break;case 3:if(Xt(t,e),dn(e),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Ni(t.containerInfo)}catch(y){Ae(e,e.return,y)}break;case 4:Xt(t,e),dn(e);break;case 13:Xt(t,e),dn(e),s=e.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(pu=Fe())),r&4&&rf(e);break;case 22:if(d=n!==null&&n.memoizedState!==null,e.mode&1?(pt=(l=pt)||d,Xt(t,e),pt=l):Xt(t,e),dn(e),r&8192){if(l=e.memoizedState!==null,(e.stateNode.isHidden=l)&&!d&&e.mode&1)for(J=e,d=e.child;d!==null;){for(u=J=d;J!==null;){switch(f=J,h=f.child,f.tag){case 0:case 11:case 14:case 15:_i(4,f,f.return);break;case 1:ps(f,f.return);var v=f.stateNode;if(typeof v.componentWillUnmount=="function"){r=f,n=f.return;try{t=r,v.props=t.memoizedProps,v.state=t.memoizedState,v.componentWillUnmount()}catch(y){Ae(r,n,y)}}break;case 5:ps(f,f.return);break;case 22:if(f.memoizedState!==null){of(u);continue}}h!==null?(h.return=f,J=h):of(u)}d=d.sibling}e:for(d=null,u=e;;){if(u.tag===5){if(d===null){d=u;try{s=u.stateNode,l?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(a=u.stateNode,c=u.memoizedProps.style,o=c!=null&&c.hasOwnProperty("display")?c.display:null,a.style.display=Yh("display",o))}catch(y){Ae(e,e.return,y)}}}else if(u.tag===6){if(d===null)try{u.stateNode.nodeValue=l?"":u.memoizedProps}catch(y){Ae(e,e.return,y)}}else if((u.tag!==22&&u.tag!==23||u.memoizedState===null||u===e)&&u.child!==null){u.child.return=u,u=u.child;continue}if(u===e)break e;for(;u.sibling===null;){if(u.return===null||u.return===e)break e;d===u&&(d=null),u=u.return}d===u&&(d=null),u.sibling.return=u.return,u=u.sibling}}break;case 19:Xt(t,e),dn(e),r&4&&rf(e);break;case 21:break;default:Xt(t,e),dn(e)}}function dn(e){var t=e.flags;if(t&2){try{e:{for(var n=e.return;n!==null;){if(bg(n)){var r=n;break e}n=n.return}throw Error($(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(ji(s,""),r.flags&=-33);var i=nf(e);id(e,i,s);break;case 3:case 4:var o=r.stateNode.containerInfo,a=nf(e);sd(e,a,o);break;default:throw Error($(161))}}catch(c){Ae(e,e.return,c)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function _w(e,t,n){J=e,Rg(e)}function Rg(e,t,n){for(var r=(e.mode&1)!==0;J!==null;){var s=J,i=s.child;if(s.tag===22&&r){var o=s.memoizedState!==null||Ro;if(!o){var a=s.alternate,c=a!==null&&a.memoizedState!==null||pt;a=Ro;var l=pt;if(Ro=o,(pt=c)&&!l)for(J=s;J!==null;)o=J,c=o.child,o.tag===22&&o.memoizedState!==null?af(s):c!==null?(c.return=o,J=c):af(s);for(;i!==null;)J=i,Rg(i),i=i.sibling;J=s,Ro=a,pt=l}sf(e)}else s.subtreeFlags&8772&&i!==null?(i.return=s,J=i):sf(e)}}function sf(e){for(;J!==null;){var t=J;if(t.flags&8772){var n=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:pt||Fa(5,t);break;case 1:var r=t.stateNode;if(t.flags&4&&!pt)if(n===null)r.componentDidMount();else{var s=t.elementType===t.type?n.memoizedProps:Jt(t.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=t.updateQueue;i!==null&&Bp(t,i,r);break;case 3:var o=t.updateQueue;if(o!==null){if(n=null,t.child!==null)switch(t.child.tag){case 5:n=t.child.stateNode;break;case 1:n=t.child.stateNode}Bp(t,o,n)}break;case 5:var a=t.stateNode;if(n===null&&t.flags&4){n=a;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var l=t.alternate;if(l!==null){var d=l.memoizedState;if(d!==null){var u=d.dehydrated;u!==null&&Ni(u)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error($(163))}pt||t.flags&512&&rd(t)}catch(f){Ae(t,t.return,f)}}if(t===e){J=null;break}if(n=t.sibling,n!==null){n.return=t.return,J=n;break}J=t.return}}function of(e){for(;J!==null;){var t=J;if(t===e){J=null;break}var n=t.sibling;if(n!==null){n.return=t.return,J=n;break}J=t.return}}function af(e){for(;J!==null;){var t=J;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{Fa(4,t)}catch(c){Ae(t,n,c)}break;case 1:var r=t.stateNode;if(typeof r.componentDidMount=="function"){var s=t.return;try{r.componentDidMount()}catch(c){Ae(t,s,c)}}var i=t.return;try{rd(t)}catch(c){Ae(t,i,c)}break;case 5:var o=t.return;try{rd(t)}catch(c){Ae(t,o,c)}}}catch(c){Ae(t,t.return,c)}if(t===e){J=null;break}var a=t.sibling;if(a!==null){a.return=t.return,J=a;break}J=t.return}}var Sw=Math.ceil,wa=zn.ReactCurrentDispatcher,du=zn.ReactCurrentOwner,Vt=zn.ReactCurrentBatchConfig,we=0,Ge=null,Be=null,et=0,Dt=0,fs=gr(0),Ke=0,Hi=null,Ar=0,za=0,uu=0,Si=null,bt=null,pu=0,js=1/0,jn=null,_a=!1,od=null,cr=null,ko=!1,er=null,Sa=0,xi=0,ad=null,Qo=-1,Ko=0;function wt(){return we&6?Fe():Qo!==-1?Qo:Qo=Fe()}function lr(e){return e.mode&1?we&2&&et!==0?et&-et:sw.transition!==null?(Ko===0&&(Ko=dm()),Ko):(e=xe,e!==0||(e=window.event,e=e===void 0?16:vm(e.type)),e):1}function nn(e,t,n,r){if(50<xi)throw xi=0,ad=null,Error($(185));Xi(e,n,r),(!(we&2)||e!==Ge)&&(e===Ge&&(!(we&2)&&(za|=n),Ke===4&&Yn(e,et)),kt(e,r),n===1&&we===0&&!(t.mode&1)&&(js=Fe()+500,Aa&&vr()))}function kt(e,t){var n=e.callbackNode;s0(e,t);var r=sa(e,e===Ge?et:0);if(r===0)n!==null&&mp(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(n!=null&&mp(n),t===1)e.tag===0?rw(cf.bind(null,e)):Am(cf.bind(null,e)),Z0(function(){!(we&6)&&vr()}),n=null;else{switch(um(r)){case 1:n=$d;break;case 4:n=cm;break;case 16:n=ra;break;case 536870912:n=lm;break;default:n=ra}n=Ng(n,kg.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function kg(e,t){if(Qo=-1,Ko=0,we&6)throw Error($(327));var n=e.callbackNode;if(xs()&&e.callbackNode!==n)return null;var r=sa(e,e===Ge?et:0);if(r===0)return null;if(r&30||r&e.expiredLanes||t)t=xa(e,r);else{t=r;var s=we;we|=2;var i=Pg();(Ge!==e||et!==t)&&(jn=null,js=Fe()+500,Lr(e,t));do try{Cw();break}catch(a){Tg(e,a)}while(1);Yd(),wa.current=i,we=s,Be!==null?t=0:(Ge=null,et=0,t=Ke)}if(t!==0){if(t===2&&(s=Nl(e),s!==0&&(r=s,t=cd(e,s))),t===1)throw n=Hi,Lr(e,0),Yn(e,r),kt(e,Fe()),n;if(t===6)Yn(e,r);else{if(s=e.current.alternate,!(r&30)&&!xw(s)&&(t=xa(e,r),t===2&&(i=Nl(e),i!==0&&(r=i,t=cd(e,i))),t===1))throw n=Hi,Lr(e,0),Yn(e,r),kt(e,Fe()),n;switch(e.finishedWork=s,e.finishedLanes=r,t){case 0:case 1:throw Error($(345));case 2:Rr(e,bt,jn);break;case 3:if(Yn(e,r),(r&130023424)===r&&(t=pu+500-Fe(),10<t)){if(sa(e,0)!==0)break;if(s=e.suspendedLanes,(s&r)!==r){wt(),e.pingedLanes|=e.suspendedLanes&s;break}e.timeoutHandle=Bl(Rr.bind(null,e,bt,jn),t);break}Rr(e,bt,jn);break;case 4:if(Yn(e,r),(r&4194240)===r)break;for(t=e.eventTimes,s=-1;0<r;){var o=31-tn(r);i=1<<o,o=t[o],o>s&&(s=o),r&=~i}if(r=s,r=Fe()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*Sw(r/1960))-r,10<r){e.timeoutHandle=Bl(Rr.bind(null,e,bt,jn),r);break}Rr(e,bt,jn);break;case 5:Rr(e,bt,jn);break;default:throw Error($(329))}}}return kt(e,Fe()),e.callbackNode===n?kg.bind(null,e):null}function cd(e,t){var n=Si;return e.current.memoizedState.isDehydrated&&(Lr(e,t).flags|=256),e=xa(e,t),e!==2&&(t=bt,bt=n,t!==null&&ld(t)),e}function ld(e){bt===null?bt=e:bt.push.apply(bt,e)}function xw(e){for(var t=e;;){if(t.flags&16384){var n=t.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var s=n[r],i=s.getSnapshot;s=s.value;try{if(!on(i(),s))return!1}catch{return!1}}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Yn(e,t){for(t&=~uu,t&=~za,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-tn(t),r=1<<n;e[n]=-1,t&=~r}}function cf(e){if(we&6)throw Error($(327));xs();var t=sa(e,0);if(!(t&1))return kt(e,Fe()),null;var n=xa(e,t);if(e.tag!==0&&n===2){var r=Nl(e);r!==0&&(t=r,n=cd(e,r))}if(n===1)throw n=Hi,Lr(e,0),Yn(e,t),kt(e,Fe()),n;if(n===6)throw Error($(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Rr(e,bt,jn),kt(e,Fe()),null}function fu(e,t){var n=we;we|=1;try{return e(t)}finally{we=n,we===0&&(js=Fe()+500,Aa&&vr())}}function Or(e){er!==null&&er.tag===0&&!(we&6)&&xs();var t=we;we|=1;var n=Vt.transition,r=xe;try{if(Vt.transition=null,xe=1,e)return e()}finally{xe=r,Vt.transition=n,we=t,!(we&6)&&vr()}}function hu(){Dt=fs.current,je(fs)}function Lr(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(n!==-1&&(e.timeoutHandle=-1,J0(n)),Be!==null)for(n=Be.return;n!==null;){var r=n;switch(qd(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&la();break;case 3:Ts(),je(Et),je(ht),ru();break;case 5:nu(r);break;case 4:Ts();break;case 13:je(De);break;case 19:je(De);break;case 10:Jd(r.type._context);break;case 22:case 23:hu()}n=n.return}if(Ge=e,Be=e=dr(e.current,null),et=Dt=t,Ke=0,Hi=null,uu=za=Ar=0,bt=Si=null,Tr!==null){for(t=0;t<Tr.length;t++)if(n=Tr[t],r=n.interleaved,r!==null){n.interleaved=null;var s=r.next,i=n.pending;if(i!==null){var o=i.next;i.next=s,r.next=o}n.pending=r}Tr=null}return e}function Tg(e,t){do{var n=Be;try{if(Yd(),Vo.current=ya,va){for(var r=Ie.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}va=!1}if(Mr=0,qe=Qe=Ie=null,wi=!1,Bi=0,du.current=null,n===null||n.return===null){Ke=1,Hi=t,Be=null;break}e:{var i=e,o=n.return,a=n,c=t;if(t=et,a.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var l=c,d=a,u=d.tag;if(!(d.mode&1)&&(u===0||u===11||u===15)){var f=d.alternate;f?(d.updateQueue=f.updateQueue,d.memoizedState=f.memoizedState,d.lanes=f.lanes):(d.updateQueue=null,d.memoizedState=null)}var h=qp(o);if(h!==null){h.flags&=-257,Gp(h,o,a,i,t),h.mode&1&&Kp(i,l,t),t=h,c=l;var v=t.updateQueue;if(v===null){var y=new Set;y.add(c),t.updateQueue=y}else v.add(c);break e}else{if(!(t&1)){Kp(i,l,t),mu();break e}c=Error($(426))}}else if(Le&&a.mode&1){var x=qp(o);if(x!==null){!(x.flags&65536)&&(x.flags|=256),Gp(x,o,a,i,t),Gd(Ps(c,a));break e}}i=c=Ps(c,a),Ke!==4&&(Ke=2),Si===null?Si=[i]:Si.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,t&=-t,i.lanes|=t;var g=ug(i,c,t);Up(i,g);break e;case 1:a=c;var m=i.type,w=i.stateNode;if(!(i.flags&128)&&(typeof m.getDerivedStateFromError=="function"||w!==null&&typeof w.componentDidCatch=="function"&&(cr===null||!cr.has(w)))){i.flags|=65536,t&=-t,i.lanes|=t;var C=pg(i,a,t);Up(i,C);break e}}i=i.return}while(i!==null)}Lg(n)}catch(L){t=L,Be===n&&n!==null&&(Be=n=n.return);continue}break}while(1)}function Pg(){var e=wa.current;return wa.current=ya,e===null?ya:e}function mu(){(Ke===0||Ke===3||Ke===2)&&(Ke=4),Ge===null||!(Ar&268435455)&&!(za&268435455)||Yn(Ge,et)}function xa(e,t){var n=we;we|=2;var r=Pg();(Ge!==e||et!==t)&&(jn=null,Lr(e,t));do try{bw();break}catch(s){Tg(e,s)}while(1);if(Yd(),we=n,wa.current=r,Be!==null)throw Error($(261));return Ge=null,et=0,Ke}function bw(){for(;Be!==null;)jg(Be)}function Cw(){for(;Be!==null&&!Gy();)jg(Be)}function jg(e){var t=Ig(e.alternate,e,Dt);e.memoizedProps=e.pendingProps,t===null?Lg(e):Be=t,du.current=null}function Lg(e){var t=e;do{var n=t.alternate;if(e=t.return,t.flags&32768){if(n=vw(n,t),n!==null){n.flags&=32767,Be=n;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Ke=6,Be=null;return}}else if(n=gw(n,t,Dt),n!==null){Be=n;return}if(t=t.sibling,t!==null){Be=t;return}Be=t=e}while(t!==null);Ke===0&&(Ke=5)}function Rr(e,t,n){var r=xe,s=Vt.transition;try{Vt.transition=null,xe=1,Ew(e,t,n,r)}finally{Vt.transition=s,xe=r}return null}function Ew(e,t,n,r){do xs();while(er!==null);if(we&6)throw Error($(327));n=e.finishedWork;var s=e.finishedLanes;if(n===null)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error($(177));e.callbackNode=null,e.callbackPriority=0;var i=n.lanes|n.childLanes;if(i0(e,i),e===Ge&&(Be=Ge=null,et=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||ko||(ko=!0,Ng(ra,function(){return xs(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=Vt.transition,Vt.transition=null;var o=xe;xe=1;var a=we;we|=4,du.current=null,ww(e,n),Eg(n,e),H0(zl),ia=!!Fl,zl=Fl=null,e.current=n,_w(n),Xy(),we=a,xe=o,Vt.transition=i}else e.current=n;if(ko&&(ko=!1,er=e,Sa=s),i=e.pendingLanes,i===0&&(cr=null),Zy(n.stateNode),kt(e,Fe()),t!==null)for(r=e.onRecoverableError,n=0;n<t.length;n++)s=t[n],r(s.value,{componentStack:s.stack,digest:s.digest});if(_a)throw _a=!1,e=od,od=null,e;return Sa&1&&e.tag!==0&&xs(),i=e.pendingLanes,i&1?e===ad?xi++:(xi=0,ad=e):xi=0,vr(),null}function xs(){if(er!==null){var e=um(Sa),t=Vt.transition,n=xe;try{if(Vt.transition=null,xe=16>e?16:e,er===null)var r=!1;else{if(e=er,er=null,Sa=0,we&6)throw Error($(331));var s=we;for(we|=4,J=e.current;J!==null;){var i=J,o=i.child;if(J.flags&16){var a=i.deletions;if(a!==null){for(var c=0;c<a.length;c++){var l=a[c];for(J=l;J!==null;){var d=J;switch(d.tag){case 0:case 11:case 15:_i(8,d,i)}var u=d.child;if(u!==null)u.return=d,J=u;else for(;J!==null;){d=J;var f=d.sibling,h=d.return;if(xg(d),d===l){J=null;break}if(f!==null){f.return=h,J=f;break}J=h}}}var v=i.alternate;if(v!==null){var y=v.child;if(y!==null){v.child=null;do{var x=y.sibling;y.sibling=null,y=x}while(y!==null)}}J=i}}if(i.subtreeFlags&2064&&o!==null)o.return=i,J=o;else e:for(;J!==null;){if(i=J,i.flags&2048)switch(i.tag){case 0:case 11:case 15:_i(9,i,i.return)}var g=i.sibling;if(g!==null){g.return=i.return,J=g;break e}J=i.return}}var m=e.current;for(J=m;J!==null;){o=J;var w=o.child;if(o.subtreeFlags&2064&&w!==null)w.return=o,J=w;else e:for(o=m;J!==null;){if(a=J,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:Fa(9,a)}}catch(L){Ae(a,a.return,L)}if(a===o){J=null;break e}var C=a.sibling;if(C!==null){C.return=a.return,J=C;break e}J=a.return}}if(we=s,vr(),wn&&typeof wn.onPostCommitFiberRoot=="function")try{wn.onPostCommitFiberRoot(La,e)}catch{}r=!0}return r}finally{xe=n,Vt.transition=t}}return!1}function lf(e,t,n){t=Ps(n,t),t=ug(e,t,1),e=ar(e,t,1),t=wt(),e!==null&&(Xi(e,1,t),kt(e,t))}function Ae(e,t,n){if(e.tag===3)lf(e,e,n);else for(;t!==null;){if(t.tag===3){lf(t,e,n);break}else if(t.tag===1){var r=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(cr===null||!cr.has(r))){e=Ps(n,e),e=pg(t,e,1),t=ar(t,e,1),e=wt(),t!==null&&(Xi(t,1,e),kt(t,e));break}}t=t.return}}function Rw(e,t,n){var r=e.pingCache;r!==null&&r.delete(t),t=wt(),e.pingedLanes|=e.suspendedLanes&n,Ge===e&&(et&n)===n&&(Ke===4||Ke===3&&(et&130023424)===et&&500>Fe()-pu?Lr(e,0):uu|=n),kt(e,t)}function Dg(e,t){t===0&&(e.mode&1?(t=vo,vo<<=1,!(vo&130023424)&&(vo=4194304)):t=1);var n=wt();e=On(e,t),e!==null&&(Xi(e,t,n),kt(e,n))}function kw(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),Dg(e,n)}function Tw(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,s=e.memoizedState;s!==null&&(n=s.retryLane);break;case 19:r=e.stateNode;break;default:throw Error($(314))}r!==null&&r.delete(t),Dg(e,n)}var Ig;Ig=function(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps||Et.current)Ct=!0;else{if(!(e.lanes&n)&&!(t.flags&128))return Ct=!1,mw(e,t,n);Ct=!!(e.flags&131072)}else Ct=!1,Le&&t.flags&1048576&&Om(t,pa,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;Ho(e,t),e=t.pendingProps;var s=Es(t,ht.current);Ss(t,n),s=iu(null,t,r,e,s,n);var i=ou();return t.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Rt(r)?(i=!0,da(t)):i=!1,t.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,eu(t),s.updater=$a,t.stateNode=s,s._reactInternals=t,Gl(t,r,e,n),t=Jl(null,t,r,!0,i,n)):(t.tag=0,Le&&i&&Kd(t),vt(null,t,s,n),t=t.child),t;case 16:r=t.elementType;e:{switch(Ho(e,t),e=t.pendingProps,s=r._init,r=s(r._payload),t.type=r,s=t.tag=jw(r),e=Jt(r,e),s){case 0:t=Yl(null,t,r,e,n);break e;case 1:t=Jp(null,t,r,e,n);break e;case 11:t=Xp(null,t,r,e,n);break e;case 14:t=Yp(null,t,r,Jt(r.type,e),n);break e}throw Error($(306,r,""))}return t;case 0:return r=t.type,s=t.pendingProps,s=t.elementType===r?s:Jt(r,s),Yl(e,t,r,s,n);case 1:return r=t.type,s=t.pendingProps,s=t.elementType===r?s:Jt(r,s),Jp(e,t,r,s,n);case 3:e:{if(gg(t),e===null)throw Error($(387));r=t.pendingProps,i=t.memoizedState,s=i.element,Vm(e,t),ma(t,r,null,n);var o=t.memoizedState;if(r=o.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},t.updateQueue.baseState=i,t.memoizedState=i,t.flags&256){s=Ps(Error($(423)),t),t=Zp(e,t,r,n,s);break e}else if(r!==s){s=Ps(Error($(424)),t),t=Zp(e,t,r,n,s);break e}else for(Mt=or(t.stateNode.containerInfo.firstChild),At=t,Le=!0,en=null,n=Um(t,null,r,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Rs(),r===s){t=$n(e,t,n);break e}vt(e,t,r,n)}t=t.child}return t;case 5:return Wm(t),e===null&&Ql(t),r=t.type,s=t.pendingProps,i=e!==null?e.memoizedProps:null,o=s.children,Ul(r,s)?o=null:i!==null&&Ul(r,i)&&(t.flags|=32),mg(e,t),vt(e,t,o,n),t.child;case 6:return e===null&&Ql(t),null;case 13:return vg(e,t,n);case 4:return tu(t,t.stateNode.containerInfo),r=t.pendingProps,e===null?t.child=ks(t,null,r,n):vt(e,t,r,n),t.child;case 11:return r=t.type,s=t.pendingProps,s=t.elementType===r?s:Jt(r,s),Xp(e,t,r,s,n);case 7:return vt(e,t,t.pendingProps,n),t.child;case 8:return vt(e,t,t.pendingProps.children,n),t.child;case 12:return vt(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,s=t.pendingProps,i=t.memoizedProps,o=s.value,Te(fa,r._currentValue),r._currentValue=o,i!==null)if(on(i.value,o)){if(i.children===s.children&&!Et.current){t=$n(e,t,n);break e}}else for(i=t.child,i!==null&&(i.return=t);i!==null;){var a=i.dependencies;if(a!==null){o=i.child;for(var c=a.firstContext;c!==null;){if(c.context===r){if(i.tag===1){c=Nn(-1,n&-n),c.tag=2;var l=i.updateQueue;if(l!==null){l=l.shared;var d=l.pending;d===null?c.next=c:(c.next=d.next,d.next=c),l.pending=c}}i.lanes|=n,c=i.alternate,c!==null&&(c.lanes|=n),Kl(i.return,n,t),a.lanes|=n;break}c=c.next}}else if(i.tag===10)o=i.type===t.type?null:i.child;else if(i.tag===18){if(o=i.return,o===null)throw Error($(341));o.lanes|=n,a=o.alternate,a!==null&&(a.lanes|=n),Kl(o,n,t),o=i.sibling}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===t){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}vt(e,t,s.children,n),t=t.child}return t;case 9:return s=t.type,r=t.pendingProps.children,Ss(t,n),s=Ht(s),r=r(s),t.flags|=1,vt(e,t,r,n),t.child;case 14:return r=t.type,s=Jt(r,t.pendingProps),s=Jt(r.type,s),Yp(e,t,r,s,n);case 15:return fg(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,s=t.pendingProps,s=t.elementType===r?s:Jt(r,s),Ho(e,t),t.tag=1,Rt(r)?(e=!0,da(t)):e=!1,Ss(t,n),dg(t,r,s),Gl(t,r,s,n),Jl(null,t,r,!0,e,n);case 19:return yg(e,t,n);case 22:return hg(e,t,n)}throw Error($(156,t.tag))};function Ng(e,t){return am(e,t)}function Pw(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Bt(e,t,n,r){return new Pw(e,t,n,r)}function gu(e){return e=e.prototype,!(!e||!e.isReactComponent)}function jw(e){if(typeof e=="function")return gu(e)?1:0;if(e!=null){if(e=e.$$typeof,e===Md)return 11;if(e===Ad)return 14}return 2}function dr(e,t){var n=e.alternate;return n===null?(n=Bt(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&14680064,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function qo(e,t,n,r,s,i){var o=2;if(r=e,typeof e=="function")gu(e)&&(o=1);else if(typeof e=="string")o=5;else e:switch(e){case rs:return Dr(n.children,s,i,t);case Nd:o=8,s|=8;break;case wl:return e=Bt(12,n,t,s|2),e.elementType=wl,e.lanes=i,e;case _l:return e=Bt(13,n,t,s),e.elementType=_l,e.lanes=i,e;case Sl:return e=Bt(19,n,t,s),e.elementType=Sl,e.lanes=i,e;case Wh:return Ua(n,s,i,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case Bh:o=10;break e;case Vh:o=9;break e;case Md:o=11;break e;case Ad:o=14;break e;case qn:o=16,r=null;break e}throw Error($(130,e==null?e:typeof e,""))}return t=Bt(o,n,t,s),t.elementType=e,t.type=r,t.lanes=i,t}function Dr(e,t,n,r){return e=Bt(7,e,r,t),e.lanes=n,e}function Ua(e,t,n,r){return e=Bt(22,e,r,t),e.elementType=Wh,e.lanes=n,e.stateNode={isHidden:!1},e}function Jc(e,t,n){return e=Bt(6,e,null,t),e.lanes=n,e}function Zc(e,t,n){return t=Bt(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Lw(e,t,n,r,s){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Ic(0),this.expirationTimes=Ic(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ic(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function vu(e,t,n,r,s,i,o,a,c){return e=new Lw(e,t,n,a,c),t===1?(t=1,i===!0&&(t|=8)):t=0,i=Bt(3,null,null,t),e.current=i,i.stateNode=e,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},eu(i),e}function Dw(e,t,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:ns,key:r==null?null:""+r,children:e,containerInfo:t,implementation:n}}function Mg(e){if(!e)return hr;e=e._reactInternals;e:{if(Br(e)!==e||e.tag!==1)throw Error($(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Rt(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error($(171))}if(e.tag===1){var n=e.type;if(Rt(n))return Mm(e,n,t)}return t}function Ag(e,t,n,r,s,i,o,a,c){return e=vu(n,r,!0,e,s,i,o,a,c),e.context=Mg(null),n=e.current,r=wt(),s=lr(n),i=Nn(r,s),i.callback=t??null,ar(n,i,s),e.current.lanes=s,Xi(e,s,r),kt(e,r),e}function Ba(e,t,n,r){var s=t.current,i=wt(),o=lr(s);return n=Mg(n),t.context===null?t.context=n:t.pendingContext=n,t=Nn(i,o),t.payload={element:e},r=r===void 0?null:r,r!==null&&(t.callback=r),e=ar(s,t,o),e!==null&&(nn(e,s,o,i),Bo(e,s,o)),o}function ba(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function df(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function yu(e,t){df(e,t),(e=e.alternate)&&df(e,t)}function Iw(){return null}var Og=typeof reportError=="function"?reportError:function(e){console.error(e)};function wu(e){this._internalRoot=e}Va.prototype.render=wu.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error($(409));Ba(e,t,null,null)};Va.prototype.unmount=wu.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Or(function(){Ba(null,e,null,null)}),t[An]=null}};function Va(e){this._internalRoot=e}Va.prototype.unstable_scheduleHydration=function(e){if(e){var t=hm();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Xn.length&&t!==0&&t<Xn[n].priority;n++);Xn.splice(n,0,e),n===0&&gm(e)}};function _u(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Wa(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function uf(){}function Nw(e,t,n,r,s){if(s){if(typeof r=="function"){var i=r;r=function(){var l=ba(o);i.call(l)}}var o=Ag(t,r,e,0,null,!1,!1,"",uf);return e._reactRootContainer=o,e[An]=o.current,Oi(e.nodeType===8?e.parentNode:e),Or(),o}for(;s=e.lastChild;)e.removeChild(s);if(typeof r=="function"){var a=r;r=function(){var l=ba(c);a.call(l)}}var c=vu(e,0,!1,null,null,!1,!1,"",uf);return e._reactRootContainer=c,e[An]=c.current,Oi(e.nodeType===8?e.parentNode:e),Or(function(){Ba(t,c,n,r)}),c}function Ha(e,t,n,r,s){var i=n._reactRootContainer;if(i){var o=i;if(typeof s=="function"){var a=s;s=function(){var c=ba(o);a.call(c)}}Ba(t,o,e,s)}else o=Nw(n,t,e,s,r);return ba(o)}pm=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=pi(t.pendingLanes);n!==0&&(Fd(t,n|1),kt(t,Fe()),!(we&6)&&(js=Fe()+500,vr()))}break;case 13:Or(function(){var r=On(e,1);if(r!==null){var s=wt();nn(r,e,1,s)}}),yu(e,1)}};zd=function(e){if(e.tag===13){var t=On(e,134217728);if(t!==null){var n=wt();nn(t,e,134217728,n)}yu(e,134217728)}};fm=function(e){if(e.tag===13){var t=lr(e),n=On(e,t);if(n!==null){var r=wt();nn(n,e,t,r)}yu(e,t)}};hm=function(){return xe};mm=function(e,t){var n=xe;try{return xe=e,t()}finally{xe=n}};Ll=function(e,t,n){switch(t){case"input":if(Cl(e,n),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var s=Ma(r);if(!s)throw Error($(90));Qh(r),Cl(r,s)}}}break;case"textarea":qh(e,n);break;case"select":t=n.value,t!=null&&vs(e,!!n.multiple,t,!1)}};tm=fu;nm=Or;var Mw={usingClientEntryPoint:!1,Events:[Ji,as,Ma,Zh,em,fu]},Js={findFiberByHostInstance:kr,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Aw={bundleType:Js.bundleType,version:Js.version,rendererPackageName:Js.rendererPackageName,rendererConfig:Js.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:zn.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=im(e),e===null?null:e.stateNode},findFiberByHostInstance:Js.findFiberByHostInstance||Iw,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var To=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!To.isDisabled&&To.supportsFiber)try{La=To.inject(Aw),wn=To}catch{}}$t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Mw;$t.createPortal=function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!_u(t))throw Error($(200));return Dw(e,t,null,n)};$t.createRoot=function(e,t){if(!_u(e))throw Error($(299));var n=!1,r="",s=Og;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(r=t.identifierPrefix),t.onRecoverableError!==void 0&&(s=t.onRecoverableError)),t=vu(e,1,!1,null,null,n,!1,r,s),e[An]=t.current,Oi(e.nodeType===8?e.parentNode:e),new wu(t)};$t.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error($(188)):(e=Object.keys(e).join(","),Error($(268,e)));return e=im(t),e=e===null?null:e.stateNode,e};$t.flushSync=function(e){return Or(e)};$t.hydrate=function(e,t,n){if(!Wa(t))throw Error($(200));return Ha(null,e,t,!0,n)};$t.hydrateRoot=function(e,t,n){if(!_u(e))throw Error($(405));var r=n!=null&&n.hydratedSources||null,s=!1,i="",o=Og;if(n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),t=Ag(t,null,e,1,n??null,s,!1,i,o),e[An]=t.current,Oi(e),r)for(e=0;e<r.length;e++)n=r[e],s=n._getVersion,s=s(n._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[n,s]:t.mutableSourceEagerHydrationData.push(n,s);return new Va(t)};$t.render=function(e,t,n){if(!Wa(t))throw Error($(200));return Ha(null,e,t,!1,n)};$t.unmountComponentAtNode=function(e){if(!Wa(e))throw Error($(40));return e._reactRootContainer?(Or(function(){Ha(null,null,e,!1,function(){e._reactRootContainer=null,e[An]=null})}),!0):!1};$t.unstable_batchedUpdates=fu;$t.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!Wa(n))throw Error($(200));if(e==null||e._reactInternals===void 0)throw Error($(38));return Ha(e,t,n,!1,r)};$t.version="18.3.1-next-f1338f8080-20240426";function $g(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE($g)}catch(e){console.error(e)}}$g(),$h.exports=$t;var Ow=$h.exports,pf=Ow;vl.createRoot=pf.createRoot,vl.hydrateRoot=pf.hydrateRoot;/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Qi(){return Qi=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Qi.apply(this,arguments)}var tr;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(tr||(tr={}));const ff="popstate";function $w(e){e===void 0&&(e={});function t(r,s){let{pathname:i,search:o,hash:a}=r.location;return dd("",{pathname:i,search:o,hash:a},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function n(r,s){return typeof s=="string"?s:Ca(s)}return zw(t,n,null,e)}function ze(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function Fg(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function Fw(){return Math.random().toString(36).substr(2,8)}function hf(e,t){return{usr:e.state,key:e.key,idx:t}}function dd(e,t,n,r){return n===void 0&&(n=null),Qi({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof t=="string"?Ns(t):t,{state:n,key:t&&t.key||r||Fw()})}function Ca(e){let{pathname:t="/",search:n="",hash:r=""}=e;return n&&n!=="?"&&(t+=n.charAt(0)==="?"?n:"?"+n),r&&r!=="#"&&(t+=r.charAt(0)==="#"?r:"#"+r),t}function Ns(e){let t={};if(e){let n=e.indexOf("#");n>=0&&(t.hash=e.substr(n),e=e.substr(0,n));let r=e.indexOf("?");r>=0&&(t.search=e.substr(r),e=e.substr(0,r)),e&&(t.pathname=e)}return t}function zw(e,t,n,r){r===void 0&&(r={});let{window:s=document.defaultView,v5Compat:i=!1}=r,o=s.history,a=tr.Pop,c=null,l=d();l==null&&(l=0,o.replaceState(Qi({},o.state,{idx:l}),""));function d(){return(o.state||{idx:null}).idx}function u(){a=tr.Pop;let x=d(),g=x==null?null:x-l;l=x,c&&c({action:a,location:y.location,delta:g})}function f(x,g){a=tr.Push;let m=dd(y.location,x,g);n&&n(m,x),l=d()+1;let w=hf(m,l),C=y.createHref(m);try{o.pushState(w,"",C)}catch(L){if(L instanceof DOMException&&L.name==="DataCloneError")throw L;s.location.assign(C)}i&&c&&c({action:a,location:y.location,delta:1})}function h(x,g){a=tr.Replace;let m=dd(y.location,x,g);n&&n(m,x),l=d();let w=hf(m,l),C=y.createHref(m);o.replaceState(w,"",C),i&&c&&c({action:a,location:y.location,delta:0})}function v(x){let g=s.location.origin!=="null"?s.location.origin:s.location.href,m=typeof x=="string"?x:Ca(x);return m=m.replace(/ $/,"%20"),ze(g,"No window.location.(origin|href) available to create URL for href: "+m),new URL(m,g)}let y={get action(){return a},get location(){return e(s,o)},listen(x){if(c)throw new Error("A history only accepts one active listener");return s.addEventListener(ff,u),c=x,()=>{s.removeEventListener(ff,u),c=null}},createHref(x){return t(s,x)},createURL:v,encodeLocation(x){let g=v(x);return{pathname:g.pathname,search:g.search,hash:g.hash}},push:f,replace:h,go(x){return o.go(x)}};return y}var mf;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(mf||(mf={}));function Uw(e,t,n){return n===void 0&&(n="/"),Bw(e,t,n,!1)}function Bw(e,t,n,r){let s=typeof t=="string"?Ns(t):t,i=Su(s.pathname||"/",n);if(i==null)return null;let o=zg(e);Vw(o);let a=null;for(let c=0;a==null&&c<o.length;++c){let l=e_(i);a=Jw(o[c],l,r)}return a}function zg(e,t,n,r){t===void 0&&(t=[]),n===void 0&&(n=[]),r===void 0&&(r="");let s=(i,o,a)=>{let c={relativePath:a===void 0?i.path||"":a,caseSensitive:i.caseSensitive===!0,childrenIndex:o,route:i};c.relativePath.startsWith("/")&&(ze(c.relativePath.startsWith(r),'Absolute route path "'+c.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),c.relativePath=c.relativePath.slice(r.length));let l=ur([r,c.relativePath]),d=n.concat(c);i.children&&i.children.length>0&&(ze(i.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+l+'".')),zg(i.children,t,d,l)),!(i.path==null&&!i.index)&&t.push({path:l,score:Xw(l,i.index),routesMeta:d})};return e.forEach((i,o)=>{var a;if(i.path===""||!((a=i.path)!=null&&a.includes("?")))s(i,o);else for(let c of Ug(i.path))s(i,o,c)}),t}function Ug(e){let t=e.split("/");if(t.length===0)return[];let[n,...r]=t,s=n.endsWith("?"),i=n.replace(/\?$/,"");if(r.length===0)return s?[i,""]:[i];let o=Ug(r.join("/")),a=[];return a.push(...o.map(c=>c===""?i:[i,c].join("/"))),s&&a.push(...o),a.map(c=>e.startsWith("/")&&c===""?"/":c)}function Vw(e){e.sort((t,n)=>t.score!==n.score?n.score-t.score:Yw(t.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}const Ww=/^:[\w-]+$/,Hw=3,Qw=2,Kw=1,qw=10,Gw=-2,gf=e=>e==="*";function Xw(e,t){let n=e.split("/"),r=n.length;return n.some(gf)&&(r+=Gw),t&&(r+=Qw),n.filter(s=>!gf(s)).reduce((s,i)=>s+(Ww.test(i)?Hw:i===""?Kw:qw),r)}function Yw(e,t){return e.length===t.length&&e.slice(0,-1).every((r,s)=>r===t[s])?e[e.length-1]-t[t.length-1]:0}function Jw(e,t,n){n===void 0&&(n=!1);let{routesMeta:r}=e,s={},i="/",o=[];for(let a=0;a<r.length;++a){let c=r[a],l=a===r.length-1,d=i==="/"?t:t.slice(i.length)||"/",u=vf({path:c.relativePath,caseSensitive:c.caseSensitive,end:l},d),f=c.route;if(!u&&l&&n&&!r[r.length-1].route.index&&(u=vf({path:c.relativePath,caseSensitive:c.caseSensitive,end:!1},d)),!u)return null;Object.assign(s,u.params),o.push({params:s,pathname:ur([i,u.pathname]),pathnameBase:s_(ur([i,u.pathnameBase])),route:f}),u.pathnameBase!=="/"&&(i=ur([i,u.pathnameBase]))}return o}function vf(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[n,r]=Zw(e.path,e.caseSensitive,e.end),s=t.match(n);if(!s)return null;let i=s[0],o=i.replace(/(.)\/+$/,"$1"),a=s.slice(1);return{params:r.reduce((l,d,u)=>{let{paramName:f,isOptional:h}=d;if(f==="*"){let y=a[u]||"";o=i.slice(0,i.length-y.length).replace(/(.)\/+$/,"$1")}const v=a[u];return h&&!v?l[f]=void 0:l[f]=(v||"").replace(/%2F/g,"/"),l},{}),pathname:i,pathnameBase:o,pattern:e}}function Zw(e,t,n){t===void 0&&(t=!1),n===void 0&&(n=!0),Fg(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let r=[],s="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,a,c)=>(r.push({paramName:a,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(r.push({paramName:"*"}),s+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?s+="\\/*$":e!==""&&e!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,t?void 0:"i"),r]}function e_(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return Fg(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),e}}function Su(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let n=t.endsWith("/")?t.length-1:t.length,r=e.charAt(n);return r&&r!=="/"?null:e.slice(n)||"/"}function t_(e,t){t===void 0&&(t="/");let{pathname:n,search:r="",hash:s=""}=typeof e=="string"?Ns(e):e;return{pathname:n?n.startsWith("/")?n:n_(n,t):t,search:i_(r),hash:o_(s)}}function n_(e,t){let n=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(s=>{s===".."?n.length>1&&n.pop():s!=="."&&n.push(s)}),n.length>1?n.join("/"):"/"}function el(e,t,n,r){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function r_(e){return e.filter((t,n)=>n===0||t.route.path&&t.route.path.length>0)}function xu(e,t){let n=r_(e);return t?n.map((r,s)=>s===n.length-1?r.pathname:r.pathnameBase):n.map(r=>r.pathnameBase)}function bu(e,t,n,r){r===void 0&&(r=!1);let s;typeof e=="string"?s=Ns(e):(s=Qi({},e),ze(!s.pathname||!s.pathname.includes("?"),el("?","pathname","search",s)),ze(!s.pathname||!s.pathname.includes("#"),el("#","pathname","hash",s)),ze(!s.search||!s.search.includes("#"),el("#","search","hash",s)));let i=e===""||s.pathname==="",o=i?"/":s.pathname,a;if(o==null)a=n;else{let u=t.length-1;if(!r&&o.startsWith("..")){let f=o.split("/");for(;f[0]==="..";)f.shift(),u-=1;s.pathname=f.join("/")}a=u>=0?t[u]:"/"}let c=t_(s,a),l=o&&o!=="/"&&o.endsWith("/"),d=(i||o===".")&&n.endsWith("/");return!c.pathname.endsWith("/")&&(l||d)&&(c.pathname+="/"),c}const ur=e=>e.join("/").replace(/\/\/+/g,"/"),s_=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),i_=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,o_=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function a_(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const Bg=["post","put","patch","delete"];new Set(Bg);const c_=["get",...Bg];new Set(c_);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Ki(){return Ki=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Ki.apply(this,arguments)}const Cu=_.createContext(null),l_=_.createContext(null),yr=_.createContext(null),Qa=_.createContext(null),Un=_.createContext({outlet:null,matches:[],isDataRoute:!1}),Vg=_.createContext(null);function d_(e,t){let{relative:n}=t===void 0?{}:t;Ms()||ze(!1);let{basename:r,navigator:s}=_.useContext(yr),{hash:i,pathname:o,search:a}=Qg(e,{relative:n}),c=o;return r!=="/"&&(c=o==="/"?r:ur([r,o])),s.createHref({pathname:c,search:a,hash:i})}function Ms(){return _.useContext(Qa)!=null}function Kt(){return Ms()||ze(!1),_.useContext(Qa).location}function Wg(e){_.useContext(yr).static||_.useLayoutEffect(e)}function Sn(){let{isDataRoute:e}=_.useContext(Un);return e?b_():u_()}function u_(){Ms()||ze(!1);let e=_.useContext(Cu),{basename:t,future:n,navigator:r}=_.useContext(yr),{matches:s}=_.useContext(Un),{pathname:i}=Kt(),o=JSON.stringify(xu(s,n.v7_relativeSplatPath)),a=_.useRef(!1);return Wg(()=>{a.current=!0}),_.useCallback(function(l,d){if(d===void 0&&(d={}),!a.current)return;if(typeof l=="number"){r.go(l);return}let u=bu(l,JSON.parse(o),i,d.relative==="path");e==null&&t!=="/"&&(u.pathname=u.pathname==="/"?t:ur([t,u.pathname])),(d.replace?r.replace:r.push)(u,d.state,d)},[t,r,o,i,e])}function Hg(){let{matches:e}=_.useContext(Un),t=e[e.length-1];return t?t.params:{}}function Qg(e,t){let{relative:n}=t===void 0?{}:t,{future:r}=_.useContext(yr),{matches:s}=_.useContext(Un),{pathname:i}=Kt(),o=JSON.stringify(xu(s,r.v7_relativeSplatPath));return _.useMemo(()=>bu(e,JSON.parse(o),i,n==="path"),[e,o,i,n])}function p_(e,t){return f_(e,t)}function f_(e,t,n,r){Ms()||ze(!1);let{navigator:s}=_.useContext(yr),{matches:i}=_.useContext(Un),o=i[i.length-1],a=o?o.params:{};o&&o.pathname;let c=o?o.pathnameBase:"/";o&&o.route;let l=Kt(),d;if(t){var u;let x=typeof t=="string"?Ns(t):t;c==="/"||(u=x.pathname)!=null&&u.startsWith(c)||ze(!1),d=x}else d=l;let f=d.pathname||"/",h=f;if(c!=="/"){let x=c.replace(/^\//,"").split("/");h="/"+f.replace(/^\//,"").split("/").slice(x.length).join("/")}let v=Uw(e,{pathname:h}),y=y_(v&&v.map(x=>Object.assign({},x,{params:Object.assign({},a,x.params),pathname:ur([c,s.encodeLocation?s.encodeLocation(x.pathname).pathname:x.pathname]),pathnameBase:x.pathnameBase==="/"?c:ur([c,s.encodeLocation?s.encodeLocation(x.pathnameBase).pathname:x.pathnameBase])})),i,n,r);return t&&y?_.createElement(Qa.Provider,{value:{location:Ki({pathname:"/",search:"",hash:"",state:null,key:"default"},d),navigationType:tr.Pop}},y):y}function h_(){let e=x_(),t=a_(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),n=e instanceof Error?e.stack:null,s={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"},i=null;return _.createElement(_.Fragment,null,_.createElement("h2",null,"Unexpected Application Error!"),_.createElement("h3",{style:{fontStyle:"italic"}},t),n?_.createElement("pre",{style:s},n):null,i)}const m_=_.createElement(h_,null);class g_ extends _.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,n){return n.location!==t.location||n.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:n.error,location:n.location,revalidation:t.revalidation||n.revalidation}}componentDidCatch(t,n){console.error("React Router caught the following error during render",t,n)}render(){return this.state.error!==void 0?_.createElement(Un.Provider,{value:this.props.routeContext},_.createElement(Vg.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function v_(e){let{routeContext:t,match:n,children:r}=e,s=_.useContext(Cu);return s&&s.static&&s.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=n.route.id),_.createElement(Un.Provider,{value:t},r)}function y_(e,t,n,r){var s;if(t===void 0&&(t=[]),n===void 0&&(n=null),r===void 0&&(r=null),e==null){var i;if(!n)return null;if(n.errors)e=n.matches;else if((i=r)!=null&&i.v7_partialHydration&&t.length===0&&!n.initialized&&n.matches.length>0)e=n.matches;else return null}let o=e,a=(s=n)==null?void 0:s.errors;if(a!=null){let d=o.findIndex(u=>u.route.id&&a?.[u.route.id]!==void 0);d>=0||ze(!1),o=o.slice(0,Math.min(o.length,d+1))}let c=!1,l=-1;if(n&&r&&r.v7_partialHydration)for(let d=0;d<o.length;d++){let u=o[d];if((u.route.HydrateFallback||u.route.hydrateFallbackElement)&&(l=d),u.route.id){let{loaderData:f,errors:h}=n,v=u.route.loader&&f[u.route.id]===void 0&&(!h||h[u.route.id]===void 0);if(u.route.lazy||v){c=!0,l>=0?o=o.slice(0,l+1):o=[o[0]];break}}}return o.reduceRight((d,u,f)=>{let h,v=!1,y=null,x=null;n&&(h=a&&u.route.id?a[u.route.id]:void 0,y=u.route.errorElement||m_,c&&(l<0&&f===0?(C_("route-fallback",!1),v=!0,x=null):l===f&&(v=!0,x=u.route.hydrateFallbackElement||null)));let g=t.concat(o.slice(0,f+1)),m=()=>{let w;return h?w=y:v?w=x:u.route.Component?w=_.createElement(u.route.Component,null):u.route.element?w=u.route.element:w=d,_.createElement(v_,{match:u,routeContext:{outlet:d,matches:g,isDataRoute:n!=null},children:w})};return n&&(u.route.ErrorBoundary||u.route.errorElement||f===0)?_.createElement(g_,{location:n.location,revalidation:n.revalidation,component:y,error:h,children:m(),routeContext:{outlet:null,matches:g,isDataRoute:!0}}):m()},null)}var Kg=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(Kg||{}),Ea=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(Ea||{});function w_(e){let t=_.useContext(Cu);return t||ze(!1),t}function __(e){let t=_.useContext(l_);return t||ze(!1),t}function S_(e){let t=_.useContext(Un);return t||ze(!1),t}function qg(e){let t=S_(),n=t.matches[t.matches.length-1];return n.route.id||ze(!1),n.route.id}function x_(){var e;let t=_.useContext(Vg),n=__(Ea.UseRouteError),r=qg(Ea.UseRouteError);return t!==void 0?t:(e=n.errors)==null?void 0:e[r]}function b_(){let{router:e}=w_(Kg.UseNavigateStable),t=qg(Ea.UseNavigateStable),n=_.useRef(!1);return Wg(()=>{n.current=!0}),_.useCallback(function(s,i){i===void 0&&(i={}),n.current&&(typeof s=="number"?e.navigate(s):e.navigate(s,Ki({fromRouteId:t},i)))},[e,t])}const yf={};function C_(e,t,n){!t&&!yf[e]&&(yf[e]=!0)}function E_(e,t){e?.v7_startTransition,e?.v7_relativeSplatPath===void 0&&(!t||t.v7_relativeSplatPath),t&&(t.v7_fetcherPersist,t.v7_normalizeFormMethod,t.v7_partialHydration,t.v7_skipActionErrorRevalidation)}function Gg(e){let{to:t,replace:n,state:r,relative:s}=e;Ms()||ze(!1);let{future:i,static:o}=_.useContext(yr),{matches:a}=_.useContext(Un),{pathname:c}=Kt(),l=Sn(),d=bu(t,xu(a,i.v7_relativeSplatPath),c,s==="path"),u=JSON.stringify(d);return _.useEffect(()=>l(JSON.parse(u),{replace:n,state:r,relative:s}),[l,u,s,n,r]),null}function Yt(e){ze(!1)}function R_(e){let{basename:t="/",children:n=null,location:r,navigationType:s=tr.Pop,navigator:i,static:o=!1,future:a}=e;Ms()&&ze(!1);let c=t.replace(/^\/*/,"/"),l=_.useMemo(()=>({basename:c,navigator:i,static:o,future:Ki({v7_relativeSplatPath:!1},a)}),[c,a,i,o]);typeof r=="string"&&(r=Ns(r));let{pathname:d="/",search:u="",hash:f="",state:h=null,key:v="default"}=r,y=_.useMemo(()=>{let x=Su(d,c);return x==null?null:{location:{pathname:x,search:u,hash:f,state:h,key:v},navigationType:s}},[c,d,u,f,h,v,s]);return y==null?null:_.createElement(yr.Provider,{value:l},_.createElement(Qa.Provider,{children:n,value:y}))}function k_(e){let{children:t,location:n}=e;return p_(ud(t),n)}new Promise(()=>{});function ud(e,t){t===void 0&&(t=[]);let n=[];return _.Children.forEach(e,(r,s)=>{if(!_.isValidElement(r))return;let i=[...t,s];if(r.type===_.Fragment){n.push.apply(n,ud(r.props.children,i));return}r.type!==Yt&&ze(!1),!r.props.index||!r.props.children||ze(!1);let o={id:r.props.id||i.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(o.children=ud(r.props.children,i)),n.push(o)}),n}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function pd(){return pd=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},pd.apply(this,arguments)}function T_(e,t){if(e==null)return{};var n={},r=Object.keys(e),s,i;for(i=0;i<r.length;i++)s=r[i],!(t.indexOf(s)>=0)&&(n[s]=e[s]);return n}function P_(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function j_(e,t){return e.button===0&&(!t||t==="_self")&&!P_(e)}function fd(e){return e===void 0&&(e=""),new URLSearchParams(typeof e=="string"||Array.isArray(e)||e instanceof URLSearchParams?e:Object.keys(e).reduce((t,n)=>{let r=e[n];return t.concat(Array.isArray(r)?r.map(s=>[n,s]):[[n,r]])},[]))}function L_(e,t){let n=fd(e);return t&&t.forEach((r,s)=>{n.has(s)||t.getAll(s).forEach(i=>{n.append(s,i)})}),n}const D_=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],I_="6";try{window.__reactRouterVersion=I_}catch{}const N_="startTransition",wf=Ry[N_];function M_(e){let{basename:t,children:n,future:r,window:s}=e,i=_.useRef();i.current==null&&(i.current=$w({window:s,v5Compat:!0}));let o=i.current,[a,c]=_.useState({action:o.action,location:o.location}),{v7_startTransition:l}=r||{},d=_.useCallback(u=>{l&&wf?wf(()=>c(u)):c(u)},[c,l]);return _.useLayoutEffect(()=>o.listen(d),[o,d]),_.useEffect(()=>E_(r),[r]),_.createElement(R_,{basename:t,children:n,location:a.location,navigationType:a.action,navigator:o,future:r})}const A_=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",O_=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Xg=_.forwardRef(function(t,n){let{onClick:r,relative:s,reloadDocument:i,replace:o,state:a,target:c,to:l,preventScrollReset:d,viewTransition:u}=t,f=T_(t,D_),{basename:h}=_.useContext(yr),v,y=!1;if(typeof l=="string"&&O_.test(l)&&(v=l,A_))try{let w=new URL(window.location.href),C=l.startsWith("//")?new URL(w.protocol+l):new URL(l),L=Su(C.pathname,h);C.origin===w.origin&&L!=null?l=L+C.search+C.hash:y=!0}catch{}let x=d_(l,{relative:s}),g=$_(l,{replace:o,state:a,target:c,preventScrollReset:d,relative:s,viewTransition:u});function m(w){r&&r(w),w.defaultPrevented||g(w)}return _.createElement("a",pd({},f,{href:v||x,onClick:y||i?r:m,ref:n,target:c}))});var _f;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(_f||(_f={}));var Sf;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(Sf||(Sf={}));function $_(e,t){let{target:n,replace:r,state:s,preventScrollReset:i,relative:o,viewTransition:a}=t===void 0?{}:t,c=Sn(),l=Kt(),d=Qg(e,{relative:o});return _.useCallback(u=>{if(j_(u,n)){u.preventDefault();let f=r!==void 0?r:Ca(l)===Ca(d);c(e,{replace:f,state:s,preventScrollReset:i,relative:o,viewTransition:a})}},[l,c,d,r,s,n,e,i,o,a])}function F_(e){let t=_.useRef(fd(e)),n=_.useRef(!1),r=Kt(),s=_.useMemo(()=>L_(r.search,n.current?null:t.current),[r.search]),i=Sn(),o=_.useCallback((a,c)=>{const l=fd(typeof a=="function"?a(s):a);n.current=!0,i("?"+l,c)},[i,s]);return[s,o]}function Yg(e,t){return function(){return e.apply(t,arguments)}}const{toString:z_}=Object.prototype,{getPrototypeOf:Eu}=Object,{iterator:Ka,toStringTag:Jg}=Symbol,qa=(e=>t=>{const n=z_.call(t);return e[n]||(e[n]=n.slice(8,-1).toLowerCase())})(Object.create(null)),an=e=>(e=e.toLowerCase(),t=>qa(t)===e),Ga=e=>t=>typeof t===e,{isArray:As}=Array,qi=Ga("undefined");function eo(e){return e!==null&&!qi(e)&&e.constructor!==null&&!qi(e.constructor)&&Tt(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const Zg=an("ArrayBuffer");function U_(e){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(e):t=e&&e.buffer&&Zg(e.buffer),t}const B_=Ga("string"),Tt=Ga("function"),ev=Ga("number"),to=e=>e!==null&&typeof e=="object",V_=e=>e===!0||e===!1,Go=e=>{if(qa(e)!=="object")return!1;const t=Eu(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Jg in e)&&!(Ka in e)},W_=e=>{if(!to(e)||eo(e))return!1;try{return Object.keys(e).length===0&&Object.getPrototypeOf(e)===Object.prototype}catch{return!1}},H_=an("Date"),Q_=an("File"),K_=an("Blob"),q_=an("FileList"),G_=e=>to(e)&&Tt(e.pipe),X_=e=>{let t;return e&&(typeof FormData=="function"&&e instanceof FormData||Tt(e.append)&&((t=qa(e))==="formdata"||t==="object"&&Tt(e.toString)&&e.toString()==="[object FormData]"))},Y_=an("URLSearchParams"),[J_,Z_,e1,t1]=["ReadableStream","Request","Response","Headers"].map(an),n1=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function no(e,t,{allOwnKeys:n=!1}={}){if(e===null||typeof e>"u")return;let r,s;if(typeof e!="object"&&(e=[e]),As(e))for(r=0,s=e.length;r<s;r++)t.call(null,e[r],r,e);else{if(eo(e))return;const i=n?Object.getOwnPropertyNames(e):Object.keys(e),o=i.length;let a;for(r=0;r<o;r++)a=i[r],t.call(null,e[a],a,e)}}function tv(e,t){if(eo(e))return null;t=t.toLowerCase();const n=Object.keys(e);let r=n.length,s;for(;r-- >0;)if(s=n[r],t===s.toLowerCase())return s;return null}const jr=(()=>typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global)(),nv=e=>!qi(e)&&e!==jr;function hd(){const{caseless:e}=nv(this)&&this||{},t={},n=(r,s)=>{const i=e&&tv(t,s)||s;Go(t[i])&&Go(r)?t[i]=hd(t[i],r):Go(r)?t[i]=hd({},r):As(r)?t[i]=r.slice():t[i]=r};for(let r=0,s=arguments.length;r<s;r++)arguments[r]&&no(arguments[r],n);return t}const r1=(e,t,n,{allOwnKeys:r}={})=>(no(t,(s,i)=>{n&&Tt(s)?e[i]=Yg(s,n):e[i]=s},{allOwnKeys:r}),e),s1=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),i1=(e,t,n,r)=>{e.prototype=Object.create(t.prototype,r),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),n&&Object.assign(e.prototype,n)},o1=(e,t,n,r)=>{let s,i,o;const a={};if(t=t||{},e==null)return t;do{for(s=Object.getOwnPropertyNames(e),i=s.length;i-- >0;)o=s[i],(!r||r(o,e,t))&&!a[o]&&(t[o]=e[o],a[o]=!0);e=n!==!1&&Eu(e)}while(e&&(!n||n(e,t))&&e!==Object.prototype);return t},a1=(e,t,n)=>{e=String(e),(n===void 0||n>e.length)&&(n=e.length),n-=t.length;const r=e.indexOf(t,n);return r!==-1&&r===n},c1=e=>{if(!e)return null;if(As(e))return e;let t=e.length;if(!ev(t))return null;const n=new Array(t);for(;t-- >0;)n[t]=e[t];return n},l1=(e=>t=>e&&t instanceof e)(typeof Uint8Array<"u"&&Eu(Uint8Array)),d1=(e,t)=>{const r=(e&&e[Ka]).call(e);let s;for(;(s=r.next())&&!s.done;){const i=s.value;t.call(e,i[0],i[1])}},u1=(e,t)=>{let n;const r=[];for(;(n=e.exec(t))!==null;)r.push(n);return r},p1=an("HTMLFormElement"),f1=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(n,r,s){return r.toUpperCase()+s}),xf=(({hasOwnProperty:e})=>(t,n)=>e.call(t,n))(Object.prototype),h1=an("RegExp"),rv=(e,t)=>{const n=Object.getOwnPropertyDescriptors(e),r={};no(n,(s,i)=>{let o;(o=t(s,i,e))!==!1&&(r[i]=o||s)}),Object.defineProperties(e,r)},m1=e=>{rv(e,(t,n)=>{if(Tt(e)&&["arguments","caller","callee"].indexOf(n)!==-1)return!1;const r=e[n];if(Tt(r)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+n+"'")})}})},g1=(e,t)=>{const n={},r=s=>{s.forEach(i=>{n[i]=!0})};return As(e)?r(e):r(String(e).split(t)),n},v1=()=>{},y1=(e,t)=>e!=null&&Number.isFinite(e=+e)?e:t;function w1(e){return!!(e&&Tt(e.append)&&e[Jg]==="FormData"&&e[Ka])}const _1=e=>{const t=new Array(10),n=(r,s)=>{if(to(r)){if(t.indexOf(r)>=0)return;if(eo(r))return r;if(!("toJSON"in r)){t[s]=r;const i=As(r)?[]:{};return no(r,(o,a)=>{const c=n(o,s+1);!qi(c)&&(i[a]=c)}),t[s]=void 0,i}}return r};return n(e,0)},S1=an("AsyncFunction"),x1=e=>e&&(to(e)||Tt(e))&&Tt(e.then)&&Tt(e.catch),sv=((e,t)=>e?setImmediate:t?((n,r)=>(jr.addEventListener("message",({source:s,data:i})=>{s===jr&&i===n&&r.length&&r.shift()()},!1),s=>{r.push(s),jr.postMessage(n,"*")}))(`axios@${Math.random()}`,[]):n=>setTimeout(n))(typeof setImmediate=="function",Tt(jr.postMessage)),b1=typeof queueMicrotask<"u"?queueMicrotask.bind(jr):typeof process<"u"&&process.nextTick||sv,C1=e=>e!=null&&Tt(e[Ka]),j={isArray:As,isArrayBuffer:Zg,isBuffer:eo,isFormData:X_,isArrayBufferView:U_,isString:B_,isNumber:ev,isBoolean:V_,isObject:to,isPlainObject:Go,isEmptyObject:W_,isReadableStream:J_,isRequest:Z_,isResponse:e1,isHeaders:t1,isUndefined:qi,isDate:H_,isFile:Q_,isBlob:K_,isRegExp:h1,isFunction:Tt,isStream:G_,isURLSearchParams:Y_,isTypedArray:l1,isFileList:q_,forEach:no,merge:hd,extend:r1,trim:n1,stripBOM:s1,inherits:i1,toFlatObject:o1,kindOf:qa,kindOfTest:an,endsWith:a1,toArray:c1,forEachEntry:d1,matchAll:u1,isHTMLForm:p1,hasOwnProperty:xf,hasOwnProp:xf,reduceDescriptors:rv,freezeMethods:m1,toObjectSet:g1,toCamelCase:f1,noop:v1,toFiniteNumber:y1,findKey:tv,global:jr,isContextDefined:nv,isSpecCompliantForm:w1,toJSONObject:_1,isAsyncFn:S1,isThenable:x1,setImmediate:sv,asap:b1,isIterable:C1};function ue(e,t,n,r,s){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",t&&(this.code=t),n&&(this.config=n),r&&(this.request=r),s&&(this.response=s,this.status=s.status?s.status:null)}j.inherits(ue,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:j.toJSONObject(this.config),code:this.code,status:this.status}}});const iv=ue.prototype,ov={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{ov[e]={value:e}});Object.defineProperties(ue,ov);Object.defineProperty(iv,"isAxiosError",{value:!0});ue.from=(e,t,n,r,s,i)=>{const o=Object.create(iv);return j.toFlatObject(e,o,function(c){return c!==Error.prototype},a=>a!=="isAxiosError"),ue.call(o,e.message,t,n,r,s),o.cause=e,o.name=e.name,i&&Object.assign(o,i),o};const E1=null;function md(e){return j.isPlainObject(e)||j.isArray(e)}function av(e){return j.endsWith(e,"[]")?e.slice(0,-2):e}function bf(e,t,n){return e?e.concat(t).map(function(s,i){return s=av(s),!n&&i?"["+s+"]":s}).join(n?".":""):t}function R1(e){return j.isArray(e)&&!e.some(md)}const k1=j.toFlatObject(j,{},null,function(t){return/^is[A-Z]/.test(t)});function Xa(e,t,n){if(!j.isObject(e))throw new TypeError("target must be an object");t=t||new FormData,n=j.toFlatObject(n,{metaTokens:!0,dots:!1,indexes:!1},!1,function(y,x){return!j.isUndefined(x[y])});const r=n.metaTokens,s=n.visitor||d,i=n.dots,o=n.indexes,c=(n.Blob||typeof Blob<"u"&&Blob)&&j.isSpecCompliantForm(t);if(!j.isFunction(s))throw new TypeError("visitor must be a function");function l(v){if(v===null)return"";if(j.isDate(v))return v.toISOString();if(j.isBoolean(v))return v.toString();if(!c&&j.isBlob(v))throw new ue("Blob is not supported. Use a Buffer instead.");return j.isArrayBuffer(v)||j.isTypedArray(v)?c&&typeof Blob=="function"?new Blob([v]):Buffer.from(v):v}function d(v,y,x){let g=v;if(v&&!x&&typeof v=="object"){if(j.endsWith(y,"{}"))y=r?y:y.slice(0,-2),v=JSON.stringify(v);else if(j.isArray(v)&&R1(v)||(j.isFileList(v)||j.endsWith(y,"[]"))&&(g=j.toArray(v)))return y=av(y),g.forEach(function(w,C){!(j.isUndefined(w)||w===null)&&t.append(o===!0?bf([y],C,i):o===null?y:y+"[]",l(w))}),!1}return md(v)?!0:(t.append(bf(x,y,i),l(v)),!1)}const u=[],f=Object.assign(k1,{defaultVisitor:d,convertValue:l,isVisitable:md});function h(v,y){if(!j.isUndefined(v)){if(u.indexOf(v)!==-1)throw Error("Circular reference detected in "+y.join("."));u.push(v),j.forEach(v,function(g,m){(!(j.isUndefined(g)||g===null)&&s.call(t,g,j.isString(m)?m.trim():m,y,f))===!0&&h(g,y?y.concat(m):[m])}),u.pop()}}if(!j.isObject(e))throw new TypeError("data must be an object");return h(e),t}function Cf(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(r){return t[r]})}function Ru(e,t){this._pairs=[],e&&Xa(e,this,t)}const cv=Ru.prototype;cv.append=function(t,n){this._pairs.push([t,n])};cv.toString=function(t){const n=t?function(r){return t.call(this,r,Cf)}:Cf;return this._pairs.map(function(s){return n(s[0])+"="+n(s[1])},"").join("&")};function T1(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function lv(e,t,n){if(!t)return e;const r=n&&n.encode||T1;j.isFunction(n)&&(n={serialize:n});const s=n&&n.serialize;let i;if(s?i=s(t,n):i=j.isURLSearchParams(t)?t.toString():new Ru(t,n).toString(r),i){const o=e.indexOf("#");o!==-1&&(e=e.slice(0,o)),e+=(e.indexOf("?")===-1?"?":"&")+i}return e}class P1{constructor(){this.handlers=[]}use(t,n,r){return this.handlers.push({fulfilled:t,rejected:n,synchronous:r?r.synchronous:!1,runWhen:r?r.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){j.forEach(this.handlers,function(r){r!==null&&t(r)})}}const Ef=P1,dv={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},j1=typeof URLSearchParams<"u"?URLSearchParams:Ru,L1=typeof FormData<"u"?FormData:null,D1=typeof Blob<"u"?Blob:null,I1={isBrowser:!0,classes:{URLSearchParams:j1,FormData:L1,Blob:D1},protocols:["http","https","file","blob","url","data"]},ku=typeof window<"u"&&typeof document<"u",gd=typeof navigator=="object"&&navigator||void 0,N1=ku&&(!gd||["ReactNative","NativeScript","NS"].indexOf(gd.product)<0),M1=(()=>typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function")(),A1=ku&&window.location.href||"http://localhost",O1=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:ku,hasStandardBrowserEnv:N1,hasStandardBrowserWebWorkerEnv:M1,navigator:gd,origin:A1},Symbol.toStringTag,{value:"Module"})),ft={...O1,...I1};function $1(e,t){return Xa(e,new ft.classes.URLSearchParams,{visitor:function(n,r,s,i){return ft.isNode&&j.isBuffer(n)?(this.append(r,n.toString("base64")),!1):i.defaultVisitor.apply(this,arguments)},...t})}function F1(e){return j.matchAll(/\w+|\[(\w*)]/g,e).map(t=>t[0]==="[]"?"":t[1]||t[0])}function z1(e){const t={},n=Object.keys(e);let r;const s=n.length;let i;for(r=0;r<s;r++)i=n[r],t[i]=e[i];return t}function uv(e){function t(n,r,s,i){let o=n[i++];if(o==="__proto__")return!0;const a=Number.isFinite(+o),c=i>=n.length;return o=!o&&j.isArray(s)?s.length:o,c?(j.hasOwnProp(s,o)?s[o]=[s[o],r]:s[o]=r,!a):((!s[o]||!j.isObject(s[o]))&&(s[o]=[]),t(n,r,s[o],i)&&j.isArray(s[o])&&(s[o]=z1(s[o])),!a)}if(j.isFormData(e)&&j.isFunction(e.entries)){const n={};return j.forEachEntry(e,(r,s)=>{t(F1(r),s,n,0)}),n}return null}function U1(e,t,n){if(j.isString(e))try{return(t||JSON.parse)(e),j.trim(e)}catch(r){if(r.name!=="SyntaxError")throw r}return(n||JSON.stringify)(e)}const Tu={transitional:dv,adapter:["xhr","http","fetch"],transformRequest:[function(t,n){const r=n.getContentType()||"",s=r.indexOf("application/json")>-1,i=j.isObject(t);if(i&&j.isHTMLForm(t)&&(t=new FormData(t)),j.isFormData(t))return s?JSON.stringify(uv(t)):t;if(j.isArrayBuffer(t)||j.isBuffer(t)||j.isStream(t)||j.isFile(t)||j.isBlob(t)||j.isReadableStream(t))return t;if(j.isArrayBufferView(t))return t.buffer;if(j.isURLSearchParams(t))return n.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let a;if(i){if(r.indexOf("application/x-www-form-urlencoded")>-1)return $1(t,this.formSerializer).toString();if((a=j.isFileList(t))||r.indexOf("multipart/form-data")>-1){const c=this.env&&this.env.FormData;return Xa(a?{"files[]":t}:t,c&&new c,this.formSerializer)}}return i||s?(n.setContentType("application/json",!1),U1(t)):t}],transformResponse:[function(t){const n=this.transitional||Tu.transitional,r=n&&n.forcedJSONParsing,s=this.responseType==="json";if(j.isResponse(t)||j.isReadableStream(t))return t;if(t&&j.isString(t)&&(r&&!this.responseType||s)){const o=!(n&&n.silentJSONParsing)&&s;try{return JSON.parse(t)}catch(a){if(o)throw a.name==="SyntaxError"?ue.from(a,ue.ERR_BAD_RESPONSE,this,null,this.response):a}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:ft.classes.FormData,Blob:ft.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};j.forEach(["delete","get","head","post","put","patch"],e=>{Tu.headers[e]={}});const Pu=Tu,B1=j.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),V1=e=>{const t={};let n,r,s;return e&&e.split(`
`).forEach(function(o){s=o.indexOf(":"),n=o.substring(0,s).trim().toLowerCase(),r=o.substring(s+1).trim(),!(!n||t[n]&&B1[n])&&(n==="set-cookie"?t[n]?t[n].push(r):t[n]=[r]:t[n]=t[n]?t[n]+", "+r:r)}),t},Rf=Symbol("internals");function Zs(e){return e&&String(e).trim().toLowerCase()}function Xo(e){return e===!1||e==null?e:j.isArray(e)?e.map(Xo):String(e)}function W1(e){const t=Object.create(null),n=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let r;for(;r=n.exec(e);)t[r[1]]=r[2];return t}const H1=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function tl(e,t,n,r,s){if(j.isFunction(r))return r.call(this,t,n);if(s&&(t=n),!!j.isString(t)){if(j.isString(r))return t.indexOf(r)!==-1;if(j.isRegExp(r))return r.test(t)}}function Q1(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,n,r)=>n.toUpperCase()+r)}function K1(e,t){const n=j.toCamelCase(" "+t);["get","set","has"].forEach(r=>{Object.defineProperty(e,r+n,{value:function(s,i,o){return this[r].call(this,t,s,i,o)},configurable:!0})})}class Ya{constructor(t){t&&this.set(t)}set(t,n,r){const s=this;function i(a,c,l){const d=Zs(c);if(!d)throw new Error("header name must be a non-empty string");const u=j.findKey(s,d);(!u||s[u]===void 0||l===!0||l===void 0&&s[u]!==!1)&&(s[u||c]=Xo(a))}const o=(a,c)=>j.forEach(a,(l,d)=>i(l,d,c));if(j.isPlainObject(t)||t instanceof this.constructor)o(t,n);else if(j.isString(t)&&(t=t.trim())&&!H1(t))o(V1(t),n);else if(j.isObject(t)&&j.isIterable(t)){let a={},c,l;for(const d of t){if(!j.isArray(d))throw TypeError("Object iterator must return a key-value pair");a[l=d[0]]=(c=a[l])?j.isArray(c)?[...c,d[1]]:[c,d[1]]:d[1]}o(a,n)}else t!=null&&i(n,t,r);return this}get(t,n){if(t=Zs(t),t){const r=j.findKey(this,t);if(r){const s=this[r];if(!n)return s;if(n===!0)return W1(s);if(j.isFunction(n))return n.call(this,s,r);if(j.isRegExp(n))return n.exec(s);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,n){if(t=Zs(t),t){const r=j.findKey(this,t);return!!(r&&this[r]!==void 0&&(!n||tl(this,this[r],r,n)))}return!1}delete(t,n){const r=this;let s=!1;function i(o){if(o=Zs(o),o){const a=j.findKey(r,o);a&&(!n||tl(r,r[a],a,n))&&(delete r[a],s=!0)}}return j.isArray(t)?t.forEach(i):i(t),s}clear(t){const n=Object.keys(this);let r=n.length,s=!1;for(;r--;){const i=n[r];(!t||tl(this,this[i],i,t,!0))&&(delete this[i],s=!0)}return s}normalize(t){const n=this,r={};return j.forEach(this,(s,i)=>{const o=j.findKey(r,i);if(o){n[o]=Xo(s),delete n[i];return}const a=t?Q1(i):String(i).trim();a!==i&&delete n[i],n[a]=Xo(s),r[a]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const n=Object.create(null);return j.forEach(this,(r,s)=>{r!=null&&r!==!1&&(n[s]=t&&j.isArray(r)?r.join(", "):r)}),n}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,n])=>t+": "+n).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...n){const r=new this(t);return n.forEach(s=>r.set(s)),r}static accessor(t){const r=(this[Rf]=this[Rf]={accessors:{}}).accessors,s=this.prototype;function i(o){const a=Zs(o);r[a]||(K1(s,o),r[a]=!0)}return j.isArray(t)?t.forEach(i):i(t),this}}Ya.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);j.reduceDescriptors(Ya.prototype,({value:e},t)=>{let n=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(r){this[n]=r}}});j.freezeMethods(Ya);const rn=Ya;function nl(e,t){const n=this||Pu,r=t||n,s=rn.from(r.headers);let i=r.data;return j.forEach(e,function(a){i=a.call(n,i,s.normalize(),t?t.status:void 0)}),s.normalize(),i}function pv(e){return!!(e&&e.__CANCEL__)}function Os(e,t,n){ue.call(this,e??"canceled",ue.ERR_CANCELED,t,n),this.name="CanceledError"}j.inherits(Os,ue,{__CANCEL__:!0});function fv(e,t,n){const r=n.config.validateStatus;!n.status||!r||r(n.status)?e(n):t(new ue("Request failed with status code "+n.status,[ue.ERR_BAD_REQUEST,ue.ERR_BAD_RESPONSE][Math.floor(n.status/100)-4],n.config,n.request,n))}function q1(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}function G1(e,t){e=e||10;const n=new Array(e),r=new Array(e);let s=0,i=0,o;return t=t!==void 0?t:1e3,function(c){const l=Date.now(),d=r[i];o||(o=l),n[s]=c,r[s]=l;let u=i,f=0;for(;u!==s;)f+=n[u++],u=u%e;if(s=(s+1)%e,s===i&&(i=(i+1)%e),l-o<t)return;const h=d&&l-d;return h?Math.round(f*1e3/h):void 0}}function X1(e,t){let n=0,r=1e3/t,s,i;const o=(l,d=Date.now())=>{n=d,s=null,i&&(clearTimeout(i),i=null),e(...l)};return[(...l)=>{const d=Date.now(),u=d-n;u>=r?o(l,d):(s=l,i||(i=setTimeout(()=>{i=null,o(s)},r-u)))},()=>s&&o(s)]}const Ra=(e,t,n=3)=>{let r=0;const s=G1(50,250);return X1(i=>{const o=i.loaded,a=i.lengthComputable?i.total:void 0,c=o-r,l=s(c),d=o<=a;r=o;const u={loaded:o,total:a,progress:a?o/a:void 0,bytes:c,rate:l||void 0,estimated:l&&a&&d?(a-o)/l:void 0,event:i,lengthComputable:a!=null,[t?"download":"upload"]:!0};e(u)},n)},kf=(e,t)=>{const n=e!=null;return[r=>t[0]({lengthComputable:n,total:e,loaded:r}),t[1]]},Tf=e=>(...t)=>j.asap(()=>e(...t)),Y1=ft.hasStandardBrowserEnv?((e,t)=>n=>(n=new URL(n,ft.origin),e.protocol===n.protocol&&e.host===n.host&&(t||e.port===n.port)))(new URL(ft.origin),ft.navigator&&/(msie|trident)/i.test(ft.navigator.userAgent)):()=>!0,J1=ft.hasStandardBrowserEnv?{write(e,t,n,r,s,i){const o=[e+"="+encodeURIComponent(t)];j.isNumber(n)&&o.push("expires="+new Date(n).toGMTString()),j.isString(r)&&o.push("path="+r),j.isString(s)&&o.push("domain="+s),i===!0&&o.push("secure"),document.cookie=o.join("; ")},read(e){const t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function Z1(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function eS(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}function hv(e,t,n){let r=!Z1(t);return e&&(r||n==!1)?eS(e,t):t}const Pf=e=>e instanceof rn?{...e}:e;function $r(e,t){t=t||{};const n={};function r(l,d,u,f){return j.isPlainObject(l)&&j.isPlainObject(d)?j.merge.call({caseless:f},l,d):j.isPlainObject(d)?j.merge({},d):j.isArray(d)?d.slice():d}function s(l,d,u,f){if(j.isUndefined(d)){if(!j.isUndefined(l))return r(void 0,l,u,f)}else return r(l,d,u,f)}function i(l,d){if(!j.isUndefined(d))return r(void 0,d)}function o(l,d){if(j.isUndefined(d)){if(!j.isUndefined(l))return r(void 0,l)}else return r(void 0,d)}function a(l,d,u){if(u in t)return r(l,d);if(u in e)return r(void 0,l)}const c={url:i,method:i,data:i,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,withXSRFToken:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,beforeRedirect:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:a,headers:(l,d,u)=>s(Pf(l),Pf(d),u,!0)};return j.forEach(Object.keys({...e,...t}),function(d){const u=c[d]||s,f=u(e[d],t[d],d);j.isUndefined(f)&&u!==a||(n[d]=f)}),n}const mv=e=>{const t=$r({},e);let{data:n,withXSRFToken:r,xsrfHeaderName:s,xsrfCookieName:i,headers:o,auth:a}=t;t.headers=o=rn.from(o),t.url=lv(hv(t.baseURL,t.url,t.allowAbsoluteUrls),e.params,e.paramsSerializer),a&&o.set("Authorization","Basic "+btoa((a.username||"")+":"+(a.password?unescape(encodeURIComponent(a.password)):"")));let c;if(j.isFormData(n)){if(ft.hasStandardBrowserEnv||ft.hasStandardBrowserWebWorkerEnv)o.setContentType(void 0);else if((c=o.getContentType())!==!1){const[l,...d]=c?c.split(";").map(u=>u.trim()).filter(Boolean):[];o.setContentType([l||"multipart/form-data",...d].join("; "))}}if(ft.hasStandardBrowserEnv&&(r&&j.isFunction(r)&&(r=r(t)),r||r!==!1&&Y1(t.url))){const l=s&&i&&J1.read(i);l&&o.set(s,l)}return t},tS=typeof XMLHttpRequest<"u",nS=tS&&function(e){return new Promise(function(n,r){const s=mv(e);let i=s.data;const o=rn.from(s.headers).normalize();let{responseType:a,onUploadProgress:c,onDownloadProgress:l}=s,d,u,f,h,v;function y(){h&&h(),v&&v(),s.cancelToken&&s.cancelToken.unsubscribe(d),s.signal&&s.signal.removeEventListener("abort",d)}let x=new XMLHttpRequest;x.open(s.method.toUpperCase(),s.url,!0),x.timeout=s.timeout;function g(){if(!x)return;const w=rn.from("getAllResponseHeaders"in x&&x.getAllResponseHeaders()),L={data:!a||a==="text"||a==="json"?x.responseText:x.response,status:x.status,statusText:x.statusText,headers:w,config:e,request:x};fv(function(F){n(F),y()},function(F){r(F),y()},L),x=null}"onloadend"in x?x.onloadend=g:x.onreadystatechange=function(){!x||x.readyState!==4||x.status===0&&!(x.responseURL&&x.responseURL.indexOf("file:")===0)||setTimeout(g)},x.onabort=function(){x&&(r(new ue("Request aborted",ue.ECONNABORTED,e,x)),x=null)},x.onerror=function(){r(new ue("Network Error",ue.ERR_NETWORK,e,x)),x=null},x.ontimeout=function(){let C=s.timeout?"timeout of "+s.timeout+"ms exceeded":"timeout exceeded";const L=s.transitional||dv;s.timeoutErrorMessage&&(C=s.timeoutErrorMessage),r(new ue(C,L.clarifyTimeoutError?ue.ETIMEDOUT:ue.ECONNABORTED,e,x)),x=null},i===void 0&&o.setContentType(null),"setRequestHeader"in x&&j.forEach(o.toJSON(),function(C,L){x.setRequestHeader(L,C)}),j.isUndefined(s.withCredentials)||(x.withCredentials=!!s.withCredentials),a&&a!=="json"&&(x.responseType=s.responseType),l&&([f,v]=Ra(l,!0),x.addEventListener("progress",f)),c&&x.upload&&([u,h]=Ra(c),x.upload.addEventListener("progress",u),x.upload.addEventListener("loadend",h)),(s.cancelToken||s.signal)&&(d=w=>{x&&(r(!w||w.type?new Os(null,e,x):w),x.abort(),x=null)},s.cancelToken&&s.cancelToken.subscribe(d),s.signal&&(s.signal.aborted?d():s.signal.addEventListener("abort",d)));const m=q1(s.url);if(m&&ft.protocols.indexOf(m)===-1){r(new ue("Unsupported protocol "+m+":",ue.ERR_BAD_REQUEST,e));return}x.send(i||null)})},rS=(e,t)=>{const{length:n}=e=e?e.filter(Boolean):[];if(t||n){let r=new AbortController,s;const i=function(l){if(!s){s=!0,a();const d=l instanceof Error?l:this.reason;r.abort(d instanceof ue?d:new Os(d instanceof Error?d.message:d))}};let o=t&&setTimeout(()=>{o=null,i(new ue(`timeout ${t} of ms exceeded`,ue.ETIMEDOUT))},t);const a=()=>{e&&(o&&clearTimeout(o),o=null,e.forEach(l=>{l.unsubscribe?l.unsubscribe(i):l.removeEventListener("abort",i)}),e=null)};e.forEach(l=>l.addEventListener("abort",i));const{signal:c}=r;return c.unsubscribe=()=>j.asap(a),c}},sS=rS,iS=function*(e,t){let n=e.byteLength;if(!t||n<t){yield e;return}let r=0,s;for(;r<n;)s=r+t,yield e.slice(r,s),r=s},oS=async function*(e,t){for await(const n of aS(e))yield*iS(n,t)},aS=async function*(e){if(e[Symbol.asyncIterator]){yield*e;return}const t=e.getReader();try{for(;;){const{done:n,value:r}=await t.read();if(n)break;yield r}}finally{await t.cancel()}},jf=(e,t,n,r)=>{const s=oS(e,t);let i=0,o,a=c=>{o||(o=!0,r&&r(c))};return new ReadableStream({async pull(c){try{const{done:l,value:d}=await s.next();if(l){a(),c.close();return}let u=d.byteLength;if(n){let f=i+=u;n(f)}c.enqueue(new Uint8Array(d))}catch(l){throw a(l),l}},cancel(c){return a(c),s.return()}},{highWaterMark:2})},Ja=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",gv=Ja&&typeof ReadableStream=="function",cS=Ja&&(typeof TextEncoder=="function"?(e=>t=>e.encode(t))(new TextEncoder):async e=>new Uint8Array(await new Response(e).arrayBuffer())),vv=(e,...t)=>{try{return!!e(...t)}catch{return!1}},lS=gv&&vv(()=>{let e=!1;const t=new Request(ft.origin,{body:new ReadableStream,method:"POST",get duplex(){return e=!0,"half"}}).headers.has("Content-Type");return e&&!t}),Lf=64*1024,vd=gv&&vv(()=>j.isReadableStream(new Response("").body)),ka={stream:vd&&(e=>e.body)};Ja&&(e=>{["text","arrayBuffer","blob","formData","stream"].forEach(t=>{!ka[t]&&(ka[t]=j.isFunction(e[t])?n=>n[t]():(n,r)=>{throw new ue(`Response type '${t}' is not supported`,ue.ERR_NOT_SUPPORT,r)})})})(new Response);const dS=async e=>{if(e==null)return 0;if(j.isBlob(e))return e.size;if(j.isSpecCompliantForm(e))return(await new Request(ft.origin,{method:"POST",body:e}).arrayBuffer()).byteLength;if(j.isArrayBufferView(e)||j.isArrayBuffer(e))return e.byteLength;if(j.isURLSearchParams(e)&&(e=e+""),j.isString(e))return(await cS(e)).byteLength},uS=async(e,t)=>{const n=j.toFiniteNumber(e.getContentLength());return n??dS(t)},pS=Ja&&(async e=>{let{url:t,method:n,data:r,signal:s,cancelToken:i,timeout:o,onDownloadProgress:a,onUploadProgress:c,responseType:l,headers:d,withCredentials:u="same-origin",fetchOptions:f}=mv(e);l=l?(l+"").toLowerCase():"text";let h=sS([s,i&&i.toAbortSignal()],o),v;const y=h&&h.unsubscribe&&(()=>{h.unsubscribe()});let x;try{if(c&&lS&&n!=="get"&&n!=="head"&&(x=await uS(d,r))!==0){let L=new Request(t,{method:"POST",body:r,duplex:"half"}),A;if(j.isFormData(r)&&(A=L.headers.get("content-type"))&&d.setContentType(A),L.body){const[F,D]=kf(x,Ra(Tf(c)));r=jf(L.body,Lf,F,D)}}j.isString(u)||(u=u?"include":"omit");const g="credentials"in Request.prototype;v=new Request(t,{...f,signal:h,method:n.toUpperCase(),headers:d.normalize().toJSON(),body:r,duplex:"half",credentials:g?u:void 0});let m=await fetch(v,f);const w=vd&&(l==="stream"||l==="response");if(vd&&(a||w&&y)){const L={};["status","statusText","headers"].forEach(B=>{L[B]=m[B]});const A=j.toFiniteNumber(m.headers.get("content-length")),[F,D]=a&&kf(A,Ra(Tf(a),!0))||[];m=new Response(jf(m.body,Lf,F,()=>{D&&D(),y&&y()}),L)}l=l||"text";let C=await ka[j.findKey(ka,l)||"text"](m,e);return!w&&y&&y(),await new Promise((L,A)=>{fv(L,A,{data:C,headers:rn.from(m.headers),status:m.status,statusText:m.statusText,config:e,request:v})})}catch(g){throw y&&y(),g&&g.name==="TypeError"&&/Load failed|fetch/i.test(g.message)?Object.assign(new ue("Network Error",ue.ERR_NETWORK,e,v),{cause:g.cause||g}):ue.from(g,g&&g.code,e,v)}}),yd={http:E1,xhr:nS,fetch:pS};j.forEach(yd,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch{}Object.defineProperty(e,"adapterName",{value:t})}});const Df=e=>`- ${e}`,fS=e=>j.isFunction(e)||e===null||e===!1,yv={getAdapter:e=>{e=j.isArray(e)?e:[e];const{length:t}=e;let n,r;const s={};for(let i=0;i<t;i++){n=e[i];let o;if(r=n,!fS(n)&&(r=yd[(o=String(n)).toLowerCase()],r===void 0))throw new ue(`Unknown adapter '${o}'`);if(r)break;s[o||"#"+i]=r}if(!r){const i=Object.entries(s).map(([a,c])=>`adapter ${a} `+(c===!1?"is not supported by the environment":"is not available in the build"));let o=t?i.length>1?`since :
`+i.map(Df).join(`
`):" "+Df(i[0]):"as no adapter specified";throw new ue("There is no suitable adapter to dispatch the request "+o,"ERR_NOT_SUPPORT")}return r},adapters:yd};function rl(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new Os(null,e)}function If(e){return rl(e),e.headers=rn.from(e.headers),e.data=nl.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),yv.getAdapter(e.adapter||Pu.adapter)(e).then(function(r){return rl(e),r.data=nl.call(e,e.transformResponse,r),r.headers=rn.from(r.headers),r},function(r){return pv(r)||(rl(e),r&&r.response&&(r.response.data=nl.call(e,e.transformResponse,r.response),r.response.headers=rn.from(r.response.headers))),Promise.reject(r)})}const wv="1.11.0",Za={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{Za[e]=function(r){return typeof r===e||"a"+(t<1?"n ":" ")+e}});const Nf={};Za.transitional=function(t,n,r){function s(i,o){return"[Axios v"+wv+"] Transitional option '"+i+"'"+o+(r?". "+r:"")}return(i,o,a)=>{if(t===!1)throw new ue(s(o," has been removed"+(n?" in "+n:"")),ue.ERR_DEPRECATED);return n&&!Nf[o]&&(Nf[o]=!0,console.warn(s(o," has been deprecated since v"+n+" and will be removed in the near future"))),t?t(i,o,a):!0}};Za.spelling=function(t){return(n,r)=>(console.warn(`${r} is likely a misspelling of ${t}`),!0)};function hS(e,t,n){if(typeof e!="object")throw new ue("options must be an object",ue.ERR_BAD_OPTION_VALUE);const r=Object.keys(e);let s=r.length;for(;s-- >0;){const i=r[s],o=t[i];if(o){const a=e[i],c=a===void 0||o(a,i,e);if(c!==!0)throw new ue("option "+i+" must be "+c,ue.ERR_BAD_OPTION_VALUE);continue}if(n!==!0)throw new ue("Unknown option "+i,ue.ERR_BAD_OPTION)}}const Yo={assertOptions:hS,validators:Za},un=Yo.validators;class Ta{constructor(t){this.defaults=t||{},this.interceptors={request:new Ef,response:new Ef}}async request(t,n){try{return await this._request(t,n)}catch(r){if(r instanceof Error){let s={};Error.captureStackTrace?Error.captureStackTrace(s):s=new Error;const i=s.stack?s.stack.replace(/^.+\n/,""):"";try{r.stack?i&&!String(r.stack).endsWith(i.replace(/^.+\n.+\n/,""))&&(r.stack+=`
`+i):r.stack=i}catch{}}throw r}}_request(t,n){typeof t=="string"?(n=n||{},n.url=t):n=t||{},n=$r(this.defaults,n);const{transitional:r,paramsSerializer:s,headers:i}=n;r!==void 0&&Yo.assertOptions(r,{silentJSONParsing:un.transitional(un.boolean),forcedJSONParsing:un.transitional(un.boolean),clarifyTimeoutError:un.transitional(un.boolean)},!1),s!=null&&(j.isFunction(s)?n.paramsSerializer={serialize:s}:Yo.assertOptions(s,{encode:un.function,serialize:un.function},!0)),n.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?n.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:n.allowAbsoluteUrls=!0),Yo.assertOptions(n,{baseUrl:un.spelling("baseURL"),withXsrfToken:un.spelling("withXSRFToken")},!0),n.method=(n.method||this.defaults.method||"get").toLowerCase();let o=i&&j.merge(i.common,i[n.method]);i&&j.forEach(["delete","get","head","post","put","patch","common"],v=>{delete i[v]}),n.headers=rn.concat(o,i);const a=[];let c=!0;this.interceptors.request.forEach(function(y){typeof y.runWhen=="function"&&y.runWhen(n)===!1||(c=c&&y.synchronous,a.unshift(y.fulfilled,y.rejected))});const l=[];this.interceptors.response.forEach(function(y){l.push(y.fulfilled,y.rejected)});let d,u=0,f;if(!c){const v=[If.bind(this),void 0];for(v.unshift(...a),v.push(...l),f=v.length,d=Promise.resolve(n);u<f;)d=d.then(v[u++],v[u++]);return d}f=a.length;let h=n;for(u=0;u<f;){const v=a[u++],y=a[u++];try{h=v(h)}catch(x){y.call(this,x);break}}try{d=If.call(this,h)}catch(v){return Promise.reject(v)}for(u=0,f=l.length;u<f;)d=d.then(l[u++],l[u++]);return d}getUri(t){t=$r(this.defaults,t);const n=hv(t.baseURL,t.url,t.allowAbsoluteUrls);return lv(n,t.params,t.paramsSerializer)}}j.forEach(["delete","get","head","options"],function(t){Ta.prototype[t]=function(n,r){return this.request($r(r||{},{method:t,url:n,data:(r||{}).data}))}});j.forEach(["post","put","patch"],function(t){function n(r){return function(i,o,a){return this.request($r(a||{},{method:t,headers:r?{"Content-Type":"multipart/form-data"}:{},url:i,data:o}))}}Ta.prototype[t]=n(),Ta.prototype[t+"Form"]=n(!0)});const Jo=Ta;class ju{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let n;this.promise=new Promise(function(i){n=i});const r=this;this.promise.then(s=>{if(!r._listeners)return;let i=r._listeners.length;for(;i-- >0;)r._listeners[i](s);r._listeners=null}),this.promise.then=s=>{let i;const o=new Promise(a=>{r.subscribe(a),i=a}).then(s);return o.cancel=function(){r.unsubscribe(i)},o},t(function(i,o,a){r.reason||(r.reason=new Os(i,o,a),n(r.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const n=this._listeners.indexOf(t);n!==-1&&this._listeners.splice(n,1)}toAbortSignal(){const t=new AbortController,n=r=>{t.abort(r)};return this.subscribe(n),t.signal.unsubscribe=()=>this.unsubscribe(n),t.signal}static source(){let t;return{token:new ju(function(s){t=s}),cancel:t}}}const mS=ju;function gS(e){return function(n){return e.apply(null,n)}}function vS(e){return j.isObject(e)&&e.isAxiosError===!0}const wd={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(wd).forEach(([e,t])=>{wd[t]=e});const yS=wd;function _v(e){const t=new Jo(e),n=Yg(Jo.prototype.request,t);return j.extend(n,Jo.prototype,t,{allOwnKeys:!0}),j.extend(n,t,null,{allOwnKeys:!0}),n.create=function(s){return _v($r(e,s))},n}const Ve=_v(Pu);Ve.Axios=Jo;Ve.CanceledError=Os;Ve.CancelToken=mS;Ve.isCancel=pv;Ve.VERSION=wv;Ve.toFormData=Xa;Ve.AxiosError=ue;Ve.Cancel=Ve.CanceledError;Ve.all=function(t){return Promise.all(t)};Ve.spread=gS;Ve.isAxiosError=vS;Ve.mergeConfig=$r;Ve.AxiosHeaders=rn;Ve.formToJSON=e=>uv(j.isHTMLForm(e)?new FormData(e):e);Ve.getAdapter=yv.getAdapter;Ve.HttpStatusCode=yS;Ve.default=Ve;const ke=Ve;let wS={data:""},_S=e=>typeof window=="object"?((e?e.querySelector("#_goober"):window._goober)||Object.assign((e||document.head).appendChild(document.createElement("style")),{innerHTML:" ",id:"_goober"})).firstChild:e||wS,SS=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,xS=/\/\*[^]*?\*\/|  +/g,Mf=/\n+/g,Jn=(e,t)=>{let n="",r="",s="";for(let i in e){let o=e[i];i[0]=="@"?i[1]=="i"?n=i+" "+o+";":r+=i[1]=="f"?Jn(o,i):i+"{"+Jn(o,i[1]=="k"?"":t)+"}":typeof o=="object"?r+=Jn(o,t?t.replace(/([^,])+/g,a=>i.replace(/([^,]*:\S+\([^)]*\))|([^,])+/g,c=>/&/.test(c)?c.replace(/&/g,a):a?a+" "+c:c)):i):o!=null&&(i=/^--/.test(i)?i:i.replace(/[A-Z]/g,"-$&").toLowerCase(),s+=Jn.p?Jn.p(i,o):i+":"+o+";")}return n+(t&&s?t+"{"+s+"}":s)+r},Cn={},Sv=e=>{if(typeof e=="object"){let t="";for(let n in e)t+=n+Sv(e[n]);return t}return e},bS=(e,t,n,r,s)=>{let i=Sv(e),o=Cn[i]||(Cn[i]=(c=>{let l=0,d=11;for(;l<c.length;)d=101*d+c.charCodeAt(l++)>>>0;return"go"+d})(i));if(!Cn[o]){let c=i!==e?e:(l=>{let d,u,f=[{}];for(;d=SS.exec(l.replace(xS,""));)d[4]?f.shift():d[3]?(u=d[3].replace(Mf," ").trim(),f.unshift(f[0][u]=f[0][u]||{})):f[0][d[1]]=d[2].replace(Mf," ").trim();return f[0]})(e);Cn[o]=Jn(s?{["@keyframes "+o]:c}:c,n?"":"."+o)}let a=n&&Cn.g?Cn.g:null;return n&&(Cn.g=Cn[o]),((c,l,d,u)=>{u?l.data=l.data.replace(u,c):l.data.indexOf(c)===-1&&(l.data=d?c+l.data:l.data+c)})(Cn[o],t,r,a),o},CS=(e,t,n)=>e.reduce((r,s,i)=>{let o=t[i];if(o&&o.call){let a=o(n),c=a&&a.props&&a.props.className||/^go/.test(a)&&a;o=c?"."+c:a&&typeof a=="object"?a.props?"":Jn(a,""):a===!1?"":a}return r+s+(o??"")},"");function ec(e){let t=this||{},n=e.call?e(t.p):e;return bS(n.unshift?n.raw?CS(n,[].slice.call(arguments,1),t.p):n.reduce((r,s)=>Object.assign(r,s&&s.call?s(t.p):s),{}):n,_S(t.target),t.g,t.o,t.k)}let xv,_d,Sd;ec.bind({g:1});let Fn=ec.bind({k:1});function ES(e,t,n,r){Jn.p=t,xv=e,_d=n,Sd=r}function wr(e,t){let n=this||{};return function(){let r=arguments;function s(i,o){let a=Object.assign({},i),c=a.className||s.className;n.p=Object.assign({theme:_d&&_d()},a),n.o=/ *go\d+/.test(c),a.className=ec.apply(n,r)+(c?" "+c:""),t&&(a.ref=o);let l=e;return e[0]&&(l=a.as||e,delete a.as),Sd&&l[0]&&Sd(a),xv(l,a)}return t?t(s):s}}var RS=e=>typeof e=="function",xd=(e,t)=>RS(e)?e(t):e,kS=(()=>{let e=0;return()=>(++e).toString()})(),TS=(()=>{let e;return()=>{if(e===void 0&&typeof window<"u"){let t=matchMedia("(prefers-reduced-motion: reduce)");e=!t||t.matches}return e}})(),PS=20,bv=(e,t)=>{switch(t.type){case 0:return{...e,toasts:[t.toast,...e.toasts].slice(0,PS)};case 1:return{...e,toasts:e.toasts.map(i=>i.id===t.toast.id?{...i,...t.toast}:i)};case 2:let{toast:n}=t;return bv(e,{type:e.toasts.find(i=>i.id===n.id)?1:0,toast:n});case 3:let{toastId:r}=t;return{...e,toasts:e.toasts.map(i=>i.id===r||r===void 0?{...i,dismissed:!0,visible:!1}:i)};case 4:return t.toastId===void 0?{...e,toasts:[]}:{...e,toasts:e.toasts.filter(i=>i.id!==t.toastId)};case 5:return{...e,pausedAt:t.time};case 6:let s=t.time-(e.pausedAt||0);return{...e,pausedAt:void 0,toasts:e.toasts.map(i=>({...i,pauseDuration:i.pauseDuration+s}))}}},jS=[],sl={toasts:[],pausedAt:void 0},Lu=e=>{sl=bv(sl,e),jS.forEach(t=>{t(sl)})},LS=(e,t="blank",n)=>({createdAt:Date.now(),visible:!0,dismissed:!1,type:t,ariaProps:{role:"status","aria-live":"polite"},message:e,pauseDuration:0,...n,id:n?.id||kS()}),ro=e=>(t,n)=>{let r=LS(t,e,n);return Lu({type:2,toast:r}),r.id},Nt=(e,t)=>ro("blank")(e,t);Nt.error=ro("error");Nt.success=ro("success");Nt.loading=ro("loading");Nt.custom=ro("custom");Nt.dismiss=e=>{Lu({type:3,toastId:e})};Nt.remove=e=>Lu({type:4,toastId:e});Nt.promise=(e,t,n)=>{let r=Nt.loading(t.loading,{...n,...n?.loading});return typeof e=="function"&&(e=e()),e.then(s=>{let i=t.success?xd(t.success,s):void 0;return i?Nt.success(i,{id:r,...n,...n?.success}):Nt.dismiss(r),s}).catch(s=>{let i=t.error?xd(t.error,s):void 0;i?Nt.error(i,{id:r,...n,...n?.error}):Nt.dismiss(r)}),e};var DS=Fn`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
 transform: scale(1) rotate(45deg);
  opacity: 1;
}`,IS=Fn`
from {
  transform: scale(0);
  opacity: 0;
}
to {
  transform: scale(1);
  opacity: 1;
}`,NS=Fn`
from {
  transform: scale(0) rotate(90deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(90deg);
	opacity: 1;
}`,MS=wr("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${e=>e.primary||"#ff4b4b"};
  position: relative;
  transform: rotate(45deg);

  animation: ${DS} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;

  &:after,
  &:before {
    content: '';
    animation: ${IS} 0.15s ease-out forwards;
    animation-delay: 150ms;
    position: absolute;
    border-radius: 3px;
    opacity: 0;
    background: ${e=>e.secondary||"#fff"};
    bottom: 9px;
    left: 4px;
    height: 2px;
    width: 12px;
  }

  &:before {
    animation: ${NS} 0.15s ease-out forwards;
    animation-delay: 180ms;
    transform: rotate(90deg);
  }
`,AS=Fn`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
`,OS=wr("div")`
  width: 12px;
  height: 12px;
  box-sizing: border-box;
  border: 2px solid;
  border-radius: 100%;
  border-color: ${e=>e.secondary||"#e0e0e0"};
  border-right-color: ${e=>e.primary||"#616161"};
  animation: ${AS} 1s linear infinite;
`,$S=Fn`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(45deg);
	opacity: 1;
}`,FS=Fn`
0% {
	height: 0;
	width: 0;
	opacity: 0;
}
40% {
  height: 0;
	width: 6px;
	opacity: 1;
}
100% {
  opacity: 1;
  height: 10px;
}`,zS=wr("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${e=>e.primary||"#61d345"};
  position: relative;
  transform: rotate(45deg);

  animation: ${$S} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;
  &:after {
    content: '';
    box-sizing: border-box;
    animation: ${FS} 0.2s ease-out forwards;
    opacity: 0;
    animation-delay: 200ms;
    position: absolute;
    border-right: 2px solid;
    border-bottom: 2px solid;
    border-color: ${e=>e.secondary||"#fff"};
    bottom: 6px;
    left: 6px;
    height: 10px;
    width: 6px;
  }
`,US=wr("div")`
  position: absolute;
`,BS=wr("div")`
  position: relative;
  display: flex;
  justify-content: center;
  align-items: center;
  min-width: 20px;
  min-height: 20px;
`,VS=Fn`
from {
  transform: scale(0.6);
  opacity: 0.4;
}
to {
  transform: scale(1);
  opacity: 1;
}`,WS=wr("div")`
  position: relative;
  transform: scale(0.6);
  opacity: 0.4;
  min-width: 20px;
  animation: ${VS} 0.3s 0.12s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
`,HS=({toast:e})=>{let{icon:t,type:n,iconTheme:r}=e;return t!==void 0?typeof t=="string"?_.createElement(WS,null,t):t:n==="blank"?null:_.createElement(BS,null,_.createElement(OS,{...r}),n!=="loading"&&_.createElement(US,null,n==="error"?_.createElement(MS,{...r}):_.createElement(zS,{...r})))},QS=e=>`
0% {transform: translate3d(0,${e*-200}%,0) scale(.6); opacity:.5;}
100% {transform: translate3d(0,0,0) scale(1); opacity:1;}
`,KS=e=>`
0% {transform: translate3d(0,0,-1px) scale(1); opacity:1;}
100% {transform: translate3d(0,${e*-150}%,-1px) scale(.6); opacity:0;}
`,qS="0%{opacity:0;} 100%{opacity:1;}",GS="0%{opacity:1;} 100%{opacity:0;}",XS=wr("div")`
  display: flex;
  align-items: center;
  background: #fff;
  color: #363636;
  line-height: 1.3;
  will-change: transform;
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1), 0 3px 3px rgba(0, 0, 0, 0.05);
  max-width: 350px;
  pointer-events: auto;
  padding: 8px 10px;
  border-radius: 8px;
`,YS=wr("div")`
  display: flex;
  justify-content: center;
  margin: 4px 10px;
  color: inherit;
  flex: 1 1 auto;
  white-space: pre-line;
`,JS=(e,t)=>{let n=e.includes("top")?1:-1,[r,s]=TS()?[qS,GS]:[QS(n),KS(n)];return{animation:t?`${Fn(r)} 0.35s cubic-bezier(.21,1.02,.73,1) forwards`:`${Fn(s)} 0.4s forwards cubic-bezier(.06,.71,.55,1)`}};_.memo(({toast:e,position:t,style:n,children:r})=>{let s=e.height?JS(e.position||t||"top-center",e.visible):{opacity:0},i=_.createElement(HS,{toast:e}),o=_.createElement(YS,{...e.ariaProps},xd(e.message,e));return _.createElement(XS,{className:e.className,style:{...s,...n,...e.style}},typeof r=="function"?r({icon:i,message:o}):_.createElement(_.Fragment,null,i,o))});ES(_.createElement);ec`
  z-index: 9999;
  > * {
    pointer-events: auto;
  }
`;var ve=Nt;const Cv=()=>"192.168.200.106",ZS=()=>!0,ex=()=>`https://${Cv()}:7000`,Pa=()=>{const e=ex(),t=ZS();if(ke.defaults.baseURL=e,ke.defaults.timeout=3e4,ke.defaults.maxContentLength=100*1024*1024,t&&typeof window>"u"){const n=require("https");ke.defaults.httpsAgent=new n.Agent({rejectUnauthorized:!1})}return Pa._tokenInterceptorAttached||(ke.interceptors.request.use(n=>{try{const r=typeof window<"u"?localStorage.getItem("token"):null;console.log("🔐 API 요청 인터셉터 - Token:",r?`${r.substring(0,20)}...`:"없음"),r?(n.headers=n.headers||{},n.headers.Authorization||(n.headers.Authorization=`Bearer ${r}`,console.log("🔐 Authorization 헤더 추가됨"))):console.warn("⚠️ Token이 없습니다 - 로그인이 필요할 수 있습니다")}catch(r){console.error("❌ API 요청 인터셉터 오류:",r)}return n}),ke.interceptors.response.use(n=>n,n=>{if(n.response?.status===401){console.error("❌ 401 Unauthorized - Token이 유효하지 않거나 만료되었습니다");const r=localStorage.getItem("token");console.error("현재 저장된 Token:",r?`${r.substring(0,20)}...`:"없음"),localStorage.removeItem("token"),localStorage.removeItem("user"),typeof window<"u"&&!window.location.pathname.includes("/login")&&(console.log("🚪 토큰 만료로 인한 자동 로그아웃 - 로그인 페이지로 이동"),setTimeout(()=>{window.location.href="/login"},1e3))}return Promise.reject(n)}),Pa._tokenInterceptorAttached=!0),console.log(`🔗 API Base URL 설정 (클라이언트 ${t?"HTTPS":"HTTP"} → 서버 HTTPS):`,e),e},tx=()=>`wss://${Cv()}:7000`;Pa();const Ev=_.createContext(),cn=()=>{const e=_.useContext(Ev);if(!e)throw new Error("useAuth must be used within an AuthProvider");return e},nx=({children:e})=>{Kt();const[t,n]=_.useState(null),[r,s]=_.useState(null),[i,o]=_.useState(!0),[a,c]=_.useState(!1),l=_.useRef(null),[d,u]=_.useState(!1),[f,h]=_.useState(null),[v,y]=_.useState(!1),[x,g]=_.useState(!1),[m,w]=_.useState(!1),C=async()=>{if(m)return console.log("⏳ 이미 미디어 권한 요청 중..."),!1;try{if(w(!0),console.log("🎥 미디어 권한 요청"),d&&f){const W=f.getVideoTracks(),k=f.getAudioTracks();if(W.length>0&&k.length>0){const U=W.some(N=>N.readyState==="live"),Y=k.some(N=>N.readyState==="live");if(U&&Y)return console.log("✅ 이미 미디어 권한이 있음 - 스트림 재사용"),w(!1),!0}}f&&(console.log("🧹 기존 스트림 정리"),f.getTracks().forEach(W=>{W.stop(),W.enabled=!1}),h(null),await new Promise(W=>setTimeout(W,500)));const Q=await navigator.mediaDevices.getUserMedia({video:{width:{ideal:1280},height:{ideal:720},facingMode:"user"},audio:{echoCancellation:!0,noiseSuppression:!0,autoGainControl:!0}});return console.log("✅ 미디어 권한 획득 성공"),console.log("비디오 트랙:",Q.getVideoTracks().length),console.log("오디오 트랙:",Q.getAudioTracks().length),h(Q),y(!0),g(!0),u(!0),ve.success("카메라와 마이크 권한이 허용되었습니다."),!0}catch(Q){console.error("❌ 앱 시작 시 미디어 권한 요청 실패:",Q);let W="카메라/마이크 권한이 필요합니다.";switch(Q.name){case"NotAllowedError":W="카메라/마이크 권한이 거부되었습니다.";break;case"NotFoundError":W="카메라 또는 마이크 장치를 찾을 수 없습니다.";break;case"NotReadableError":W="카메라 또는 마이크가 다른 애플리케이션에서 사용 중입니다.";break;default:W=`미디어 접근 오류: ${Q.message}`}return ve.error(W),u(!1),!1}finally{w(!1)}},L=async()=>{if(navigator.permissions)try{const Q=await navigator.permissions.query({name:"camera"}),W=await navigator.permissions.query({name:"microphone"}),k=Q.state==="granted"&&W.state==="granted";if(u(k),k&&!f){const U=await navigator.mediaDevices.getUserMedia({video:!0,audio:!0});h(U),y(!0),g(!0)}return k}catch(Q){return console.log("권한 상태 확인 실패:",Q),!1}return!1},A=()=>{if(l.current?.connected)return console.log("✅ Socket.IO 이미 연결됨 - 재사용"),l.current;if(l.current&&l.current.connecting)return console.log("⏳ Socket.IO 연결 중 - 대기"),l.current;const Q=localStorage.getItem("token");if(!Q)return console.log("토큰이 없어 Socket.IO 연결하지 않음"),null;console.log("🔗 Socket.IO 신규 연결 시작");const W=tx();return console.log("🔗 WebSocket URL:",W),l.current=cy(W,{transports:["websocket","polling"],auth:{token:Q},reconnection:!0,reconnectionAttempts:1/0,reconnectionDelay:1e3,reconnectionDelayMax:5e3,timeout:2e4,forceNew:!1,upgrade:!0,rememberUpgrade:!0,pingTimeout:6e4,pingInterval:25e3,autoConnect:!0,rejectUnauthorized:!1,secure:!0}),l.current.on("connect",()=>{console.log("✅ Socket.IO 연결 성공:",l.current.id),c(!0);try{const k=localStorage.getItem("token");k&&l.current.emit("authenticate",{token:k})}catch(k){console.error("소켓 인증 이벤트 전송 실패:",k)}}),l.current.on("disconnect",k=>{console.log("⚠️ Socket.IO 연결 종료:",k),c(!1),k==="io server disconnect"||k==="transport close"||k==="transport error"?console.log("🔄 Socket.IO 자동 재연결 활성화"):k==="io client disconnect"&&console.log("📴 클라이언트가 의도적으로 연결 종료함")}),l.current.on("connect_error",k=>{console.error("❌ Socket.IO 연결 오류:",k),c(!1)}),l.current.on("reconnect",k=>{console.log("🔄 Socket.IO 재연결 성공:",k),c(!0)}),l.current.on("reconnect_attempt",k=>{console.log("🔄 Socket.IO 재연결 시도:",k)}),l.current.on("reconnect_error",k=>{console.error("❌ Socket.IO 재연결 오류:",k)}),l.current.on("reconnect_failed",()=>{console.error("❌ Socket.IO 재연결 실패"),ve.error("서버 연결에 실패했습니다. 페이지를 새로고침해주세요.")}),l.current.on("authenticated",()=>{console.log("✅ Socket.IO 인증 완료"),l.current.emit("request-server-state")}),l.current.on("ping",k=>{l.current.emit("pong",k),console.log("🏓 Ping 수신 → Pong 응답")}),l.current.on("connection-timeout",k=>{console.error("⏱️ 연결 타임아웃:",k.message),alert("서버와의 연결이 끊어졌습니다. 페이지를 새로고침해주세요.")}),l.current.on("auto-rejoin",k=>{console.log("🔄 자동 재입장 알림:",k),ve(k.message||"이전 입실 상태가 복원되었습니다."),window.location.pathname!==`/metaverse/${k.mapId}`&&(window.location.href=`/metaverse/${k.mapId}`)}),l.current},F=()=>{l.current&&(console.log("Socket.IO 연결 종료"),l.current.disconnect(),l.current=null,c(!1))};_.useEffect(()=>{const Q=localStorage.getItem("token");s(Q),Q?D(Q):(o(!1),n(null))},[]),_.useEffect(()=>{t&&A()},[t]);const D=async Q=>{try{console.log("🔐 checkAuth 호출 - token:",Q?`${Q.substring(0,20)}...`:"없음");const W=await ke.get("/api/auth/user/me",{headers:{Authorization:`Bearer ${Q}`}});console.log("✅ checkAuth 성공:",W.data.user?.username),n(W.data.user)}catch(W){if(console.error("❌ checkAuth 실패:",W.response?.status,W.response?.data?.message),W.response?.status===401)console.log("🚪 토큰 만료 또는 무효 - 로그아웃 처리"),localStorage.removeItem("token"),localStorage.removeItem("user"),n(null),s(null);else{const k=localStorage.getItem("user");if(k&&Q)try{const U=JSON.parse(k);console.log("📦 로컬 스토리지에서 사용자 정보 복원:",U.username),n(U)}catch{console.error("❌ 저장된 사용자 정보 파싱 실패")}}}finally{o(!1)}},fe={user:t,loading:i,token:r,login:async(Q,W)=>{try{console.log("로그인 시도 - email:",Q,"password:",W?"제공됨":"없음"),console.log("API URL:",ke.defaults.baseURL);const k=await ke.post("/api/auth/login",{email:Q,password:W});console.log("로그인 응답:",k.data);const{token:U,user:Y}=k.data;return localStorage.setItem("token",U),localStorage.setItem("user",JSON.stringify(Y)),s(U),n(Y),ve.success("로그인되었습니다."),!0}catch(k){return console.error("로그인 오류:",k.response?.status,k.response?.data),console.error("로그인 오류 상세:",k),k.response?.data?.needsEmailVerification?(ve.error("이메일 인증이 필요합니다. 이메일을 확인하여 인증을 완료해주세요."),{needsEmailVerification:!0,email:Q}):(ve.error(k.response?.data?.message||"로그인에 실패했습니다."),!1)}},register:async(Q,W,k)=>{try{return console.log("회원가입 시도 - API URL:",ke.defaults.baseURL),(await ke.post("/api/auth/register",{username:Q,email:W,password:k})).data.success?(ve.success("회원가입이 완료되었습니다. 이메일을 확인하여 인증을 완료해주세요."),{success:!0,needsEmailVerification:!0,email:W}):!1}catch(U){console.error("회원가입 오류:",U.response?.data);const Y=U.response?.data?.message||"회원가입에 실패했습니다.";return ve.error(Y),{success:!1,error:Y,errorDetails:U.response?.data}}},logout:async()=>{try{const Q=localStorage.getItem("token");Q&&await ke.post("/api/auth/logout",{},{headers:{Authorization:`Bearer ${Q}`}})}catch(Q){console.error("로그아웃 오류:",Q)}finally{localStorage.removeItem("token"),localStorage.removeItem("user"),s(null),n(null),F(),ve.success("로그아웃되었습니다.")}},deleteAccount:async()=>{try{const Q=localStorage.getItem("token");if(!Q)return ve.error("로그인이 필요합니다."),!1;if(!window.confirm(`정말로 계정을 삭제하시겠습니까?

이 작업은 되돌릴 수 없으며, 모든 데이터가 영구적으로 삭제됩니다.`))return!1;const k=await ke.delete("/api/auth/delete-account",{headers:{Authorization:`Bearer ${Q}`}});return k.data.success?(localStorage.removeItem("token"),localStorage.removeItem("user"),s(null),n(null),F(),ve.success("계정이 성공적으로 삭제되었습니다."),!0):(ve.error(k.data.message||"계정 삭제에 실패했습니다."),!1)}catch(Q){return console.error("계정 삭제 오류:",Q),ve.error(Q.response?.data?.message||"계정 삭제 중 오류가 발생했습니다."),!1}},resendVerification:async Q=>{try{console.log("📧 이메일 인증 재전송 요청:",Q);const W=await ke.post("/api/auth/resend-verification",{email:Q});return W.data.success?(ve.success("인증 이메일이 재전송되었습니다. 이메일을 확인해주세요."),{success:!0}):(ve.error(W.data.message||"이메일 재전송에 실패했습니다."),{success:!1,error:W.data.message})}catch(W){console.error("이메일 재전송 오류:",W);const k=W.response?.data?.message||"이메일 재전송 중 오류가 발생했습니다.";return ve.error(k),{success:!1,error:k}}},googleLogin:()=>{window.location.href="/api/auth/google"},socket:l.current,socketConnected:a,connectSocket:A,hasMediaPermission:d,localStream:f,isCameraOn:v,isMicrophoneOn:x,requestMediaPermission:C,checkMediaPermission:L,setLocalStream:h,setIsCameraOn:y,setIsMicrophoneOn:g};return p.jsx(Ev.Provider,{value:fe,children:e})},rx=(e="향상된 캐릭터")=>{const t=document.createElement("canvas"),n=t.getContext("2d");t.width=32,t.height=32;const r={up:{head:"😊",body:"👕",arms:"👐",legs:"👖"},down:{head:"😊",body:"👕",arms:"👐",legs:"👖"},left:{head:"😊",body:"👕",arms:"👐",legs:"👖"},right:{head:"😊",body:"👕",arms:"👐",legs:"👖"}},s={};return Object.keys(r).forEach(i=>{n.clearRect(0,0,32,32),n.clearRect(0,0,32,32);const o=r[i];n.font="12px Arial",n.textAlign="center",n.fillStyle="#000000",n.fillText(o.head,16,8),n.font="10px Arial",n.fillText(o.body,16,18),n.font="8px Arial",i==="left"?n.fillText(o.arms,8,18):i==="right"?n.fillText(o.arms,24,18):(n.fillText(o.arms,12,18),n.fillText(o.arms,20,18)),n.font="8px Arial",n.fillText(o.legs,16,28),s[i]=t.toDataURL("image/png")}),{name:e,images:s,size:32,position:{x:0,y:0}}};Pa();const Rv=_.createContext(),so=()=>{const e=_.useContext(Rv);if(!e)throw new Error("useMetaverse must be used within a MetaverseProvider");return e},sx=({children:e})=>{const{user:t,token:n,loading:r,socket:s}=cn();Kt();const[i,o]=_.useState([]),[a,c]=_.useState([]),[l,d]=_.useState([]),[u,f]=_.useState(null),[h,v]=_.useState(null),[y,x]=_.useState(!1),[g,m]=_.useState(null),[w,C]=_.useState({}),[L,A]=_.useState([]),F=async()=>{const N=localStorage.getItem("token");if(!n&&!N){console.log("❌ fetchMaps: Token 없음"),m("로그인이 필요합니다.");return}try{x(!0),console.log("📡 방 목록 조회 시작");const T=await ke.get("/api/maps");console.log("📡 방 목록 응답:",T.data.success?"성공":"실패");const P=await ke.get("/api/user/logged-in-users");if(console.log("📡 사용자 정보 응답:",P.data.success?"성공":"실패"),T.data.success&&P.data.success){const q=T.data.maps||[],O=P.data,ne=O.mapUserCounts||{},he=q.map(_e=>({..._e,participantCount:ne[_e.id]||0,participants:O.mapUsers?.[_e.id]||[]}));he.lobbyParticipantCount=O.lobbyCount||0,o(he),m(null),console.log("✅ 방 목록 조회 성공 - 맵 개수:",q.length),console.log("맵별 사용자 수:",ne),console.log("대기실 사용자 수:",O.lobbyCount)}else console.error("❌ API 응답 실패"),m("방 목록을 불러오는데 실패했습니다.")}catch(T){console.error("❌ 방 목록 조회 오류:",T),T.response?.status===401?m("로그인이 필요합니다. 다시 로그인해주세요."):m("방 목록을 불러오는데 실패했습니다.")}finally{x(!1)}},D=async()=>{if(n)try{const N=await ke.get("/api/maps/active");N.data.success&&c(N.data.maps||[])}catch(N){console.error("활성화된 방 목록 조회 오류:",N)}},B=async N=>{if(console.log("🔍 fetchMap 호출:",{mapId:N,token:!!n}),!n||!N)return console.log("❌ fetchMap: token 또는 mapId 없음"),null;try{console.log("📡 API 호출:",`/maps/${N}`);const T=await ke.get(`/api/maps/${N}`);return console.log("📡 API 응답:",T.data),T.data.success?(console.log("✅ fetchMap 성공:",T.data.map),T.data.map):(console.log("❌ fetchMap: API 응답 실패"),m("방을 찾을 수 없습니다."),null)}catch(T){return console.error("❌ fetchMap 오류:",T.response||T),m("방을 불러오는데 실패했습니다."),null}},M=async()=>{const N=localStorage.getItem("token");if(!n&&!N){console.log("❌ fetchCharacters: Token 없음");return}try{console.log("📡 캐릭터 목록 조회 시작");const T=await ke.get("/api/characters");if(console.log("📡 캐릭터 목록 응답:",T.data.success?"성공":"실패"),T.data.success){const P=T.data.characters||[];d(P),console.log("✅ 캐릭터 목록 조회 성공 - 캐릭터 개수:",P.length),P.length>0&&!u&&f(P[0])}}catch(T){console.error("❌ 캐릭터 목록 조회 오류:",T),T.response?.status===401&&m("로그인이 필요합니다. 다시 로그인해주세요.")}},X=async N=>{if(!n)return null;try{const T=await ke.post("/api/maps",N);if(T.data.success){const P=T.data.map;return o(q=>[P,...q]),P}else return m("방 생성에 실패했습니다."),null}catch(T){return console.error("방 생성 오류:",T),m("방 생성에 실패했습니다."),null}},ee=async(N,T)=>{if(!n||!N)return null;try{const P=await ke.put(`/api/maps/${N}`,T);if(P.data.success){const q=P.data.map;return o(O=>O.map(ne=>ne.id===N?q:ne)),q}else return m("방 업데이트에 실패했습니다."),null}catch(P){return console.error("방 업데이트 오류:",P),m("방 업데이트에 실패했습니다."),null}},V=async N=>{if(!n||!N)return!1;try{return(await ke.delete(`/api/maps/${N}`)).data.success?(o(P=>P.filter(q=>q.id!==N)),h&&h.id===N&&v(null),!0):(m("방 삭제에 실패했습니다."),!1)}catch(T){return console.error("방 삭제 오류:",T),m("방 삭제에 실패했습니다."),!1}},Z=async(N,T)=>{if(!n||!N)return null;try{const P=await ke.put(`/api/characters/${N}`,T);if(P.data.success){const q=P.data.character;return d(O=>O.map(ne=>ne.id===N?q:ne)),u&&u.id===N&&f(q),q}else return m("캐릭터 업데이트에 실패했습니다."),null}catch(P){return console.error("캐릭터 업데이트 오류:",P),m("캐릭터 업데이트에 실패했습니다."),null}},fe=async N=>{if(!n)return null;try{const T=await ke.post("/api/characters",N);if(T.data.success){const P=T.data.character;return d(q=>[...q,P]),P}else return m("캐릭터 생성에 실패했습니다."),null}catch(T){return console.error("캐릭터 생성 오류:",T),m("캐릭터 생성에 실패했습니다."),null}},Q=N=>{f(N)},W=N=>{v(N)},k=async N=>{if(!n)return null;try{const T=rx(N),P=await fe(T);return P?(f(P),P):null}catch(T){return console.error("이모지 캐릭터 생성 오류:",T),null}};_.useEffect(()=>{const N=localStorage.getItem("token");console.log("🔍 MetaverseContext useEffect:",{user:!!t,token:!!n,storedToken:!!N,authLoading:r}),t&&n&&!r?(console.log("✅ 사용자 인증 완료 - 데이터 로드 시작"),F(),M()):!r&&!t&&!n&&!N?(console.log("❌ 인증되지 않은 사용자 - 로그인 필요"),m("로그인이 필요합니다.")):console.log("⏳ 사용자 인증 대기 중 또는 로딩 중")},[t,n,r]),_.useEffect(()=>{if(!t||!s)return;const N=O=>{},T=O=>{O.mapId&&O.occupants!==void 0&&C(ne=>({...ne,[O.mapId]:O.occupants}))},P=O=>{O.mapParticipants&&C(O.mapParticipants)},q=O=>{O.users&&A(O.users)};return s.on("maps-list-updated",N),s.on("update-occupants",T),s.on("update-participants",P),s.on("all-logged-in-users-updated",q),()=>{s.off("maps-list-updated",N),s.off("update-occupants",T),s.off("update-participants",P),s.off("all-logged-in-users-updated",q)}},[t,s]),_.useEffect(()=>{if(l.length>0&&!u){const N=localStorage.getItem("selectedCharacterId");if(N){const T=l.find(P=>P.id.toString()===N);if(T){f(T);return}}f(l[0])}},[l,u]),_.useEffect(()=>{u&&localStorage.setItem("selectedCharacterId",u.id.toString())},[u]);const Y={maps:i,activeMaps:a,characters:l,currentCharacter:u,currentMap:h,loading:y,error:g,mapParticipants:w,allLoggedInUsers:L,fetchMaps:F,fetchActiveMaps:D,fetchMap:B,fetchCharacters:M,createMap:X,updateMap:ee,deleteMap:V,updateCharacter:Z,createCharacter:fe,selectCharacter:Q,selectMap:W,createEmojiCharacter:k,refreshMaps:()=>{F(),D()},setError:m};return p.jsx(Rv.Provider,{value:Y,children:e})};const ix=()=>{const[e,t]=_.useState({email:"",password:""}),[n,r]=_.useState(!1),[s,i]=_.useState(""),[o,a]=_.useState(!1),[c,l]=_.useState(!1),{login:d,resendVerification:u}=cn(),f=Sn(),h=Kt(),y=new URLSearchParams(h.search).get("duplicate"),x=async w=>{w.preventDefault(),r(!0),i("");try{const C=await d(e.email,e.password);if(C&&typeof C=="object"&&C.needsEmailVerification)i("이메일 인증이 필요합니다. 이메일을 확인하여 인증을 완료해주세요."),a(!0);else if(C===!0){const L=h.state?.redirectTo||h.state?.from?.pathname||"/";f(L,{replace:!0})}else i("로그인에 실패했습니다. 이메일과 비밀번호를 확인해주세요.")}catch{i("로그인 중 오류가 발생했습니다.")}finally{r(!1)}},g=w=>{t({...e,[w.target.name]:w.target.value})},m=async()=>{l(!0);try{const w=await u(e.email);w.success?(i("인증 이메일이 재전송되었습니다. 이메일을 확인해주세요."),a(!1)):i(w.error||"이메일 재전송에 실패했습니다.")}catch{i("이메일 재전송 중 오류가 발생했습니다.")}finally{l(!1)}};return p.jsx("div",{className:"auth-container",children:p.jsxs("div",{className:"auth-card",children:[p.jsx("h1",{children:"mini area 로그인"}),p.jsx("p",{className:"auth-subtitle",children:"가상공간을 만들어보세요!"}),h.state?.message&&p.jsx("div",{className:"info-message",children:h.state.message}),y&&p.jsx("div",{className:"warning-message",children:"⚠️ 이미 다른 창에서 로그인되어 있습니다. 기존 연결을 종료한 후 다시 시도해주세요."}),s&&p.jsx("div",{className:"error-message",children:s}),o&&p.jsxs("div",{className:"resend-verification",children:[p.jsx("p",{children:"이메일을 받지 못하셨나요?"}),p.jsx("button",{type:"button",onClick:m,disabled:c,className:"resend-btn",children:c?"전송 중...":"인증 이메일 재전송"})]}),p.jsxs("form",{onSubmit:x,className:"register-form",children:[p.jsx("div",{className:"form-group",children:p.jsx("input",{type:"email",name:"email",value:e.email,onChange:g,required:!0,placeholder:"이메일을 입력하세요",className:"form-input"})}),p.jsx("div",{className:"form-group",children:p.jsx("input",{type:"password",name:"password",value:e.password,onChange:g,required:!0,placeholder:"비밀번호를 입력하세요",className:"form-input"})}),p.jsx("button",{type:"submit",disabled:n,children:n?"로그인 중...":"로그인"})]}),p.jsx("div",{className:"auth-footer",children:p.jsxs("p",{children:["계정이 없으신가요? ",p.jsx(Xg,{to:"/register",children:"회원가입"})]})})]})})},ox=()=>{const[e,t]=_.useState({username:"",email:"",password:"",confirmPassword:""}),[n,r]=_.useState(!1),[s,i]=_.useState(""),[o,a]=_.useState(!1),[c,l]=_.useState(""),[d,u]=_.useState(!1),{register:f,resendVerification:h}=cn(),v=Sn(),y=Kt(),x=async w=>{if(w.preventDefault(),r(!0),i(""),e.password!==e.confirmPassword){i("비밀번호가 일치하지 않습니다."),r(!1);return}try{const C=await f(e.username,e.email,e.password);if(C&&C.success&&C.needsEmailVerification)l(e.email),a(!0),i("");else if(C&&C.success){const L=y.state?.from?.pathname||"/";v(L,{replace:!0})}else C&&C.error?(i(C.error),C.errorDetails?.canResend&&(l(C.errorDetails.email),a(!0))):i("회원가입에 실패했습니다. 다시 시도해주세요.")}catch{i("회원가입 중 오류가 발생했습니다.")}finally{r(!1)}},g=w=>{t({...e,[w.target.name]:w.target.value})},m=async()=>{u(!0);try{const w=await h(c);w.success?i("인증 이메일이 재전송되었습니다. 이메일을 확인해주세요."):i(w.error||"이메일 재전송에 실패했습니다.")}catch{i("이메일 재전송 중 오류가 발생했습니다.")}finally{u(!1)}};return p.jsx("div",{className:"auth-container",children:p.jsx("div",{className:"auth-card",children:o?p.jsxs("div",{className:"email-verification-success",children:[p.jsx("div",{className:"success-icon",children:"✓"}),p.jsx("h2",{children:"회원가입 완료!"}),p.jsx("p",{children:"이메일 인증이 필요합니다."}),p.jsxs("p",{children:[p.jsx("strong",{children:c}),"로 인증 이메일을 전송했습니다."]}),p.jsx("p",{children:"이메일을 확인하여 인증을 완료해주세요."}),p.jsxs("div",{className:"verification-actions",children:[p.jsx("button",{onClick:()=>v("/login"),className:"auth-button",children:"로그인 페이지로 이동"}),p.jsx("button",{onClick:()=>a(!1),className:"auth-button secondary",children:"다른 이메일로 다시 가입"}),p.jsx("button",{onClick:m,disabled:d,className:"auth-button resend",children:d?"전송 중...":"인증 이메일 재전송"})]})]}):p.jsxs(p.Fragment,{children:[p.jsx("h1",{children:"mini area 회원가입"}),p.jsx("p",{className:"auth-subtitle",children:"가상공간을 만들어보세요!"}),s&&p.jsx("div",{className:"error-message",children:s}),p.jsxs("form",{onSubmit:x,className:"register-form",children:[p.jsx("div",{className:"form-group",children:p.jsx("input",{id:"username",type:"text",name:"username",value:e.username,onChange:g,required:!0,placeholder:"사용자명을 입력하세요",className:"form-input"})}),p.jsx("div",{className:"form-group",children:p.jsx("input",{id:"email",type:"email",name:"email",value:e.email,onChange:g,required:!0,placeholder:"이메일을 입력하세요",className:"form-input"})}),p.jsx("div",{className:"form-group",children:p.jsx("input",{id:"password",type:"password",name:"password",value:e.password,onChange:g,required:!0,placeholder:"비밀번호를 입력하세요",className:"form-input"})}),p.jsx("div",{className:"form-group",children:p.jsx("input",{id:"confirmPassword",type:"password",name:"confirmPassword",value:e.confirmPassword,onChange:g,required:!0,placeholder:"비밀번호를 다시 입력하세요",className:"form-input"})}),p.jsx("button",{type:"submit",disabled:n,className:"auth-btn",children:n?"회원가입 중...":"회원가입"})]}),p.jsx("div",{className:"auth-footer",children:p.jsxs("p",{children:["이미 계정이 있으신가요? ",p.jsx(Xg,{to:"/login",children:"로그인"})]})})]})})})},ax=()=>{const[e]=F_(),t=Sn(),[n,r]=_.useState("verifying"),[s,i]=_.useState(""),[o,a]=_.useState(""),[c,l]=_.useState(!1);_.useEffect(()=>{const h=e.get("token");h?d(h):(r("error"),i("유효하지 않은 인증 링크입니다."))},[e]);const d=async h=>{try{const v=await ke.get(`/api/auth/verify-email/${h}`);v.data.success?(r("success"),i(v.data.message)):(r("error"),i(v.data.message))}catch(v){r("error"),i(v.response?.data?.message||"이메일 인증 중 오류가 발생했습니다.")}},u=async()=>{if(!o){i("이메일 주소를 입력해주세요.");return}l(!0);try{const h=await ke.post("/api/auth/resend-verification",{email:o});h.data.success?i("인증 이메일이 재전송되었습니다. 이메일을 확인해주세요."):i(h.data.message)}catch(h){i(h.response?.data?.message||"이메일 재전송 중 오류가 발생했습니다.")}finally{l(!1)}},f=()=>{switch(n){case"verifying":return p.jsxs("div",{className:"verifying",children:[p.jsx("div",{className:"loading-spinner"}),p.jsx("h3",{children:"이메일 인증 중..."}),p.jsx("p",{children:"잠시만 기다려주세요."})]});case"success":return p.jsxs("div",{className:"success",children:[p.jsx("div",{className:"success-icon",children:"✓"}),p.jsx("h3",{children:"이메일 인증 완료!"}),p.jsx("p",{children:s}),p.jsx("div",{className:"verification-actions",children:p.jsx("button",{onClick:()=>t("/login"),className:"auth-button",children:"로그인하기"})})]});case"error":return p.jsxs("div",{className:"error",children:[p.jsx("div",{className:"error-icon",children:"✗"}),p.jsx("h3",{children:"인증 실패"}),p.jsx("p",{children:s}),p.jsxs("div",{className:"resend-section",children:[p.jsx("p",{children:"인증 이메일을 다시 받으시겠습니까?"}),p.jsx("input",{type:"email",placeholder:"이메일 주소를 입력하세요",value:o,onChange:h=>a(h.target.value),className:"auth-input"}),p.jsx("button",{onClick:u,disabled:c,className:"auth-button",children:c?"전송 중...":"인증 이메일 재전송"})]}),p.jsx("div",{className:"verification-actions",children:p.jsx("button",{onClick:()=>t("/login"),className:"auth-button secondary",children:"로그인 페이지로 이동"})})]});default:return null}};return p.jsx("div",{className:"auth-container",children:p.jsx("div",{className:"auth-card",children:f()})})},Af=50,cx=.2,bd=3e3;class Of{constructor(t){this.id=t.userId||t.socketId,this.username=t.username,this.socketId=t.socketId,this.serverPosition={...t.position},this.displayPosition={...t.position},this.targetPosition={...t.position},this.previousPosition={...t.position},this.direction=t.direction||"down",this.isMoving=!1,this.characterInfo=t.characterInfo,this.lastUpdate=Date.now(),this.lastServerUpdate=Date.now()}updateFromServer(t){this.previousPosition={...this.serverPosition},this.serverPosition={...t.position},this.targetPosition={...t.position},this.direction=t.direction||this.direction,this.characterInfo=t.characterInfo||this.characterInfo,this.lastServerUpdate=Date.now(),this.lastUpdate=Date.now();const n=this.serverPosition.x-this.previousPosition.x,r=this.serverPosition.y-this.previousPosition.y;this.isMoving=Math.abs(n)>1||Math.abs(r)>1}interpolate(t){const n=Math.min(1,cx*(t/16));this.displayPosition.x+=(this.targetPosition.x-this.displayPosition.x)*n,this.displayPosition.y+=(this.targetPosition.y-this.displayPosition.y)*n,Math.hypot(this.targetPosition.x-this.displayPosition.x,this.targetPosition.y-this.displayPosition.y)<1&&(this.displayPosition={...this.targetPosition},this.isMoving=!1)}isStale(){return Date.now()-this.lastUpdate>bd}}const lx=(e,t)=>{const{user:n}=cn(),[r,s]=_.useState({x:200,y:200}),[i,o]=_.useState("down"),[a,c]=_.useState(new Map),[l,d]=_.useState([]),u=_.useRef(new Map),f=_.useRef(0),h=_.useRef(null),v=_.useRef(Date.now()),y=_.useRef(r),x=_.useRef(i);_.useRef([]);const g=_.useRef(null),m=_.useRef({x:0,y:0}),w=_.useRef(null);_.useEffect(()=>{y.current=r},[r]),_.useEffect(()=>{x.current=i},[i]),_.useEffect(()=>{if(t?.spawnPoints?.length>0){const B=t.spawnPoints.find(M=>M.isDefault)||t.spawnPoints[0];s({x:B.x||200,y:B.y||200})}else t?.startPoint&&s({x:t.startPoint.x||200,y:t.startPoint.y||200})},[t?.id]);const C=_.useCallback((D,B)=>{if(!t?.walls||t.walls.length===0)return!1;for(const M of t.walls){const X=M.start?.x??M.x1??0,ee=M.start?.y??M.y1??0,V=M.end?.x??M.x2??0,Z=M.end?.y??M.y2??0,fe=(B.x-D.x)*(Z-ee)-(B.y-D.y)*(V-X);if(Math.abs(fe)<1e-4)continue;const Q=((X-D.x)*(Z-ee)-(ee-D.y)*(V-X))/fe,W=((X-D.x)*(B.y-D.y)-(ee-D.y)*(B.x-D.x))/fe;if(Q>=0&&Q<=1&&W>=0&&W<=1)return!0}return!1},[t]);_.useCallback((D,B)=>{if(!t)return[B];t.walls;const M=10,X=Math.hypot(B.x-D.x,B.y-D.y),ee=Math.ceil(X/M)*2,V=[];let Z={...D},fe=0;for(;fe<ee;){fe++;const Q={x:Z.x+(B.x-Z.x)*.1,y:Z.y+(B.y-Z.y)*.1};if(C(Z,Q)){const W=[Math.PI/4,-Math.PI/4,Math.PI/2,-Math.PI/2,Math.PI*3/4,-Math.PI*3/4];let k=!1;for(const U of W){const Y=Math.cos(U)*M*2,N=Math.sin(U)*M*2,T={x:Z.x+Y,y:Z.y+N};if(!C(Z,T)){V.push(T),Z=T,k=!0;break}}if(!k){V.push(B);break}}else if(V.push(Q),Z=Q,Math.hypot(B.x-Z.x,B.y-Z.y)<M){V.push(B);break}}return V.length>0?V:[B]},[t,C]);const L=_.useCallback(D=>{const M=m.current,X=Math.hypot(D.x-M.x,D.y-M.y);X>=50&&(console.log("🌍 거리 기반 영역 검사:",{distance:X,position:D}),m.current={...D},w.current&&w.current(D))},[]),A=_.useCallback((D,B=null)=>{console.log("🎯 클릭 이동: 직선 이동 시작",D),console.log("📍 현재 위치:",r),g.current=D;const M=300;let X=null;const ee=V=>{if(!g.current)return;const Z=X?(V-X)/1e3:.016;X=V;const fe=y.current,Q=g.current,W=Q.x-fe.x,k=Q.y-fe.y,U=Math.hypot(W,k);if(U<5){console.log("🏁 목적지 도착"),s(Q),d([]),g.current=null,B&&B(Q);return}const Y=W/U,N=k/U,T=M*Z,P=fe.x+Y*Math.min(T,U),q=fe.y+N*Math.min(T,U),O={x:P,y:q};if(C(fe,O))console.log("⛔ 벽과 충돌 - 이동 중지"),g.current=null,d([]);else{let ne=x.current;Math.abs(W)>Math.abs(k)?ne=W>0?"right":"left":Math.abs(k)>0&&(ne=k>0?"down":"up"),s(O),o(ne),x.current=ne,L(O),d([r,Q]),requestAnimationFrame(ee)}};requestAnimationFrame(ee)},[C,r]);_.useEffect(()=>{if(!e||!t||!n)return;const D=()=>{const M=Date.now();M-f.current>=Af&&(e.emit("update-position",{mapId:t.id,position:y.current,direction:x.current,username:n.username,timestamp:M}),f.current=M)},B=setInterval(D,Af);return D(),()=>clearInterval(B)},[e,t,n]),_.useEffect(()=>{if(!e||!n)return;const D=ee=>{if(ee.userId===n.id||ee.username===n.username)return;const V=ee.userId||ee.socketId;u.current.has(V)?u.current.get(V).updateFromServer(ee):u.current.set(V,new Of(ee))},B=ee=>{const{users:V,mapId:Z}=ee;if(!V||Z!==t?.id)return;const fe=new Set;V.forEach(Q=>{if(Q.userId===n.id||Q.username===n.username)return;const W=Q.userId||Q.socketId;fe.add(W),u.current.has(W)?u.current.get(W).updateFromServer(Q):u.current.set(W,new Of(Q))}),u.current.forEach((Q,W)=>{fe.has(W)||(Q.lastUpdate=Date.now()-bd+1e3)})},M=ee=>{const V=ee.userId||ee.socketId,Z=u.current.get(V);Z&&(Z.lastUpdate=0)},X=ee=>{if(ee.mapId!==t?.id)return;const V=new Set(ee.participants.filter(Z=>Z.userId!==n.id).map(Z=>Z.userId||Z.socketId));u.current.forEach((Z,fe)=>{V.has(fe)||(Z.lastUpdate=Date.now()-bd+500)})};return e.on("user-position",D),e.on("all-users-update",B),e.on("user-left",M),e.on("update-participants",X),()=>{e.off("user-position",D),e.off("all-users-update",B),e.off("user-left",M),e.off("update-participants",X)}},[e,n,t?.id]),_.useEffect(()=>{const D=()=>{const B=Date.now(),M=B-v.current;v.current=B;const X=new Map;u.current.forEach((V,Z)=>{V.isStale()||(V.interpolate(M),X.set(Z,{id:V.id,username:V.username,position:{...V.displayPosition},direction:V.direction,isMoving:V.isMoving,characterInfo:V.characterInfo}))});const ee=[];u.current.forEach((V,Z)=>{V.isStale()&&ee.push(Z)}),ee.forEach(V=>u.current.delete(V)),c(X),h.current=requestAnimationFrame(D)};return h.current=requestAnimationFrame(D),()=>{h.current&&cancelAnimationFrame(h.current)}},[]),_.useEffect(()=>{console.log("🔍 맵 정보 초기화 시도, currentMap:",t);let D=t?.size?.width||t?.width||1e3,B=t?.size?.height||t?.height||1e3;(t?.backgroundImage||t?.backgroundLayer?.image)&&(D=t?.imageSize?.width||D,B=t?.imageSize?.height||B),console.log(`📐 맵 크기: ${D} x ${B}`),t?.walls&&console.log(`🧱 벽 설정: ${t.walls.length}개`),console.log("✅ 맵 정보 초기화 완료")},[t]),_.useEffect(()=>{u.current.clear(),c(new Map),d([])},[t?.id]);const F=_.useCallback(D=>{w.current=D,m.current={...r}},[r]);return{myPosition:r,myDirection:i,otherCharacters:a,currentPath:l,moveCharacterTo:A,setMyPosition:s,setMyDirection:o,setOnPositionChange:F}},dx=(e,t,n,r)=>{const[s,i]=_.useState({type:"public",id:"public_unknown",name:"퍼블릭 영역",status:"online"}),o=_.useCallback((f,h)=>{if(console.log("🌐 [영역감지] 시작:",{position:f,mapId:h?.id,mapName:h?.name,privateAreasCount:h?.privateAreas?.length||0,privateAreas:h?.privateAreas}),!f||!h)return console.log("❌ [영역감지] 위치나 맵 정보 없음"),{type:"public",id:`public_${h?.id||"unknown"}`,name:h?.name||"퍼블릭 영역"};if(h.privateAreas&&Array.isArray(h.privateAreas)){console.log("🔍 [영역감지] 프라이빗 영역들 검사 시작:",h.privateAreas.length,"개");for(let y=0;y<h.privateAreas.length;y++){const x=h.privateAreas[y];if(console.log(`🔍 [영역감지] 프라이빗 영역 ${y+1}/${h.privateAreas.length} 검사:`,x),a(f,x)){const g={type:"private",id:x.id||`private_${x.x}_${x.y}`,name:x.name||`프라이빗 영역 ${x.id}`};return console.log("✅ [영역감지] 프라이빗 영역에 속함:",g),g}}console.log("❌ [영역감지] 모든 프라이빗 영역 검사 완료 - 해당 없음")}else console.log("❌ [영역감지] 프라이빗 영역 데이터 없음:",{hasPrivateAreas:!!h.privateAreas,isArray:Array.isArray(h.privateAreas)});const v={type:"public",id:`public_${h.id}`,name:h.name||"퍼블릭 영역"};return console.log("✅ [영역감지] 퍼블릭 영역으로 분류:",v),v},[]),a=(f,h)=>{if(console.log("🔍 [좌표검사] 위치 검사:",{position:f,area:h,areaId:h?.id,areaName:h?.name}),h?.isValid===!1)return console.log("❌ [좌표검사] 유효하지 않은 영역:",h.error),!1;let v,y,x,g,m,w;if(h.startX!==void 0&&h.startY!==void 0&&h.endX!==void 0&&h.endY!==void 0)v=h.startX,y=h.startY,x=h.endX,g=h.endY,m=h.width,w=h.height;else if(h.position&&h.size)v=h.position.x,y=h.position.y,m=h.size.width,w=h.size.height,x=v+m,g=y+w;else if(h.x!==void 0&&h.y!==void 0&&h.width&&h.height)v=h.x,y=h.y,m=h.width,w=h.height,x=v+m,g=y+w;else return console.log("❌ [좌표검사] 프라이빗 영역 좌표 데이터 부족:",{hasArea:!!h,availableFields:Object.keys(h||{}),expectedFormat:"position: {x, y} + size: {width, height}",note:"모든 영역이 퍼블릭 영역으로 처리됩니다."}),!1;if(v===void 0||y===void 0||x===void 0||g===void 0||!m||!w||m<=0||w<=0)return console.log("❌ [좌표검사] 유효하지 않은 좌표값:",{startX:v,startY:y,endX:x,endY:g,width:m,height:w}),!1;const C=f.x>=v&&f.x<=x&&f.y>=y&&f.y<=g;return console.log("📍 [좌표검사] 결과:",{position:`(${f.x}, ${f.y})`,areaBounds:`시작점(${v}, ${y}) ~ 끝점(${x}, ${g})`,areaSize:`${m} x ${w}`,areaId:h.id,areaName:h.name,isInside:C,checks:{xMin:f.x>=v,xMax:f.x<=x,yMin:f.y>=y,yMax:f.y<=g}}),C};_.useEffect(()=>{if(!e||!t)return;const f=o(t,e),h={...f,status:c(f.type)};(f.type!==s.type||f.id!==s.id||f.name!==s.name)&&(i(h),n&&r&&n.emit("area-changed",{userId:r.id,username:r.username,areaType:h.type,areaId:h.id,areaName:h.name,status:h.status,position:t,mapId:e.id,timestamp:Date.now()}),console.log("🌍 [입실] 즉시 영역 감지:",{from:s,to:h,position:t,mapId:e.id}))},[e?.id,t?.x,t?.y]),_.useEffect(()=>{if(console.log("🔄 [useEffect] 위치 변화 감지 트리거:",{hasCharacterPosition:!!t,hasCurrentMap:!!e,characterPosition:t,currentMapId:e?.id}),!t||!e){console.log("❌ [useEffect] 위치나 맵 정보 없어서 종료");return}console.log("🔄 [useEffect] 영역 감지 시작:",{currentPosition:t,currentAreaBefore:s});const f=o(t,e);if(console.log("🔄 [useEffect] 감지된 새 영역:",{newArea:f,currentArea:s,willChange:f.type!==s.type||f.id!==s.id||f.name!==s.name}),f.type!==s.type||f.id!==s.id||f.name!==s.name){const h={...f,status:c(f.type)};console.log("✅ [useEffect] 영역 업데이트 실행:",{from:s,to:h}),i(h),n&&r&&n.emit("area-changed",{userId:r.id,username:r.username,areaType:h.type,areaId:h.id,areaName:h.name,status:h.status,position:t,mapId:e.id,timestamp:Date.now()}),console.log("🌍 [이동] 영역 변경 감지:",{from:s,to:h,position:t})}else console.log("❌ [useEffect] 영역 변화 없음 - 업데이트 스킵")},[t,e,s,o,n,r]);const c=f=>{switch(f){case"private":return"in-private-area";case"public":default:return"in-map"}},l=_.useCallback((f,h=null,v=null)=>{const y={type:f,id:h,name:v,status:c(f)};i(y),n&&r&&n.emit("area-changed",{userId:r.id,username:r.username,areaType:y.type,areaId:y.id,areaName:y.name,status:y.status,position:t,mapId:e?.id,timestamp:Date.now()}),console.log("🌍 수동 영역 설정:",y)},[n,r,t,e]),d=_.useCallback(()=>({...s,isPrivate:s.type==="private",isPublic:s.type==="public",isLobby:s.type==="lobby",displayName:s.name||u(s.type)}),[s]),u=f=>{switch(f){case"private":return"프라이빗 영역";case"public":default:return"퍼블릭 영역"}};return{currentArea:s,setArea:l,getAreaInfo:d,isPrivate:s.type==="private",isPublic:s.type==="public"}};const ux=({posts:e,onPostCreate:t,onPostLike:n,onPostComment:r})=>{const[s,i]=_.useState(""),[o,a]=_.useState({}),c=()=>{if(!s.trim())return;const h={id:Date.now(),content:s,author:"사용자",timestamp:new Date().toISOString(),likes:0,comments:[],hashtags:u(s)};t(h),i("")},l=h=>{n(h)},d=h=>{const v=o[h];v?.trim()&&(r(h,v),a(y=>({...y,[h]:""})))},u=h=>{const v=/#[\w가-힣]+/g;return h.match(v)||[]},f=h=>{const v=new Date(h),x=new Date-v;return x<6e4?"방금 전":x<36e5?`${Math.floor(x/6e4)}분 전`:x<864e5?`${Math.floor(x/36e5)}시간 전`:v.toLocaleDateString()};return p.jsxs("div",{className:"sns-board",children:[p.jsxs("div",{className:"sns-header",children:[p.jsx("h2",{children:"📱 SNS 게시판"}),p.jsx("p",{children:"mini area에서의 경험을 공유해보세요!"})]}),p.jsxs("div",{className:"post-create",children:[p.jsx("textarea",{value:s,onChange:h=>i(h.target.value),placeholder:"무엇을 공유하고 싶으신가요? #해시태그도 사용할 수 있어요!",rows:3}),p.jsxs("div",{className:"post-create-footer",children:[p.jsxs("div",{className:"hashtag-suggestions",children:[p.jsx("span",{className:"hashtag-hint",children:"추천 해시태그: "}),p.jsx("button",{onClick:()=>i(h=>h+" #miniarea"),children:"#miniarea"}),p.jsx("button",{onClick:()=>i(h=>h+" #화상통화"),children:"#화상통화"}),p.jsx("button",{onClick:()=>i(h=>h+" #캐릭터"),children:"#캐릭터"})]}),p.jsx("button",{className:"post-submit-btn",onClick:c,disabled:!s.trim(),children:"게시하기"})]})]}),p.jsx("div",{className:"posts-list",children:e.length===0?p.jsxs("div",{className:"empty-posts",children:[p.jsx("div",{className:"empty-icon",children:"📝"}),p.jsx("p",{children:"아직 게시글이 없어요!"}),p.jsx("p",{children:"첫 번째 게시글을 작성해보세요."})]}):e.map(h=>p.jsxs("div",{className:"post-item",children:[p.jsx("div",{className:"post-header",children:p.jsxs("div",{className:"post-author",children:[p.jsx("div",{className:"author-avatar",children:"👤"}),p.jsxs("div",{className:"author-info",children:[p.jsx("div",{className:"author-name",children:h.author}),p.jsx("div",{className:"post-time",children:f(h.timestamp)})]})]})}),p.jsx("div",{className:"post-content",children:h.content.split(" ").map((v,y)=>v.startsWith("#")?p.jsx("span",{className:"hashtag",children:v},y):v+" ")}),p.jsxs("div",{className:"post-actions",children:[p.jsxs("button",{className:"action-btn like-btn",onClick:()=>l(h.id),children:["❤️ 좋아요 (",h.likes,")"]}),p.jsxs("button",{className:"action-btn",children:["💬 댓글 (",h.comments?.length||0,")"]}),p.jsx("button",{className:"action-btn",children:"🔄 공유"})]}),p.jsxs("div",{className:"comments-section",children:[h.comments?.map((v,y)=>p.jsxs("div",{className:"comment-item",children:[p.jsx("div",{className:"comment-author",children:v.author}),p.jsx("div",{className:"comment-content",children:v.content}),p.jsx("div",{className:"comment-time",children:f(v.timestamp)})]},y)),p.jsxs("div",{className:"comment-input",children:[p.jsx("input",{type:"text",value:o[h.id]||"",onChange:v=>a(y=>({...y,[h.id]:v.target.value})),placeholder:"댓글을 입력하세요...",onKeyPress:v=>v.key==="Enter"&&d(h.id)}),p.jsx("button",{onClick:()=>d(h.id),disabled:!o[h.id]?.trim(),children:"댓글"})]})]})]},h.id))})]})};const px=({currentView:e,onViewChange:t,currentArea:n,onReturnToLobby:r,onToggleGroupCall:s,groupCallActive:i,onOpenUserList:o,roomName:a})=>{const[c,l]=_.useState(!1);_.useEffect(()=>{const u=()=>{l(!!document.fullscreenElement)};return document.addEventListener("fullscreenchange",u),()=>document.removeEventListener("fullscreenchange",u)},[]);const d=()=>{document.fullscreenElement?document.exitFullscreen():document.documentElement.requestFullscreen().catch(u=>{console.error("전체화면 전환 실패:",u)})};return p.jsxs("div",{className:"navigation-bar",children:[p.jsxs("div",{className:"nav-left",children:[a&&p.jsxs("span",{className:"room-name-display",style:{color:"#fff",fontSize:"16px",fontWeight:"bold",marginRight:"15px",padding:"5px 10px",background:"rgba(255, 255, 255, 0.1)",borderRadius:"8px"},children:["📍 ",a]}),p.jsx("button",{className:`nav-button ${e==="metaverse"?"active":""}`,onClick:()=>t("metaverse"),children:"🎮 mini area"}),p.jsx("button",{className:`nav-button ${e==="sns"?"active":""}`,onClick:()=>t("sns"),children:"📱 SNS"})]}),p.jsx("div",{className:"nav-center"}),p.jsxs("div",{className:"nav-right",children:[p.jsxs("button",{className:"nav-button",onClick:d,title:c?"전체화면 종료":"전체화면",children:[c?"🔳":"🔲"," 전체화면"]}),p.jsx("button",{className:"nav-button",onClick:()=>o&&o(),title:"1:1 화상통화",children:"🤝 1:1 통화"}),p.jsx("button",{className:"nav-button return-button",onClick:r,children:"🏠 로비로"})]})]})};var kv={},Cd={exports:{}},il,$f;function fx(){if($f)return il;$f=1;var e=1e3,t=e*60,n=t*60,r=n*24,s=r*7,i=r*365.25;il=function(d,u){u=u||{};var f=typeof d;if(f==="string"&&d.length>0)return o(d);if(f==="number"&&isFinite(d))return u.long?c(d):a(d);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(d))};function o(d){if(d=String(d),!(d.length>100)){var u=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(d);if(u){var f=parseFloat(u[1]),h=(u[2]||"ms").toLowerCase();switch(h){case"years":case"year":case"yrs":case"yr":case"y":return f*i;case"weeks":case"week":case"w":return f*s;case"days":case"day":case"d":return f*r;case"hours":case"hour":case"hrs":case"hr":case"h":return f*n;case"minutes":case"minute":case"mins":case"min":case"m":return f*t;case"seconds":case"second":case"secs":case"sec":case"s":return f*e;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return f;default:return}}}}function a(d){var u=Math.abs(d);return u>=r?Math.round(d/r)+"d":u>=n?Math.round(d/n)+"h":u>=t?Math.round(d/t)+"m":u>=e?Math.round(d/e)+"s":d+"ms"}function c(d){var u=Math.abs(d);return u>=r?l(d,u,r,"day"):u>=n?l(d,u,n,"hour"):u>=t?l(d,u,t,"minute"):u>=e?l(d,u,e,"second"):d+" ms"}function l(d,u,f,h){var v=u>=f*1.5;return Math.round(d/f)+" "+h+(v?"s":"")}return il}function hx(e){n.debug=n,n.default=n,n.coerce=c,n.disable=o,n.enable=s,n.enabled=a,n.humanize=fx(),n.destroy=l,Object.keys(e).forEach(d=>{n[d]=e[d]}),n.names=[],n.skips=[],n.formatters={};function t(d){let u=0;for(let f=0;f<d.length;f++)u=(u<<5)-u+d.charCodeAt(f),u|=0;return n.colors[Math.abs(u)%n.colors.length]}n.selectColor=t;function n(d){let u,f=null,h,v;function y(...x){if(!y.enabled)return;const g=y,m=Number(new Date),w=m-(u||m);g.diff=w,g.prev=u,g.curr=m,u=m,x[0]=n.coerce(x[0]),typeof x[0]!="string"&&x.unshift("%O");let C=0;x[0]=x[0].replace(/%([a-zA-Z%])/g,(A,F)=>{if(A==="%%")return"%";C++;const D=n.formatters[F];if(typeof D=="function"){const B=x[C];A=D.call(g,B),x.splice(C,1),C--}return A}),n.formatArgs.call(g,x),(g.log||n.log).apply(g,x)}return y.namespace=d,y.useColors=n.useColors(),y.color=n.selectColor(d),y.extend=r,y.destroy=n.destroy,Object.defineProperty(y,"enabled",{enumerable:!0,configurable:!1,get:()=>f!==null?f:(h!==n.namespaces&&(h=n.namespaces,v=n.enabled(d)),v),set:x=>{f=x}}),typeof n.init=="function"&&n.init(y),y}function r(d,u){const f=n(this.namespace+(typeof u>"u"?":":u)+d);return f.log=this.log,f}function s(d){n.save(d),n.namespaces=d,n.names=[],n.skips=[];const u=(typeof d=="string"?d:"").trim().replace(/\s+/g,",").split(",").filter(Boolean);for(const f of u)f[0]==="-"?n.skips.push(f.slice(1)):n.names.push(f)}function i(d,u){let f=0,h=0,v=-1,y=0;for(;f<d.length;)if(h<u.length&&(u[h]===d[f]||u[h]==="*"))u[h]==="*"?(v=h,y=f,h++):(f++,h++);else if(v!==-1)h=v+1,y++,f=y;else return!1;for(;h<u.length&&u[h]==="*";)h++;return h===u.length}function o(){const d=[...n.names,...n.skips.map(u=>"-"+u)].join(",");return n.enable(""),d}function a(d){for(const u of n.skips)if(i(d,u))return!1;for(const u of n.names)if(i(d,u))return!0;return!1}function c(d){return d instanceof Error?d.stack||d.message:d}function l(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return n.enable(n.load()),n}var mx=hx;(function(e,t){t.formatArgs=r,t.save=s,t.load=i,t.useColors=n,t.storage=o(),t.destroy=(()=>{let c=!1;return()=>{c||(c=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function n(){if(typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs))return!0;if(typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;let c;return typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&(c=navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/))&&parseInt(c[1],10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function r(c){if(c[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+c[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),!this.useColors)return;const l="color: "+this.color;c.splice(1,0,l,"color: inherit");let d=0,u=0;c[0].replace(/%[a-zA-Z%]/g,f=>{f!=="%%"&&(d++,f==="%c"&&(u=d))}),c.splice(u,0,l)}t.log=console.debug||console.log||(()=>{});function s(c){try{c?t.storage.setItem("debug",c):t.storage.removeItem("debug")}catch{}}function i(){let c;try{c=t.storage.getItem("debug")||t.storage.getItem("DEBUG")}catch{}return!c&&typeof process<"u"&&"env"in process&&(c={}.DEBUG),c}function o(){try{return localStorage}catch{}}e.exports=mx(t);const{formatters:a}=e.exports;a.j=function(c){try{return JSON.stringify(c)}catch(l){return"[UnexpectedJSONParseError]: "+l.message}}})(Cd,Cd.exports);var tc=Cd.exports,Tv={};Object.defineProperty(Tv,"__esModule",{value:!0});var $s={},Du=Object.defineProperty,gx=Object.getOwnPropertyDescriptor,vx=Object.getOwnPropertyNames,yx=Object.prototype.hasOwnProperty,wx=(e,t)=>{for(var n in t)Du(e,n,{get:t[n],enumerable:!0})},_x=(e,t,n,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let s of vx(t))!yx.call(e,s)&&s!==n&&Du(e,s,{get:()=>t[s],enumerable:!(r=gx(t,s))||r.enumerable});return e},Sx=e=>_x(Du({},"__esModule",{value:!0}),e),Pv={};wx(Pv,{BrowserDetector:()=>Dv,KnownBrowsers:()=>jv,KnownPlatforms:()=>Lv,default:()=>Rx});var xx=Sx(Pv),jv={chrome:"Google Chrome",brave:"Brave",crios:"Google Chrome",edge:"Microsoft Edge",edg:"Microsoft Edge",edgios:"Microsoft Edge",fennec:"Mozilla Firefox",jsdom:"JsDOM",mozilla:"Mozilla Firefox",fxios:"Mozilla Firefox",msie:"Microsoft Internet Explorer",opera:"Opera",opios:"Opera",opr:"Opera",opt:"Opera",rv:"Microsoft Internet Explorer",safari:"Safari",samsungbrowser:"Samsung Browser",electron:"Electron"},Lv={android:"Android",androidTablet:"Android Tablet",cros:"Chrome OS",fennec:"Android Tablet",ipad:"IPad",ipod:"IPod",iphone:"IPhone",jsdom:"JsDOM",linux:"Linux",mac:"Macintosh",tablet:"Android Tablet",win:"Windows","windows phone":"Windows Phone",xbox:"Microsoft Xbox"},bx=(e,t=-1)=>{let n=new RegExp(`^-?\\d+(?:.\\d{0,${t}})?`),r=Number(e).toString().match(n);return r?r[0]:null},Cx={toFixed:bx},Ex="4.1.0",Ff=()=>typeof window<"u"?window.navigator:null,Dv=class{userAgent;constructor(e){this.userAgent=e||Ff()?.userAgent||null}static get VERSION(){return Ex}parseUserAgent(e){let t={},n=e||this.userAgent||"",r=n.toLowerCase().replace(/\s\s+/g," "),s=/(edge)\/([\w.]+)/.exec(r)||/(edg)[/]([\w.]+)/.exec(r)||/(opr)[/]([\w.]+)/.exec(r)||/(opt)[/]([\w.]+)/.exec(r)||/(fxios)[/]([\w.]+)/.exec(r)||/(edgios)[/]([\w.]+)/.exec(r)||/(jsdom)[/]([\w.]+)/.exec(r)||/(samsungbrowser)[/]([\w.]+)/.exec(r)||/(electron)[/]([\w.]+)/.exec(r)||/(chrome)[/]([\w.]+)/.exec(r)||/(crios)[/]([\w.]+)/.exec(r)||/(opios)[/]([\w.]+)/.exec(r)||/(version)(applewebkit)[/]([\w.]+).*(safari)[/]([\w.]+)/.exec(r)||/(webkit)[/]([\w.]+).*(version)[/]([\w.]+).*(safari)[/]([\w.]+)/.exec(r)||/(applewebkit)[/]([\w.]+).*(safari)[/]([\w.]+)/.exec(r)||/(webkit)[/]([\w.]+)/.exec(r)||/(opera)(?:.*version|)[/]([\w.]+)/.exec(r)||/(msie) ([\w.]+)/.exec(r)||/(fennec)[/]([\w.]+)/.exec(r)||r.indexOf("trident")>=0&&/(rv)(?::| )([\w.]+)/.exec(r)||r.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(r)||[],i=/(ipad)/.exec(r)||/(ipod)/.exec(r)||/(iphone)/.exec(r)||/(jsdom)/.exec(r)||/(windows phone)/.exec(r)||/(xbox)/.exec(r)||/(win)/.exec(r)||/(tablet)/.exec(r)||/(android)/.test(r)&&/(mobile)/.test(r)===!1&&["androidTablet"]||/(android)/.exec(r)||/(mac)/.exec(r)||/(linux)/.exec(r)||/(cros)/.exec(r)||[],o=s[5]||s[3]||s[1]||null,a=i[0]||null,c=s[4]||s[2]||null,l=Ff();o==="chrome"&&typeof l?.brave?.isBrave=="function"&&(o="brave"),o&&(t[o]=!0),a&&(t[a]=!0);let d=!!(t.tablet||t.android||t.androidTablet),u=!!(t.ipad||t.tablet||t.androidTablet),f=!!(t.android||t.androidTablet||t.tablet||t.ipad||t.ipod||t.iphone||t["windows phone"]),h=!!(t.cros||t.mac||t.linux||t.win),v=!!(t.brave||t.chrome||t.crios||t.opr||t.safari||t.edg||t.electron),y=!!(t.msie||t.rv),x=!!(t.chrome||t.crios),g=!!(t.fxios||t.fennec||t.mozilla),m=!!t.safari,w=!!(t.opera||t.opios||t.opr||t.opt),C=!!(t.edg||t.edge||t.edgios);return{name:jv[o]??null,platform:Lv[a]??null,userAgent:n,version:c,shortVersion:c?Cx.toFixed(parseFloat(c),2):null,isAndroid:d,isTablet:u,isMobile:f,isDesktop:h,isWebkit:v,isIE:y,isChrome:x,isFireFox:g,isSafari:m,isOpera:w,isEdge:C}}getBrowserInfo(){let e=this.parseUserAgent();return{name:e.name,platform:e.platform,userAgent:e.userAgent,version:e.version,shortVersion:e.shortVersion}}},Rx=Dv,rt={};Object.defineProperty(rt,"__esModule",{value:!0});rt.Logger=void 0;const Kr=tc,qr="mediasoup-client";let kx=class{_debug;_warn;_error;constructor(t){t?(this._debug=(0,Kr.default)(`${qr}:${t}`),this._warn=(0,Kr.default)(`${qr}:WARN:${t}`),this._error=(0,Kr.default)(`${qr}:ERROR:${t}`)):(this._debug=(0,Kr.default)(qr),this._warn=(0,Kr.default)(`${qr}:WARN`),this._error=(0,Kr.default)(`${qr}:ERROR`)),this._debug.log=console.info.bind(console),this._warn.log=console.warn.bind(console),this._error.log=console.error.bind(console)}get debug(){return this._debug}get warn(){return this._warn}get error(){return this._error}};rt.Logger=kx;var gt={},Iu={exports:{}},bs=typeof Reflect=="object"?Reflect:null,zf=bs&&typeof bs.apply=="function"?bs.apply:function(t,n,r){return Function.prototype.apply.call(t,n,r)},Zo;bs&&typeof bs.ownKeys=="function"?Zo=bs.ownKeys:Object.getOwnPropertySymbols?Zo=function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:Zo=function(t){return Object.getOwnPropertyNames(t)};function Tx(e){console&&console.warn&&console.warn(e)}var Iv=Number.isNaN||function(t){return t!==t};function be(){be.init.call(this)}Iu.exports=be;Iu.exports.once=Dx;be.EventEmitter=be;be.prototype._events=void 0;be.prototype._eventsCount=0;be.prototype._maxListeners=void 0;var Uf=10;function nc(e){if(typeof e!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}Object.defineProperty(be,"defaultMaxListeners",{enumerable:!0,get:function(){return Uf},set:function(e){if(typeof e!="number"||e<0||Iv(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");Uf=e}});be.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};be.prototype.setMaxListeners=function(t){if(typeof t!="number"||t<0||Iv(t))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+t+".");return this._maxListeners=t,this};function Nv(e){return e._maxListeners===void 0?be.defaultMaxListeners:e._maxListeners}be.prototype.getMaxListeners=function(){return Nv(this)};be.prototype.emit=function(t){for(var n=[],r=1;r<arguments.length;r++)n.push(arguments[r]);var s=t==="error",i=this._events;if(i!==void 0)s=s&&i.error===void 0;else if(!s)return!1;if(s){var o;if(n.length>0&&(o=n[0]),o instanceof Error)throw o;var a=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw a.context=o,a}var c=i[t];if(c===void 0)return!1;if(typeof c=="function")zf(c,this,n);else for(var l=c.length,d=Fv(c,l),r=0;r<l;++r)zf(d[r],this,n);return!0};function Mv(e,t,n,r){var s,i,o;if(nc(n),i=e._events,i===void 0?(i=e._events=Object.create(null),e._eventsCount=0):(i.newListener!==void 0&&(e.emit("newListener",t,n.listener?n.listener:n),i=e._events),o=i[t]),o===void 0)o=i[t]=n,++e._eventsCount;else if(typeof o=="function"?o=i[t]=r?[n,o]:[o,n]:r?o.unshift(n):o.push(n),s=Nv(e),s>0&&o.length>s&&!o.warned){o.warned=!0;var a=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");a.name="MaxListenersExceededWarning",a.emitter=e,a.type=t,a.count=o.length,Tx(a)}return e}be.prototype.addListener=function(t,n){return Mv(this,t,n,!1)};be.prototype.on=be.prototype.addListener;be.prototype.prependListener=function(t,n){return Mv(this,t,n,!0)};function Px(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function Av(e,t,n){var r={fired:!1,wrapFn:void 0,target:e,type:t,listener:n},s=Px.bind(r);return s.listener=n,r.wrapFn=s,s}be.prototype.once=function(t,n){return nc(n),this.on(t,Av(this,t,n)),this};be.prototype.prependOnceListener=function(t,n){return nc(n),this.prependListener(t,Av(this,t,n)),this};be.prototype.removeListener=function(t,n){var r,s,i,o,a;if(nc(n),s=this._events,s===void 0)return this;if(r=s[t],r===void 0)return this;if(r===n||r.listener===n)--this._eventsCount===0?this._events=Object.create(null):(delete s[t],s.removeListener&&this.emit("removeListener",t,r.listener||n));else if(typeof r!="function"){for(i=-1,o=r.length-1;o>=0;o--)if(r[o]===n||r[o].listener===n){a=r[o].listener,i=o;break}if(i<0)return this;i===0?r.shift():jx(r,i),r.length===1&&(s[t]=r[0]),s.removeListener!==void 0&&this.emit("removeListener",t,a||n)}return this};be.prototype.off=be.prototype.removeListener;be.prototype.removeAllListeners=function(t){var n,r,s;if(r=this._events,r===void 0)return this;if(r.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):r[t]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete r[t]),this;if(arguments.length===0){var i=Object.keys(r),o;for(s=0;s<i.length;++s)o=i[s],o!=="removeListener"&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(n=r[t],typeof n=="function")this.removeListener(t,n);else if(n!==void 0)for(s=n.length-1;s>=0;s--)this.removeListener(t,n[s]);return this};function Ov(e,t,n){var r=e._events;if(r===void 0)return[];var s=r[t];return s===void 0?[]:typeof s=="function"?n?[s.listener||s]:[s]:n?Lx(s):Fv(s,s.length)}be.prototype.listeners=function(t){return Ov(this,t,!0)};be.prototype.rawListeners=function(t){return Ov(this,t,!1)};be.listenerCount=function(e,t){return typeof e.listenerCount=="function"?e.listenerCount(t):$v.call(e,t)};be.prototype.listenerCount=$v;function $v(e){var t=this._events;if(t!==void 0){var n=t[e];if(typeof n=="function")return 1;if(n!==void 0)return n.length}return 0}be.prototype.eventNames=function(){return this._eventsCount>0?Zo(this._events):[]};function Fv(e,t){for(var n=new Array(t),r=0;r<t;++r)n[r]=e[r];return n}function jx(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}function Lx(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}function Dx(e,t){return new Promise(function(n,r){function s(o){e.removeListener(t,i),r(o)}function i(){typeof e.removeListener=="function"&&e.removeListener("error",s),n([].slice.call(arguments))}zv(e,t,i,{once:!0}),t!=="error"&&Ix(e,s,{once:!0})})}function Ix(e,t,n){typeof e.on=="function"&&zv(e,"error",t,n)}function zv(e,t,n,r){if(typeof e.on=="function")r.once?e.once(t,n):e.on(t,n);else if(typeof e.addEventListener=="function")e.addEventListener(t,function s(i){r.once&&e.removeEventListener(t,s),n(i)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e)}var Nx=Iu.exports;Object.defineProperty(gt,"__esModule",{value:!0});gt.EnhancedEventEmitter=void 0;const Mx=Nx,Ax=rt,Ox=new Ax.Logger("EnhancedEventEmitter");class $x extends Mx.EventEmitter{constructor(){super(),this.setMaxListeners(1/0)}close(){super.removeAllListeners()}emit(t,...n){return super.emit(t,...n)}safeEmit(t,...n){try{return super.emit(t,...n)}catch(r){Ox.error("safeEmit() | event listener threw an error [eventName:%s]:%o",t,r);try{super.emit("listenererror",t,r)}catch{}return!!super.listenerCount(t)}}on(t,n){return super.on(t,n),this}off(t,n){return super.off(t,n),this}addListener(t,n){return super.on(t,n),this}prependListener(t,n){return super.prependListener(t,n),this}once(t,n){return super.once(t,n),this}prependOnceListener(t,n){return super.prependOnceListener(t,n),this}removeListener(t,n){return super.off(t,n),this}removeAllListeners(t){return super.removeAllListeners(t),this}listenerCount(t){return super.listenerCount(t)}listeners(t){return super.listeners(t)}rawListeners(t){return super.rawListeners(t)}}gt.EnhancedEventEmitter=$x;var mt={};Object.defineProperty(mt,"__esModule",{value:!0});mt.InvalidStateError=mt.UnsupportedError=void 0;class Nu extends Error{constructor(t){super(t),this.name="UnsupportedError",Error.hasOwnProperty("captureStackTrace")?Error.captureStackTrace(this,Nu):this.stack=new Error(t).stack}}mt.UnsupportedError=Nu;class Mu extends Error{constructor(t){super(t),this.name="InvalidStateError",Error.hasOwnProperty("captureStackTrace")?Error.captureStackTrace(this,Mu):this.stack=new Error(t).stack}}mt.InvalidStateError=Mu;var xn={};Object.defineProperty(xn,"__esModule",{value:!0});xn.clone=Fx;xn.generateRandomNumber=zx;xn.deepFreeze=Uv;function Fx(e){if(e!==void 0)return Number.isNaN(e)?NaN:typeof structuredClone=="function"?structuredClone(e):JSON.parse(JSON.stringify(e))}function zx(){return Math.round(Math.random()*1e7)}function Uv(e){const t=Reflect.ownKeys(e);for(const n of t){const r=e[n];(r&&typeof r=="object"||typeof r=="function")&&Uv(r)}return Object.freeze(e)}var Oe={},tt={},rc={},Ux=np&&np.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(rc,"__esModule",{value:!0});rc.Logger=void 0;const Gr=Ux(tc),Xr="h264-profile-level-id";let Bx=class{constructor(t){t?(this._debug=(0,Gr.default)(`${Xr}:${t}`),this._warn=(0,Gr.default)(`${Xr}:WARN:${t}`),this._error=(0,Gr.default)(`${Xr}:ERROR:${t}`)):(this._debug=(0,Gr.default)(Xr),this._warn=(0,Gr.default)(`${Xr}:WARN`),this._error=(0,Gr.default)(`${Xr}:ERROR`)),this._debug.log=console.info.bind(console),this._warn.log=console.warn.bind(console),this._error.log=console.error.bind(console)}get debug(){return this._debug}get warn(){return this._warn}get error(){return this._error}};rc.Logger=Bx;Object.defineProperty(tt,"__esModule",{value:!0});tt.ProfileLevelId=tt.Level=tt.Profile=void 0;tt.parseProfileLevelId=Bv;tt.profileLevelIdToString=Vv;tt.profileToString=Qx;tt.levelToString=Kx;tt.parseSdpProfileLevelId=Fr;tt.isSameProfile=qx;tt.isSameProfileAndLevel=Gx;tt.generateProfileLevelIdStringForAnswer=Xx;tt.supportedLevel=Yx;const Vx=rc,sn=new Vx.Logger;var Ce;(function(e){e[e.ConstrainedBaseline=1]="ConstrainedBaseline",e[e.Baseline=2]="Baseline",e[e.Main=3]="Main",e[e.ConstrainedHigh=4]="ConstrainedHigh",e[e.High=5]="High",e[e.PredictiveHigh444=6]="PredictiveHigh444"})(Ce||(tt.Profile=Ce={}));var te;(function(e){e[e.L1_b=0]="L1_b",e[e.L1=10]="L1",e[e.L1_1=11]="L1_1",e[e.L1_2=12]="L1_2",e[e.L1_3=13]="L1_3",e[e.L2=20]="L2",e[e.L2_1=21]="L2_1",e[e.L2_2=22]="L2_2",e[e.L3=30]="L3",e[e.L3_1=31]="L3_1",e[e.L3_2=32]="L3_2",e[e.L4=40]="L4",e[e.L4_1=41]="L4_1",e[e.L4_2=42]="L4_2",e[e.L5=50]="L5",e[e.L5_1=51]="L5_1",e[e.L5_2=52]="L5_2"})(te||(tt.Level=te={}));class sc{constructor(t,n){this.profile=t,this.level=n}}tt.ProfileLevelId=sc;const Wx=new sc(Ce.ConstrainedBaseline,te.L3_1);class En{constructor(t){this.mask=~Vf("x",t),this.masked_value=Vf("1",t)}isMatch(t){return this.masked_value===(t&this.mask)}}class Rn{constructor(t,n,r){this.profile_idc=t,this.profile_iop=n,this.profile=r}}const Hx=[new Rn(66,new En("x1xx0000"),Ce.ConstrainedBaseline),new Rn(77,new En("1xxx0000"),Ce.ConstrainedBaseline),new Rn(88,new En("11xx0000"),Ce.ConstrainedBaseline),new Rn(66,new En("x0xx0000"),Ce.Baseline),new Rn(88,new En("10xx0000"),Ce.Baseline),new Rn(77,new En("0x0x0000"),Ce.Main),new Rn(100,new En("00000000"),Ce.High),new Rn(100,new En("00001100"),Ce.ConstrainedHigh),new Rn(244,new En("00000000"),Ce.PredictiveHigh444)],Bf=[{max_macroblocks_per_second:1485,max_macroblock_frame_size:99,level:te.L1},{max_macroblocks_per_second:1485,max_macroblock_frame_size:99,level:te.L1_b},{max_macroblocks_per_second:3e3,max_macroblock_frame_size:396,level:te.L1_1},{max_macroblocks_per_second:6e3,max_macroblock_frame_size:396,level:te.L1_2},{max_macroblocks_per_second:11880,max_macroblock_frame_size:396,level:te.L1_3},{max_macroblocks_per_second:11880,max_macroblock_frame_size:396,level:te.L2},{max_macroblocks_per_second:19800,max_macroblock_frame_size:792,level:te.L2_1},{max_macroblocks_per_second:20250,max_macroblock_frame_size:1620,level:te.L2_2},{max_macroblocks_per_second:40500,max_macroblock_frame_size:1620,level:te.L3},{max_macroblocks_per_second:108e3,max_macroblock_frame_size:3600,level:te.L3_1},{max_macroblocks_per_second:216e3,max_macroblock_frame_size:5120,level:te.L3_2},{max_macroblocks_per_second:245760,max_macroblock_frame_size:8192,level:te.L4},{max_macroblocks_per_second:245760,max_macroblock_frame_size:8192,level:te.L4_1},{max_macroblocks_per_second:522240,max_macroblock_frame_size:8704,level:te.L4_2},{max_macroblocks_per_second:589824,max_macroblock_frame_size:22080,level:te.L5},{max_macroblocks_per_second:983040,max_macroblock_frame_size:36864,level:te.L5_1},{max_macroblocks_per_second:2073600,max_macroblock_frame_size:36864,level:te.L5_2}];function Bv(e){if(typeof e!="string"||e.length!==6)return;const n=parseInt(e,16);if(n===0)return;const r=n&255,s=n>>8&255,i=n>>16&255;let o;switch(r){case te.L1_1:{o=s&16?te.L1_b:te.L1_1;break}case te.L1:case te.L1_2:case te.L1_3:case te.L2:case te.L2_1:case te.L2_2:case te.L3:case te.L3_1:case te.L3_2:case te.L4:case te.L4_1:case te.L4_2:case te.L5:case te.L5_1:case te.L5_2:{o=r;break}default:{sn.warn(`parseProfileLevelId() | unrecognized level_idc [str:${e}, level_idc:${r}]`);return}}for(const a of Hx)if(i===a.profile_idc&&a.profile_iop.isMatch(s))return sn.debug(`parseProfileLevelId() | result [str:${e}, profile:${a.profile}, level:${o}]`),new sc(a.profile,o);sn.warn(`parseProfileLevelId() | unrecognized profile_idc/profile_iop combination [str:${e}, profile_idc:${i}, profile_iop:${s}]`)}function Vv(e){if(e.level==te.L1_b)switch(e.profile){case Ce.ConstrainedBaseline:return"42f00b";case Ce.Baseline:return"42100b";case Ce.Main:return"4d100b";default:{sn.warn(`profileLevelIdToString() | Level 1_b not is allowed for profile ${e.profile}`);return}}let t;switch(e.profile){case Ce.ConstrainedBaseline:{t="42e0";break}case Ce.Baseline:{t="4200";break}case Ce.Main:{t="4d00";break}case Ce.ConstrainedHigh:{t="640c";break}case Ce.High:{t="6400";break}case Ce.PredictiveHigh444:{t="f400";break}default:{sn.warn(`profileLevelIdToString() | unrecognized profile ${e.profile}`);return}}let n=e.level.toString(16);return n.length===1&&(n=`0${n}`),`${t}${n}`}function Qx(e){switch(e){case Ce.ConstrainedBaseline:return"ConstrainedBaseline";case Ce.Baseline:return"Baseline";case Ce.Main:return"Main";case Ce.ConstrainedHigh:return"ConstrainedHigh";case Ce.High:return"High";case Ce.PredictiveHigh444:return"PredictiveHigh444";default:{sn.warn(`profileToString() | unrecognized profile ${e}`);return}}}function Kx(e){switch(e){case te.L1_b:return"1b";case te.L1:return"1";case te.L1_1:return"1.1";case te.L1_2:return"1.2";case te.L1_3:return"1.3";case te.L2:return"2";case te.L2_1:return"2.1";case te.L2_2:return"2.2";case te.L3:return"3";case te.L3_1:return"3.1";case te.L3_2:return"3.2";case te.L4:return"4";case te.L4_1:return"4.1";case te.L4_2:return"4.2";case te.L5:return"5";case te.L5_1:return"5.1";case te.L5_2:return"5.2";default:{sn.warn(`levelToString() | unrecognized level ${e}`);return}}}function Fr(e={}){const t=e["profile-level-id"];return t?Bv(t):Wx}function qx(e={},t={}){const n=Fr(e),r=Fr(t);return!!(n&&r&&n.profile===r.profile)}function Gx(e={},t={}){const n=Fr(e),r=Fr(t);return!!(n&&r&&n.profile===r.profile&&n.level==r.level)}function Xx(e={},t={}){if(!e["profile-level-id"]&&!t["profile-level-id"]){sn.warn("generateProfileLevelIdStringForAnswer() | profile-level-id missing in local and remote params");return}const n=Fr(e),r=Fr(t);if(!n)throw new TypeError("invalid local_profile_level_id");if(!r)throw new TypeError("invalid remote_profile_level_id");if(n.profile!==r.profile)throw new TypeError("H264 Profile mismatch");const s=Wf(e)&&Wf(t),i=n.level,o=r.level,a=Zx(i,o),c=s?i:a;return sn.debug(`generateProfileLevelIdStringForAnswer() | result [profile:${n.profile}, level:${c}]`),Vv(new sc(n.profile,c))}function Yx(e,t){for(let r=Bf.length-1;r>=0;--r){const s=Bf[r];if(s.max_macroblock_frame_size*256<=e&&s.max_macroblocks_per_second<=t*s.max_macroblock_frame_size)return sn.debug(`supportedLevel() | result [max_frame_pixel_count:${e}, max_fps:${t}, level:${s.level}]`),s.level}sn.warn(`supportedLevel() | no level supported [max_frame_pixel_count:${e}, max_fps:${t}]`)}function Vf(e,t){return+(t[0]===e)<<7|+(t[1]===e)<<6|+(t[2]===e)<<5|+(t[3]===e)<<4|+(t[4]===e)<<3|+(t[5]===e)<<2|+(t[6]===e)<<1|+(t[7]===e)<<0}function Jx(e,t){return e===te.L1_b?t!==te.L1&&t!==te.L1_b:t===te.L1_b?e!==te.L1:e<t}function Zx(e,t){return Jx(e,t)?e:t}function Wf(e={}){const t=e["level-asymmetry-allowed"];return t===!0||t===1||t==="1"}Object.defineProperty(Oe,"__esModule",{value:!0});Oe.validateAndNormalizeRtpCapabilities=sb;Oe.validateAndNormalizeRtpParameters=Au;Oe.validateAndNormalizeSctpStreamParameters=ib;Oe.validateSctpCapabilities=ob;Oe.getExtendedRtpCapabilities=ab;Oe.getRecvRtpCapabilities=cb;Oe.getSendingRtpParameters=lb;Oe.getSendingRemoteRtpParameters=db;Oe.reduceCodecs=ub;Oe.generateProbatorRtpParameters=pb;Oe.canSend=fb;Oe.canReceive=hb;const Hf=tt,eb=xn,tb="probator",nb=1234,rb=127;function sb(e){if(typeof e!="object")throw new TypeError("caps is not an object");if(e.codecs&&!Array.isArray(e.codecs))throw new TypeError("caps.codecs is not an array");e.codecs||(e.codecs=[]);for(const t of e.codecs)mb(t);if(e.headerExtensions&&!Array.isArray(e.headerExtensions))throw new TypeError("caps.headerExtensions is not an array");e.headerExtensions||(e.headerExtensions=[]);for(const t of e.headerExtensions)gb(t)}function Au(e){if(typeof e!="object")throw new TypeError("params is not an object");if(e.mid&&typeof e.mid!="string")throw new TypeError("params.mid is not a string");if(!Array.isArray(e.codecs))throw new TypeError("missing params.codecs");for(const t of e.codecs)vb(t);if(e.headerExtensions&&!Array.isArray(e.headerExtensions))throw new TypeError("params.headerExtensions is not an array");e.headerExtensions||(e.headerExtensions=[]);for(const t of e.headerExtensions)yb(t);if(e.encodings&&!Array.isArray(e.encodings))throw new TypeError("params.encodings is not an array");e.encodings||(e.encodings=[]);for(const t of e.encodings)wb(t);if(e.rtcp&&typeof e.rtcp!="object")throw new TypeError("params.rtcp is not an object");e.rtcp||(e.rtcp={}),_b(e.rtcp)}function ib(e){if(typeof e!="object")throw new TypeError("params is not an object");if(typeof e.streamId!="number")throw new TypeError("missing params.streamId");let t=!1;if(typeof e.ordered=="boolean"?t=!0:e.ordered=!0,e.maxPacketLifeTime&&typeof e.maxPacketLifeTime!="number")throw new TypeError("invalid params.maxPacketLifeTime");if(e.maxRetransmits&&typeof e.maxRetransmits!="number")throw new TypeError("invalid params.maxRetransmits");if(e.maxPacketLifeTime&&e.maxRetransmits)throw new TypeError("cannot provide both maxPacketLifeTime and maxRetransmits");if(t&&e.ordered&&(e.maxPacketLifeTime||e.maxRetransmits))throw new TypeError("cannot be ordered with maxPacketLifeTime or maxRetransmits");if(!t&&(e.maxPacketLifeTime||e.maxRetransmits)&&(e.ordered=!1),e.label&&typeof e.label!="string")throw new TypeError("invalid params.label");if(e.protocol&&typeof e.protocol!="string")throw new TypeError("invalid params.protocol")}function ob(e){if(typeof e!="object")throw new TypeError("caps is not an object");if(!e.numStreams||typeof e.numStreams!="object")throw new TypeError("missing caps.numStreams");Sb(e.numStreams)}function ab(e,t,n){const r={codecs:[],headerExtensions:[]};if(n)for(const s of e.codecs??[]){if(hs(s))continue;const i=(t.codecs??[]).find(a=>Ed(a,s,{strict:!0,modify:!0}));if(!i)continue;const o={kind:s.kind,mimeType:s.mimeType,clockRate:s.clockRate,channels:s.channels,localPayloadType:s.preferredPayloadType,localRtxPayloadType:void 0,remotePayloadType:i.preferredPayloadType,remoteRtxPayloadType:void 0,localParameters:s.parameters??{},remoteParameters:i.parameters??{},rtcpFeedback:Qf(s,i)};r.codecs.push(o)}else for(const s of t.codecs??[]){if(hs(s))continue;const i=(e.codecs??[]).find(a=>Ed(a,s,{strict:!0,modify:!0}));if(!i)continue;const o={kind:i.kind,mimeType:i.mimeType,clockRate:i.clockRate,channels:i.channels,localPayloadType:i.preferredPayloadType,localRtxPayloadType:void 0,remotePayloadType:s.preferredPayloadType,remoteRtxPayloadType:void 0,localParameters:i.parameters??{},remoteParameters:s.parameters??{},rtcpFeedback:Qf(i,s)};r.codecs.push(o)}for(const s of r.codecs){const i=e.codecs.find(a=>hs(a)&&a.parameters?.apt===s.localPayloadType),o=t.codecs.find(a=>hs(a)&&a.parameters?.apt===s.remotePayloadType);i&&o&&(s.localRtxPayloadType=i.preferredPayloadType,s.remoteRtxPayloadType=o.preferredPayloadType)}for(const s of t.headerExtensions){const i=e.headerExtensions.find(a=>xb(a,s));if(!i)continue;const o={kind:s.kind,uri:s.uri,sendId:i.preferredId,recvId:s.preferredId,encrypt:i.preferredEncrypt??!1,direction:"sendrecv"};switch(s.direction){case"sendrecv":{o.direction="sendrecv";break}case"recvonly":{o.direction="sendonly";break}case"sendonly":{o.direction="recvonly";break}case"inactive":{o.direction="inactive";break}}r.headerExtensions.push(o)}return r}function cb(e){const t={codecs:[],headerExtensions:[]};for(const n of e.codecs){const r={kind:n.kind,mimeType:n.mimeType,preferredPayloadType:n.remotePayloadType,clockRate:n.clockRate,channels:n.channels,parameters:n.localParameters,rtcpFeedback:n.rtcpFeedback};if(t.codecs.push(r),!n.remoteRtxPayloadType)continue;const s={kind:n.kind,mimeType:`${n.kind}/rtx`,preferredPayloadType:n.remoteRtxPayloadType,clockRate:n.clockRate,parameters:{apt:n.remotePayloadType},rtcpFeedback:[]};t.codecs.push(s)}for(const n of e.headerExtensions){if(n.direction!=="sendrecv"&&n.direction!=="recvonly")continue;const r={kind:n.kind,uri:n.uri,preferredId:n.recvId,preferredEncrypt:n.encrypt??!1,direction:n.direction};t.headerExtensions.push(r)}return t}function lb(e,t){const n={mid:void 0,codecs:[],headerExtensions:[],encodings:[],rtcp:{}};for(const r of t.codecs){if(r.kind!==e)continue;const s={mimeType:r.mimeType,payloadType:r.localPayloadType,clockRate:r.clockRate,channels:r.channels,parameters:r.localParameters,rtcpFeedback:r.rtcpFeedback};if(n.codecs.push(s),r.localRtxPayloadType){const i={mimeType:`${r.kind}/rtx`,payloadType:r.localRtxPayloadType,clockRate:r.clockRate,parameters:{apt:r.localPayloadType},rtcpFeedback:[]};n.codecs.push(i)}}for(const r of t.headerExtensions){if(r.kind&&r.kind!==e||r.direction!=="sendrecv"&&r.direction!=="sendonly")continue;const s={uri:r.uri,id:r.sendId,encrypt:r.encrypt,parameters:{}};n.headerExtensions.push(s)}return n}function db(e,t){const n={mid:void 0,codecs:[],headerExtensions:[],encodings:[],rtcp:{}};for(const r of t.codecs){if(r.kind!==e)continue;const s={mimeType:r.mimeType,payloadType:r.localPayloadType,clockRate:r.clockRate,channels:r.channels,parameters:r.remoteParameters,rtcpFeedback:r.rtcpFeedback};if(n.codecs.push(s),r.localRtxPayloadType){const i={mimeType:`${r.kind}/rtx`,payloadType:r.localRtxPayloadType,clockRate:r.clockRate,parameters:{apt:r.localPayloadType},rtcpFeedback:[]};n.codecs.push(i)}}for(const r of t.headerExtensions){if(r.kind&&r.kind!==e||r.direction!=="sendrecv"&&r.direction!=="sendonly")continue;const s={uri:r.uri,id:r.sendId,encrypt:r.encrypt,parameters:{}};n.headerExtensions.push(s)}if(n.headerExtensions.some(r=>r.uri==="http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01"))for(const r of n.codecs)r.rtcpFeedback=(r.rtcpFeedback??[]).filter(s=>s.type!=="goog-remb");else if(n.headerExtensions.some(r=>r.uri==="http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time"))for(const r of n.codecs)r.rtcpFeedback=(r.rtcpFeedback??[]).filter(s=>s.type!=="transport-cc");else for(const r of n.codecs)r.rtcpFeedback=(r.rtcpFeedback??[]).filter(s=>s.type!=="transport-cc"&&s.type!=="goog-remb");return n}function ub(e,t){const n=[];if(!t)n.push(e[0]),hs(e[1])&&n.push(e[1]);else{for(let r=0;r<e.length;++r)if(Ed(e[r],t,{strict:!0})){n.push(e[r]),hs(e[r+1])&&n.push(e[r+1]);break}if(n.length===0)throw new TypeError("no matching codec found")}return n}function pb(e){e=eb.clone(e),Au(e);const t={mid:tb,codecs:[],headerExtensions:[],encodings:[{ssrc:nb}],rtcp:{cname:"probator"}};return t.codecs.push(e.codecs[0]),t.codecs[0].payloadType=rb,t.headerExtensions=e.headerExtensions,t}function fb(e,t){return(t.codecs??[]).some(n=>n.kind===e)}function hb(e,t){if(Au(e),e.codecs.length===0)return!1;const n=e.codecs[0];return(t.codecs??[]).some(r=>r.preferredPayloadType===n.payloadType)}function mb(e){const t=new RegExp("^(audio|video)/(.+)","i");if(typeof e!="object")throw new TypeError("codec is not an object");if(!e.mimeType||typeof e.mimeType!="string")throw new TypeError("missing codec.mimeType");const n=t.exec(e.mimeType);if(!n)throw new TypeError("invalid codec.mimeType");if(e.kind=n[1].toLowerCase(),typeof e.preferredPayloadType!="number")throw new TypeError("missing codec.preferredPayloadType");if(typeof e.clockRate!="number")throw new TypeError("missing codec.clockRate");e.kind==="audio"?typeof e.channels!="number"&&(e.channels=1):delete e.channels,(!e.parameters||typeof e.parameters!="object")&&(e.parameters={});for(const r of Object.keys(e.parameters)){let s=e.parameters[r];if(s===void 0&&(e.parameters[r]="",s=""),typeof s!="string"&&typeof s!="number")throw new TypeError(`invalid codec parameter [key:${r}s, value:${s}]`);if(r==="apt"&&typeof s!="number")throw new TypeError("invalid codec apt parameter")}(!e.rtcpFeedback||!Array.isArray(e.rtcpFeedback))&&(e.rtcpFeedback=[]);for(const r of e.rtcpFeedback)Wv(r)}function Wv(e){if(typeof e!="object")throw new TypeError("fb is not an object");if(!e.type||typeof e.type!="string")throw new TypeError("missing fb.type");(!e.parameter||typeof e.parameter!="string")&&(e.parameter="")}function gb(e){if(typeof e!="object")throw new TypeError("ext is not an object");if(e.kind!=="audio"&&e.kind!=="video")throw new TypeError("invalid ext.kind");if(!e.uri||typeof e.uri!="string")throw new TypeError("missing ext.uri");if(typeof e.preferredId!="number")throw new TypeError("missing ext.preferredId");if(e.preferredEncrypt&&typeof e.preferredEncrypt!="boolean")throw new TypeError("invalid ext.preferredEncrypt");if(e.preferredEncrypt||(e.preferredEncrypt=!1),e.direction&&typeof e.direction!="string")throw new TypeError("invalid ext.direction");e.direction||(e.direction="sendrecv")}function vb(e){const t=new RegExp("^(audio|video)/(.+)","i");if(typeof e!="object")throw new TypeError("codec is not an object");if(!e.mimeType||typeof e.mimeType!="string")throw new TypeError("missing codec.mimeType");const n=t.exec(e.mimeType);if(!n)throw new TypeError("invalid codec.mimeType");if(typeof e.payloadType!="number")throw new TypeError("missing codec.payloadType");if(typeof e.clockRate!="number")throw new TypeError("missing codec.clockRate");n[1].toLowerCase()==="audio"?typeof e.channels!="number"&&(e.channels=1):delete e.channels,(!e.parameters||typeof e.parameters!="object")&&(e.parameters={});for(const s of Object.keys(e.parameters)){let i=e.parameters[s];if(i===void 0&&(e.parameters[s]="",i=""),typeof i!="string"&&typeof i!="number")throw new TypeError(`invalid codec parameter [key:${s}s, value:${i}]`);if(s==="apt"&&typeof i!="number")throw new TypeError("invalid codec apt parameter")}(!e.rtcpFeedback||!Array.isArray(e.rtcpFeedback))&&(e.rtcpFeedback=[]);for(const s of e.rtcpFeedback)Wv(s)}function yb(e){if(typeof e!="object")throw new TypeError("ext is not an object");if(!e.uri||typeof e.uri!="string")throw new TypeError("missing ext.uri");if(typeof e.id!="number")throw new TypeError("missing ext.id");if(e.encrypt&&typeof e.encrypt!="boolean")throw new TypeError("invalid ext.encrypt");e.encrypt||(e.encrypt=!1),(!e.parameters||typeof e.parameters!="object")&&(e.parameters={});for(const t of Object.keys(e.parameters)){let n=e.parameters[t];if(n===void 0&&(e.parameters[t]="",n=""),typeof n!="string"&&typeof n!="number")throw new TypeError("invalid header extension parameter")}}function wb(e){if(typeof e!="object")throw new TypeError("encoding is not an object");if(e.ssrc&&typeof e.ssrc!="number")throw new TypeError("invalid encoding.ssrc");if(e.rid&&typeof e.rid!="string")throw new TypeError("invalid encoding.rid");if(e.rtx&&typeof e.rtx!="object")throw new TypeError("invalid encoding.rtx");if(e.rtx&&typeof e.rtx.ssrc!="number")throw new TypeError("missing encoding.rtx.ssrc");if((!e.dtx||typeof e.dtx!="boolean")&&(e.dtx=!1),e.scalabilityMode&&typeof e.scalabilityMode!="string")throw new TypeError("invalid encoding.scalabilityMode")}function _b(e){if(typeof e!="object")throw new TypeError("rtcp is not an object");if(e.cname&&typeof e.cname!="string")throw new TypeError("invalid rtcp.cname");(!e.reducedSize||typeof e.reducedSize!="boolean")&&(e.reducedSize=!0)}function Sb(e){if(typeof e!="object")throw new TypeError("numStreams is not an object");if(typeof e.OS!="number")throw new TypeError("missing numStreams.OS");if(typeof e.MIS!="number")throw new TypeError("missing numStreams.MIS")}function hs(e){return e?/.+\/rtx$/i.test(e.mimeType):!1}function Ed(e,t,{strict:n=!1,modify:r=!1}={}){const s=e.mimeType.toLowerCase(),i=t.mimeType.toLowerCase();if(s!==i||e.clockRate!==t.clockRate||e.channels!==t.channels)return!1;switch(s){case"video/h264":{if(n){const o=e.parameters["packetization-mode"]??0,a=t.parameters["packetization-mode"]??0;if(o!==a||!Hf.isSameProfile(e.parameters,t.parameters))return!1;let c;try{c=Hf.generateProfileLevelIdStringForAnswer(e.parameters,t.parameters)}catch{return!1}r&&(c?(e.parameters["profile-level-id"]=c,t.parameters["profile-level-id"]=c):(delete e.parameters["profile-level-id"],delete t.parameters["profile-level-id"]))}break}case"video/vp9":{if(n){const o=e.parameters["profile-id"]??0,a=t.parameters["profile-id"]??0;if(o!==a)return!1}break}}return!0}function xb(e,t){return!(e.kind&&t.kind&&e.kind!==t.kind||e.uri!==t.uri)}function Qf(e,t){const n=[];for(const r of e.rtcpFeedback??[]){const s=(t.rtcpFeedback??[]).find(i=>i.type===r.type&&(i.parameter===r.parameter||!i.parameter&&!r.parameter));s&&n.push(s)}return n}var ic={},Hv={},oc={},ac={};Object.defineProperty(ac,"__esModule",{value:!0});ac.Logger=void 0;const Yr=tc,Jr="awaitqueue";class bb{_debug;_warn;_error;constructor(t){t?(this._debug=Yr(`${Jr}:${t}`),this._warn=Yr(`${Jr}:WARN:${t}`),this._error=Yr(`${Jr}:ERROR:${t}`)):(this._debug=Yr(Jr),this._warn=Yr(`${Jr}:WARN`),this._error=Yr(`${Jr}:ERROR`)),this._debug.log=console.info.bind(console),this._warn.log=console.warn.bind(console),this._error.log=console.error.bind(console)}get debug(){return this._debug}get warn(){return this._warn}get error(){return this._error}}ac.Logger=bb;var zr={};Object.defineProperty(zr,"__esModule",{value:!0});zr.AwaitQueueRemovedTaskError=zr.AwaitQueueStoppedError=void 0;class Ou extends Error{constructor(t){super(t??"queue stopped"),this.name="AwaitQueueStoppedError",typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,Ou)}}zr.AwaitQueueStoppedError=Ou;class $u extends Error{constructor(t){super(t??"queue task removed"),this.name="AwaitQueueRemovedTaskError",typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,$u)}}zr.AwaitQueueRemovedTaskError=$u;Object.defineProperty(oc,"__esModule",{value:!0});oc.AwaitQueue=void 0;const Cb=ac,Kf=zr,kn=new Cb.Logger("AwaitQueue");class Eb{pendingTasks=new Map;nextTaskId=0;stopping=!1;constructor(){kn.debug("constructor()")}get size(){return this.pendingTasks.size}async push(t,n){if(n=n??t.name,kn.debug(`push() [name:${n}]`),typeof t!="function")throw new TypeError("given task is not a function");if(n)try{Object.defineProperty(t,"name",{value:n})}catch{}return new Promise((r,s)=>{const i={id:this.nextTaskId++,task:t,name:n,enqueuedAt:Date.now(),executedAt:void 0,completed:!1,resolve:o=>{if(i.completed)return;i.completed=!0,this.pendingTasks.delete(i.id),kn.debug(`resolving task [name:${i.name}]`),r(o);const[a]=this.pendingTasks.values();a&&!a.executedAt&&this.execute(a)},reject:o=>{if(!i.completed&&(i.completed=!0,this.pendingTasks.delete(i.id),kn.debug(`rejecting task [name:${i.name}]: %s`,String(o)),s(o),!this.stopping)){const[a]=this.pendingTasks.values();a&&!a.executedAt&&this.execute(a)}}};this.pendingTasks.set(i.id,i),this.pendingTasks.size===1&&this.execute(i)})}stop(){kn.debug("stop()"),this.stopping=!0;for(const t of this.pendingTasks.values())kn.debug(`stop() | stopping task [name:${t.name}]`),t.reject(new Kf.AwaitQueueStoppedError);this.stopping=!1}remove(t){kn.debug(`remove() [taskIdx:${t}]`);const n=Array.from(this.pendingTasks.values())[t];if(!n){kn.debug(`stop() | no task with given idx [taskIdx:${t}]`);return}n.reject(new Kf.AwaitQueueRemovedTaskError)}dump(){const t=Date.now();let n=0;return Array.from(this.pendingTasks.values()).map(r=>({idx:n++,task:r.task,name:r.name,enqueuedTime:r.executedAt?r.executedAt-r.enqueuedAt:t-r.enqueuedAt,executionTime:r.executedAt?t-r.executedAt:0}))}async execute(t){if(kn.debug(`execute() [name:${t.name}]`),t.executedAt)throw new Error("task already being executed");t.executedAt=Date.now();try{const n=await t.task();t.resolve(n)}catch(n){t.reject(n)}}}oc.AwaitQueue=Eb;(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.AwaitQueueRemovedTaskError=e.AwaitQueueStoppedError=e.AwaitQueue=void 0;var t=oc;Object.defineProperty(e,"AwaitQueue",{enumerable:!0,get:function(){return t.AwaitQueue}});var n=zr;Object.defineProperty(e,"AwaitQueueStoppedError",{enumerable:!0,get:function(){return n.AwaitQueueStoppedError}}),Object.defineProperty(e,"AwaitQueueRemovedTaskError",{enumerable:!0,get:function(){return n.AwaitQueueRemovedTaskError}})})(Hv);var cc={};Object.defineProperty(cc,"__esModule",{value:!0});cc.Producer=void 0;const Rb=rt,qf=gt,Zr=mt,pn=new Rb.Logger("Producer");class kb extends qf.EnhancedEventEmitter{_id;_localId;_closed=!1;_rtpSender;_track;_kind;_rtpParameters;_paused;_maxSpatialLayer;_stopTracks;_disableTrackOnPause;_zeroRtpOnPause;_appData;_observer=new qf.EnhancedEventEmitter;constructor({id:t,localId:n,rtpSender:r,track:s,rtpParameters:i,stopTracks:o,disableTrackOnPause:a,zeroRtpOnPause:c,appData:l}){super(),pn.debug("constructor()"),this._id=t,this._localId=n,this._rtpSender=r,this._track=s,this._kind=s.kind,this._rtpParameters=i,this._paused=a?!s.enabled:!1,this._maxSpatialLayer=void 0,this._stopTracks=o,this._disableTrackOnPause=a,this._zeroRtpOnPause=c,this._appData=l??{},this.onTrackEnded=this.onTrackEnded.bind(this),this.handleTrack()}get id(){return this._id}get localId(){return this._localId}get closed(){return this._closed}get kind(){return this._kind}get rtpSender(){return this._rtpSender}get track(){return this._track}get rtpParameters(){return this._rtpParameters}get paused(){return this._paused}get maxSpatialLayer(){return this._maxSpatialLayer}get appData(){return this._appData}set appData(t){this._appData=t}get observer(){return this._observer}close(){this._closed||(pn.debug("close()"),this._closed=!0,this.destroyTrack(),this.emit("@close"),this._observer.safeEmit("close"),super.close(),this._observer.close())}transportClosed(){this._closed||(pn.debug("transportClosed()"),this._closed=!0,this.destroyTrack(),this.safeEmit("transportclose"),this._observer.safeEmit("close"))}async getStats(){if(this._closed)throw new Zr.InvalidStateError("closed");return new Promise((t,n)=>{this.safeEmit("@getstats",t,n)})}pause(){if(pn.debug("pause()"),this._closed){pn.error("pause() | Producer closed");return}this._paused=!0,this._track&&this._disableTrackOnPause&&(this._track.enabled=!1),this._zeroRtpOnPause&&new Promise((t,n)=>{this.safeEmit("@pause",t,n)}).catch(()=>{}),this._observer.safeEmit("pause")}resume(){if(pn.debug("resume()"),this._closed){pn.error("resume() | Producer closed");return}this._paused=!1,this._track&&this._disableTrackOnPause&&(this._track.enabled=!0),this._zeroRtpOnPause&&new Promise((t,n)=>{this.safeEmit("@resume",t,n)}).catch(()=>{}),this._observer.safeEmit("resume")}async replaceTrack({track:t}){if(pn.debug("replaceTrack() [track:%o]",t),this._closed){if(t&&this._stopTracks)try{t.stop()}catch{}throw new Zr.InvalidStateError("closed")}else if(t&&t.readyState==="ended")throw new Zr.InvalidStateError("track ended");if(t===this._track){pn.debug("replaceTrack() | same track, ignored");return}await new Promise((n,r)=>{this.safeEmit("@replacetrack",t,n,r)}),this.destroyTrack(),this._track=t,this._track&&this._disableTrackOnPause&&(this._paused?this._paused&&(this._track.enabled=!1):this._track.enabled=!0),this.handleTrack()}async setMaxSpatialLayer(t){if(this._closed)throw new Zr.InvalidStateError("closed");if(this._kind!=="video")throw new Zr.UnsupportedError("not a video Producer");if(typeof t!="number")throw new TypeError("invalid spatialLayer");t!==this._maxSpatialLayer&&(await new Promise((n,r)=>{this.safeEmit("@setmaxspatiallayer",t,n,r)}).catch(()=>{}),this._maxSpatialLayer=t)}async setRtpEncodingParameters(t){if(this._closed)throw new Zr.InvalidStateError("closed");if(typeof t!="object")throw new TypeError("invalid params");await new Promise((n,r)=>{this.safeEmit("@setrtpencodingparameters",t,n,r)})}onTrackEnded(){pn.debug('track "ended" event'),this.safeEmit("trackended"),this._observer.safeEmit("trackended")}handleTrack(){this._track&&this._track.addEventListener("ended",this.onTrackEnded)}destroyTrack(){if(this._track)try{this._track.removeEventListener("ended",this.onTrackEnded),this._stopTracks&&this._track.stop()}catch{}}}cc.Producer=kb;var lc={};Object.defineProperty(lc,"__esModule",{value:!0});lc.Consumer=void 0;const Tb=rt,Gf=gt,Pb=mt,fn=new Tb.Logger("Consumer");class jb extends Gf.EnhancedEventEmitter{_id;_localId;_producerId;_closed=!1;_rtpReceiver;_track;_rtpParameters;_paused;_appData;_observer=new Gf.EnhancedEventEmitter;constructor({id:t,localId:n,producerId:r,rtpReceiver:s,track:i,rtpParameters:o,appData:a}){super(),fn.debug("constructor()"),this._id=t,this._localId=n,this._producerId=r,this._rtpReceiver=s,this._track=i,this._rtpParameters=o,this._paused=!i.enabled,this._appData=a??{},this.onTrackEnded=this.onTrackEnded.bind(this),this.handleTrack()}get id(){return this._id}get localId(){return this._localId}get producerId(){return this._producerId}get closed(){return this._closed}get kind(){return this._track.kind}get rtpReceiver(){return this._rtpReceiver}get track(){return this._track}get rtpParameters(){return this._rtpParameters}get paused(){return this._paused}get appData(){return this._appData}set appData(t){this._appData=t}get observer(){return this._observer}close(){this._closed||(fn.debug("close()"),this._closed=!0,this.destroyTrack(),this.emit("@close"),this._observer.safeEmit("close"),super.close(),this._observer.close())}transportClosed(){this._closed||(fn.debug("transportClosed()"),this._closed=!0,this.destroyTrack(),this.safeEmit("transportclose"),this._observer.safeEmit("close"))}async getStats(){if(this._closed)throw new Pb.InvalidStateError("closed");return new Promise((t,n)=>{this.safeEmit("@getstats",t,n)})}pause(){if(fn.debug("pause()"),this._closed){fn.error("pause() | Consumer closed");return}if(this._paused){fn.debug("pause() | Consumer is already paused");return}this._paused=!0,this._track.enabled=!1,this.emit("@pause"),this._observer.safeEmit("pause")}resume(){if(fn.debug("resume()"),this._closed){fn.error("resume() | Consumer closed");return}if(!this._paused){fn.debug("resume() | Consumer is already resumed");return}this._paused=!1,this._track.enabled=!0,this.emit("@resume"),this._observer.safeEmit("resume")}onTrackEnded(){fn.debug('track "ended" event'),this.safeEmit("trackended"),this._observer.safeEmit("trackended")}handleTrack(){this._track.addEventListener("ended",this.onTrackEnded)}destroyTrack(){try{this._track.removeEventListener("ended",this.onTrackEnded),this._track.stop()}catch{}}}lc.Consumer=jb;var dc={};Object.defineProperty(dc,"__esModule",{value:!0});dc.DataProducer=void 0;const Lb=rt,Xf=gt,Db=mt,Tn=new Lb.Logger("DataProducer");class Ib extends Xf.EnhancedEventEmitter{_id;_dataChannel;_closed=!1;_sctpStreamParameters;_appData;_observer=new Xf.EnhancedEventEmitter;constructor({id:t,dataChannel:n,sctpStreamParameters:r,appData:s}){super(),Tn.debug("constructor()"),this._id=t,this._dataChannel=n,this._sctpStreamParameters=r,this._appData=s??{},this.handleDataChannel()}get id(){return this._id}get closed(){return this._closed}get sctpStreamParameters(){return this._sctpStreamParameters}get readyState(){return this._dataChannel.readyState}get label(){return this._dataChannel.label}get protocol(){return this._dataChannel.protocol}get bufferedAmount(){return this._dataChannel.bufferedAmount}get bufferedAmountLowThreshold(){return this._dataChannel.bufferedAmountLowThreshold}set bufferedAmountLowThreshold(t){this._dataChannel.bufferedAmountLowThreshold=t}get appData(){return this._appData}set appData(t){this._appData=t}get observer(){return this._observer}close(){this._closed||(Tn.debug("close()"),this._closed=!0,this._dataChannel.close(),this.emit("@close"),this._observer.safeEmit("close"),super.close(),this._observer.close())}transportClosed(){this._closed||(Tn.debug("transportClosed()"),this._closed=!0,this._dataChannel.close(),this.safeEmit("transportclose"),this._observer.safeEmit("close"))}send(t){if(Tn.debug("send()"),this._closed)throw new Db.InvalidStateError("closed");this._dataChannel.send(t)}handleDataChannel(){this._dataChannel.addEventListener("open",()=>{this._closed||(Tn.debug('DataChannel "open" event'),this.safeEmit("open"))}),this._dataChannel.addEventListener("error",t=>{if(this._closed)return;const n=t.error??new Error("unknown DataChannel error");t.error?.errorDetail==="sctp-failure"?Tn.error("DataChannel SCTP error [sctpCauseCode:%s]: %s",t.error?.sctpCauseCode,t.error.message):Tn.error('DataChannel "error" event: %o',n),this.safeEmit("error",n)}),this._dataChannel.addEventListener("close",()=>{this._closed||(Tn.warn('DataChannel "close" event'),this._closed=!0,this.emit("@close"),this.safeEmit("close"),this._observer.safeEmit("close"))}),this._dataChannel.addEventListener("message",()=>{this._closed||Tn.warn('DataChannel "message" event in a DataProducer, message discarded')}),this._dataChannel.addEventListener("bufferedamountlow",()=>{this._closed||this.safeEmit("bufferedamountlow")})}}dc.DataProducer=Ib;var uc={};Object.defineProperty(uc,"__esModule",{value:!0});uc.DataConsumer=void 0;const Nb=rt,Yf=gt,br=new Nb.Logger("DataConsumer");class Mb extends Yf.EnhancedEventEmitter{_id;_dataProducerId;_dataChannel;_closed=!1;_sctpStreamParameters;_appData;_observer=new Yf.EnhancedEventEmitter;constructor({id:t,dataProducerId:n,dataChannel:r,sctpStreamParameters:s,appData:i}){super(),br.debug("constructor()"),this._id=t,this._dataProducerId=n,this._dataChannel=r,this._sctpStreamParameters=s,this._appData=i??{},this.handleDataChannel()}get id(){return this._id}get dataProducerId(){return this._dataProducerId}get closed(){return this._closed}get sctpStreamParameters(){return this._sctpStreamParameters}get readyState(){return this._dataChannel.readyState}get label(){return this._dataChannel.label}get protocol(){return this._dataChannel.protocol}get binaryType(){return this._dataChannel.binaryType}set binaryType(t){this._dataChannel.binaryType=t}get appData(){return this._appData}set appData(t){this._appData=t}get observer(){return this._observer}close(){this._closed||(br.debug("close()"),this._closed=!0,this._dataChannel.close(),this.emit("@close"),this._observer.safeEmit("close"),super.close(),this._observer.close())}transportClosed(){this._closed||(br.debug("transportClosed()"),this._closed=!0,this._dataChannel.close(),this.safeEmit("transportclose"),this._observer.safeEmit("close"))}handleDataChannel(){this._dataChannel.addEventListener("open",()=>{this._closed||(br.debug('DataChannel "open" event'),this.safeEmit("open"))}),this._dataChannel.addEventListener("error",t=>{if(this._closed)return;const n=t.error??new Error("unknown DataChannel error");t.error?.errorDetail==="sctp-failure"?br.error("DataChannel SCTP error [sctpCauseCode:%s]: %s",t.error?.sctpCauseCode,t.error.message):br.error('DataChannel "error" event: %o',n),this.safeEmit("error",n)}),this._dataChannel.addEventListener("close",()=>{this._closed||(br.warn('DataChannel "close" event'),this._closed=!0,this.emit("@close"),this.safeEmit("close"),this._observer.safeEmit("close"))}),this._dataChannel.addEventListener("message",t=>{this._closed||this.safeEmit("message",t.data)})}}uc.DataConsumer=Mb;Object.defineProperty(ic,"__esModule",{value:!0});ic.Transport=void 0;const Ab=Hv,Ob=rt,Jf=gt,He=mt,ol=xn,ei=Oe,$b=cc,Fb=lc,zb=dc,Ub=uc,$e=new Ob.Logger("Transport");class Bb{consumerOptions;promise;resolve;reject;constructor(t){this.consumerOptions=t,this.promise=new Promise((n,r)=>{this.resolve=n,this.reject=r})}}class Vb extends Jf.EnhancedEventEmitter{_id;_closed=!1;_direction;_getSendExtendedRtpCapabilities;_recvRtpCapabilities;_canProduceByKind;_maxSctpMessageSize;_handler;_iceGatheringState="new";_connectionState="new";_appData;_producers=new Map;_consumers=new Map;_dataProducers=new Map;_dataConsumers=new Map;_probatorConsumerCreated=!1;_awaitQueue=new Ab.AwaitQueue;_pendingConsumerTasks=[];_consumerCreationInProgress=!1;_pendingPauseConsumers=new Map;_consumerPauseInProgress=!1;_pendingResumeConsumers=new Map;_consumerResumeInProgress=!1;_pendingCloseConsumers=new Map;_consumerCloseInProgress=!1;_observer=new Jf.EnhancedEventEmitter;constructor({direction:t,id:n,iceParameters:r,iceCandidates:s,dtlsParameters:i,sctpParameters:o,iceServers:a,iceTransportPolicy:c,additionalSettings:l,appData:d,handlerFactory:u,getSendExtendedRtpCapabilities:f,recvRtpCapabilities:h,canProduceByKind:v}){super(),$e.debug("constructor() [id:%s, direction:%s]",n,t),this._id=n,this._direction=t,this._getSendExtendedRtpCapabilities=f,this._recvRtpCapabilities=h,this._canProduceByKind=v,this._maxSctpMessageSize=o?o.maxMessageSize:null;const y=ol.clone(l)??{};delete y.iceServers,delete y.iceTransportPolicy,delete y.bundlePolicy,delete y.rtcpMuxPolicy,this._handler=u.factory({direction:t,iceParameters:r,iceCandidates:s,dtlsParameters:i,sctpParameters:o,iceServers:a,iceTransportPolicy:c,additionalSettings:y,getSendExtendedRtpCapabilities:this._getSendExtendedRtpCapabilities}),this._appData=d??{},this.handleHandler()}get id(){return this._id}get closed(){return this._closed}get direction(){return this._direction}get handler(){return this._handler}get iceGatheringState(){return this._iceGatheringState}get connectionState(){return this._connectionState}get appData(){return this._appData}set appData(t){this._appData=t}get observer(){return this._observer}close(){if(!this._closed){$e.debug("close()"),this._closed=!0,this._awaitQueue.stop(),this._handler.close(),this._connectionState="closed";for(const t of this._producers.values())t.transportClosed();this._producers.clear();for(const t of this._consumers.values())t.transportClosed();this._consumers.clear();for(const t of this._dataProducers.values())t.transportClosed();this._dataProducers.clear();for(const t of this._dataConsumers.values())t.transportClosed();this._dataConsumers.clear(),this._observer.safeEmit("close"),super.close(),this._observer.close()}}async getStats(){if(this._closed)throw new He.InvalidStateError("closed");return this._handler.getTransportStats()}async restartIce({iceParameters:t}){if($e.debug("restartIce()"),this._closed)throw new He.InvalidStateError("closed");if(!t)throw new TypeError("missing iceParameters");return this._awaitQueue.push(async()=>await this._handler.restartIce(t),"transport.restartIce()")}async updateIceServers({iceServers:t}={}){if($e.debug("updateIceServers()"),this._closed)throw new He.InvalidStateError("closed");if(!Array.isArray(t))throw new TypeError("missing iceServers");return this._awaitQueue.push(async()=>this._handler.updateIceServers(t),"transport.updateIceServers()")}async produce({track:t,encodings:n,codecOptions:r,codec:s,stopTracks:i=!0,disableTrackOnPause:o=!0,zeroRtpOnPause:a=!1,onRtpSender:c,appData:l={}}={}){if($e.debug("produce() [track:%o]",t),this._closed)throw new He.InvalidStateError("closed");if(t){if(this._direction!=="send")throw new He.UnsupportedError("not a sending Transport");if(this._canProduceByKind[t.kind]){if(t.readyState==="ended")throw new He.InvalidStateError("track ended");if(this.listenerCount("connect")===0&&this._connectionState==="new")throw new TypeError('no "connect" listener set into this transport');if(this.listenerCount("produce")===0)throw new TypeError('no "produce" listener set into this transport');if(l&&typeof l!="object")throw new TypeError("if given, appData must be an object")}else throw new He.UnsupportedError(`cannot produce ${t.kind}`)}else throw new TypeError("missing track");return this._awaitQueue.push(async()=>{let d;if(n&&!Array.isArray(n))throw TypeError("encodings must be an array");n&&n.length===0?d=void 0:n&&(d=n.map(v=>{const y={active:!0};return v.active===!1&&(y.active=!1),typeof v.dtx=="boolean"&&(y.dtx=v.dtx),typeof v.scalabilityMode=="string"&&(y.scalabilityMode=v.scalabilityMode),typeof v.scaleResolutionDownBy=="number"&&(y.scaleResolutionDownBy=v.scaleResolutionDownBy),typeof v.maxBitrate=="number"&&(y.maxBitrate=v.maxBitrate),typeof v.maxFramerate=="number"&&(y.maxFramerate=v.maxFramerate),typeof v.adaptivePtime=="boolean"&&(y.adaptivePtime=v.adaptivePtime),typeof v.priority=="string"&&(y.priority=v.priority),typeof v.networkPriority=="string"&&(y.networkPriority=v.networkPriority),y}));const{localId:u,rtpParameters:f,rtpSender:h}=await this._handler.send({track:t,encodings:d,codecOptions:r,codec:s,onRtpSender:c});try{ei.validateAndNormalizeRtpParameters(f);const{id:v}=await new Promise((x,g)=>{this.safeEmit("produce",{kind:t.kind,rtpParameters:f,appData:l},x,g)}),y=new $b.Producer({id:v,localId:u,rtpSender:h,track:t,rtpParameters:f,stopTracks:i,disableTrackOnPause:o,zeroRtpOnPause:a,appData:l});return this._producers.set(y.id,y),this.handleProducer(y),this._observer.safeEmit("newproducer",y),y}catch(v){throw this._handler.stopSending(u).catch(()=>{}),v}},"transport.produce()").catch(d=>{if(i)try{t.stop()}catch{}throw d})}async consume({id:t,producerId:n,kind:r,rtpParameters:s,streamId:i,onRtpReceiver:o,appData:a={}}){if($e.debug("consume()"),this._closed)throw new He.InvalidStateError("closed");if(this._direction!=="recv")throw new He.UnsupportedError("not a receiving Transport");if(typeof t!="string")throw new TypeError("missing id");if(typeof n!="string")throw new TypeError("missing producerId");if(r!=="audio"&&r!=="video")throw new TypeError(`invalid kind '${r}'`);if(this.listenerCount("connect")===0&&this._connectionState==="new")throw new TypeError('no "connect" listener set into this transport');if(a&&typeof a!="object")throw new TypeError("if given, appData must be an object");const c=ol.clone(s);if(!ei.canReceive(c,this._recvRtpCapabilities))throw new He.UnsupportedError("cannot consume this Producer");const d=new Bb({id:t,producerId:n,kind:r,rtpParameters:c,streamId:i,onRtpReceiver:o,appData:a});return this._pendingConsumerTasks.push(d),queueMicrotask(()=>{this._closed||this._consumerCreationInProgress===!1&&this.createPendingConsumers()}),d.promise}async produceData({ordered:t=!0,maxPacketLifeTime:n,maxRetransmits:r,label:s="",protocol:i="",appData:o={}}={}){if($e.debug("produceData()"),this._closed)throw new He.InvalidStateError("closed");if(this._direction!=="send")throw new He.UnsupportedError("not a sending Transport");if(this._maxSctpMessageSize){if(this.listenerCount("connect")===0&&this._connectionState==="new")throw new TypeError('no "connect" listener set into this transport');if(this.listenerCount("producedata")===0)throw new TypeError('no "producedata" listener set into this transport');if(o&&typeof o!="object")throw new TypeError("if given, appData must be an object")}else throw new He.UnsupportedError("SCTP not enabled by remote Transport");return(n||r)&&(t=!1),this._awaitQueue.push(async()=>{const{dataChannel:a,sctpStreamParameters:c}=await this._handler.sendDataChannel({ordered:t,maxPacketLifeTime:n,maxRetransmits:r,label:s,protocol:i});ei.validateAndNormalizeSctpStreamParameters(c);const{id:l}=await new Promise((u,f)=>{this.safeEmit("producedata",{sctpStreamParameters:c,label:s,protocol:i,appData:o},u,f)}),d=new zb.DataProducer({id:l,dataChannel:a,sctpStreamParameters:c,appData:o});return this._dataProducers.set(d.id,d),this.handleDataProducer(d),this._observer.safeEmit("newdataproducer",d),d},"transport.produceData()")}async consumeData({id:t,dataProducerId:n,sctpStreamParameters:r,label:s="",protocol:i="",appData:o={}}){if($e.debug("consumeData()"),this._closed)throw new He.InvalidStateError("closed");if(this._direction!=="recv")throw new He.UnsupportedError("not a receiving Transport");if(this._maxSctpMessageSize){if(typeof t!="string")throw new TypeError("missing id");if(typeof n!="string")throw new TypeError("missing dataProducerId");if(this.listenerCount("connect")===0&&this._connectionState==="new")throw new TypeError('no "connect" listener set into this transport');if(o&&typeof o!="object")throw new TypeError("if given, appData must be an object")}else throw new He.UnsupportedError("SCTP not enabled by remote Transport");const a=ol.clone(r);return ei.validateAndNormalizeSctpStreamParameters(a),this._awaitQueue.push(async()=>{const{dataChannel:c}=await this._handler.receiveDataChannel({sctpStreamParameters:a,label:s,protocol:i}),l=new Ub.DataConsumer({id:t,dataProducerId:n,dataChannel:c,sctpStreamParameters:a,appData:o});return this._dataConsumers.set(l.id,l),this.handleDataConsumer(l),this._observer.safeEmit("newdataconsumer",l),l},"transport.consumeData()")}createPendingConsumers(){this._consumerCreationInProgress=!0,this._awaitQueue.push(async()=>{if(this._pendingConsumerTasks.length===0){$e.debug("createPendingConsumers() | there is no Consumer to be created");return}const t=[...this._pendingConsumerTasks];this._pendingConsumerTasks=[];let n;const r=[];for(const s of t){const{id:i,kind:o,rtpParameters:a,streamId:c,onRtpReceiver:l}=s.consumerOptions;r.push({trackId:i,kind:o,rtpParameters:a,streamId:c,onRtpReceiver:l})}try{const s=await this._handler.receive(r);for(let i=0;i<s.length;++i){const o=t[i],a=s[i],{id:c,producerId:l,kind:d,rtpParameters:u,appData:f}=o.consumerOptions,{localId:h,rtpReceiver:v,track:y}=a,x=new Fb.Consumer({id:c,localId:h,producerId:l,rtpReceiver:v,track:y,rtpParameters:u,appData:f});this._consumers.set(x.id,x),this.handleConsumer(x),!this._probatorConsumerCreated&&!n&&d==="video"&&(n=x),this._observer.safeEmit("newconsumer",x),o.resolve(x)}}catch(s){for(const i of t)i.reject(s)}if(n)try{const s=ei.generateProbatorRtpParameters(n.rtpParameters);await this._handler.receive([{trackId:"probator",kind:"video",rtpParameters:s}]),$e.debug("createPendingConsumers() | Consumer for RTP probation created"),this._probatorConsumerCreated=!0}catch(s){$e.error("createPendingConsumers() | failed to create Consumer for RTP probation:%o",s)}},"transport.createPendingConsumers()").then(()=>{this._consumerCreationInProgress=!1,this._pendingConsumerTasks.length>0&&this.createPendingConsumers()}).catch(()=>{})}pausePendingConsumers(){this._consumerPauseInProgress=!0,this._awaitQueue.push(async()=>{if(this._pendingPauseConsumers.size===0){$e.debug("pausePendingConsumers() | there is no Consumer to be paused");return}const t=Array.from(this._pendingPauseConsumers.values());this._pendingPauseConsumers.clear();try{const n=t.map(r=>r.localId);await this._handler.pauseReceiving(n)}catch(n){$e.error("pausePendingConsumers() | failed to pause Consumers:",n)}},"transport.pausePendingConsumers").then(()=>{this._consumerPauseInProgress=!1,this._pendingPauseConsumers.size>0&&this.pausePendingConsumers()}).catch(()=>{})}resumePendingConsumers(){this._consumerResumeInProgress=!0,this._awaitQueue.push(async()=>{if(this._pendingResumeConsumers.size===0){$e.debug("resumePendingConsumers() | there is no Consumer to be resumed");return}const t=Array.from(this._pendingResumeConsumers.values());this._pendingResumeConsumers.clear();try{const n=t.map(r=>r.localId);await this._handler.resumeReceiving(n)}catch(n){$e.error("resumePendingConsumers() | failed to resume Consumers:",n)}},"transport.resumePendingConsumers").then(()=>{this._consumerResumeInProgress=!1,this._pendingResumeConsumers.size>0&&this.resumePendingConsumers()}).catch(()=>{})}closePendingConsumers(){this._consumerCloseInProgress=!0,this._awaitQueue.push(async()=>{if(this._pendingCloseConsumers.size===0){$e.debug("closePendingConsumers() | there is no Consumer to be closed");return}const t=Array.from(this._pendingCloseConsumers.values());this._pendingCloseConsumers.clear();try{await this._handler.stopReceiving(t.map(n=>n.localId))}catch(n){$e.error("closePendingConsumers() | failed to close Consumers:",n)}},"transport.closePendingConsumers").then(()=>{this._consumerCloseInProgress=!1,this._pendingCloseConsumers.size>0&&this.closePendingConsumers()}).catch(()=>{})}handleHandler(){const t=this._handler;t.on("@connect",({dtlsParameters:n},r,s)=>{if(this._closed){s(new He.InvalidStateError("closed"));return}this.safeEmit("connect",{dtlsParameters:n},r,s)}),t.on("@icegatheringstatechange",n=>{n!==this._iceGatheringState&&($e.debug("ICE gathering state changed to %s",n),this._iceGatheringState=n,this._closed||this.safeEmit("icegatheringstatechange",n))}),t.on("@icecandidateerror",n=>{$e.warn(`ICE candidate error [url:${n.url}, localAddress:${n.address}, localPort:${n.port}]: ${n.errorCode} "${n.errorText}"`),this.safeEmit("icecandidateerror",n)}),t.on("@connectionstatechange",n=>{n!==this._connectionState&&($e.debug("connection state changed to %s",n),this._connectionState=n,this._closed||this.safeEmit("connectionstatechange",n))})}handleProducer(t){t.on("@close",()=>{this._producers.delete(t.id),!this._closed&&this._awaitQueue.push(async()=>await this._handler.stopSending(t.localId),"producer @close event").catch(n=>$e.warn("producer.close() failed:%o",n))}),t.on("@pause",(n,r)=>{this._awaitQueue.push(async()=>await this._handler.pauseSending(t.localId),"producer @pause event").then(n).catch(r)}),t.on("@resume",(n,r)=>{this._awaitQueue.push(async()=>await this._handler.resumeSending(t.localId),"producer @resume event").then(n).catch(r)}),t.on("@replacetrack",(n,r,s)=>{this._awaitQueue.push(async()=>await this._handler.replaceTrack(t.localId,n),"producer @replacetrack event").then(r).catch(s)}),t.on("@setmaxspatiallayer",(n,r,s)=>{this._awaitQueue.push(async()=>await this._handler.setMaxSpatialLayer(t.localId,n),"producer @setmaxspatiallayer event").then(r).catch(s)}),t.on("@setrtpencodingparameters",(n,r,s)=>{this._awaitQueue.push(async()=>await this._handler.setRtpEncodingParameters(t.localId,n),"producer @setrtpencodingparameters event").then(r).catch(s)}),t.on("@getstats",(n,r)=>{if(this._closed)return r(new He.InvalidStateError("closed"));this._handler.getSenderStats(t.localId).then(n).catch(r)})}handleConsumer(t){t.on("@close",()=>{this._consumers.delete(t.id),this._pendingPauseConsumers.delete(t.id),this._pendingResumeConsumers.delete(t.id),!this._closed&&(this._pendingCloseConsumers.set(t.id,t),this._consumerCloseInProgress===!1&&this.closePendingConsumers())}),t.on("@pause",()=>{this._pendingResumeConsumers.has(t.id)&&this._pendingResumeConsumers.delete(t.id),this._pendingPauseConsumers.set(t.id,t),queueMicrotask(()=>{this._closed||this._consumerPauseInProgress===!1&&this.pausePendingConsumers()})}),t.on("@resume",()=>{this._pendingPauseConsumers.has(t.id)&&this._pendingPauseConsumers.delete(t.id),this._pendingResumeConsumers.set(t.id,t),queueMicrotask(()=>{this._closed||this._consumerResumeInProgress===!1&&this.resumePendingConsumers()})}),t.on("@getstats",(n,r)=>{if(this._closed)return r(new He.InvalidStateError("closed"));this._handler.getReceiverStats(t.localId).then(n).catch(r)})}handleDataProducer(t){t.on("@close",()=>{this._dataProducers.delete(t.id)})}handleDataConsumer(t){t.on("@close",()=>{this._dataConsumers.delete(t.id)})}}ic.Transport=Vb;var pc={},st={},Qv={},Kv={exports:{}},Zf=Kv.exports={v:[{name:"version",reg:/^(\d*)$/}],o:[{name:"origin",reg:/^(\S*) (\d*) (\d*) (\S*) IP(\d) (\S*)/,names:["username","sessionId","sessionVersion","netType","ipVer","address"],format:"%s %s %d %s IP%d %s"}],s:[{name:"name"}],i:[{name:"description"}],u:[{name:"uri"}],e:[{name:"email"}],p:[{name:"phone"}],z:[{name:"timezones"}],r:[{name:"repeats"}],t:[{name:"timing",reg:/^(\d*) (\d*)/,names:["start","stop"],format:"%d %d"}],c:[{name:"connection",reg:/^IN IP(\d) (\S*)/,names:["version","ip"],format:"IN IP%d %s"}],b:[{push:"bandwidth",reg:/^(TIAS|AS|CT|RR|RS):(\d*)/,names:["type","limit"],format:"%s:%s"}],m:[{reg:/^(\w*) (\d*) ([\w/]*)(?: (.*))?/,names:["type","port","protocol","payloads"],format:"%s %d %s %s"}],a:[{push:"rtp",reg:/^rtpmap:(\d*) ([\w\-.]*)(?:\s*\/(\d*)(?:\s*\/(\S*))?)?/,names:["payload","codec","rate","encoding"],format:function(e){return e.encoding?"rtpmap:%d %s/%s/%s":e.rate?"rtpmap:%d %s/%s":"rtpmap:%d %s"}},{push:"fmtp",reg:/^fmtp:(\d*) ([\S| ]*)/,names:["payload","config"],format:"fmtp:%d %s"},{name:"control",reg:/^control:(.*)/,format:"control:%s"},{name:"rtcp",reg:/^rtcp:(\d*)(?: (\S*) IP(\d) (\S*))?/,names:["port","netType","ipVer","address"],format:function(e){return e.address!=null?"rtcp:%d %s IP%d %s":"rtcp:%d"}},{push:"rtcpFbTrrInt",reg:/^rtcp-fb:(\*|\d*) trr-int (\d*)/,names:["payload","value"],format:"rtcp-fb:%s trr-int %d"},{push:"rtcpFb",reg:/^rtcp-fb:(\*|\d*) ([\w-_]*)(?: ([\w-_]*))?/,names:["payload","type","subtype"],format:function(e){return e.subtype!=null?"rtcp-fb:%s %s %s":"rtcp-fb:%s %s"}},{push:"ext",reg:/^extmap:(\d+)(?:\/(\w+))?(?: (urn:ietf:params:rtp-hdrext:encrypt))? (\S*)(?: (\S*))?/,names:["value","direction","encrypt-uri","uri","config"],format:function(e){return"extmap:%d"+(e.direction?"/%s":"%v")+(e["encrypt-uri"]?" %s":"%v")+" %s"+(e.config?" %s":"")}},{name:"extmapAllowMixed",reg:/^(extmap-allow-mixed)/},{push:"crypto",reg:/^crypto:(\d*) ([\w_]*) (\S*)(?: (\S*))?/,names:["id","suite","config","sessionConfig"],format:function(e){return e.sessionConfig!=null?"crypto:%d %s %s %s":"crypto:%d %s %s"}},{name:"setup",reg:/^setup:(\w*)/,format:"setup:%s"},{name:"connectionType",reg:/^connection:(new|existing)/,format:"connection:%s"},{name:"mid",reg:/^mid:([^\s]*)/,format:"mid:%s"},{name:"msid",reg:/^msid:(.*)/,format:"msid:%s"},{name:"ptime",reg:/^ptime:(\d*(?:\.\d*)*)/,format:"ptime:%d"},{name:"maxptime",reg:/^maxptime:(\d*(?:\.\d*)*)/,format:"maxptime:%d"},{name:"direction",reg:/^(sendrecv|recvonly|sendonly|inactive)/},{name:"icelite",reg:/^(ice-lite)/},{name:"iceUfrag",reg:/^ice-ufrag:(\S*)/,format:"ice-ufrag:%s"},{name:"icePwd",reg:/^ice-pwd:(\S*)/,format:"ice-pwd:%s"},{name:"fingerprint",reg:/^fingerprint:(\S*) (\S*)/,names:["type","hash"],format:"fingerprint:%s %s"},{push:"candidates",reg:/^candidate:(\S*) (\d*) (\S*) (\d*) (\S*) (\d*) typ (\S*)(?: raddr (\S*) rport (\d*))?(?: tcptype (\S*))?(?: generation (\d*))?(?: network-id (\d*))?(?: network-cost (\d*))?/,names:["foundation","component","transport","priority","ip","port","type","raddr","rport","tcptype","generation","network-id","network-cost"],format:function(e){var t="candidate:%s %d %s %d %s %d typ %s";return t+=e.raddr!=null?" raddr %s rport %d":"%v%v",t+=e.tcptype!=null?" tcptype %s":"%v",e.generation!=null&&(t+=" generation %d"),t+=e["network-id"]!=null?" network-id %d":"%v",t+=e["network-cost"]!=null?" network-cost %d":"%v",t}},{name:"endOfCandidates",reg:/^(end-of-candidates)/},{name:"remoteCandidates",reg:/^remote-candidates:(.*)/,format:"remote-candidates:%s"},{name:"iceOptions",reg:/^ice-options:(\S*)/,format:"ice-options:%s"},{push:"ssrcs",reg:/^ssrc:(\d*) ([\w_-]*)(?::(.*))?/,names:["id","attribute","value"],format:function(e){var t="ssrc:%d";return e.attribute!=null&&(t+=" %s",e.value!=null&&(t+=":%s")),t}},{push:"ssrcGroups",reg:/^ssrc-group:([\x21\x23\x24\x25\x26\x27\x2A\x2B\x2D\x2E\w]*) (.*)/,names:["semantics","ssrcs"],format:"ssrc-group:%s %s"},{name:"msidSemantic",reg:/^msid-semantic:\s?(\w*) (\S*)/,names:["semantic","token"],format:"msid-semantic: %s %s"},{push:"groups",reg:/^group:(\w*) (.*)/,names:["type","mids"],format:"group:%s %s"},{name:"rtcpMux",reg:/^(rtcp-mux)/},{name:"rtcpRsize",reg:/^(rtcp-rsize)/},{name:"sctpmap",reg:/^sctpmap:([\w_/]*) (\S*)(?: (\S*))?/,names:["sctpmapNumber","app","maxMessageSize"],format:function(e){return e.maxMessageSize!=null?"sctpmap:%s %s %s":"sctpmap:%s %s"}},{name:"xGoogleFlag",reg:/^x-google-flag:([^\s]*)/,format:"x-google-flag:%s"},{push:"rids",reg:/^rid:([\d\w]+) (\w+)(?: ([\S| ]*))?/,names:["id","direction","params"],format:function(e){return e.params?"rid:%s %s %s":"rid:%s %s"}},{push:"imageattrs",reg:new RegExp("^imageattr:(\\d+|\\*)[\\s\\t]+(send|recv)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*)(?:[\\s\\t]+(recv|send)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*))?"),names:["pt","dir1","attrs1","dir2","attrs2"],format:function(e){return"imageattr:%s %s %s"+(e.dir2?" %s %s":"")}},{name:"simulcast",reg:new RegExp("^simulcast:(send|recv) ([a-zA-Z0-9\\-_~;,]+)(?:\\s?(send|recv) ([a-zA-Z0-9\\-_~;,]+))?$"),names:["dir1","list1","dir2","list2"],format:function(e){return"simulcast:%s %s"+(e.dir2?" %s %s":"")}},{name:"simulcast_03",reg:/^simulcast:[\s\t]+([\S+\s\t]+)$/,names:["value"],format:"simulcast: %s"},{name:"framerate",reg:/^framerate:(\d+(?:$|\.\d+))/,format:"framerate:%s"},{name:"sourceFilter",reg:/^source-filter: *(excl|incl) (\S*) (IP4|IP6|\*) (\S*) (.*)/,names:["filterMode","netType","addressTypes","destAddress","srcList"],format:"source-filter: %s %s %s %s %s"},{name:"bundleOnly",reg:/^(bundle-only)/},{name:"label",reg:/^label:(.+)/,format:"label:%s"},{name:"sctpPort",reg:/^sctp-port:(\d+)$/,format:"sctp-port:%s"},{name:"maxMessageSize",reg:/^max-message-size:(\d+)$/,format:"max-message-size:%s"},{push:"tsRefClocks",reg:/^ts-refclk:([^\s=]*)(?:=(\S*))?/,names:["clksrc","clksrcExt"],format:function(e){return"ts-refclk:%s"+(e.clksrcExt!=null?"=%s":"")}},{name:"mediaClk",reg:/^mediaclk:(?:id=(\S*))? *([^\s=]*)(?:=(\S*))?(?: *rate=(\d+)\/(\d+))?/,names:["id","mediaClockName","mediaClockValue","rateNumerator","rateDenominator"],format:function(e){var t="mediaclk:";return t+=e.id!=null?"id=%s %s":"%v%s",t+=e.mediaClockValue!=null?"=%s":"",t+=e.rateNumerator!=null?" rate=%s":"",t+=e.rateDenominator!=null?"/%s":"",t}},{name:"keywords",reg:/^keywds:(.+)$/,format:"keywds:%s"},{name:"content",reg:/^content:(.+)/,format:"content:%s"},{name:"bfcpFloorCtrl",reg:/^floorctrl:(c-only|s-only|c-s)/,format:"floorctrl:%s"},{name:"bfcpConfId",reg:/^confid:(\d+)/,format:"confid:%s"},{name:"bfcpUserId",reg:/^userid:(\d+)/,format:"userid:%s"},{name:"bfcpFloorId",reg:/^floorid:(.+) (?:m-stream|mstrm):(.+)/,names:["id","mStream"],format:"floorid:%s mstrm:%s"},{push:"invalid",names:["value"]}]};Object.keys(Zf).forEach(function(e){var t=Zf[e];t.forEach(function(n){n.reg||(n.reg=/(.*)/),n.format||(n.format="%s")})});var Fu=Kv.exports;(function(e){var t=function(a){return String(Number(a))===a?Number(a):a},n=function(a,c,l,d){if(d&&!l)c[d]=t(a[1]);else for(var u=0;u<l.length;u+=1)a[u+1]!=null&&(c[l[u]]=t(a[u+1]))},r=function(a,c,l){var d=a.name&&a.names;a.push&&!c[a.push]?c[a.push]=[]:d&&!c[a.name]&&(c[a.name]={});var u=a.push?{}:d?c[a.name]:c;n(l.match(a.reg),u,a.names,a.name),a.push&&c[a.push].push(u)},s=Fu,i=RegExp.prototype.test.bind(/^([a-z])=(.*)/);e.parse=function(a){var c={},l=[],d=c;return a.split(/(\r\n|\r|\n)/).filter(i).forEach(function(u){var f=u[0],h=u.slice(2);f==="m"&&(l.push({rtp:[],fmtp:[]}),d=l[l.length-1]);for(var v=0;v<(s[f]||[]).length;v+=1){var y=s[f][v];if(y.reg.test(h))return r(y,d,h)}}),c.media=l,c};var o=function(a,c){var l=c.split(/=(.+)/,2);return l.length===2?a[l[0]]=t(l[1]):l.length===1&&c.length>1&&(a[l[0]]=void 0),a};e.parseParams=function(a){return a.split(/;\s?/).reduce(o,{})},e.parseFmtpConfig=e.parseParams,e.parsePayloads=function(a){return a.toString().split(" ").map(Number)},e.parseRemoteCandidates=function(a){for(var c=[],l=a.split(" ").map(t),d=0;d<l.length;d+=3)c.push({component:l[d],ip:l[d+1],port:l[d+2]});return c},e.parseImageAttributes=function(a){return a.split(" ").map(function(c){return c.substring(1,c.length-1).split(",").reduce(o,{})})},e.parseSimulcastStreamList=function(a){return a.split(";").map(function(c){return c.split(",").map(function(l){var d,u=!1;return l[0]!=="~"?d=t(l):(d=t(l.substring(1,l.length)),u=!0),{scid:d,paused:u}})})}})(Qv);var al=Fu,Wb=/%[sdv%]/g,Hb=function(e){var t=1,n=arguments,r=n.length;return e.replace(Wb,function(s){if(t>=r)return s;var i=n[t];switch(t+=1,s){case"%%":return"%";case"%s":return String(i);case"%d":return Number(i);case"%v":return""}})},ti=function(e,t,n){var r=t.format instanceof Function?t.format(t.push?n:n[t.name]):t.format,s=[e+"="+r];if(t.names)for(var i=0;i<t.names.length;i+=1){var o=t.names[i];t.name?s.push(n[t.name][o]):s.push(n[t.names[i]])}else s.push(n[t.name]);return Hb.apply(null,s)},Qb=["v","o","s","i","u","e","p","c","b","t","r","z","a"],Kb=["i","c","b","a"],qb=function(e,t){t=t||{},e.version==null&&(e.version=0),e.name==null&&(e.name=" "),e.media.forEach(function(i){i.payloads==null&&(i.payloads="")});var n=t.outerOrder||Qb,r=t.innerOrder||Kb,s=[];return n.forEach(function(i){al[i].forEach(function(o){o.name in e&&e[o.name]!=null?s.push(ti(i,o,e)):o.push in e&&e[o.push]!=null&&e[o.push].forEach(function(a){s.push(ti(i,o,a))})})}),e.media.forEach(function(i){s.push(ti("m",al.m[0],i)),r.forEach(function(o){al[o].forEach(function(a){a.name in i&&i[a.name]!=null?s.push(ti(o,a,i)):a.push in i&&i[a.push]!=null&&i[a.push].forEach(function(c){s.push(ti(o,a,c))})})})}),s.join(`\r
`)+`\r
`},Vr=Qv,Gb=qb,Xb=Fu;st.grammar=Xb;st.write=Gb;st.parse=Vr.parse;st.parseParams=Vr.parseParams;st.parseFmtpConfig=Vr.parseFmtpConfig;st.parsePayloads=Vr.parsePayloads;st.parseRemoteCandidates=Vr.parseRemoteCandidates;st.parseImageAttributes=Vr.parseImageAttributes;st.parseSimulcastStreamList=Vr.parseSimulcastStreamList;var _r={};Object.defineProperty(_r,"__esModule",{value:!0});_r.parse=Jb;const Yb=new RegExp("^[LS]([1-9]\\d{0,1})T([1-9]\\d{0,1})");function Jb(e){const t=Yb.exec(e??"");return t?{spatialLayers:Number(t[1]),temporalLayers:Number(t[2])}:{spatialLayers:1,temporalLayers:1}}var bn={};Object.defineProperty(bn,"__esModule",{value:!0});bn.extractRtpCapabilities=Zb;bn.extractDtlsParameters=eC;bn.getCname=tC;bn.applyCodecParameters=nC;const qv=st;function Zb({sdpObject:e}){const t=new Map,n=new Map;for(const s of e.media){const i=s.type;switch(i){case"audio":case"video":break;default:continue}for(const o of s.rtp){const a={kind:i,mimeType:`${i}/${o.codec}`,preferredPayloadType:o.payload,clockRate:o.rate,channels:o.encoding,parameters:{},rtcpFeedback:[]};t.set(a.preferredPayloadType,a)}for(const o of s.fmtp??[]){const a=qv.parseParams(o.config),c=t.get(o.payload);c&&(a?.hasOwnProperty("profile-level-id")&&(a["profile-level-id"]=String(a["profile-level-id"])),c.parameters=a)}for(const o of s.rtcpFb??[]){const a={type:o.type,parameter:o.subtype};if(a.parameter||delete a.parameter,o.payload!=="*"){const c=t.get(Number(o.payload));if(!c)continue;c.rtcpFeedback.push(a)}else for(const c of t.values())c.kind===i&&!/.+\/rtx$/i.test(c.mimeType)&&c.rtcpFeedback.push(a)}for(const o of s.ext??[]){if(o["encrypt-uri"])continue;const a={kind:i,uri:o.uri,preferredId:o.value};n.set(a.preferredId,a)}}return{codecs:Array.from(t.values()),headerExtensions:Array.from(n.values())}}function eC({sdpObject:e}){let t=e.setup,n=e.fingerprint;if(!t||!n){const i=(e.media??[]).find(o=>o.port!==0);i&&(t??=i.setup,n??=i.fingerprint)}if(t){if(!n)throw new Error("no a=fingerprint found at SDP session or media level")}else throw new Error("no a=setup found at SDP session or media level");let r;switch(t){case"active":{r="client";break}case"passive":{r="server";break}case"actpass":{r="auto";break}}return{role:r,fingerprints:[{algorithm:n.type,value:n.hash}]}}function tC({offerMediaObject:e}){const t=(e.ssrcs??[]).find(n=>n.attribute==="cname");return t?t.value:""}function nC({offerRtpParameters:e,answerMediaObject:t}){for(const n of e.codecs){const r=n.mimeType.toLowerCase();if(r!=="audio/opus"||!(t.rtp??[]).find(a=>a.payload===n.payloadType))continue;t.fmtp=t.fmtp??[];let i=t.fmtp.find(a=>a.payload===n.payloadType);i||(i={payload:n.payloadType,config:""},t.fmtp.push(i));const o=qv.parseParams(i.config);switch(r){case"audio/opus":{const a=n.parameters?.["sprop-stereo"];a!==void 0&&(o.stereo=Number(a)?1:0);break}}i.config="";for(const a of Object.keys(o))i.config&&(i.config+=";"),i.config+=`${a}=${o[a]}`}}var Sr={};Object.defineProperty(Sr,"__esModule",{value:!0});Sr.getRtpEncodings=rC;Sr.addLegacySimulcast=sC;function rC({offerMediaObject:e}){const t=new Set;for(const s of e.ssrcs??[]){const i=s.id;i&&t.add(i)}if(t.size===0)throw new Error("no a=ssrc lines found");const n=new Map;for(const s of e.ssrcGroups??[]){if(s.semantics!=="FID")continue;const i=s.ssrcs.split(/\s+/),o=Number(i[0]),a=Number(i[1]);t.has(o)&&(t.delete(o),t.delete(a),n.set(o,a))}for(const s of t)n.set(s,void 0);const r=[];for(const[s,i]of n){const o={ssrc:s};i&&(o.rtx={ssrc:i}),r.push(o)}return r}function sC({offerMediaObject:e,numStreams:t}){if(t<=1)throw new TypeError("numStreams must be greater than 1");const n=(e.ssrcs??[]).find(u=>u.attribute==="msid");if(!n)throw new Error("a=ssrc line with msid information not found");const[r,s]=n.value.split(" "),i=Number(n.id);let o;(e.ssrcGroups??[]).some(u=>{if(u.semantics!=="FID")return!1;const f=u.ssrcs.split(/\s+/);return Number(f[0])===i?(o=Number(f[1]),!0):!1});const a=(e.ssrcs??[]).find(u=>u.attribute==="cname");if(!a)throw new Error("a=ssrc line with cname information not found");const c=a.value,l=[],d=[];for(let u=0;u<t;++u)l.push(i+u),o&&d.push(o+u);e.ssrcGroups=[],e.ssrcs=[],e.ssrcGroups.push({semantics:"SIM",ssrcs:l.join(" ")});for(const u of l)e.ssrcs.push({id:u,attribute:"cname",value:c}),e.ssrcs.push({id:u,attribute:"msid",value:`${r} ${s}`});for(let u=0;u<d.length;++u){const f=l[u],h=d[u];e.ssrcs.push({id:h,attribute:"cname",value:c}),e.ssrcs.push({id:h,attribute:"msid",value:`${r} ${s}`}),e.ssrcGroups.push({semantics:"FID",ssrcs:`${f} ${h}`})}}var Fs={};Object.defineProperty(Fs,"__esModule",{value:!0});Fs.addNackSupportForOpus=iC;function iC(e){for(const t of e.codecs??[])(t.mimeType.toLowerCase()==="audio/opus"||t.mimeType.toLowerCase()==="audio/multiopus")&&!t.rtcpFeedback?.some(n=>n.type==="nack"&&!n.parameter)&&(t.rtcpFeedback||(t.rtcpFeedback=[]),t.rtcpFeedback.push({type:"nack"}))}var xr={},pr={};Object.defineProperty(pr,"__esModule",{value:!0});pr.OfferMediaSection=pr.AnswerMediaSection=pr.MediaSection=void 0;const oC=st,eh=xn;class zu{_mediaObject;constructor({iceParameters:t,iceCandidates:n,dtlsParameters:r}){if(this._mediaObject={type:"",port:0,protocol:"",payloads:"",rtp:[],fmtp:[]},t&&this.setIceParameters(t),n){this._mediaObject.candidates=[];for(const s of n){const i={foundation:s.foundation,component:1,ip:s.address??s.ip,port:s.port,priority:s.priority,transport:s.protocol,type:s.type};s.tcpType&&(i.tcptype=s.tcpType),this._mediaObject.candidates.push(i)}this._mediaObject.endOfCandidates="end-of-candidates",this._mediaObject.iceOptions="renomination"}r&&this.setDtlsRole(r.role)}get mid(){return String(this._mediaObject.mid)}get closed(){return this._mediaObject.port===0}getObject(){return this._mediaObject}setIceParameters(t){this._mediaObject.iceUfrag=t.usernameFragment,this._mediaObject.icePwd=t.password}pause(){this._mediaObject.direction="inactive"}disable(){this.pause(),delete this._mediaObject.ext,delete this._mediaObject.ssrcs,delete this._mediaObject.ssrcGroups,delete this._mediaObject.simulcast,delete this._mediaObject.simulcast_03,delete this._mediaObject.rids,delete this._mediaObject.extmapAllowMixed}close(){this.disable(),this._mediaObject.port=0}}pr.MediaSection=zu;class aC extends zu{constructor({iceParameters:t,iceCandidates:n,dtlsParameters:r,sctpParameters:s,plainRtpParameters:i,offerMediaObject:o,offerRtpParameters:a,answerRtpParameters:c,codecOptions:l}){switch(super({iceParameters:t,iceCandidates:n,dtlsParameters:r}),this._mediaObject.mid=String(o.mid),this._mediaObject.type=o.type,this._mediaObject.protocol=o.protocol,i?(this._mediaObject.connection={ip:i.ip,version:i.ipVersion},this._mediaObject.port=i.port):(this._mediaObject.connection={ip:"127.0.0.1",version:4},this._mediaObject.port=7),o.type){case"audio":case"video":{this._mediaObject.direction="recvonly",this._mediaObject.rtp=[],this._mediaObject.rtcpFb=[],this._mediaObject.fmtp=[];for(const d of c.codecs){const u={payload:d.payloadType,codec:Gv(d),rate:d.clockRate};d.channels>1&&(u.encoding=d.channels),this._mediaObject.rtp.push(u);const f=eh.clone(d.parameters)??{};let h=eh.clone(d.rtcpFeedback)??[];if(l){const{opusStereo:y,opusFec:x,opusDtx:g,opusMaxPlaybackRate:m,opusMaxAverageBitrate:w,opusPtime:C,opusNack:L,videoGoogleStartBitrate:A,videoGoogleMaxBitrate:F,videoGoogleMinBitrate:D}=l,B=a.codecs.find(M=>M.payloadType===d.payloadType);switch(d.mimeType.toLowerCase()){case"audio/opus":case"audio/multiopus":{y!==void 0&&(B.parameters["sprop-stereo"]=y?1:0,f.stereo=y?1:0),x!==void 0&&(B.parameters.useinbandfec=x?1:0,f.useinbandfec=x?1:0),g!==void 0&&(B.parameters.usedtx=g?1:0,f.usedtx=g?1:0),m!==void 0&&(f.maxplaybackrate=m),w!==void 0&&(f.maxaveragebitrate=w),C!==void 0&&(B.parameters.ptime=C,f.ptime=C),L||(B.rtcpFeedback=B.rtcpFeedback.filter(M=>M.type!=="nack"||M.parameter),h=h.filter(M=>M.type!=="nack"||M.parameter));break}case"video/vp8":case"video/vp9":case"video/h264":case"video/h265":case"video/av1":{A!==void 0&&(f["x-google-start-bitrate"]=A),F!==void 0&&(f["x-google-max-bitrate"]=F),D!==void 0&&(f["x-google-min-bitrate"]=D);break}}}const v={payload:d.payloadType,config:""};for(const y of Object.keys(f))v.config&&(v.config+=";"),v.config+=`${y}=${f[y]}`;v.config&&this._mediaObject.fmtp.push(v);for(const y of h)this._mediaObject.rtcpFb.push({payload:d.payloadType,type:y.type,subtype:y.parameter})}this._mediaObject.payloads=c.codecs.map(d=>d.payloadType).join(" "),this._mediaObject.ext=[];for(const d of c.headerExtensions)(o.ext??[]).some(f=>f.uri===d.uri)&&this._mediaObject.ext.push({uri:d.uri,value:d.id});if(o.extmapAllowMixed==="extmap-allow-mixed"&&(this._mediaObject.extmapAllowMixed="extmap-allow-mixed"),o.simulcast){this._mediaObject.simulcast={dir1:"recv",list1:o.simulcast.list1},this._mediaObject.rids=[];for(const d of o.rids??[])d.direction==="send"&&this._mediaObject.rids.push({id:d.id,direction:"recv"})}else if(o.simulcast_03){this._mediaObject.simulcast_03={value:o.simulcast_03.value.replace(/send/g,"recv")},this._mediaObject.rids=[];for(const d of o.rids??[])d.direction==="send"&&this._mediaObject.rids.push({id:d.id,direction:"recv"})}this._mediaObject.rtcpMux="rtcp-mux",this._mediaObject.rtcpRsize="rtcp-rsize";break}case"application":{typeof o.sctpPort=="number"?(this._mediaObject.payloads="webrtc-datachannel",this._mediaObject.sctpPort=s.port,this._mediaObject.maxMessageSize=s.maxMessageSize):o.sctpmap&&(this._mediaObject.payloads=String(s.port),this._mediaObject.sctpmap={app:"webrtc-datachannel",sctpmapNumber:s.port,maxMessageSize:s.maxMessageSize});break}}}setDtlsRole(t){switch(t){case"client":{this._mediaObject.setup="active";break}case"server":{this._mediaObject.setup="passive";break}case"auto":{this._mediaObject.setup="actpass";break}}}resume(){this._mediaObject.direction="recvonly"}muxSimulcastStreams(t){if(!this._mediaObject.simulcast?.list1)return;const n={};for(const i of t)i.rid&&(n[i.rid]=i);const r=this._mediaObject.simulcast.list1,s=oC.parseSimulcastStreamList(r);for(const i of s)for(const o of i)o.paused=!n[o.scid]?.active;this._mediaObject.simulcast.list1=s.map(i=>i.map(o=>`${o.paused?"~":""}${o.scid}`).join(",")).join(";")}}pr.AnswerMediaSection=aC;class cC extends zu{constructor({iceParameters:t,iceCandidates:n,dtlsParameters:r,sctpParameters:s,plainRtpParameters:i,mid:o,kind:a,offerRtpParameters:c,streamId:l,trackId:d}){switch(super({iceParameters:t,iceCandidates:n,dtlsParameters:r}),this._mediaObject.mid=String(o),this._mediaObject.type=a,i?(this._mediaObject.connection={ip:i.ip,version:i.ipVersion},this._mediaObject.protocol="RTP/AVP",this._mediaObject.port=i.port):(this._mediaObject.connection={ip:"127.0.0.1",version:4},s?this._mediaObject.protocol="UDP/DTLS/SCTP":this._mediaObject.protocol="UDP/TLS/RTP/SAVPF",this._mediaObject.port=7),this._mediaObject.extmapAllowMixed="extmap-allow-mixed",a){case"audio":case"video":{this._mediaObject.direction="sendonly",this._mediaObject.rtp=[],this._mediaObject.rtcpFb=[],this._mediaObject.fmtp=[],this._mediaObject.msid=`${l??"-"} ${d}`;for(const v of c.codecs){const y={payload:v.payloadType,codec:Gv(v),rate:v.clockRate};v.channels>1&&(y.encoding=v.channels),this._mediaObject.rtp.push(y);const x={payload:v.payloadType,config:""};for(const g of Object.keys(v.parameters??{}))x.config&&(x.config+=";"),x.config+=`${g}=${v.parameters[g]}`;x.config&&this._mediaObject.fmtp.push(x);for(const g of v.rtcpFeedback)this._mediaObject.rtcpFb.push({payload:v.payloadType,type:g.type,subtype:g.parameter})}this._mediaObject.payloads=c.codecs.map(v=>v.payloadType).join(" "),this._mediaObject.ext=[];for(const v of c.headerExtensions)this._mediaObject.ext.push({uri:v.uri,value:v.id});this._mediaObject.rtcpMux="rtcp-mux",this._mediaObject.rtcpRsize="rtcp-rsize";const u=c.encodings[0],f=u.ssrc,h=u.rtx?.ssrc;this._mediaObject.ssrcs=[],this._mediaObject.ssrcGroups=[],f&&c.rtcp.cname&&this._mediaObject.ssrcs.push({id:f,attribute:"cname",value:c.rtcp.cname}),h&&(c.rtcp.cname&&this._mediaObject.ssrcs.push({id:h,attribute:"cname",value:c.rtcp.cname}),f&&this._mediaObject.ssrcGroups.push({semantics:"FID",ssrcs:`${f} ${h}`}));break}case"application":{this._mediaObject.payloads="webrtc-datachannel",this._mediaObject.sctpPort=s.port,this._mediaObject.maxMessageSize=s.maxMessageSize;break}}}setDtlsRole(t){this._mediaObject.setup="actpass"}resume(){this._mediaObject.direction="sendonly"}}pr.OfferMediaSection=cC;function Gv(e){const n=new RegExp("^(audio|video)/(.+)","i").exec(e.mimeType);if(!n)throw new TypeError("invalid codec.mimeType");return n[2]}Object.defineProperty(xr,"__esModule",{value:!0});xr.RemoteSdp=void 0;const lC=st,dC=rt,Po=pr,uC=["av1","h264"],jo=new dC.Logger("RemoteSdp");class pC{_iceParameters;_iceCandidates;_dtlsParameters;_sctpParameters;_plainRtpParameters;_mediaSections=[];_midToIndex=new Map;_firstMid;_sdpObject;constructor({iceParameters:t,iceCandidates:n,dtlsParameters:r,sctpParameters:s,plainRtpParameters:i}){if(this._iceParameters=t,this._iceCandidates=n,this._dtlsParameters=r,this._sctpParameters=s,this._plainRtpParameters=i,this._sdpObject={version:0,origin:{address:"0.0.0.0",ipVer:4,netType:"IN",sessionId:"10000",sessionVersion:0,username:"mediasoup-client"},name:"-",timing:{start:0,stop:0},media:[]},t?.iceLite&&(this._sdpObject.icelite="ice-lite"),r){this._sdpObject.msidSemantic={semantic:"WMS",token:"*"};const o=this._dtlsParameters.fingerprints.length;this._sdpObject.fingerprint={type:r.fingerprints[o-1].algorithm,hash:r.fingerprints[o-1].value},this._sdpObject.groups=[{type:"BUNDLE",mids:""}]}i&&(this._sdpObject.origin.address=i.ip,this._sdpObject.origin.ipVer=i.ipVersion)}updateIceParameters(t){jo.debug("updateIceParameters() [iceParameters:%o]",t),this._iceParameters=t,this._sdpObject.icelite=t.iceLite?"ice-lite":void 0;for(const n of this._mediaSections)n.setIceParameters(t)}updateDtlsRole(t){jo.debug("updateDtlsRole() [role:%s]",t),this._dtlsParameters.role=t;for(const n of this._mediaSections)n.setDtlsRole(t)}setSessionExtmapAllowMixed(){jo.debug("setSessionExtmapAllowMixed()"),this._sdpObject.extmapAllowMixed="extmap-allow-mixed"}getNextMediaSectionIdx(){for(let t=0;t<this._mediaSections.length;++t){const n=this._mediaSections[t];if(n.closed)return{idx:t,reuseMid:n.mid}}return{idx:this._mediaSections.length}}send({offerMediaObject:t,reuseMid:n,offerRtpParameters:r,answerRtpParameters:s,codecOptions:i}){const o=new Po.AnswerMediaSection({iceParameters:this._iceParameters,iceCandidates:this._iceCandidates,dtlsParameters:this._dtlsParameters,plainRtpParameters:this._plainRtpParameters,offerMediaObject:t,offerRtpParameters:r,answerRtpParameters:s,codecOptions:i}),a=o.getObject();a.rtp.find(l=>uC.includes(l.codec.toLowerCase()))||(a.ext=a.ext?.filter(l=>l.uri!=="https://aomediacodec.github.io/av1-rtp-spec/#dependency-descriptor-rtp-header-extension")),n?this._replaceMediaSection(o,n):this._midToIndex.has(o.mid)?this._replaceMediaSection(o):this._addMediaSection(o)}receive({mid:t,kind:n,offerRtpParameters:r,streamId:s,trackId:i}){this.setSessionExtmapAllowMixed();const o=new Po.OfferMediaSection({iceParameters:this._iceParameters,iceCandidates:this._iceCandidates,dtlsParameters:this._dtlsParameters,plainRtpParameters:this._plainRtpParameters,mid:t,kind:n,offerRtpParameters:r,streamId:s,trackId:i}),a=this._mediaSections.find(c=>c.closed);a?this._replaceMediaSection(o,a.mid):this._addMediaSection(o)}pauseMediaSection(t){this._findMediaSection(t).pause()}resumeSendingMediaSection(t){this._findMediaSection(t).resume()}resumeReceivingMediaSection(t){this._findMediaSection(t).resume()}disableMediaSection(t){this._findMediaSection(t).disable()}closeMediaSection(t){const n=this._findMediaSection(t);return t===this._firstMid?(jo.debug("closeMediaSection() | cannot close first media section, disabling it instead [mid:%s]",t),this.disableMediaSection(t),!1):(n.close(),this._regenerateBundleMids(),!0)}muxMediaSectionSimulcast(t,n){const r=this._findMediaSection(t);r.muxSimulcastStreams(n),this._replaceMediaSection(r)}sendSctpAssociation({offerMediaObject:t}){const n=new Po.AnswerMediaSection({iceParameters:this._iceParameters,iceCandidates:this._iceCandidates,dtlsParameters:this._dtlsParameters,sctpParameters:this._sctpParameters,plainRtpParameters:this._plainRtpParameters,offerMediaObject:t});this._addMediaSection(n)}receiveSctpAssociation(){const t=new Po.OfferMediaSection({iceParameters:this._iceParameters,iceCandidates:this._iceCandidates,dtlsParameters:this._dtlsParameters,sctpParameters:this._sctpParameters,plainRtpParameters:this._plainRtpParameters,mid:"datachannel",kind:"application"});this._addMediaSection(t)}getSdp(){return this._sdpObject.origin.sessionVersion++,lC.write(this._sdpObject)}_addMediaSection(t){this._firstMid||(this._firstMid=t.mid),this._mediaSections.push(t),this._midToIndex.set(t.mid,this._mediaSections.length-1),this._sdpObject.media.push(t.getObject()),this._regenerateBundleMids()}_replaceMediaSection(t,n){if(typeof n=="string"){const r=this._midToIndex.get(n);if(r===void 0)throw new Error(`no media section found for reuseMid '${n}'`);const s=this._mediaSections[r];this._mediaSections[r]=t,this._midToIndex.delete(s.mid),this._midToIndex.set(t.mid,r),this._sdpObject.media[r]=t.getObject(),this._regenerateBundleMids()}else{const r=this._midToIndex.get(t.mid);if(r===void 0)throw new Error(`no media section found with mid '${t.mid}'`);this._mediaSections[r]=t,this._sdpObject.media[r]=t.getObject()}}_findMediaSection(t){const n=this._midToIndex.get(t);if(n===void 0)throw new Error(`no media section found with mid '${t}'`);return this._mediaSections[n]}_regenerateBundleMids(){this._dtlsParameters&&(this._sdpObject.groups[0].mids=this._mediaSections.filter(t=>!t.closed).map(t=>t.mid).join(" "))}}xr.RemoteSdp=pC;Object.defineProperty(pc,"__esModule",{value:!0});pc.Chrome111=void 0;const Qn=st,fC=gt,hC=rt,ni=Oe,mC=mt,gC=_r,Lo=bn,th=Sr,vC=Fs,yC=xr,ce=new hC.Logger("Chrome111"),nh="Chrome111",rh={OS:1024,MIS:1024};class bi extends fC.EnhancedEventEmitter{_closed=!1;_direction;_remoteSdp;_getSendExtendedRtpCapabilities;_forcedLocalDtlsRole;_pc;_mapMidTransceiver=new Map;_sendStream=new MediaStream;_hasDataChannelMediaSection=!1;_nextSendSctpStreamId=0;_transportReady=!1;static createFactory(){return{name:nh,factory:t=>new bi(t),getNativeRtpCapabilities:async()=>{ce.debug("getNativeRtpCapabilities()");let t=new RTCPeerConnection({iceServers:[],iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require"});try{t.addTransceiver("audio"),t.addTransceiver("video",{sendEncodings:[{scalabilityMode:"L3T3"}]});const n=await t.createOffer();try{t.close()}catch{}t=void 0;const r=Qn.parse(n.sdp);return bi.getLocalRtpCapabilities(r)}catch(n){try{t?.close()}catch{}throw t=void 0,n}},getNativeSctpCapabilities:async()=>(ce.debug("getNativeSctpCapabilities()"),{numStreams:rh})}}static getLocalRtpCapabilities(t){const n=Lo.extractRtpCapabilities({sdpObject:t});return ni.validateAndNormalizeRtpCapabilities(n),vC.addNackSupportForOpus(n),n}constructor({direction:t,iceParameters:n,iceCandidates:r,dtlsParameters:s,sctpParameters:i,iceServers:o,iceTransportPolicy:a,additionalSettings:c,getSendExtendedRtpCapabilities:l}){super(),ce.debug("constructor()"),this._direction=t,this._remoteSdp=new yC.RemoteSdp({iceParameters:n,iceCandidates:r,dtlsParameters:s,sctpParameters:i}),this._getSendExtendedRtpCapabilities=l,s.role&&s.role!=="auto"&&(this._forcedLocalDtlsRole=s.role==="server"?"client":"server"),this._pc=new RTCPeerConnection({iceServers:o??[],iceTransportPolicy:a??"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",...c}),this._pc.addEventListener("icegatheringstatechange",this.onIceGatheringStateChange),this._pc.addEventListener("icecandidateerror",this.onIceCandidateError),this._pc.connectionState?this._pc.addEventListener("connectionstatechange",this.onConnectionStateChange):(ce.warn("run() | pc.connectionState not supported, using pc.iceConnectionState"),this._pc.addEventListener("iceconnectionstatechange",this.onIceConnectionStateChange))}get name(){return nh}close(){if(ce.debug("close()"),!this._closed){this._closed=!0;try{this._pc.close()}catch{}this._pc.removeEventListener("icegatheringstatechange",this.onIceGatheringStateChange),this._pc.removeEventListener("icecandidateerror",this.onIceCandidateError),this._pc.removeEventListener("connectionstatechange",this.onConnectionStateChange),this._pc.removeEventListener("iceconnectionstatechange",this.onIceConnectionStateChange),this.emit("@close"),super.close()}}async updateIceServers(t){this.assertNotClosed(),ce.debug("updateIceServers()");const n=this._pc.getConfiguration();n.iceServers=t,this._pc.setConfiguration(n)}async restartIce(t){if(this.assertNotClosed(),ce.debug("restartIce()"),this._remoteSdp.updateIceParameters(t),!!this._transportReady)if(this._direction==="send"){const n=await this._pc.createOffer({iceRestart:!0});ce.debug("restartIce() | calling pc.setLocalDescription() [offer:%o]",n),await this._pc.setLocalDescription(n);const r={type:"answer",sdp:this._remoteSdp.getSdp()};ce.debug("restartIce() | calling pc.setRemoteDescription() [answer:%o]",r),await this._pc.setRemoteDescription(r)}else{const n={type:"offer",sdp:this._remoteSdp.getSdp()};ce.debug("restartIce() | calling pc.setRemoteDescription() [offer:%o]",n),await this._pc.setRemoteDescription(n);const r=await this._pc.createAnswer();ce.debug("restartIce() | calling pc.setLocalDescription() [answer:%o]",r),await this._pc.setLocalDescription(r)}}async getTransportStats(){return this.assertNotClosed(),this._pc.getStats()}async send({track:t,encodings:n,codecOptions:r,codec:s,onRtpSender:i}){if(this.assertNotClosed(),this.assertSendDirection(),ce.debug("send() [kind:%s, track.id:%s]",t.kind,t.id),n&&n.length>1){let g=1;for(const m of n){const w=m.scalabilityMode?(0,gC.parse)(m.scalabilityMode).temporalLayers:3;w>g&&(g=w)}n.forEach((m,w)=>{m.rid=`r${w}`,m.scalabilityMode=`L1T${g}`})}const o=this._remoteSdp.getNextMediaSectionIdx(),a=this._pc.addTransceiver(t,{direction:"sendonly",streams:[this._sendStream],sendEncodings:n});i&&i(a.sender);const c=await this._pc.createOffer();let l=Qn.parse(c.sdp);l.extmapAllowMixed&&this._remoteSdp.setSessionExtmapAllowMixed();const d=bi.getLocalRtpCapabilities(l),u=this._getSendExtendedRtpCapabilities(d),f=ni.getSendingRtpParameters(t.kind,u);f.codecs=ni.reduceCodecs(f.codecs,s);const h=ni.getSendingRemoteRtpParameters(t.kind,u);h.codecs=ni.reduceCodecs(h.codecs,s),this._transportReady||await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:l}),ce.debug("send() | calling pc.setLocalDescription() [offer:%o]",c),await this._pc.setLocalDescription(c);const v=a.mid;f.mid=v,l=Qn.parse(this._pc.localDescription.sdp);const y=l.media[o.idx];if(f.rtcp.cname=Lo.getCname({offerMediaObject:y}),!n)f.encodings=th.getRtpEncodings({offerMediaObject:y});else if(n.length===1){const g=th.getRtpEncodings({offerMediaObject:y});Object.assign(g[0],n[0]),f.encodings=g}else f.encodings=n;this._remoteSdp.send({offerMediaObject:y,reuseMid:o.reuseMid,offerRtpParameters:f,answerRtpParameters:h,codecOptions:r});const x={type:"answer",sdp:this._remoteSdp.getSdp()};return ce.debug("send() | calling pc.setRemoteDescription() [answer:%o]",x),await this._pc.setRemoteDescription(x),this._mapMidTransceiver.set(v,a),{localId:v,rtpParameters:f,rtpSender:a.sender}}async stopSending(t){if(this.assertSendDirection(),ce.debug("stopSending() [localId:%s]",t),this._closed)return;const n=this._mapMidTransceiver.get(t);if(!n)throw new Error("associated RTCRtpTransceiver not found");if(n.sender.replaceTrack(null),this._pc.removeTrack(n.sender),this._remoteSdp.closeMediaSection(n.mid))try{n.stop()}catch{}const s=await this._pc.createOffer();ce.debug("stopSending() | calling pc.setLocalDescription() [offer:%o]",s),await this._pc.setLocalDescription(s);const i={type:"answer",sdp:this._remoteSdp.getSdp()};ce.debug("stopSending() | calling pc.setRemoteDescription() [answer:%o]",i),await this._pc.setRemoteDescription(i),this._mapMidTransceiver.delete(t)}async pauseSending(t){this.assertNotClosed(),this.assertSendDirection(),ce.debug("pauseSending() [localId:%s]",t);const n=this._mapMidTransceiver.get(t);if(!n)throw new Error("associated RTCRtpTransceiver not found");n.direction="inactive",this._remoteSdp.pauseMediaSection(t);const r=await this._pc.createOffer();ce.debug("pauseSending() | calling pc.setLocalDescription() [offer:%o]",r),await this._pc.setLocalDescription(r);const s={type:"answer",sdp:this._remoteSdp.getSdp()};ce.debug("pauseSending() | calling pc.setRemoteDescription() [answer:%o]",s),await this._pc.setRemoteDescription(s)}async resumeSending(t){this.assertNotClosed(),this.assertSendDirection(),ce.debug("resumeSending() [localId:%s]",t);const n=this._mapMidTransceiver.get(t);if(this._remoteSdp.resumeSendingMediaSection(t),!n)throw new Error("associated RTCRtpTransceiver not found");n.direction="sendonly";const r=await this._pc.createOffer();ce.debug("resumeSending() | calling pc.setLocalDescription() [offer:%o]",r),await this._pc.setLocalDescription(r);const s={type:"answer",sdp:this._remoteSdp.getSdp()};ce.debug("resumeSending() | calling pc.setRemoteDescription() [answer:%o]",s),await this._pc.setRemoteDescription(s)}async replaceTrack(t,n){this.assertNotClosed(),this.assertSendDirection(),n?ce.debug("replaceTrack() [localId:%s, track.id:%s]",t,n.id):ce.debug("replaceTrack() [localId:%s, no track]",t);const r=this._mapMidTransceiver.get(t);if(!r)throw new Error("associated RTCRtpTransceiver not found");await r.sender.replaceTrack(n)}async setMaxSpatialLayer(t,n){this.assertNotClosed(),this.assertSendDirection(),ce.debug("setMaxSpatialLayer() [localId:%s, spatialLayer:%s]",t,n);const r=this._mapMidTransceiver.get(t);if(!r)throw new Error("associated RTCRtpTransceiver not found");const s=r.sender.getParameters();s.encodings.forEach((a,c)=>{c<=n?a.active=!0:a.active=!1}),await r.sender.setParameters(s),this._remoteSdp.muxMediaSectionSimulcast(t,s.encodings);const i=await this._pc.createOffer();ce.debug("setMaxSpatialLayer() | calling pc.setLocalDescription() [offer:%o]",i),await this._pc.setLocalDescription(i);const o={type:"answer",sdp:this._remoteSdp.getSdp()};ce.debug("setMaxSpatialLayer() | calling pc.setRemoteDescription() [answer:%o]",o),await this._pc.setRemoteDescription(o)}async setRtpEncodingParameters(t,n){this.assertNotClosed(),this.assertSendDirection(),ce.debug("setRtpEncodingParameters() [localId:%s, params:%o]",t,n);const r=this._mapMidTransceiver.get(t);if(!r)throw new Error("associated RTCRtpTransceiver not found");const s=r.sender.getParameters();s.encodings.forEach((a,c)=>{s.encodings[c]={...a,...n}}),await r.sender.setParameters(s),this._remoteSdp.muxMediaSectionSimulcast(t,s.encodings);const i=await this._pc.createOffer();ce.debug("setRtpEncodingParameters() | calling pc.setLocalDescription() [offer:%o]",i),await this._pc.setLocalDescription(i);const o={type:"answer",sdp:this._remoteSdp.getSdp()};ce.debug("setRtpEncodingParameters() | calling pc.setRemoteDescription() [answer:%o]",o),await this._pc.setRemoteDescription(o)}async getSenderStats(t){this.assertNotClosed(),this.assertSendDirection();const n=this._mapMidTransceiver.get(t);if(!n)throw new Error("associated RTCRtpTransceiver not found");return n.sender.getStats()}async sendDataChannel({ordered:t,maxPacketLifeTime:n,maxRetransmits:r,label:s,protocol:i}){this.assertNotClosed(),this.assertSendDirection();const o={negotiated:!0,id:this._nextSendSctpStreamId,ordered:t,maxPacketLifeTime:n,maxRetransmits:r,protocol:i};ce.debug("sendDataChannel() [options:%o]",o);const a=this._pc.createDataChannel(s,o);if(this._nextSendSctpStreamId=++this._nextSendSctpStreamId%rh.MIS,!this._hasDataChannelMediaSection){const l=await this._pc.createOffer(),d=Qn.parse(l.sdp),u=d.media.find(h=>h.type==="application");this._transportReady||await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:d}),ce.debug("sendDataChannel() | calling pc.setLocalDescription() [offer:%o]",l),await this._pc.setLocalDescription(l),this._remoteSdp.sendSctpAssociation({offerMediaObject:u});const f={type:"answer",sdp:this._remoteSdp.getSdp()};ce.debug("sendDataChannel() | calling pc.setRemoteDescription() [answer:%o]",f),await this._pc.setRemoteDescription(f),this._hasDataChannelMediaSection=!0}const c={streamId:o.id,ordered:o.ordered,maxPacketLifeTime:o.maxPacketLifeTime,maxRetransmits:o.maxRetransmits};return{dataChannel:a,sctpStreamParameters:c}}async receive(t){this.assertNotClosed(),this.assertRecvDirection();const n=[],r=new Map;for(const a of t){const{trackId:c,kind:l,rtpParameters:d,streamId:u}=a;ce.debug("receive() [trackId:%s, kind:%s]",c,l);const f=d.mid??String(this._mapMidTransceiver.size);r.set(c,f),this._remoteSdp.receive({mid:f,kind:l,offerRtpParameters:d,streamId:u??d.rtcp.cname,trackId:c})}const s={type:"offer",sdp:this._remoteSdp.getSdp()};ce.debug("receive() | calling pc.setRemoteDescription() [offer:%o]",s),await this._pc.setRemoteDescription(s);for(const a of t){const{trackId:c,onRtpReceiver:l}=a;if(l){const d=r.get(c),u=this._pc.getTransceivers().find(f=>f.mid===d);if(!u)throw new Error("transceiver not found");l(u.receiver)}}let i=await this._pc.createAnswer();const o=Qn.parse(i.sdp);for(const a of t){const{trackId:c,rtpParameters:l}=a,d=r.get(c),u=o.media.find(f=>String(f.mid)===d);Lo.applyCodecParameters({offerRtpParameters:l,answerMediaObject:u})}i={type:"answer",sdp:Qn.write(o)},this._transportReady||await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:o}),ce.debug("receive() | calling pc.setLocalDescription() [answer:%o]",i),await this._pc.setLocalDescription(i);for(const a of t){const{trackId:c}=a,l=r.get(c),d=this._pc.getTransceivers().find(u=>u.mid===l);if(d)this._mapMidTransceiver.set(l,d),n.push({localId:l,track:d.receiver.track,rtpReceiver:d.receiver});else throw new Error("new RTCRtpTransceiver not found")}return n}async stopReceiving(t){if(this.assertRecvDirection(),this._closed)return;for(const s of t){ce.debug("stopReceiving() [localId:%s]",s);const i=this._mapMidTransceiver.get(s);if(!i)throw new Error("associated RTCRtpTransceiver not found");this._remoteSdp.closeMediaSection(i.mid)}const n={type:"offer",sdp:this._remoteSdp.getSdp()};ce.debug("stopReceiving() | calling pc.setRemoteDescription() [offer:%o]",n),await this._pc.setRemoteDescription(n);const r=await this._pc.createAnswer();ce.debug("stopReceiving() | calling pc.setLocalDescription() [answer:%o]",r),await this._pc.setLocalDescription(r);for(const s of t)this._mapMidTransceiver.delete(s)}async pauseReceiving(t){this.assertNotClosed(),this.assertRecvDirection();for(const s of t){ce.debug("pauseReceiving() [localId:%s]",s);const i=this._mapMidTransceiver.get(s);if(!i)throw new Error("associated RTCRtpTransceiver not found");i.direction="inactive",this._remoteSdp.pauseMediaSection(s)}const n={type:"offer",sdp:this._remoteSdp.getSdp()};ce.debug("pauseReceiving() | calling pc.setRemoteDescription() [offer:%o]",n),await this._pc.setRemoteDescription(n);const r=await this._pc.createAnswer();ce.debug("pauseReceiving() | calling pc.setLocalDescription() [answer:%o]",r),await this._pc.setLocalDescription(r)}async resumeReceiving(t){this.assertNotClosed(),this.assertRecvDirection();for(const s of t){ce.debug("resumeReceiving() [localId:%s]",s);const i=this._mapMidTransceiver.get(s);if(!i)throw new Error("associated RTCRtpTransceiver not found");i.direction="recvonly",this._remoteSdp.resumeReceivingMediaSection(s)}const n={type:"offer",sdp:this._remoteSdp.getSdp()};ce.debug("resumeReceiving() | calling pc.setRemoteDescription() [offer:%o]",n),await this._pc.setRemoteDescription(n);const r=await this._pc.createAnswer();ce.debug("resumeReceiving() | calling pc.setLocalDescription() [answer:%o]",r),await this._pc.setLocalDescription(r)}async getReceiverStats(t){this.assertNotClosed(),this.assertRecvDirection();const n=this._mapMidTransceiver.get(t);if(!n)throw new Error("associated RTCRtpTransceiver not found");return n.receiver.getStats()}async receiveDataChannel({sctpStreamParameters:t,label:n,protocol:r}){this.assertNotClosed(),this.assertRecvDirection();const{streamId:s,ordered:i,maxPacketLifeTime:o,maxRetransmits:a}=t,c={negotiated:!0,id:s,ordered:i,maxPacketLifeTime:o,maxRetransmits:a,protocol:r};ce.debug("receiveDataChannel() [options:%o]",c);const l=this._pc.createDataChannel(n,c);if(!this._hasDataChannelMediaSection){this._remoteSdp.receiveSctpAssociation();const d={type:"offer",sdp:this._remoteSdp.getSdp()};ce.debug("receiveDataChannel() | calling pc.setRemoteDescription() [offer:%o]",d),await this._pc.setRemoteDescription(d);const u=await this._pc.createAnswer();if(!this._transportReady){const f=Qn.parse(u.sdp);await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:f})}ce.debug("receiveDataChannel() | calling pc.setRemoteDescription() [answer:%o]",u),await this._pc.setLocalDescription(u),this._hasDataChannelMediaSection=!0}return{dataChannel:l}}async setupTransport({localDtlsRole:t,localSdpObject:n}){n||(n=Qn.parse(this._pc.localDescription.sdp));const r=Lo.extractDtlsParameters({sdpObject:n});r.role=t,this._remoteSdp.updateDtlsRole(t==="client"?"server":"client"),await new Promise((s,i)=>{this.safeEmit("@connect",{dtlsParameters:r},s,i)}),this._transportReady=!0}onIceGatheringStateChange=()=>{this.emit("@icegatheringstatechange",this._pc.iceGatheringState)};onIceCandidateError=t=>{this.emit("@icecandidateerror",t)};onConnectionStateChange=()=>{this.emit("@connectionstatechange",this._pc.connectionState)};onIceConnectionStateChange=()=>{switch(this._pc.iceConnectionState){case"checking":{this.emit("@connectionstatechange","connecting");break}case"connected":case"completed":{this.emit("@connectionstatechange","connected");break}case"failed":{this.emit("@connectionstatechange","failed");break}case"disconnected":{this.emit("@connectionstatechange","disconnected");break}case"closed":{this.emit("@connectionstatechange","closed");break}}};assertNotClosed(){if(this._closed)throw new mC.InvalidStateError("method called in a closed handler")}assertSendDirection(){if(this._direction!=="send")throw new Error('method can just be called for handlers with "send" direction')}assertRecvDirection(){if(this._direction!=="recv")throw new Error('method can just be called for handlers with "recv" direction')}}pc.Chrome111=bi;var fc={};Object.defineProperty(fc,"__esModule",{value:!0});fc.Chrome74=void 0;const hn=st,wC=rt,_C=gt,ri=Oe,SC=mt,xC=_r,Do=bn,cl=Sr,bC=Fs,CC=xr,ie=new wC.Logger("Chrome74"),sh="Chrome74",ih={OS:1024,MIS:1024};class Ci extends _C.EnhancedEventEmitter{_closed=!1;_direction;_remoteSdp;_getSendExtendedRtpCapabilities;_forcedLocalDtlsRole;_pc;_mapMidTransceiver=new Map;_sendStream=new MediaStream;_hasDataChannelMediaSection=!1;_nextSendSctpStreamId=0;_transportReady=!1;static createFactory(){return{name:sh,factory:t=>new Ci(t),getNativeRtpCapabilities:async()=>{ie.debug("getNativeRtpCapabilities()");let t=new RTCPeerConnection({iceServers:[],iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require"});try{t.addTransceiver("audio"),t.addTransceiver("video");const n=await t.createOffer();try{t.close()}catch{}t=void 0;const r=hn.parse(n.sdp);return Ci.getLocalRtpCapabilities(r)}catch(n){try{t?.close()}catch{}throw t=void 0,n}},getNativeSctpCapabilities:async()=>(ie.debug("getNativeSctpCapabilities()"),{numStreams:ih})}}static getLocalRtpCapabilities(t){const n=Do.extractRtpCapabilities({sdpObject:t});return ri.validateAndNormalizeRtpCapabilities(n),bC.addNackSupportForOpus(n),n}constructor({direction:t,iceParameters:n,iceCandidates:r,dtlsParameters:s,sctpParameters:i,iceServers:o,iceTransportPolicy:a,additionalSettings:c,getSendExtendedRtpCapabilities:l}){super(),ie.debug("constructor()"),this._direction=t,this._remoteSdp=new CC.RemoteSdp({iceParameters:n,iceCandidates:r,dtlsParameters:s,sctpParameters:i}),this._getSendExtendedRtpCapabilities=l,s.role&&s.role!=="auto"&&(this._forcedLocalDtlsRole=s.role==="server"?"client":"server"),this._pc=new RTCPeerConnection({iceServers:o??[],iceTransportPolicy:a??"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",...c}),this._pc.addEventListener("icegatheringstatechange",this.onIceGatheringStateChange),this._pc.addEventListener("icecandidateerror",this.onIceCandidateError),this._pc.connectionState?this._pc.addEventListener("connectionstatechange",this.onConnectionStateChange):(ie.warn("run() | pc.connectionState not supported, using pc.iceConnectionState"),this._pc.addEventListener("iceconnectionstatechange",this.onIceConnectionStateChange))}get name(){return sh}close(){if(ie.debug("close()"),!this._closed){this._closed=!0;try{this._pc.close()}catch{}this._pc.removeEventListener("icegatheringstatechange",this.onIceGatheringStateChange),this._pc.removeEventListener("icecandidateerror",this.onIceCandidateError),this._pc.removeEventListener("connectionstatechange",this.onConnectionStateChange),this._pc.removeEventListener("iceconnectionstatechange",this.onIceConnectionStateChange),this.emit("@close"),super.close()}}async updateIceServers(t){this.assertNotClosed(),ie.debug("updateIceServers()");const n=this._pc.getConfiguration();n.iceServers=t,this._pc.setConfiguration(n)}async restartIce(t){if(this.assertNotClosed(),ie.debug("restartIce()"),this._remoteSdp.updateIceParameters(t),!!this._transportReady)if(this._direction==="send"){const n=await this._pc.createOffer({iceRestart:!0});ie.debug("restartIce() | calling pc.setLocalDescription() [offer:%o]",n),await this._pc.setLocalDescription(n);const r={type:"answer",sdp:this._remoteSdp.getSdp()};ie.debug("restartIce() | calling pc.setRemoteDescription() [answer:%o]",r),await this._pc.setRemoteDescription(r)}else{const n={type:"offer",sdp:this._remoteSdp.getSdp()};ie.debug("restartIce() | calling pc.setRemoteDescription() [offer:%o]",n),await this._pc.setRemoteDescription(n);const r=await this._pc.createAnswer();ie.debug("restartIce() | calling pc.setLocalDescription() [answer:%o]",r),await this._pc.setLocalDescription(r)}}async getTransportStats(){return this.assertNotClosed(),this._pc.getStats()}async send({track:t,encodings:n,codecOptions:r,codec:s}){this.assertNotClosed(),this.assertSendDirection(),ie.debug("send() [kind:%s, track.id:%s]",t.kind,t.id),n&&n.length>1&&n.forEach((m,w)=>{m.rid=`r${w}`});const i=this._remoteSdp.getNextMediaSectionIdx(),o=this._pc.addTransceiver(t,{direction:"sendonly",streams:[this._sendStream],sendEncodings:n});let a=await this._pc.createOffer(),c=hn.parse(a.sdp);c.extmapAllowMixed&&this._remoteSdp.setSessionExtmapAllowMixed();const l=Ci.getLocalRtpCapabilities(c),d=this._getSendExtendedRtpCapabilities(l),u=ri.getSendingRtpParameters(t.kind,d);u.codecs=ri.reduceCodecs(u.codecs,s);const f=ri.getSendingRemoteRtpParameters(t.kind,d);f.codecs=ri.reduceCodecs(f.codecs,s),this._transportReady||await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:c});let h=!1;const v=(0,xC.parse)((n??[{}])[0].scalabilityMode);let y;n&&n.length===1&&v.spatialLayers>1&&u.codecs[0].mimeType.toLowerCase()==="video/vp9"&&(ie.debug("send() | enabling legacy simulcast for VP9 SVC"),h=!0,c=hn.parse(a.sdp),y=c.media[i.idx],cl.addLegacySimulcast({offerMediaObject:y,numStreams:v.spatialLayers}),a={type:"offer",sdp:hn.write(c)}),ie.debug("send() | calling pc.setLocalDescription() [offer:%o]",a),await this._pc.setLocalDescription(a);const x=o.mid;if(u.mid=x,c=hn.parse(this._pc.localDescription.sdp),y=c.media[i.idx],u.rtcp.cname=Do.getCname({offerMediaObject:y}),!n)u.encodings=cl.getRtpEncodings({offerMediaObject:y});else if(n.length===1){let m=cl.getRtpEncodings({offerMediaObject:y});Object.assign(m[0],n[0]),h&&(m=[m[0]]),u.encodings=m}else u.encodings=n;if(u.encodings.length>1&&(u.codecs[0].mimeType.toLowerCase()==="video/vp8"||u.codecs[0].mimeType.toLowerCase()==="video/h264"))for(const m of u.encodings)m.scalabilityMode?m.scalabilityMode=`L1T${v.temporalLayers}`:m.scalabilityMode="L1T3";this._remoteSdp.send({offerMediaObject:y,reuseMid:i.reuseMid,offerRtpParameters:u,answerRtpParameters:f,codecOptions:r});const g={type:"answer",sdp:this._remoteSdp.getSdp()};return ie.debug("send() | calling pc.setRemoteDescription() [answer:%o]",g),await this._pc.setRemoteDescription(g),this._mapMidTransceiver.set(x,o),{localId:x,rtpParameters:u,rtpSender:o.sender}}async stopSending(t){if(this.assertSendDirection(),ie.debug("stopSending() [localId:%s]",t),this._closed)return;const n=this._mapMidTransceiver.get(t);if(!n)throw new Error("associated RTCRtpTransceiver not found");if(n.sender.replaceTrack(null),this._pc.removeTrack(n.sender),this._remoteSdp.closeMediaSection(n.mid))try{n.stop()}catch{}const s=await this._pc.createOffer();ie.debug("stopSending() | calling pc.setLocalDescription() [offer:%o]",s),await this._pc.setLocalDescription(s);const i={type:"answer",sdp:this._remoteSdp.getSdp()};ie.debug("stopSending() | calling pc.setRemoteDescription() [answer:%o]",i),await this._pc.setRemoteDescription(i),this._mapMidTransceiver.delete(t)}async pauseSending(t){this.assertNotClosed(),this.assertSendDirection(),ie.debug("pauseSending() [localId:%s]",t);const n=this._mapMidTransceiver.get(t);if(!n)throw new Error("associated RTCRtpTransceiver not found");n.direction="inactive",this._remoteSdp.pauseMediaSection(t);const r=await this._pc.createOffer();ie.debug("pauseSending() | calling pc.setLocalDescription() [offer:%o]",r),await this._pc.setLocalDescription(r);const s={type:"answer",sdp:this._remoteSdp.getSdp()};ie.debug("pauseSending() | calling pc.setRemoteDescription() [answer:%o]",s),await this._pc.setRemoteDescription(s)}async resumeSending(t){this.assertNotClosed(),this.assertSendDirection(),ie.debug("resumeSending() [localId:%s]",t);const n=this._mapMidTransceiver.get(t);if(this._remoteSdp.resumeSendingMediaSection(t),!n)throw new Error("associated RTCRtpTransceiver not found");n.direction="sendonly";const r=await this._pc.createOffer();ie.debug("resumeSending() | calling pc.setLocalDescription() [offer:%o]",r),await this._pc.setLocalDescription(r);const s={type:"answer",sdp:this._remoteSdp.getSdp()};ie.debug("resumeSending() | calling pc.setRemoteDescription() [answer:%o]",s),await this._pc.setRemoteDescription(s)}async replaceTrack(t,n){this.assertNotClosed(),this.assertSendDirection(),n?ie.debug("replaceTrack() [localId:%s, track.id:%s]",t,n.id):ie.debug("replaceTrack() [localId:%s, no track]",t);const r=this._mapMidTransceiver.get(t);if(!r)throw new Error("associated RTCRtpTransceiver not found");await r.sender.replaceTrack(n)}async setMaxSpatialLayer(t,n){this.assertNotClosed(),this.assertSendDirection(),ie.debug("setMaxSpatialLayer() [localId:%s, spatialLayer:%s]",t,n);const r=this._mapMidTransceiver.get(t);if(!r)throw new Error("associated RTCRtpTransceiver not found");const s=r.sender.getParameters();s.encodings.forEach((a,c)=>{c<=n?a.active=!0:a.active=!1}),await r.sender.setParameters(s),this._remoteSdp.muxMediaSectionSimulcast(t,s.encodings);const i=await this._pc.createOffer();ie.debug("setMaxSpatialLayer() | calling pc.setLocalDescription() [offer:%o]",i),await this._pc.setLocalDescription(i);const o={type:"answer",sdp:this._remoteSdp.getSdp()};ie.debug("setMaxSpatialLayer() | calling pc.setRemoteDescription() [answer:%o]",o),await this._pc.setRemoteDescription(o)}async setRtpEncodingParameters(t,n){this.assertNotClosed(),this.assertSendDirection(),ie.debug("setRtpEncodingParameters() [localId:%s, params:%o]",t,n);const r=this._mapMidTransceiver.get(t);if(!r)throw new Error("associated RTCRtpTransceiver not found");const s=r.sender.getParameters();s.encodings.forEach((a,c)=>{s.encodings[c]={...a,...n}}),await r.sender.setParameters(s),this._remoteSdp.muxMediaSectionSimulcast(t,s.encodings);const i=await this._pc.createOffer();ie.debug("setRtpEncodingParameters() | calling pc.setLocalDescription() [offer:%o]",i),await this._pc.setLocalDescription(i);const o={type:"answer",sdp:this._remoteSdp.getSdp()};ie.debug("setRtpEncodingParameters() | calling pc.setRemoteDescription() [answer:%o]",o),await this._pc.setRemoteDescription(o)}async getSenderStats(t){this.assertNotClosed(),this.assertSendDirection();const n=this._mapMidTransceiver.get(t);if(!n)throw new Error("associated RTCRtpTransceiver not found");return n.sender.getStats()}async sendDataChannel({ordered:t,maxPacketLifeTime:n,maxRetransmits:r,label:s,protocol:i}){this.assertNotClosed(),this.assertSendDirection();const o={negotiated:!0,id:this._nextSendSctpStreamId,ordered:t,maxPacketLifeTime:n,maxRetransmits:r,protocol:i};ie.debug("sendDataChannel() [options:%o]",o);const a=this._pc.createDataChannel(s,o);if(this._nextSendSctpStreamId=++this._nextSendSctpStreamId%ih.MIS,!this._hasDataChannelMediaSection){const l=await this._pc.createOffer(),d=hn.parse(l.sdp),u=d.media.find(h=>h.type==="application");this._transportReady||await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:d}),ie.debug("sendDataChannel() | calling pc.setLocalDescription() [offer:%o]",l),await this._pc.setLocalDescription(l),this._remoteSdp.sendSctpAssociation({offerMediaObject:u});const f={type:"answer",sdp:this._remoteSdp.getSdp()};ie.debug("sendDataChannel() | calling pc.setRemoteDescription() [answer:%o]",f),await this._pc.setRemoteDescription(f),this._hasDataChannelMediaSection=!0}const c={streamId:o.id,ordered:o.ordered,maxPacketLifeTime:o.maxPacketLifeTime,maxRetransmits:o.maxRetransmits};return{dataChannel:a,sctpStreamParameters:c}}async receive(t){this.assertNotClosed(),this.assertRecvDirection();const n=[],r=new Map;for(const a of t){const{trackId:c,kind:l,rtpParameters:d,streamId:u}=a;ie.debug("receive() [trackId:%s, kind:%s]",c,l);const f=d.mid??String(this._mapMidTransceiver.size);r.set(c,f),this._remoteSdp.receive({mid:f,kind:l,offerRtpParameters:d,streamId:u??d.rtcp.cname,trackId:c})}const s={type:"offer",sdp:this._remoteSdp.getSdp()};ie.debug("receive() | calling pc.setRemoteDescription() [offer:%o]",s),await this._pc.setRemoteDescription(s);let i=await this._pc.createAnswer();const o=hn.parse(i.sdp);for(const a of t){const{trackId:c,rtpParameters:l}=a,d=r.get(c),u=o.media.find(f=>String(f.mid)===d);Do.applyCodecParameters({offerRtpParameters:l,answerMediaObject:u})}i={type:"answer",sdp:hn.write(o)},this._transportReady||await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:o}),ie.debug("receive() | calling pc.setLocalDescription() [answer:%o]",i),await this._pc.setLocalDescription(i);for(const a of t){const{trackId:c}=a,l=r.get(c),d=this._pc.getTransceivers().find(u=>u.mid===l);if(d)this._mapMidTransceiver.set(l,d),n.push({localId:l,track:d.receiver.track,rtpReceiver:d.receiver});else throw new Error("new RTCRtpTransceiver not found")}return n}async stopReceiving(t){if(this.assertRecvDirection(),this._closed)return;for(const s of t){ie.debug("stopReceiving() [localId:%s]",s);const i=this._mapMidTransceiver.get(s);if(!i)throw new Error("associated RTCRtpTransceiver not found");this._remoteSdp.closeMediaSection(i.mid)}const n={type:"offer",sdp:this._remoteSdp.getSdp()};ie.debug("stopReceiving() | calling pc.setRemoteDescription() [offer:%o]",n),await this._pc.setRemoteDescription(n);const r=await this._pc.createAnswer();ie.debug("stopReceiving() | calling pc.setLocalDescription() [answer:%o]",r),await this._pc.setLocalDescription(r);for(const s of t)this._mapMidTransceiver.delete(s)}async pauseReceiving(t){this.assertNotClosed(),this.assertRecvDirection();for(const s of t){ie.debug("pauseReceiving() [localId:%s]",s);const i=this._mapMidTransceiver.get(s);if(!i)throw new Error("associated RTCRtpTransceiver not found");i.direction="inactive",this._remoteSdp.pauseMediaSection(s)}const n={type:"offer",sdp:this._remoteSdp.getSdp()};ie.debug("pauseReceiving() | calling pc.setRemoteDescription() [offer:%o]",n),await this._pc.setRemoteDescription(n);const r=await this._pc.createAnswer();ie.debug("pauseReceiving() | calling pc.setLocalDescription() [answer:%o]",r),await this._pc.setLocalDescription(r)}async resumeReceiving(t){this.assertNotClosed(),this.assertRecvDirection();for(const s of t){ie.debug("resumeReceiving() [localId:%s]",s);const i=this._mapMidTransceiver.get(s);if(!i)throw new Error("associated RTCRtpTransceiver not found");i.direction="recvonly",this._remoteSdp.resumeReceivingMediaSection(s)}const n={type:"offer",sdp:this._remoteSdp.getSdp()};ie.debug("resumeReceiving() | calling pc.setRemoteDescription() [offer:%o]",n),await this._pc.setRemoteDescription(n);const r=await this._pc.createAnswer();ie.debug("resumeReceiving() | calling pc.setLocalDescription() [answer:%o]",r),await this._pc.setLocalDescription(r)}async getReceiverStats(t){this.assertNotClosed(),this.assertRecvDirection();const n=this._mapMidTransceiver.get(t);if(!n)throw new Error("associated RTCRtpTransceiver not found");return n.receiver.getStats()}async receiveDataChannel({sctpStreamParameters:t,label:n,protocol:r}){this.assertNotClosed(),this.assertRecvDirection();const{streamId:s,ordered:i,maxPacketLifeTime:o,maxRetransmits:a}=t,c={negotiated:!0,id:s,ordered:i,maxPacketLifeTime:o,maxRetransmits:a,protocol:r};ie.debug("receiveDataChannel() [options:%o]",c);const l=this._pc.createDataChannel(n,c);if(!this._hasDataChannelMediaSection){this._remoteSdp.receiveSctpAssociation();const d={type:"offer",sdp:this._remoteSdp.getSdp()};ie.debug("receiveDataChannel() | calling pc.setRemoteDescription() [offer:%o]",d),await this._pc.setRemoteDescription(d);const u=await this._pc.createAnswer();if(!this._transportReady){const f=hn.parse(u.sdp);await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:f})}ie.debug("receiveDataChannel() | calling pc.setRemoteDescription() [answer:%o]",u),await this._pc.setLocalDescription(u),this._hasDataChannelMediaSection=!0}return{dataChannel:l}}async setupTransport({localDtlsRole:t,localSdpObject:n}){n||(n=hn.parse(this._pc.localDescription.sdp));const r=Do.extractDtlsParameters({sdpObject:n});r.role=t,this._remoteSdp.updateDtlsRole(t==="client"?"server":"client"),await new Promise((s,i)=>{this.safeEmit("@connect",{dtlsParameters:r},s,i)}),this._transportReady=!0}onIceGatheringStateChange=()=>{this.emit("@icegatheringstatechange",this._pc.iceGatheringState)};onIceCandidateError=t=>{this.emit("@icecandidateerror",t)};onConnectionStateChange=()=>{this.emit("@connectionstatechange",this._pc.connectionState)};onIceConnectionStateChange=()=>{switch(this._pc.iceConnectionState){case"checking":{this.emit("@connectionstatechange","connecting");break}case"connected":case"completed":{this.emit("@connectionstatechange","connected");break}case"failed":{this.emit("@connectionstatechange","failed");break}case"disconnected":{this.emit("@connectionstatechange","disconnected");break}case"closed":{this.emit("@connectionstatechange","closed");break}}};assertNotClosed(){if(this._closed)throw new SC.InvalidStateError("method called in a closed handler")}assertSendDirection(){if(this._direction!=="send")throw new Error('method can just be called for handlers with "send" direction')}assertRecvDirection(){if(this._direction!=="recv")throw new Error('method can just be called for handlers with "recv" direction')}}fc.Chrome74=Ci;var hc={};Object.defineProperty(hc,"__esModule",{value:!0});hc.Firefox120=void 0;const Kn=st,EC=gt,RC=rt,oh=mt,si=Oe,kC=_r,Io=bn,ah=Sr,TC=xr,le=new RC.Logger("Firefox120"),ch="Firefox120",lh={OS:16,MIS:2048};class Ei extends EC.EnhancedEventEmitter{_closed=!1;_direction;_remoteSdp;_getSendExtendedRtpCapabilities;_pc;_mapMidTransceiver=new Map;_sendStream=new MediaStream;_hasDataChannelMediaSection=!1;_nextSendSctpStreamId=0;_transportReady=!1;static createFactory(){return{name:ch,factory:t=>new Ei(t),getNativeRtpCapabilities:async()=>{le.debug("getNativeRtpCapabilities()");let t=new RTCPeerConnection({iceServers:[],iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require"});const n=document.createElement("canvas");n.getContext("2d");const s=n.captureStream().getVideoTracks()[0];try{t.addTransceiver("audio",{direction:"sendrecv"}),t.addTransceiver(s,{direction:"sendrecv",sendEncodings:[{rid:"r0",maxBitrate:1e5},{rid:"r1",maxBitrate:5e5}]});const i=await t.createOffer();try{n.remove()}catch{}try{s.stop()}catch{}try{t.close()}catch{}t=void 0;const o=Kn.parse(i.sdp);return Ei.getLocalRtpCapabilities(o)}catch(i){try{n.remove()}catch{}try{s.stop()}catch{}try{t?.close()}catch{}throw t=void 0,i}},getNativeSctpCapabilities:async()=>(le.debug("getNativeSctpCapabilities()"),{numStreams:lh})}}static getLocalRtpCapabilities(t){const n=Io.extractRtpCapabilities({sdpObject:t});return si.validateAndNormalizeRtpCapabilities(n),n}constructor({direction:t,iceParameters:n,iceCandidates:r,dtlsParameters:s,sctpParameters:i,iceServers:o,iceTransportPolicy:a,additionalSettings:c,getSendExtendedRtpCapabilities:l}){super(),le.debug("constructor()"),this._direction=t,this._remoteSdp=new TC.RemoteSdp({iceParameters:n,iceCandidates:r,dtlsParameters:s,sctpParameters:i}),this._getSendExtendedRtpCapabilities=l,this._pc=new RTCPeerConnection({iceServers:o??[],iceTransportPolicy:a??"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",...c}),this._pc.addEventListener("icegatheringstatechange",this.onIceGatheringStateChange),this._pc.addEventListener("icecandidateerror",this.onIceCandidateError),this._pc.connectionState?this._pc.addEventListener("connectionstatechange",this.onConnectionStateChange):(le.warn("run() | pc.connectionState not supported, using pc.iceConnectionState"),this._pc.addEventListener("iceconnectionstatechange",this.onIceConnectionStateChange))}get name(){return ch}close(){if(le.debug("close()"),!this._closed){this._closed=!0;try{this._pc.close()}catch{}this._pc.removeEventListener("icegatheringstatechange",this.onIceGatheringStateChange),this._pc.removeEventListener("icecandidateerror",this.onIceCandidateError),this._pc.removeEventListener("connectionstatechange",this.onConnectionStateChange),this._pc.removeEventListener("iceconnectionstatechange",this.onIceConnectionStateChange),this.emit("@close"),super.close()}}async updateIceServers(t){throw this.assertNotClosed(),new oh.UnsupportedError("not supported")}async restartIce(t){if(this.assertNotClosed(),le.debug("restartIce()"),this._remoteSdp.updateIceParameters(t),!!this._transportReady)if(this._direction==="send"){const n=await this._pc.createOffer({iceRestart:!0});le.debug("restartIce() | calling pc.setLocalDescription() [offer:%o]",n),await this._pc.setLocalDescription(n);const r={type:"answer",sdp:this._remoteSdp.getSdp()};le.debug("restartIce() | calling pc.setRemoteDescription() [answer:%o]",r),await this._pc.setRemoteDescription(r)}else{const n={type:"offer",sdp:this._remoteSdp.getSdp()};le.debug("restartIce() | calling pc.setRemoteDescription() [offer:%o]",n),await this._pc.setRemoteDescription(n);const r=await this._pc.createAnswer();le.debug("restartIce() | calling pc.setLocalDescription() [answer:%o]",r),await this._pc.setLocalDescription(r)}}async getTransportStats(){return this.assertNotClosed(),this._pc.getStats()}async send({track:t,encodings:n,codecOptions:r,codec:s,onRtpSender:i}){this.assertNotClosed(),this.assertSendDirection(),le.debug("send() [kind:%s, track.id:%s]",t.kind,t.id),n&&n.length>1&&n.forEach((g,m)=>{g.rid=`r${m}`});const o=this._pc.addTransceiver(t,{direction:"sendonly",streams:[this._sendStream],sendEncodings:n});i&&i(o.sender);const a=await this._pc.createOffer();let c=Kn.parse(a.sdp);c.extmapAllowMixed&&this._remoteSdp.setSessionExtmapAllowMixed();const l=Ei.getLocalRtpCapabilities(c),d=this._getSendExtendedRtpCapabilities(l),u=si.getSendingRtpParameters(t.kind,d);u.codecs=si.reduceCodecs(u.codecs,s);const f=si.getSendingRemoteRtpParameters(t.kind,d);f.codecs=si.reduceCodecs(f.codecs,s),this._transportReady||await this.setupTransport({localDtlsRole:"client",localSdpObject:c});const h=(0,kC.parse)((n??[{}])[0].scalabilityMode);le.debug("send() | calling pc.setLocalDescription() [offer:%o]",a),await this._pc.setLocalDescription(a);const v=o.mid;u.mid=v,c=Kn.parse(this._pc.localDescription.sdp);const y=c.media[c.media.length-1];if(u.rtcp.cname=Io.getCname({offerMediaObject:y}),!n)u.encodings=ah.getRtpEncodings({offerMediaObject:y});else if(n.length===1){const g=ah.getRtpEncodings({offerMediaObject:y});Object.assign(g[0],n[0]),u.encodings=g}else u.encodings=n;if(u.encodings.length>1&&(u.codecs[0].mimeType.toLowerCase()==="video/vp8"||u.codecs[0].mimeType.toLowerCase()==="video/h264"))for(const g of u.encodings)g.scalabilityMode?g.scalabilityMode=`L1T${h.temporalLayers}`:g.scalabilityMode="L1T3";this._remoteSdp.send({offerMediaObject:y,offerRtpParameters:u,answerRtpParameters:f,codecOptions:r});const x={type:"answer",sdp:this._remoteSdp.getSdp()};return le.debug("send() | calling pc.setRemoteDescription() [answer:%o]",x),await this._pc.setRemoteDescription(x),this._mapMidTransceiver.set(v,o),{localId:v,rtpParameters:u,rtpSender:o.sender}}async stopSending(t){if(this.assertSendDirection(),le.debug("stopSending() [localId:%s]",t),this._closed)return;const n=this._mapMidTransceiver.get(t);if(!n)throw new Error("associated transceiver not found");n.sender.replaceTrack(null),this._pc.removeTrack(n.sender),this._remoteSdp.disableMediaSection(n.mid);const r=await this._pc.createOffer();le.debug("stopSending() | calling pc.setLocalDescription() [offer:%o]",r),await this._pc.setLocalDescription(r);const s={type:"answer",sdp:this._remoteSdp.getSdp()};le.debug("stopSending() | calling pc.setRemoteDescription() [answer:%o]",s),await this._pc.setRemoteDescription(s),this._mapMidTransceiver.delete(t)}async pauseSending(t){this.assertNotClosed(),this.assertSendDirection(),le.debug("pauseSending() [localId:%s]",t);const n=this._mapMidTransceiver.get(t);if(!n)throw new Error("associated RTCRtpTransceiver not found");n.direction="inactive",this._remoteSdp.pauseMediaSection(t);const r=await this._pc.createOffer();le.debug("pauseSending() | calling pc.setLocalDescription() [offer:%o]",r),await this._pc.setLocalDescription(r);const s={type:"answer",sdp:this._remoteSdp.getSdp()};le.debug("pauseSending() | calling pc.setRemoteDescription() [answer:%o]",s),await this._pc.setRemoteDescription(s)}async resumeSending(t){this.assertNotClosed(),this.assertSendDirection(),le.debug("resumeSending() [localId:%s]",t);const n=this._mapMidTransceiver.get(t);if(!n)throw new Error("associated RTCRtpTransceiver not found");n.direction="sendonly",this._remoteSdp.resumeSendingMediaSection(t);const r=await this._pc.createOffer();le.debug("resumeSending() | calling pc.setLocalDescription() [offer:%o]",r),await this._pc.setLocalDescription(r);const s={type:"answer",sdp:this._remoteSdp.getSdp()};le.debug("resumeSending() | calling pc.setRemoteDescription() [answer:%o]",s),await this._pc.setRemoteDescription(s)}async replaceTrack(t,n){this.assertNotClosed(),this.assertSendDirection(),n?le.debug("replaceTrack() [localId:%s, track.id:%s]",t,n.id):le.debug("replaceTrack() [localId:%s, no track]",t);const r=this._mapMidTransceiver.get(t);if(!r)throw new Error("associated RTCRtpTransceiver not found");await r.sender.replaceTrack(n)}async setMaxSpatialLayer(t,n){this.assertNotClosed(),this.assertSendDirection(),le.debug("setMaxSpatialLayer() [localId:%s, spatialLayer:%s]",t,n);const r=this._mapMidTransceiver.get(t);if(!r)throw new Error("associated transceiver not found");const s=r.sender.getParameters();s.encodings.forEach((a,c)=>{c<=n?a.active=!0:a.active=!1}),await r.sender.setParameters(s),this._remoteSdp.muxMediaSectionSimulcast(t,s.encodings);const i=await this._pc.createOffer();le.debug("setMaxSpatialLayer() | calling pc.setLocalDescription() [offer:%o]",i),await this._pc.setLocalDescription(i);const o={type:"answer",sdp:this._remoteSdp.getSdp()};le.debug("setMaxSpatialLayer() | calling pc.setRemoteDescription() [answer:%o]",o),await this._pc.setRemoteDescription(o)}async setRtpEncodingParameters(t,n){this.assertNotClosed(),this.assertSendDirection(),le.debug("setRtpEncodingParameters() [localId:%s, params:%o]",t,n);const r=this._mapMidTransceiver.get(t);if(!r)throw new Error("associated RTCRtpTransceiver not found");const s=r.sender.getParameters();s.encodings.forEach((a,c)=>{s.encodings[c]={...a,...n}}),await r.sender.setParameters(s),this._remoteSdp.muxMediaSectionSimulcast(t,s.encodings);const i=await this._pc.createOffer();le.debug("setRtpEncodingParameters() | calling pc.setLocalDescription() [offer:%o]",i),await this._pc.setLocalDescription(i);const o={type:"answer",sdp:this._remoteSdp.getSdp()};le.debug("setRtpEncodingParameters() | calling pc.setRemoteDescription() [answer:%o]",o),await this._pc.setRemoteDescription(o)}async getSenderStats(t){this.assertNotClosed(),this.assertSendDirection();const n=this._mapMidTransceiver.get(t);if(!n)throw new Error("associated RTCRtpTransceiver not found");return n.sender.getStats()}async sendDataChannel({ordered:t,maxPacketLifeTime:n,maxRetransmits:r,label:s,protocol:i}){this.assertNotClosed(),this.assertSendDirection();const o={negotiated:!0,id:this._nextSendSctpStreamId,ordered:t,maxPacketLifeTime:n,maxRetransmits:r,protocol:i};le.debug("sendDataChannel() [options:%o]",o);const a=this._pc.createDataChannel(s,o);if(this._nextSendSctpStreamId=++this._nextSendSctpStreamId%lh.MIS,!this._hasDataChannelMediaSection){const l=await this._pc.createOffer(),d=Kn.parse(l.sdp),u=d.media.find(h=>h.type==="application");this._transportReady||await this.setupTransport({localDtlsRole:"client",localSdpObject:d}),le.debug("sendDataChannel() | calling pc.setLocalDescription() [offer:%o]",l),await this._pc.setLocalDescription(l),this._remoteSdp.sendSctpAssociation({offerMediaObject:u});const f={type:"answer",sdp:this._remoteSdp.getSdp()};le.debug("sendDataChannel() | calling pc.setRemoteDescription() [answer:%o]",f),await this._pc.setRemoteDescription(f),this._hasDataChannelMediaSection=!0}const c={streamId:o.id,ordered:o.ordered,maxPacketLifeTime:o.maxPacketLifeTime,maxRetransmits:o.maxRetransmits};return{dataChannel:a,sctpStreamParameters:c}}async receive(t){this.assertNotClosed(),this.assertRecvDirection();const n=[],r=new Map;for(const a of t){const{trackId:c,kind:l,rtpParameters:d,streamId:u}=a;le.debug("receive() [trackId:%s, kind:%s]",c,l);const f=d.mid??String(this._mapMidTransceiver.size);r.set(c,f),this._remoteSdp.receive({mid:f,kind:l,offerRtpParameters:d,streamId:u??d.rtcp.cname,trackId:c})}const s={type:"offer",sdp:this._remoteSdp.getSdp()};le.debug("receive() | calling pc.setRemoteDescription() [offer:%o]",s),await this._pc.setRemoteDescription(s);for(const a of t){const{trackId:c,onRtpReceiver:l}=a;if(l){const d=r.get(c),u=this._pc.getTransceivers().find(f=>f.mid===d);if(!u)throw new Error("transceiver not found");l(u.receiver)}}let i=await this._pc.createAnswer();const o=Kn.parse(i.sdp);for(const a of t){const{trackId:c,rtpParameters:l}=a,d=r.get(c),u=o.media.find(f=>String(f.mid)===d);Io.applyCodecParameters({offerRtpParameters:l,answerMediaObject:u}),i={type:"answer",sdp:Kn.write(o)}}this._transportReady||await this.setupTransport({localDtlsRole:"client",localSdpObject:o}),le.debug("receive() | calling pc.setLocalDescription() [answer:%o]",i),await this._pc.setLocalDescription(i);for(const a of t){const{trackId:c}=a,l=r.get(c),d=this._pc.getTransceivers().find(u=>u.mid===l);if(!d)throw new Error("new RTCRtpTransceiver not found");this._mapMidTransceiver.set(l,d),n.push({localId:l,track:d.receiver.track,rtpReceiver:d.receiver})}return n}async stopReceiving(t){if(this.assertRecvDirection(),this._closed)return;for(const s of t){le.debug("stopReceiving() [localId:%s]",s);const i=this._mapMidTransceiver.get(s);if(!i)throw new Error("associated RTCRtpTransceiver not found");this._remoteSdp.closeMediaSection(i.mid)}const n={type:"offer",sdp:this._remoteSdp.getSdp()};le.debug("stopReceiving() | calling pc.setRemoteDescription() [offer:%o]",n),await this._pc.setRemoteDescription(n);const r=await this._pc.createAnswer();le.debug("stopReceiving() | calling pc.setLocalDescription() [answer:%o]",r),await this._pc.setLocalDescription(r);for(const s of t)this._mapMidTransceiver.delete(s)}async pauseReceiving(t){this.assertNotClosed(),this.assertRecvDirection();for(const s of t){le.debug("pauseReceiving() [localId:%s]",s);const i=this._mapMidTransceiver.get(s);if(!i)throw new Error("associated RTCRtpTransceiver not found");i.direction="inactive",this._remoteSdp.pauseMediaSection(s)}const n={type:"offer",sdp:this._remoteSdp.getSdp()};le.debug("pauseReceiving() | calling pc.setRemoteDescription() [offer:%o]",n),await this._pc.setRemoteDescription(n);const r=await this._pc.createAnswer();le.debug("pauseReceiving() | calling pc.setLocalDescription() [answer:%o]",r),await this._pc.setLocalDescription(r)}async resumeReceiving(t){this.assertNotClosed(),this.assertRecvDirection();for(const s of t){le.debug("resumeReceiving() [localId:%s]",s);const i=this._mapMidTransceiver.get(s);if(!i)throw new Error("associated RTCRtpTransceiver not found");i.direction="recvonly",this._remoteSdp.resumeReceivingMediaSection(s)}const n={type:"offer",sdp:this._remoteSdp.getSdp()};le.debug("resumeReceiving() | calling pc.setRemoteDescription() [offer:%o]",n),await this._pc.setRemoteDescription(n);const r=await this._pc.createAnswer();le.debug("resumeReceiving() | calling pc.setLocalDescription() [answer:%o]",r),await this._pc.setLocalDescription(r)}async getReceiverStats(t){this.assertRecvDirection();const n=this._mapMidTransceiver.get(t);if(!n)throw new Error("associated RTCRtpTransceiver not found");return n.receiver.getStats()}async receiveDataChannel({sctpStreamParameters:t,label:n,protocol:r}){this.assertNotClosed(),this.assertRecvDirection();const{streamId:s,ordered:i,maxPacketLifeTime:o,maxRetransmits:a}=t,c={negotiated:!0,id:s,ordered:i,maxPacketLifeTime:o,maxRetransmits:a,protocol:r};le.debug("receiveDataChannel() [options:%o]",c);const l=this._pc.createDataChannel(n,c);if(!this._hasDataChannelMediaSection){this._remoteSdp.receiveSctpAssociation();const d={type:"offer",sdp:this._remoteSdp.getSdp()};le.debug("receiveDataChannel() | calling pc.setRemoteDescription() [offer:%o]",d),await this._pc.setRemoteDescription(d);const u=await this._pc.createAnswer();if(!this._transportReady){const f=Kn.parse(u.sdp);await this.setupTransport({localDtlsRole:"client",localSdpObject:f})}le.debug("receiveDataChannel() | calling pc.setRemoteDescription() [answer:%o]",u),await this._pc.setLocalDescription(u),this._hasDataChannelMediaSection=!0}return{dataChannel:l}}async setupTransport({localDtlsRole:t,localSdpObject:n}){n||(n=Kn.parse(this._pc.localDescription.sdp));const r=Io.extractDtlsParameters({sdpObject:n});r.role=t,this._remoteSdp.updateDtlsRole(t==="client"?"server":"client"),await new Promise((s,i)=>{this.safeEmit("@connect",{dtlsParameters:r},s,i)}),this._transportReady=!0}onIceGatheringStateChange=()=>{this.emit("@icegatheringstatechange",this._pc.iceGatheringState)};onIceCandidateError=t=>{this.emit("@icecandidateerror",t)};onConnectionStateChange=()=>{this.emit("@connectionstatechange",this._pc.connectionState)};onIceConnectionStateChange=()=>{switch(this._pc.iceConnectionState){case"checking":{this.emit("@connectionstatechange","connecting");break}case"connected":case"completed":{this.emit("@connectionstatechange","connected");break}case"failed":{this.emit("@connectionstatechange","failed");break}case"disconnected":{this.emit("@connectionstatechange","disconnected");break}case"closed":{this.emit("@connectionstatechange","closed");break}}};assertNotClosed(){if(this._closed)throw new oh.InvalidStateError("method called in a closed handler")}assertSendDirection(){if(this._direction!=="send")throw new Error('method can just be called for handlers with "send" direction')}assertRecvDirection(){if(this._direction!=="recv")throw new Error('method can just be called for handlers with "recv" direction')}}hc.Firefox120=Ei;var mc={};Object.defineProperty(mc,"__esModule",{value:!0});mc.Safari12=void 0;const mn=st,PC=gt,jC=rt,ii=Oe,LC=mt,DC=_r,IC=xr,No=bn,dh=Sr,NC=Fs,oe=new jC.Logger("Safari12"),uh="Safari12",ph={OS:1024,MIS:1024};class Ri extends PC.EnhancedEventEmitter{_closed=!1;_direction;_remoteSdp;_getSendExtendedRtpCapabilities;_forcedLocalDtlsRole;_pc;_mapMidTransceiver=new Map;_sendStream=new MediaStream;_hasDataChannelMediaSection=!1;_nextSendSctpStreamId=0;_transportReady=!1;static createFactory(){return{name:uh,factory:t=>new Ri(t),getNativeRtpCapabilities:async()=>{oe.debug("getNativeRtpCapabilities()");let t=new RTCPeerConnection({iceServers:[],iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require"});try{t.addTransceiver("audio"),t.addTransceiver("video");const n=await t.createOffer();try{t.close()}catch{}t=void 0;const r=mn.parse(n.sdp);return Ri.getLocalRtpCapabilities(r)}catch(n){try{t?.close()}catch{}throw t=void 0,n}},getNativeSctpCapabilities:async()=>(oe.debug("getNativeSctpCapabilities()"),{numStreams:ph})}}static getLocalRtpCapabilities(t){const n=No.extractRtpCapabilities({sdpObject:t});return ii.validateAndNormalizeRtpCapabilities(n),NC.addNackSupportForOpus(n),n}constructor({direction:t,iceParameters:n,iceCandidates:r,dtlsParameters:s,sctpParameters:i,iceServers:o,iceTransportPolicy:a,additionalSettings:c,getSendExtendedRtpCapabilities:l}){super(),oe.debug("constructor()"),this._direction=t,this._remoteSdp=new IC.RemoteSdp({iceParameters:n,iceCandidates:r,dtlsParameters:s,sctpParameters:i}),this._getSendExtendedRtpCapabilities=l,s.role&&s.role!=="auto"&&(this._forcedLocalDtlsRole=s.role==="server"?"client":"server"),this._pc=new RTCPeerConnection({iceServers:o??[],iceTransportPolicy:a??"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",...c}),this._pc.addEventListener("icegatheringstatechange",()=>{this.emit("@icegatheringstatechange",this._pc.iceGatheringState)}),this._pc.addEventListener("icecandidateerror",d=>{this.emit("@icecandidateerror",d)}),this._pc.addEventListener("icegatheringstatechange",this.onIceGatheringStateChange),this._pc.addEventListener("icecandidateerror",this.onIceCandidateError),this._pc.connectionState?this._pc.addEventListener("connectionstatechange",this.onConnectionStateChange):(oe.warn("run() | pc.connectionState not supported, using pc.iceConnectionState"),this._pc.addEventListener("iceconnectionstatechange",this.onIceConnectionStateChange))}get name(){return uh}close(){if(oe.debug("close()"),!this._closed){this._closed=!0;try{this._pc.close()}catch{}this._pc.removeEventListener("icegatheringstatechange",this.onIceGatheringStateChange),this._pc.removeEventListener("icecandidateerror",this.onIceCandidateError),this._pc.removeEventListener("connectionstatechange",this.onConnectionStateChange),this._pc.removeEventListener("iceconnectionstatechange",this.onIceConnectionStateChange),this.emit("@close"),super.close()}}async updateIceServers(t){this.assertNotClosed(),oe.debug("updateIceServers()");const n=this._pc.getConfiguration();n.iceServers=t,this._pc.setConfiguration(n)}async restartIce(t){if(this.assertNotClosed(),oe.debug("restartIce()"),this._remoteSdp.updateIceParameters(t),!!this._transportReady)if(this._direction==="send"){const n=await this._pc.createOffer({iceRestart:!0});oe.debug("restartIce() | calling pc.setLocalDescription() [offer:%o]",n),await this._pc.setLocalDescription(n);const r={type:"answer",sdp:this._remoteSdp.getSdp()};oe.debug("restartIce() | calling pc.setRemoteDescription() [answer:%o]",r),await this._pc.setRemoteDescription(r)}else{const n={type:"offer",sdp:this._remoteSdp.getSdp()};oe.debug("restartIce() | calling pc.setRemoteDescription() [offer:%o]",n),await this._pc.setRemoteDescription(n);const r=await this._pc.createAnswer();oe.debug("restartIce() | calling pc.setLocalDescription() [answer:%o]",r),await this._pc.setLocalDescription(r)}}async getTransportStats(){return this.assertNotClosed(),this._pc.getStats()}async send({track:t,encodings:n,codecOptions:r,codec:s,onRtpSender:i}){this.assertNotClosed(),this.assertSendDirection(),oe.debug("send() [kind:%s, track.id:%s]",t.kind,t.id);const o=this._remoteSdp.getNextMediaSectionIdx(),a=this._pc.addTransceiver(t,{direction:"sendonly",streams:[this._sendStream]});i&&i(a.sender);let c=await this._pc.createOffer(),l=mn.parse(c.sdp);l.extmapAllowMixed&&this._remoteSdp.setSessionExtmapAllowMixed();const d=Ri.getLocalRtpCapabilities(l),u=this._getSendExtendedRtpCapabilities(d),f=ii.getSendingRtpParameters(t.kind,u);f.codecs=ii.reduceCodecs(f.codecs,s);const h=ii.getSendingRemoteRtpParameters(t.kind,u);h.codecs=ii.reduceCodecs(h.codecs,s);let v;this._transportReady||await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:l});const y=(0,DC.parse)((n??[{}])[0].scalabilityMode);n&&n.length>1&&(oe.debug("send() | enabling legacy simulcast"),l=mn.parse(c.sdp),v=l.media[o.idx],dh.addLegacySimulcast({offerMediaObject:v,numStreams:n.length}),c={type:"offer",sdp:mn.write(l)}),oe.debug("send() | calling pc.setLocalDescription() [offer:%o]",c),await this._pc.setLocalDescription(c);const x=a.mid;if(f.mid=x,l=mn.parse(this._pc.localDescription.sdp),v=l.media[o.idx],f.rtcp.cname=No.getCname({offerMediaObject:v}),f.encodings=dh.getRtpEncodings({offerMediaObject:v}),n)for(let m=0;m<f.encodings.length;++m)n[m]&&Object.assign(f.encodings[m],n[m]);if(f.encodings.length>1&&(f.codecs[0].mimeType.toLowerCase()==="video/vp8"||f.codecs[0].mimeType.toLowerCase()==="video/h264"))for(const m of f.encodings)m.scalabilityMode?m.scalabilityMode=`L1T${y.temporalLayers}`:m.scalabilityMode="L1T3";this._remoteSdp.send({offerMediaObject:v,reuseMid:o.reuseMid,offerRtpParameters:f,answerRtpParameters:h,codecOptions:r});const g={type:"answer",sdp:this._remoteSdp.getSdp()};return oe.debug("send() | calling pc.setRemoteDescription() [answer:%o]",g),await this._pc.setRemoteDescription(g),this._mapMidTransceiver.set(x,a),{localId:x,rtpParameters:f,rtpSender:a.sender}}async stopSending(t){if(this.assertSendDirection(),this._closed)return;oe.debug("stopSending() [localId:%s]",t);const n=this._mapMidTransceiver.get(t);if(!n)throw new Error("associated RTCRtpTransceiver not found");if(n.sender.replaceTrack(null),this._pc.removeTrack(n.sender),this._remoteSdp.closeMediaSection(n.mid))try{n.stop()}catch{}const s=await this._pc.createOffer();oe.debug("stopSending() | calling pc.setLocalDescription() [offer:%o]",s),await this._pc.setLocalDescription(s);const i={type:"answer",sdp:this._remoteSdp.getSdp()};oe.debug("stopSending() | calling pc.setRemoteDescription() [answer:%o]",i),await this._pc.setRemoteDescription(i),this._mapMidTransceiver.delete(t)}async pauseSending(t){this.assertNotClosed(),this.assertSendDirection(),oe.debug("pauseSending() [localId:%s]",t);const n=this._mapMidTransceiver.get(t);if(!n)throw new Error("associated RTCRtpTransceiver not found");n.direction="inactive",this._remoteSdp.pauseMediaSection(t);const r=await this._pc.createOffer();oe.debug("pauseSending() | calling pc.setLocalDescription() [offer:%o]",r),await this._pc.setLocalDescription(r);const s={type:"answer",sdp:this._remoteSdp.getSdp()};oe.debug("pauseSending() | calling pc.setRemoteDescription() [answer:%o]",s),await this._pc.setRemoteDescription(s)}async resumeSending(t){this.assertNotClosed(),this.assertSendDirection(),oe.debug("resumeSending() [localId:%s]",t);const n=this._mapMidTransceiver.get(t);if(!n)throw new Error("associated RTCRtpTransceiver not found");n.direction="sendonly",this._remoteSdp.resumeSendingMediaSection(t);const r=await this._pc.createOffer();oe.debug("resumeSending() | calling pc.setLocalDescription() [offer:%o]",r),await this._pc.setLocalDescription(r);const s={type:"answer",sdp:this._remoteSdp.getSdp()};oe.debug("resumeSending() | calling pc.setRemoteDescription() [answer:%o]",s),await this._pc.setRemoteDescription(s)}async replaceTrack(t,n){this.assertNotClosed(),this.assertSendDirection(),n?oe.debug("replaceTrack() [localId:%s, track.id:%s]",t,n.id):oe.debug("replaceTrack() [localId:%s, no track]",t);const r=this._mapMidTransceiver.get(t);if(!r)throw new Error("associated RTCRtpTransceiver not found");await r.sender.replaceTrack(n)}async setMaxSpatialLayer(t,n){this.assertNotClosed(),this.assertSendDirection(),oe.debug("setMaxSpatialLayer() [localId:%s, spatialLayer:%s]",t,n);const r=this._mapMidTransceiver.get(t);if(!r)throw new Error("associated RTCRtpTransceiver not found");const s=r.sender.getParameters();s.encodings.forEach((a,c)=>{c<=n?a.active=!0:a.active=!1}),await r.sender.setParameters(s),this._remoteSdp.muxMediaSectionSimulcast(t,s.encodings);const i=await this._pc.createOffer();oe.debug("setMaxSpatialLayer() | calling pc.setLocalDescription() [offer:%o]",i),await this._pc.setLocalDescription(i);const o={type:"answer",sdp:this._remoteSdp.getSdp()};oe.debug("setMaxSpatialLayer() | calling pc.setRemoteDescription() [answer:%o]",o),await this._pc.setRemoteDescription(o)}async setRtpEncodingParameters(t,n){this.assertNotClosed(),this.assertSendDirection(),oe.debug("setRtpEncodingParameters() [localId:%s, params:%o]",t,n);const r=this._mapMidTransceiver.get(t);if(!r)throw new Error("associated RTCRtpTransceiver not found");const s=r.sender.getParameters();s.encodings.forEach((a,c)=>{s.encodings[c]={...a,...n}}),await r.sender.setParameters(s),this._remoteSdp.muxMediaSectionSimulcast(t,s.encodings);const i=await this._pc.createOffer();oe.debug("setRtpEncodingParameters() | calling pc.setLocalDescription() [offer:%o]",i),await this._pc.setLocalDescription(i);const o={type:"answer",sdp:this._remoteSdp.getSdp()};oe.debug("setRtpEncodingParameters() | calling pc.setRemoteDescription() [answer:%o]",o),await this._pc.setRemoteDescription(o)}async getSenderStats(t){this.assertNotClosed(),this.assertSendDirection();const n=this._mapMidTransceiver.get(t);if(!n)throw new Error("associated RTCRtpTransceiver not found");return n.sender.getStats()}async sendDataChannel({ordered:t,maxPacketLifeTime:n,maxRetransmits:r,label:s,protocol:i}){this.assertNotClosed(),this.assertSendDirection();const o={negotiated:!0,id:this._nextSendSctpStreamId,ordered:t,maxPacketLifeTime:n,maxRetransmits:r,protocol:i};oe.debug("sendDataChannel() [options:%o]",o);const a=this._pc.createDataChannel(s,o);if(this._nextSendSctpStreamId=++this._nextSendSctpStreamId%ph.MIS,!this._hasDataChannelMediaSection){const l=await this._pc.createOffer(),d=mn.parse(l.sdp),u=d.media.find(h=>h.type==="application");this._transportReady||await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:d}),oe.debug("sendDataChannel() | calling pc.setLocalDescription() [offer:%o]",l),await this._pc.setLocalDescription(l),this._remoteSdp.sendSctpAssociation({offerMediaObject:u});const f={type:"answer",sdp:this._remoteSdp.getSdp()};oe.debug("sendDataChannel() | calling pc.setRemoteDescription() [answer:%o]",f),await this._pc.setRemoteDescription(f),this._hasDataChannelMediaSection=!0}const c={streamId:o.id,ordered:o.ordered,maxPacketLifeTime:o.maxPacketLifeTime,maxRetransmits:o.maxRetransmits};return{dataChannel:a,sctpStreamParameters:c}}async receive(t){this.assertNotClosed(),this.assertRecvDirection();const n=[],r=new Map;for(const a of t){const{trackId:c,kind:l,rtpParameters:d,streamId:u}=a;oe.debug("receive() [trackId:%s, kind:%s]",c,l);const f=d.mid??String(this._mapMidTransceiver.size);r.set(c,f),this._remoteSdp.receive({mid:f,kind:l,offerRtpParameters:d,streamId:u??d.rtcp.cname,trackId:c})}const s={type:"offer",sdp:this._remoteSdp.getSdp()};oe.debug("receive() | calling pc.setRemoteDescription() [offer:%o]",s),await this._pc.setRemoteDescription(s);for(const a of t){const{trackId:c,onRtpReceiver:l}=a;if(l){const d=r.get(c),u=this._pc.getTransceivers().find(f=>f.mid===d);if(!u)throw new Error("transceiver not found");l(u.receiver)}}let i=await this._pc.createAnswer();const o=mn.parse(i.sdp);for(const a of t){const{trackId:c,rtpParameters:l}=a,d=r.get(c),u=o.media.find(f=>String(f.mid)===d);No.applyCodecParameters({offerRtpParameters:l,answerMediaObject:u})}i={type:"answer",sdp:mn.write(o)},this._transportReady||await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:o}),oe.debug("receive() | calling pc.setLocalDescription() [answer:%o]",i),await this._pc.setLocalDescription(i);for(const a of t){const{trackId:c}=a,l=r.get(c),d=this._pc.getTransceivers().find(u=>u.mid===l);if(!d)throw new Error("new RTCRtpTransceiver not found");this._mapMidTransceiver.set(l,d),n.push({localId:l,track:d.receiver.track,rtpReceiver:d.receiver})}return n}async stopReceiving(t){if(this.assertRecvDirection(),this._closed)return;for(const s of t){oe.debug("stopReceiving() [localId:%s]",s);const i=this._mapMidTransceiver.get(s);if(!i)throw new Error("associated RTCRtpTransceiver not found");this._remoteSdp.closeMediaSection(i.mid)}const n={type:"offer",sdp:this._remoteSdp.getSdp()};oe.debug("stopReceiving() | calling pc.setRemoteDescription() [offer:%o]",n),await this._pc.setRemoteDescription(n);const r=await this._pc.createAnswer();oe.debug("stopReceiving() | calling pc.setLocalDescription() [answer:%o]",r),await this._pc.setLocalDescription(r);for(const s of t)this._mapMidTransceiver.delete(s)}async pauseReceiving(t){this.assertNotClosed(),this.assertRecvDirection();for(const s of t){oe.debug("pauseReceiving() [localId:%s]",s);const i=this._mapMidTransceiver.get(s);if(!i)throw new Error("associated RTCRtpTransceiver not found");i.direction="inactive",this._remoteSdp.pauseMediaSection(s)}const n={type:"offer",sdp:this._remoteSdp.getSdp()};oe.debug("pauseReceiving() | calling pc.setRemoteDescription() [offer:%o]",n),await this._pc.setRemoteDescription(n);const r=await this._pc.createAnswer();oe.debug("pauseReceiving() | calling pc.setLocalDescription() [answer:%o]",r),await this._pc.setLocalDescription(r)}async resumeReceiving(t){this.assertNotClosed(),this.assertRecvDirection();for(const s of t){oe.debug("resumeReceiving() [localId:%s]",s);const i=this._mapMidTransceiver.get(s);if(!i)throw new Error("associated RTCRtpTransceiver not found");i.direction="recvonly",this._remoteSdp.resumeReceivingMediaSection(s)}const n={type:"offer",sdp:this._remoteSdp.getSdp()};oe.debug("resumeReceiving() | calling pc.setRemoteDescription() [offer:%o]",n),await this._pc.setRemoteDescription(n);const r=await this._pc.createAnswer();oe.debug("resumeReceiving() | calling pc.setLocalDescription() [answer:%o]",r),await this._pc.setLocalDescription(r)}async getReceiverStats(t){this.assertNotClosed(),this.assertRecvDirection();const n=this._mapMidTransceiver.get(t);if(!n)throw new Error("associated RTCRtpTransceiver not found");return n.receiver.getStats()}async receiveDataChannel({sctpStreamParameters:t,label:n,protocol:r}){this.assertNotClosed(),this.assertRecvDirection();const{streamId:s,ordered:i,maxPacketLifeTime:o,maxRetransmits:a}=t,c={negotiated:!0,id:s,ordered:i,maxPacketLifeTime:o,maxRetransmits:a,protocol:r};oe.debug("receiveDataChannel() [options:%o]",c);const l=this._pc.createDataChannel(n,c);if(!this._hasDataChannelMediaSection){this._remoteSdp.receiveSctpAssociation();const d={type:"offer",sdp:this._remoteSdp.getSdp()};oe.debug("receiveDataChannel() | calling pc.setRemoteDescription() [offer:%o]",d),await this._pc.setRemoteDescription(d);const u=await this._pc.createAnswer();if(!this._transportReady){const f=mn.parse(u.sdp);await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:f})}oe.debug("receiveDataChannel() | calling pc.setRemoteDescription() [answer:%o]",u),await this._pc.setLocalDescription(u),this._hasDataChannelMediaSection=!0}return{dataChannel:l}}async setupTransport({localDtlsRole:t,localSdpObject:n}){n||(n=mn.parse(this._pc.localDescription.sdp));const r=No.extractDtlsParameters({sdpObject:n});r.role=t,this._remoteSdp.updateDtlsRole(t==="client"?"server":"client"),await new Promise((s,i)=>{this.safeEmit("@connect",{dtlsParameters:r},s,i)}),this._transportReady=!0}onIceGatheringStateChange=()=>{this.emit("@icegatheringstatechange",this._pc.iceGatheringState)};onIceCandidateError=t=>{this.emit("@icecandidateerror",t)};onConnectionStateChange=()=>{this.emit("@connectionstatechange",this._pc.connectionState)};onIceConnectionStateChange=()=>{switch(this._pc.iceConnectionState){case"checking":{this.emit("@connectionstatechange","connecting");break}case"connected":case"completed":{this.emit("@connectionstatechange","connected");break}case"failed":{this.emit("@connectionstatechange","failed");break}case"disconnected":{this.emit("@connectionstatechange","disconnected");break}case"closed":{this.emit("@connectionstatechange","closed");break}}};assertNotClosed(){if(this._closed)throw new LC.InvalidStateError("method called in a closed handler")}assertSendDirection(){if(this._direction!=="send")throw new Error('method can just be called for handlers with "send" direction')}assertRecvDirection(){if(this._direction!=="recv")throw new Error('method can just be called for handlers with "recv" direction')}}mc.Safari12=Ri;var gc={};Object.defineProperty(gc,"__esModule",{value:!0});gc.ReactNative106=void 0;const gn=st,MC=gt,AC=rt,oi=Oe,OC=mt,$C=_r,FC=xr,Mo=bn,ll=Sr,zC=Fs,se=new AC.Logger("ReactNative106"),fh="ReactNative106",hh={OS:1024,MIS:1024};class ki extends MC.EnhancedEventEmitter{_closed=!1;_direction;_remoteSdp;_getSendExtendedRtpCapabilities;_forcedLocalDtlsRole;_pc;_mapMidTransceiver=new Map;_sendStream=new MediaStream;_hasDataChannelMediaSection=!1;_nextSendSctpStreamId=0;_transportReady=!1;static createFactory(){return{name:fh,factory:t=>new ki(t),getNativeRtpCapabilities:async()=>{se.debug("getNativeRtpCapabilities()");let t=new RTCPeerConnection({iceServers:[],iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require"});try{t.addTransceiver("audio"),t.addTransceiver("video");const n=await t.createOffer();try{t.close()}catch{}t=void 0;const r=gn.parse(n.sdp);return ki.getLocalRtpCapabilities(r)}catch(n){try{t?.close()}catch{}throw t=void 0,n}},getNativeSctpCapabilities:async()=>(se.debug("getNativeSctpCapabilities()"),{numStreams:hh})}}static getLocalRtpCapabilities(t){const n=Mo.extractRtpCapabilities({sdpObject:t});return oi.validateAndNormalizeRtpCapabilities(n),zC.addNackSupportForOpus(n),n}constructor({direction:t,iceParameters:n,iceCandidates:r,dtlsParameters:s,sctpParameters:i,iceServers:o,iceTransportPolicy:a,additionalSettings:c,getSendExtendedRtpCapabilities:l}){super(),se.debug("constructor()"),this._direction=t,this._remoteSdp=new FC.RemoteSdp({iceParameters:n,iceCandidates:r,dtlsParameters:s,sctpParameters:i}),this._getSendExtendedRtpCapabilities=l,s.role&&s.role!=="auto"&&(this._forcedLocalDtlsRole=s.role==="server"?"client":"server"),this._pc=new RTCPeerConnection({iceServers:o??[],iceTransportPolicy:a??"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",...c}),this._pc.addEventListener("icegatheringstatechange",this.onIceGatheringStateChange),this._pc.addEventListener("icecandidateerror",this.onIceCandidateError),this._pc.connectionState?this._pc.addEventListener("connectionstatechange",this.onConnectionStateChange):(se.warn("run() | pc.connectionState not supported, using pc.iceConnectionState"),this._pc.addEventListener("iceconnectionstatechange",this.onIceConnectionStateChange))}get name(){return fh}close(){if(se.debug("close()"),!this._closed){this._closed=!0,this._sendStream.release(!1);try{this._pc.close()}catch{}this._pc.removeEventListener("icegatheringstatechange",this.onIceGatheringStateChange),this._pc.removeEventListener("icecandidateerror",this.onIceCandidateError),this._pc.removeEventListener("connectionstatechange",this.onConnectionStateChange),this._pc.removeEventListener("iceconnectionstatechange",this.onIceConnectionStateChange),this.emit("@close"),super.close()}}async updateIceServers(t){this.assertNotClosed(),se.debug("updateIceServers()");const n=this._pc.getConfiguration();n.iceServers=t,this._pc.setConfiguration(n)}async restartIce(t){if(this.assertNotClosed(),se.debug("restartIce()"),this._remoteSdp.updateIceParameters(t),!!this._transportReady)if(this._direction==="send"){const n=await this._pc.createOffer({iceRestart:!0});se.debug("restartIce() | calling pc.setLocalDescription() [offer:%o]",n),await this._pc.setLocalDescription(n);const r={type:"answer",sdp:this._remoteSdp.getSdp()};se.debug("restartIce() | calling pc.setRemoteDescription() [answer:%o]",r),await this._pc.setRemoteDescription(r)}else{const n={type:"offer",sdp:this._remoteSdp.getSdp()};se.debug("restartIce() | calling pc.setRemoteDescription() [offer:%o]",n),await this._pc.setRemoteDescription(n);const r=await this._pc.createAnswer();se.debug("restartIce() | calling pc.setLocalDescription() [answer:%o]",r),await this._pc.setLocalDescription(r)}}async getTransportStats(){return this.assertNotClosed(),this._pc.getStats()}async send({track:t,encodings:n,codecOptions:r,codec:s,onRtpSender:i}){this.assertNotClosed(),this.assertSendDirection(),se.debug("send() [kind:%s, track.id:%s]",t.kind,t.id),n&&n.length>1&&n.forEach((w,C)=>{w.rid=`r${C}`});const o=this._remoteSdp.getNextMediaSectionIdx(),a=this._pc.addTransceiver(t,{direction:"sendonly",streams:[this._sendStream],sendEncodings:n});i&&i(a.sender);let c=await this._pc.createOffer(),l=gn.parse(c.sdp);l.extmapAllowMixed&&this._remoteSdp.setSessionExtmapAllowMixed();const d=ki.getLocalRtpCapabilities(l),u=this._getSendExtendedRtpCapabilities(d),f=oi.getSendingRtpParameters(t.kind,u);f.codecs=oi.reduceCodecs(f.codecs,s);const h=oi.getSendingRemoteRtpParameters(t.kind,u);h.codecs=oi.reduceCodecs(h.codecs,s),this._transportReady||await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:l});let v=!1;const y=(0,$C.parse)((n??[{}])[0].scalabilityMode);let x;n&&n.length===1&&y.spatialLayers>1&&f.codecs[0].mimeType.toLowerCase()==="video/vp9"&&(se.debug("send() | enabling legacy simulcast for VP9 SVC"),v=!0,l=gn.parse(c.sdp),x=l.media[o.idx],ll.addLegacySimulcast({offerMediaObject:x,numStreams:y.spatialLayers}),c={type:"offer",sdp:gn.write(l)}),se.debug("send() | calling pc.setLocalDescription() [offer:%o]",c),await this._pc.setLocalDescription(c);let g=a.mid??void 0;if(g||se.warn("send() | missing transceiver.mid (bug in react-native-webrtc, using a workaround"),f.mid=g,l=gn.parse(this._pc.localDescription.sdp),x=l.media[o.idx],f.rtcp.cname=Mo.getCname({offerMediaObject:x}),!n)f.encodings=ll.getRtpEncodings({offerMediaObject:x});else if(n.length===1){let w=ll.getRtpEncodings({offerMediaObject:x});Object.assign(w[0],n[0]),v&&(w=[w[0]]),f.encodings=w}else f.encodings=n;if(f.encodings.length>1&&(f.codecs[0].mimeType.toLowerCase()==="video/vp8"||f.codecs[0].mimeType.toLowerCase()==="video/h264"))for(const w of f.encodings)w.scalabilityMode?w.scalabilityMode=`L1T${y.temporalLayers}`:w.scalabilityMode="L1T3";this._remoteSdp.send({offerMediaObject:x,reuseMid:o.reuseMid,offerRtpParameters:f,answerRtpParameters:h,codecOptions:r});const m={type:"answer",sdp:this._remoteSdp.getSdp()};return se.debug("send() | calling pc.setRemoteDescription() [answer:%o]",m),await this._pc.setRemoteDescription(m),g||(g=a.mid,f.mid=g),this._mapMidTransceiver.set(g,a),{localId:g,rtpParameters:f,rtpSender:a.sender}}async stopSending(t){if(this.assertSendDirection(),this._closed)return;se.debug("stopSending() [localId:%s]",t);const n=this._mapMidTransceiver.get(t);if(!n)throw new Error("associated RTCRtpTransceiver not found");if(n.sender.replaceTrack(null),this._pc.removeTrack(n.sender),this._remoteSdp.closeMediaSection(n.mid))try{n.stop()}catch{}const s=await this._pc.createOffer();se.debug("stopSending() | calling pc.setLocalDescription() [offer:%o]",s),await this._pc.setLocalDescription(s);const i={type:"answer",sdp:this._remoteSdp.getSdp()};se.debug("stopSending() | calling pc.setRemoteDescription() [answer:%o]",i),await this._pc.setRemoteDescription(i),this._mapMidTransceiver.delete(t)}async pauseSending(t){this.assertNotClosed(),this.assertSendDirection(),se.debug("pauseSending() [localId:%s]",t);const n=this._mapMidTransceiver.get(t);if(!n)throw new Error("associated RTCRtpTransceiver not found");n.direction="inactive",this._remoteSdp.pauseMediaSection(t);const r=await this._pc.createOffer();se.debug("pauseSending() | calling pc.setLocalDescription() [offer:%o]",r),await this._pc.setLocalDescription(r);const s={type:"answer",sdp:this._remoteSdp.getSdp()};se.debug("pauseSending() | calling pc.setRemoteDescription() [answer:%o]",s),await this._pc.setRemoteDescription(s)}async resumeSending(t){this.assertNotClosed(),this.assertSendDirection(),se.debug("resumeSending() [localId:%s]",t);const n=this._mapMidTransceiver.get(t);if(this._remoteSdp.resumeSendingMediaSection(t),!n)throw new Error("associated RTCRtpTransceiver not found");n.direction="sendonly";const r=await this._pc.createOffer();se.debug("resumeSending() | calling pc.setLocalDescription() [offer:%o]",r),await this._pc.setLocalDescription(r);const s={type:"answer",sdp:this._remoteSdp.getSdp()};se.debug("resumeSending() | calling pc.setRemoteDescription() [answer:%o]",s),await this._pc.setRemoteDescription(s)}async replaceTrack(t,n){this.assertNotClosed(),this.assertSendDirection(),n?se.debug("replaceTrack() [localId:%s, track.id:%s]",t,n.id):se.debug("replaceTrack() [localId:%s, no track]",t);const r=this._mapMidTransceiver.get(t);if(!r)throw new Error("associated RTCRtpTransceiver not found");await r.sender.replaceTrack(n)}async setMaxSpatialLayer(t,n){this.assertNotClosed(),this.assertSendDirection(),se.debug("setMaxSpatialLayer() [localId:%s, spatialLayer:%s]",t,n);const r=this._mapMidTransceiver.get(t);if(!r)throw new Error("associated RTCRtpTransceiver not found");const s=r.sender.getParameters();s.encodings.forEach((a,c)=>{c<=n?a.active=!0:a.active=!1}),await r.sender.setParameters(s),this._remoteSdp.muxMediaSectionSimulcast(t,s.encodings);const i=await this._pc.createOffer();se.debug("setMaxSpatialLayer() | calling pc.setLocalDescription() [offer:%o]",i),await this._pc.setLocalDescription(i);const o={type:"answer",sdp:this._remoteSdp.getSdp()};se.debug("setMaxSpatialLayer() | calling pc.setRemoteDescription() [answer:%o]",o),await this._pc.setRemoteDescription(o)}async setRtpEncodingParameters(t,n){this.assertNotClosed(),this.assertSendDirection(),se.debug("setRtpEncodingParameters() [localId:%s, params:%o]",t,n);const r=this._mapMidTransceiver.get(t);if(!r)throw new Error("associated RTCRtpTransceiver not found");const s=r.sender.getParameters();s.encodings.forEach((a,c)=>{s.encodings[c]={...a,...n}}),await r.sender.setParameters(s),this._remoteSdp.muxMediaSectionSimulcast(t,s.encodings);const i=await this._pc.createOffer();se.debug("setRtpEncodingParameters() | calling pc.setLocalDescription() [offer:%o]",i),await this._pc.setLocalDescription(i);const o={type:"answer",sdp:this._remoteSdp.getSdp()};se.debug("setRtpEncodingParameters() | calling pc.setRemoteDescription() [answer:%o]",o),await this._pc.setRemoteDescription(o)}async getSenderStats(t){this.assertNotClosed(),this.assertSendDirection();const n=this._mapMidTransceiver.get(t);if(!n)throw new Error("associated RTCRtpTransceiver not found");return n.sender.getStats()}async sendDataChannel({ordered:t,maxPacketLifeTime:n,maxRetransmits:r,label:s,protocol:i}){this.assertNotClosed(),this.assertSendDirection();const o={negotiated:!0,id:this._nextSendSctpStreamId,ordered:t,maxPacketLifeTime:n,maxRetransmits:r,protocol:i};se.debug("sendDataChannel() [options:%o]",o);const a=this._pc.createDataChannel(s,o);if(this._nextSendSctpStreamId=++this._nextSendSctpStreamId%hh.MIS,!this._hasDataChannelMediaSection){const l=await this._pc.createOffer(),d=gn.parse(l.sdp),u=d.media.find(h=>h.type==="application");this._transportReady||await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:d}),se.debug("sendDataChannel() | calling pc.setLocalDescription() [offer:%o]",l),await this._pc.setLocalDescription(l),this._remoteSdp.sendSctpAssociation({offerMediaObject:u});const f={type:"answer",sdp:this._remoteSdp.getSdp()};se.debug("sendDataChannel() | calling pc.setRemoteDescription() [answer:%o]",f),await this._pc.setRemoteDescription(f),this._hasDataChannelMediaSection=!0}const c={streamId:o.id,ordered:o.ordered,maxPacketLifeTime:o.maxPacketLifeTime,maxRetransmits:o.maxRetransmits};return{dataChannel:a,sctpStreamParameters:c}}async receive(t){this.assertNotClosed(),this.assertRecvDirection();const n=[],r=new Map;for(const a of t){const{trackId:c,kind:l,rtpParameters:d,streamId:u}=a;se.debug("receive() [trackId:%s, kind:%s]",c,l);const f=d.mid??String(this._mapMidTransceiver.size);r.set(c,f),this._remoteSdp.receive({mid:f,kind:l,offerRtpParameters:d,streamId:u??d.rtcp.cname,trackId:c})}const s={type:"offer",sdp:this._remoteSdp.getSdp()};se.debug("receive() | calling pc.setRemoteDescription() [offer:%o]",s),await this._pc.setRemoteDescription(s);for(const a of t){const{trackId:c,onRtpReceiver:l}=a;if(l){const d=r.get(c),u=this._pc.getTransceivers().find(f=>f.mid===d);if(!u)throw new Error("transceiver not found");l(u.receiver)}}let i=await this._pc.createAnswer();const o=gn.parse(i.sdp);for(const a of t){const{trackId:c,rtpParameters:l}=a,d=r.get(c),u=o.media.find(f=>String(f.mid)===d);Mo.applyCodecParameters({offerRtpParameters:l,answerMediaObject:u})}i={type:"answer",sdp:gn.write(o)},this._transportReady||await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:o}),se.debug("receive() | calling pc.setLocalDescription() [answer:%o]",i),await this._pc.setLocalDescription(i);for(const a of t){const{trackId:c}=a,l=r.get(c),d=this._pc.getTransceivers().find(u=>u.mid===l);if(d)this._mapMidTransceiver.set(l,d),n.push({localId:l,track:d.receiver.track,rtpReceiver:d.receiver});else throw new Error("new RTCRtpTransceiver not found")}return n}async stopReceiving(t){if(this.assertRecvDirection(),this._closed)return;for(const s of t){se.debug("stopReceiving() [localId:%s]",s);const i=this._mapMidTransceiver.get(s);if(!i)throw new Error("associated RTCRtpTransceiver not found");this._remoteSdp.closeMediaSection(i.mid)}const n={type:"offer",sdp:this._remoteSdp.getSdp()};se.debug("stopReceiving() | calling pc.setRemoteDescription() [offer:%o]",n),await this._pc.setRemoteDescription(n);const r=await this._pc.createAnswer();se.debug("stopReceiving() | calling pc.setLocalDescription() [answer:%o]",r),await this._pc.setLocalDescription(r);for(const s of t)this._mapMidTransceiver.delete(s)}async pauseReceiving(t){this.assertNotClosed(),this.assertRecvDirection();for(const s of t){se.debug("pauseReceiving() [localId:%s]",s);const i=this._mapMidTransceiver.get(s);if(!i)throw new Error("associated RTCRtpTransceiver not found");i.direction="inactive",this._remoteSdp.pauseMediaSection(s)}const n={type:"offer",sdp:this._remoteSdp.getSdp()};se.debug("pauseReceiving() | calling pc.setRemoteDescription() [offer:%o]",n),await this._pc.setRemoteDescription(n);const r=await this._pc.createAnswer();se.debug("pauseReceiving() | calling pc.setLocalDescription() [answer:%o]",r),await this._pc.setLocalDescription(r)}async resumeReceiving(t){this.assertNotClosed(),this.assertRecvDirection();for(const s of t){se.debug("resumeReceiving() [localId:%s]",s);const i=this._mapMidTransceiver.get(s);if(!i)throw new Error("associated RTCRtpTransceiver not found");i.direction="recvonly",this._remoteSdp.resumeReceivingMediaSection(s)}const n={type:"offer",sdp:this._remoteSdp.getSdp()};se.debug("resumeReceiving() | calling pc.setRemoteDescription() [offer:%o]",n),await this._pc.setRemoteDescription(n);const r=await this._pc.createAnswer();se.debug("resumeReceiving() | calling pc.setLocalDescription() [answer:%o]",r),await this._pc.setLocalDescription(r)}async getReceiverStats(t){this.assertNotClosed(),this.assertRecvDirection();const n=this._mapMidTransceiver.get(t);if(!n)throw new Error("associated RTCRtpTransceiver not found");return n.receiver.getStats()}async receiveDataChannel({sctpStreamParameters:t,label:n,protocol:r}){this.assertNotClosed(),this.assertRecvDirection();const{streamId:s,ordered:i,maxPacketLifeTime:o,maxRetransmits:a}=t,c={negotiated:!0,id:s,ordered:i,maxPacketLifeTime:o,maxRetransmits:a,protocol:r};se.debug("receiveDataChannel() [options:%o]",c);const l=this._pc.createDataChannel(n,c);if(!this._hasDataChannelMediaSection){this._remoteSdp.receiveSctpAssociation();const d={type:"offer",sdp:this._remoteSdp.getSdp()};se.debug("receiveDataChannel() | calling pc.setRemoteDescription() [offer:%o]",d),await this._pc.setRemoteDescription(d);const u=await this._pc.createAnswer();if(!this._transportReady){const f=gn.parse(u.sdp);await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:f})}se.debug("receiveDataChannel() | calling pc.setRemoteDescription() [answer:%o]",u),await this._pc.setLocalDescription(u),this._hasDataChannelMediaSection=!0}return{dataChannel:l}}async setupTransport({localDtlsRole:t,localSdpObject:n}){n||(n=gn.parse(this._pc.localDescription.sdp));const r=Mo.extractDtlsParameters({sdpObject:n});r.role=t,this._remoteSdp.updateDtlsRole(t==="client"?"server":"client"),await new Promise((s,i)=>{this.safeEmit("@connect",{dtlsParameters:r},s,i)}),this._transportReady=!0}onIceGatheringStateChange=()=>{this.emit("@icegatheringstatechange",this._pc.iceGatheringState)};onIceCandidateError=t=>{this.emit("@icecandidateerror",t)};onConnectionStateChange=()=>{this.emit("@connectionstatechange",this._pc.connectionState)};onIceConnectionStateChange=()=>{switch(this._pc.iceConnectionState){case"checking":{this.emit("@connectionstatechange","connecting");break}case"connected":case"completed":{this.emit("@connectionstatechange","connected");break}case"failed":{this.emit("@connectionstatechange","failed");break}case"disconnected":{this.emit("@connectionstatechange","disconnected");break}case"closed":{this.emit("@connectionstatechange","closed");break}}};assertNotClosed(){if(this._closed)throw new OC.InvalidStateError("method called in a closed handler")}assertSendDirection(){if(this._direction!=="send")throw new Error('method can just be called for handlers with "send" direction')}assertRecvDirection(){if(this._direction!=="recv")throw new Error('method can just be called for handlers with "recv" direction')}}gc.ReactNative106=ki;Object.defineProperty($s,"__esModule",{value:!0});$s.Device=void 0;$s.detectDevice=Xv;$s.detectDeviceAsync=Yv;const ms=xx,UC=rt,BC=gt,Cr=mt,dl=xn,Pn=Oe,VC=ic,WC=pc,HC=fc,QC=hc,KC=mc,qC=gc,Ze=new UC.Logger("Device");function Xv(e){Ze.debug("detectDevice() [userAgent:%s]",e),!e&&typeof navigator=="object"&&(e=navigator.userAgent);const t=new ms.default(e);return Jv(t)}async function Yv(e){Ze.debug("detectDeviceAsync() [userAgent:%s]",e),!e&&typeof navigator=="object"&&(e=navigator.userAgent);const t=new ms.default(e);return Jv(t)}class Uu{_handlerFactory;_handlerName;_loaded=!1;_getSendExtendedRtpCapabilities;_recvRtpCapabilities;_canProduceByKind={audio:!1,video:!1};_sctpCapabilities;_observer=new BC.EnhancedEventEmitter;static async factory({handlerName:t,handlerFactory:n}={}){if(Ze.debug("factory()"),t&&n)throw new TypeError("just one of handlerName or handlerInterface can be given");if(!t&&!n&&(t=await Yv(),!t))throw new Cr.UnsupportedError("device not supported");return new Uu({handlerName:t,handlerFactory:n})}constructor({handlerName:t,handlerFactory:n}={}){if(Ze.debug("constructor()"),t&&n)throw new TypeError("just one of handlerName or handlerInterface can be given");if(n)this._handlerFactory=n;else{if(t)Ze.debug("constructor() | handler given: %s",t);else if(t=Xv(),t)Ze.debug("constructor() | detected handler: %s",t);else throw new Cr.UnsupportedError("device not supported");switch(t){case"Chrome111":{this._handlerFactory=WC.Chrome111.createFactory();break}case"Chrome74":{this._handlerFactory=HC.Chrome74.createFactory();break}case"Firefox120":{this._handlerFactory=QC.Firefox120.createFactory();break}case"Safari12":{this._handlerFactory=KC.Safari12.createFactory();break}case"ReactNative106":{this._handlerFactory=qC.ReactNative106.createFactory();break}default:throw new TypeError(`unknown handlerName "${t}"`)}}this._handlerName=this._handlerFactory.name}get handlerName(){return this._handlerName}get loaded(){return this._loaded}get rtpCapabilities(){if(!this._loaded)throw new Cr.InvalidStateError("not loaded");return this._recvRtpCapabilities}get sctpCapabilities(){if(!this._loaded)throw new Cr.InvalidStateError("not loaded");return this._sctpCapabilities}get observer(){return this._observer}async load({routerRtpCapabilities:t,preferLocalCodecsOrder:n=!1}){if(Ze.debug("load() [routerRtpCapabilities:%o]",t),this._loaded)throw new Cr.InvalidStateError("already loaded");const r=dl.clone(t);Pn.validateAndNormalizeRtpCapabilities(r);const{getNativeRtpCapabilities:s,getNativeSctpCapabilities:i}=this._handlerFactory,o=dl.clone(await s());Pn.validateAndNormalizeRtpCapabilities(o),Ze.debug("load() | got native RTP capabilities:%o",o),this._getSendExtendedRtpCapabilities=c=>dl.clone(Pn.getExtendedRtpCapabilities(c,r,n));const a=Pn.getExtendedRtpCapabilities(o,r,!1);this._recvRtpCapabilities=Pn.getRecvRtpCapabilities(a),Pn.validateAndNormalizeRtpCapabilities(this._recvRtpCapabilities),Ze.debug("load() | got receiving RTP capabilities:%o",this._recvRtpCapabilities),this._canProduceByKind.audio=Pn.canSend("audio",this._recvRtpCapabilities),this._canProduceByKind.video=Pn.canSend("video",this._recvRtpCapabilities),this._sctpCapabilities=await i(),Pn.validateSctpCapabilities(this._sctpCapabilities),Ze.debug("load() | got native SCTP capabilities:%o",this._sctpCapabilities),Ze.debug("load() succeeded"),this._loaded=!0}canProduce(t){if(this._loaded){if(t!=="audio"&&t!=="video")throw new TypeError(`invalid kind "${t}"`)}else throw new Cr.InvalidStateError("not loaded");return this._canProduceByKind[t]}createSendTransport({id:t,iceParameters:n,iceCandidates:r,dtlsParameters:s,sctpParameters:i,iceServers:o,iceTransportPolicy:a,additionalSettings:c,appData:l}){return Ze.debug("createSendTransport()"),this.createTransport({direction:"send",id:t,iceParameters:n,iceCandidates:r,dtlsParameters:s,sctpParameters:i,iceServers:o,iceTransportPolicy:a,additionalSettings:c,appData:l})}createRecvTransport({id:t,iceParameters:n,iceCandidates:r,dtlsParameters:s,sctpParameters:i,iceServers:o,iceTransportPolicy:a,additionalSettings:c,appData:l}){return Ze.debug("createRecvTransport()"),this.createTransport({direction:"recv",id:t,iceParameters:n,iceCandidates:r,dtlsParameters:s,sctpParameters:i,iceServers:o,iceTransportPolicy:a,additionalSettings:c,appData:l})}createTransport({direction:t,id:n,iceParameters:r,iceCandidates:s,dtlsParameters:i,sctpParameters:o,iceServers:a,iceTransportPolicy:c,additionalSettings:l,appData:d}){if(this._loaded){if(typeof n!="string")throw new TypeError("missing id");if(typeof r!="object")throw new TypeError("missing iceParameters");if(Array.isArray(s)){if(typeof i!="object")throw new TypeError("missing dtlsParameters");if(o&&typeof o!="object")throw new TypeError("wrong sctpParameters");if(d&&typeof d!="object")throw new TypeError("if given, appData must be an object")}else throw new TypeError("missing iceCandidates")}else throw new Cr.InvalidStateError("not loaded");const u=new VC.Transport({direction:t,id:n,iceParameters:r,iceCandidates:s,dtlsParameters:i,sctpParameters:o,iceServers:a,iceTransportPolicy:c,additionalSettings:l,appData:d,handlerFactory:this._handlerFactory,getSendExtendedRtpCapabilities:this._getSendExtendedRtpCapabilities,recvRtpCapabilities:this._recvRtpCapabilities,canProduceByKind:this._canProduceByKind});return this._observer.safeEmit("newtransport",u),u}}$s.Device=Uu;function Jv(e){if(typeof navigator=="object"&&navigator.product==="ReactNative"){if(Ze.debug("detectDeviceImpl() | React-Native detected"),typeof RTCPeerConnection>"u"||typeof RTCRtpTransceiver>"u"){Ze.warn("detectDeviceImpl() | unsupported react-native-webrtc without RTCPeerConnection or RTCRtpTransceiver, forgot to call registerGlobals() on it?");return}return"ReactNative106"}else{const t=e.parseUserAgent(),n=/^\d+/.exec(t?.shortVersion??"0"),r=parseInt(n?.[0]??"0",10),s=t.platform===ms.KnownPlatforms.iphone||t.platform===ms.KnownPlatforms.ipad||t.platform===ms.KnownPlatforms.mac&&(t.isMobile||t.isTablet||typeof navigator=="object"&&navigator?.maxTouchPoints>=2),i=t.isChrome,o=t.isFireFox,a=t.isSafari,c=t.isEdge,l=t.isDesktop&&t.name===ms.KnownBrowsers.electron,d=t.isWebkit,u={browserMajorVersion:r,isIOS:s,isChrome:i,isFirefox:o,isSafari:a,isElectron:l,isWebkit:d};if(Ze.debug("detectDeviceImpl() | detected browser [userAgent:%s, parsed:%o, result:%o]",t.userAgent,t,u),(i||c)&&!s&&r>=111)return"Chrome111";if(i&&!s&&r>=74||c&&!s&&r>=88)return"Chrome74";if(l)return"Chrome111";if(o&&!s&&r>=120)return"Firefox120";if(a&&r>=12&&typeof RTCRtpTransceiver<"u"&&RTCRtpTransceiver.prototype.hasOwnProperty("currentDirection"))return"Safari12";if(s&&typeof RTCRtpTransceiver<"u"&&RTCRtpTransceiver.prototype.hasOwnProperty("currentDirection"))return"Safari12";if(d){const f=e.userAgent?.match(/(?:(?:Chrome|Chromium))[ /](\w+)/i);return f?Number(f[1])>=111?"Chrome111":"Chrome74":"Chrome111"}else{Ze.warn("detectDeviceImpl() | browser not supported [userAgent:%s, parsed:%o, result:%o]",t.userAgent,t,u);return}}}var vc={},yc={},Zv={},Bu={};Object.defineProperty(Bu,"__esModule",{value:!0});Bu.default="ffffffff-ffff-ffff-ffff-ffffffffffff";var Vu={};Object.defineProperty(Vu,"__esModule",{value:!0});Vu.default="00000000-0000-0000-0000-000000000000";var zs={},Us={},Wu={};Object.defineProperty(Wu,"__esModule",{value:!0});Wu.default=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-8][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000|ffffffff-ffff-ffff-ffff-ffffffffffff)$/i;Object.defineProperty(Us,"__esModule",{value:!0});const GC=Wu;function XC(e){return typeof e=="string"&&GC.default.test(e)}Us.default=XC;Object.defineProperty(zs,"__esModule",{value:!0});const YC=Us;function JC(e){if(!(0,YC.default)(e))throw TypeError("Invalid UUID");let t;return Uint8Array.of((t=parseInt(e.slice(0,8),16))>>>24,t>>>16&255,t>>>8&255,t&255,(t=parseInt(e.slice(9,13),16))>>>8,t&255,(t=parseInt(e.slice(14,18),16))>>>8,t&255,(t=parseInt(e.slice(19,23),16))>>>8,t&255,(t=parseInt(e.slice(24,36),16))/1099511627776&255,t/4294967296&255,t>>>24&255,t>>>16&255,t>>>8&255,t&255)}zs.default=JC;var qt={};Object.defineProperty(qt,"__esModule",{value:!0});qt.unsafeStringify=void 0;const ZC=Us,Xe=[];for(let e=0;e<256;++e)Xe.push((e+256).toString(16).slice(1));function ey(e,t=0){return(Xe[e[t+0]]+Xe[e[t+1]]+Xe[e[t+2]]+Xe[e[t+3]]+"-"+Xe[e[t+4]]+Xe[e[t+5]]+"-"+Xe[e[t+6]]+Xe[e[t+7]]+"-"+Xe[e[t+8]]+Xe[e[t+9]]+"-"+Xe[e[t+10]]+Xe[e[t+11]]+Xe[e[t+12]]+Xe[e[t+13]]+Xe[e[t+14]]+Xe[e[t+15]]).toLowerCase()}qt.unsafeStringify=ey;function eE(e,t=0){const n=ey(e,t);if(!(0,ZC.default)(n))throw TypeError("Stringified UUID is invalid");return n}qt.default=eE;var Bs={},io={};Object.defineProperty(io,"__esModule",{value:!0});let ul;const tE=new Uint8Array(16);function nE(){if(!ul){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");ul=crypto.getRandomValues.bind(crypto)}return ul(tE)}io.default=nE;Object.defineProperty(Bs,"__esModule",{value:!0});Bs.updateV1State=void 0;const mh=io,rE=qt,ai={};function sE(e,t,n){let r;const s=e?._v6??!1;if(e){const i=Object.keys(e);i.length===1&&i[0]==="_v6"&&(e=void 0)}if(e)r=gh(e.random??e.rng?.()??(0,mh.default)(),e.msecs,e.nsecs,e.clockseq,e.node,t,n);else{const i=Date.now(),o=(0,mh.default)();ty(ai,i,o),r=gh(o,ai.msecs,ai.nsecs,s?void 0:ai.clockseq,s?void 0:ai.node,t,n)}return t??(0,rE.unsafeStringify)(r)}function ty(e,t,n){return e.msecs??=-1/0,e.nsecs??=0,t===e.msecs?(e.nsecs++,e.nsecs>=1e4&&(e.node=void 0,e.nsecs=0)):t>e.msecs?e.nsecs=0:t<e.msecs&&(e.node=void 0),e.node||(e.node=n.slice(10,16),e.node[0]|=1,e.clockseq=(n[8]<<8|n[9])&16383),e.msecs=t,e}Bs.updateV1State=ty;function gh(e,t,n,r,s,i,o=0){if(e.length<16)throw new Error("Random bytes length must be >= 16");if(!i)i=new Uint8Array(16),o=0;else if(o<0||o+16>i.length)throw new RangeError(`UUID byte range ${o}:${o+15} is out of buffer bounds`);t??=Date.now(),n??=0,r??=(e[8]<<8|e[9])&16383,s??=e.slice(10,16),t+=122192928e5;const a=((t&268435455)*1e4+n)%4294967296;i[o++]=a>>>24&255,i[o++]=a>>>16&255,i[o++]=a>>>8&255,i[o++]=a&255;const c=t/4294967296*1e4&268435455;i[o++]=c>>>8&255,i[o++]=c&255,i[o++]=c>>>24&15|16,i[o++]=c>>>16&255,i[o++]=r>>>8|128,i[o++]=r&255;for(let l=0;l<6;++l)i[o++]=s[l];return i}Bs.default=sE;var wc={};Object.defineProperty(wc,"__esModule",{value:!0});const iE=zs,oE=qt;function aE(e){const t=typeof e=="string"?(0,iE.default)(e):e,n=cE(t);return typeof e=="string"?(0,oE.unsafeStringify)(n):n}wc.default=aE;function cE(e){return Uint8Array.of((e[6]&15)<<4|e[7]>>4&15,(e[7]&15)<<4|(e[4]&240)>>4,(e[4]&15)<<4|(e[5]&240)>>4,(e[5]&15)<<4|(e[0]&240)>>4,(e[0]&15)<<4|(e[1]&240)>>4,(e[1]&15)<<4|(e[2]&240)>>4,96|e[2]&15,e[3],e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15])}var ny={},Hu={};Object.defineProperty(Hu,"__esModule",{value:!0});function lE(e){const t=pE(e),n=uE(t,e.length*8);return dE(n)}function dE(e){const t=new Uint8Array(e.length*4);for(let n=0;n<e.length*4;n++)t[n]=e[n>>2]>>>n%4*8&255;return t}function ry(e){return(e+64>>>9<<4)+14+1}function uE(e,t){const n=new Uint32Array(ry(t)).fill(0);n.set(e),n[t>>5]|=128<<t%32,n[n.length-1]=t,e=n;let r=1732584193,s=-271733879,i=-1732584194,o=271733878;for(let a=0;a<e.length;a+=16){const c=r,l=s,d=i,u=o;r=ct(r,s,i,o,e[a],7,-680876936),o=ct(o,r,s,i,e[a+1],12,-389564586),i=ct(i,o,r,s,e[a+2],17,606105819),s=ct(s,i,o,r,e[a+3],22,-1044525330),r=ct(r,s,i,o,e[a+4],7,-176418897),o=ct(o,r,s,i,e[a+5],12,1200080426),i=ct(i,o,r,s,e[a+6],17,-1473231341),s=ct(s,i,o,r,e[a+7],22,-45705983),r=ct(r,s,i,o,e[a+8],7,1770035416),o=ct(o,r,s,i,e[a+9],12,-1958414417),i=ct(i,o,r,s,e[a+10],17,-42063),s=ct(s,i,o,r,e[a+11],22,-1990404162),r=ct(r,s,i,o,e[a+12],7,1804603682),o=ct(o,r,s,i,e[a+13],12,-40341101),i=ct(i,o,r,s,e[a+14],17,-1502002290),s=ct(s,i,o,r,e[a+15],22,1236535329),r=lt(r,s,i,o,e[a+1],5,-165796510),o=lt(o,r,s,i,e[a+6],9,-1069501632),i=lt(i,o,r,s,e[a+11],14,643717713),s=lt(s,i,o,r,e[a],20,-373897302),r=lt(r,s,i,o,e[a+5],5,-701558691),o=lt(o,r,s,i,e[a+10],9,38016083),i=lt(i,o,r,s,e[a+15],14,-660478335),s=lt(s,i,o,r,e[a+4],20,-405537848),r=lt(r,s,i,o,e[a+9],5,568446438),o=lt(o,r,s,i,e[a+14],9,-1019803690),i=lt(i,o,r,s,e[a+3],14,-187363961),s=lt(s,i,o,r,e[a+8],20,1163531501),r=lt(r,s,i,o,e[a+13],5,-1444681467),o=lt(o,r,s,i,e[a+2],9,-51403784),i=lt(i,o,r,s,e[a+7],14,1735328473),s=lt(s,i,o,r,e[a+12],20,-1926607734),r=dt(r,s,i,o,e[a+5],4,-378558),o=dt(o,r,s,i,e[a+8],11,-2022574463),i=dt(i,o,r,s,e[a+11],16,1839030562),s=dt(s,i,o,r,e[a+14],23,-35309556),r=dt(r,s,i,o,e[a+1],4,-1530992060),o=dt(o,r,s,i,e[a+4],11,1272893353),i=dt(i,o,r,s,e[a+7],16,-155497632),s=dt(s,i,o,r,e[a+10],23,-1094730640),r=dt(r,s,i,o,e[a+13],4,681279174),o=dt(o,r,s,i,e[a],11,-358537222),i=dt(i,o,r,s,e[a+3],16,-722521979),s=dt(s,i,o,r,e[a+6],23,76029189),r=dt(r,s,i,o,e[a+9],4,-640364487),o=dt(o,r,s,i,e[a+12],11,-421815835),i=dt(i,o,r,s,e[a+15],16,530742520),s=dt(s,i,o,r,e[a+2],23,-995338651),r=ut(r,s,i,o,e[a],6,-198630844),o=ut(o,r,s,i,e[a+7],10,1126891415),i=ut(i,o,r,s,e[a+14],15,-1416354905),s=ut(s,i,o,r,e[a+5],21,-57434055),r=ut(r,s,i,o,e[a+12],6,1700485571),o=ut(o,r,s,i,e[a+3],10,-1894986606),i=ut(i,o,r,s,e[a+10],15,-1051523),s=ut(s,i,o,r,e[a+1],21,-2054922799),r=ut(r,s,i,o,e[a+8],6,1873313359),o=ut(o,r,s,i,e[a+15],10,-30611744),i=ut(i,o,r,s,e[a+6],15,-1560198380),s=ut(s,i,o,r,e[a+13],21,1309151649),r=ut(r,s,i,o,e[a+4],6,-145523070),o=ut(o,r,s,i,e[a+11],10,-1120210379),i=ut(i,o,r,s,e[a+2],15,718787259),s=ut(s,i,o,r,e[a+9],21,-343485551),r=nr(r,c),s=nr(s,l),i=nr(i,d),o=nr(o,u)}return Uint32Array.of(r,s,i,o)}function pE(e){if(e.length===0)return new Uint32Array;const t=new Uint32Array(ry(e.length*8)).fill(0);for(let n=0;n<e.length;n++)t[n>>2]|=(e[n]&255)<<n%4*8;return t}function nr(e,t){const n=(e&65535)+(t&65535);return(e>>16)+(t>>16)+(n>>16)<<16|n&65535}function fE(e,t){return e<<t|e>>>32-t}function _c(e,t,n,r,s,i){return nr(fE(nr(nr(t,e),nr(r,i)),s),n)}function ct(e,t,n,r,s,i,o){return _c(t&n|~t&r,e,t,s,i,o)}function lt(e,t,n,r,s,i,o){return _c(t&r|n&~r,e,t,s,i,o)}function dt(e,t,n,r,s,i,o){return _c(t^n^r,e,t,s,i,o)}function ut(e,t,n,r,s,i,o){return _c(n^(t|~r),e,t,s,i,o)}Hu.default=lE;var Wt={};Object.defineProperty(Wt,"__esModule",{value:!0});Wt.URL=Wt.DNS=Wt.stringToBytes=void 0;const vh=zs,hE=qt;function sy(e){e=unescape(encodeURIComponent(e));const t=new Uint8Array(e.length);for(let n=0;n<e.length;++n)t[n]=e.charCodeAt(n);return t}Wt.stringToBytes=sy;Wt.DNS="6ba7b810-9dad-11d1-80b4-00c04fd430c8";Wt.URL="6ba7b811-9dad-11d1-80b4-00c04fd430c8";function mE(e,t,n,r,s,i){const o=typeof n=="string"?sy(n):n,a=typeof r=="string"?(0,vh.default)(r):r;if(typeof r=="string"&&(r=(0,vh.default)(r)),r?.length!==16)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");let c=new Uint8Array(16+o.length);if(c.set(a),c.set(o,a.length),c=t(c),c[6]=c[6]&15|e,c[8]=c[8]&63|128,s){i=i||0;for(let l=0;l<16;++l)s[i+l]=c[l];return s}return(0,hE.unsafeStringify)(c)}Wt.default=mE;(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.URL=e.DNS=void 0;const t=Hu,n=Wt;var r=Wt;Object.defineProperty(e,"DNS",{enumerable:!0,get:function(){return r.DNS}}),Object.defineProperty(e,"URL",{enumerable:!0,get:function(){return r.URL}});function s(i,o,a,c){return(0,n.default)(48,t.default,i,o,a,c)}s.DNS=n.DNS,s.URL=n.URL,e.default=s})(ny);var Qu={},Ku={};Object.defineProperty(Ku,"__esModule",{value:!0});const gE=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto);Ku.default={randomUUID:gE};Object.defineProperty(Qu,"__esModule",{value:!0});const yh=Ku,vE=io,yE=qt;function wE(e,t,n){if(yh.default.randomUUID&&!t&&!e)return yh.default.randomUUID();e=e||{};const r=e.random??e.rng?.()??(0,vE.default)();if(r.length<16)throw new Error("Random bytes length must be >= 16");if(r[6]=r[6]&15|64,r[8]=r[8]&63|128,t){if(n=n||0,n<0||n+16>t.length)throw new RangeError(`UUID byte range ${n}:${n+15} is out of buffer bounds`);for(let s=0;s<16;++s)t[n+s]=r[s];return t}return(0,yE.unsafeStringify)(r)}Qu.default=wE;var iy={},qu={};Object.defineProperty(qu,"__esModule",{value:!0});function _E(e,t,n,r){switch(e){case 0:return t&n^~t&r;case 1:return t^n^r;case 2:return t&n^t&r^n&r;case 3:return t^n^r}}function pl(e,t){return e<<t|e>>>32-t}function SE(e){const t=[1518500249,1859775393,2400959708,3395469782],n=[1732584193,4023233417,2562383102,271733878,3285377520],r=new Uint8Array(e.length+1);r.set(e),r[e.length]=128,e=r;const s=e.length/4+2,i=Math.ceil(s/16),o=new Array(i);for(let a=0;a<i;++a){const c=new Uint32Array(16);for(let l=0;l<16;++l)c[l]=e[a*64+l*4]<<24|e[a*64+l*4+1]<<16|e[a*64+l*4+2]<<8|e[a*64+l*4+3];o[a]=c}o[i-1][14]=(e.length-1)*8/Math.pow(2,32),o[i-1][14]=Math.floor(o[i-1][14]),o[i-1][15]=(e.length-1)*8&4294967295;for(let a=0;a<i;++a){const c=new Uint32Array(80);for(let v=0;v<16;++v)c[v]=o[a][v];for(let v=16;v<80;++v)c[v]=pl(c[v-3]^c[v-8]^c[v-14]^c[v-16],1);let l=n[0],d=n[1],u=n[2],f=n[3],h=n[4];for(let v=0;v<80;++v){const y=Math.floor(v/20),x=pl(l,5)+_E(y,d,u,f)+h+t[y]+c[v]>>>0;h=f,f=u,u=pl(d,30)>>>0,d=l,l=x}n[0]=n[0]+l>>>0,n[1]=n[1]+d>>>0,n[2]=n[2]+u>>>0,n[3]=n[3]+f>>>0,n[4]=n[4]+h>>>0}return Uint8Array.of(n[0]>>24,n[0]>>16,n[0]>>8,n[0],n[1]>>24,n[1]>>16,n[1]>>8,n[1],n[2]>>24,n[2]>>16,n[2]>>8,n[2],n[3]>>24,n[3]>>16,n[3]>>8,n[3],n[4]>>24,n[4]>>16,n[4]>>8,n[4])}qu.default=SE;(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.URL=e.DNS=void 0;const t=qu,n=Wt;var r=Wt;Object.defineProperty(e,"DNS",{enumerable:!0,get:function(){return r.DNS}}),Object.defineProperty(e,"URL",{enumerable:!0,get:function(){return r.URL}});function s(i,o,a,c){return(0,n.default)(80,t.default,i,o,a,c)}s.DNS=n.DNS,s.URL=n.URL,e.default=s})(iy);var Gu={};Object.defineProperty(Gu,"__esModule",{value:!0});const xE=qt,bE=Bs,CE=wc;function EE(e,t,n){e??={},n??=0;let r=(0,bE.default)({...e,_v6:!0},new Uint8Array(16));if(r=(0,CE.default)(r),t){for(let s=0;s<16;s++)t[n+s]=r[s];return t}return(0,xE.unsafeStringify)(r)}Gu.default=EE;var Xu={};Object.defineProperty(Xu,"__esModule",{value:!0});const RE=zs,kE=qt;function TE(e){const t=typeof e=="string"?(0,RE.default)(e):e,n=PE(t);return typeof e=="string"?(0,kE.unsafeStringify)(n):n}Xu.default=TE;function PE(e){return Uint8Array.of((e[3]&15)<<4|e[4]>>4&15,(e[4]&15)<<4|(e[5]&240)>>4,(e[5]&15)<<4|e[6]&15,e[7],(e[1]&15)<<4|(e[2]&240)>>4,(e[2]&15)<<4|(e[3]&240)>>4,16|(e[0]&240)>>4,(e[0]&15)<<4|(e[1]&240)>>4,e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15])}var oo={};Object.defineProperty(oo,"__esModule",{value:!0});oo.updateV7State=void 0;const wh=io,jE=qt,fl={};function LE(e,t,n){let r;if(e)r=_h(e.random??e.rng?.()??(0,wh.default)(),e.msecs,e.seq,t,n);else{const s=Date.now(),i=(0,wh.default)();oy(fl,s,i),r=_h(i,fl.msecs,fl.seq,t,n)}return t??(0,jE.unsafeStringify)(r)}function oy(e,t,n){return e.msecs??=-1/0,e.seq??=0,t>e.msecs?(e.seq=n[6]<<23|n[7]<<16|n[8]<<8|n[9],e.msecs=t):(e.seq=e.seq+1|0,e.seq===0&&e.msecs++),e}oo.updateV7State=oy;function _h(e,t,n,r,s=0){if(e.length<16)throw new Error("Random bytes length must be >= 16");if(!r)r=new Uint8Array(16),s=0;else if(s<0||s+16>r.length)throw new RangeError(`UUID byte range ${s}:${s+15} is out of buffer bounds`);return t??=Date.now(),n??=e[6]*127<<24|e[7]<<16|e[8]<<8|e[9],r[s++]=t/1099511627776&255,r[s++]=t/4294967296&255,r[s++]=t/16777216&255,r[s++]=t/65536&255,r[s++]=t/256&255,r[s++]=t&255,r[s++]=112|n>>>28&15,r[s++]=n>>>20&255,r[s++]=128|n>>>14&63,r[s++]=n>>>6&255,r[s++]=n<<2&255|e[10]&3,r[s++]=e[11],r[s++]=e[12],r[s++]=e[13],r[s++]=e[14],r[s++]=e[15],r}oo.default=LE;var Yu={};Object.defineProperty(Yu,"__esModule",{value:!0});const DE=Us;function IE(e){if(!(0,DE.default)(e))throw TypeError("Invalid UUID");return parseInt(e.slice(14,15),16)}Yu.default=IE;(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.version=e.validate=e.v7=e.v6ToV1=e.v6=e.v5=e.v4=e.v3=e.v1ToV6=e.v1=e.stringify=e.parse=e.NIL=e.MAX=void 0;var t=Bu;Object.defineProperty(e,"MAX",{enumerable:!0,get:function(){return t.default}});var n=Vu;Object.defineProperty(e,"NIL",{enumerable:!0,get:function(){return n.default}});var r=zs;Object.defineProperty(e,"parse",{enumerable:!0,get:function(){return r.default}});var s=qt;Object.defineProperty(e,"stringify",{enumerable:!0,get:function(){return s.default}});var i=Bs;Object.defineProperty(e,"v1",{enumerable:!0,get:function(){return i.default}});var o=wc;Object.defineProperty(e,"v1ToV6",{enumerable:!0,get:function(){return o.default}});var a=ny;Object.defineProperty(e,"v3",{enumerable:!0,get:function(){return a.default}});var c=Qu;Object.defineProperty(e,"v4",{enumerable:!0,get:function(){return c.default}});var l=iy;Object.defineProperty(e,"v5",{enumerable:!0,get:function(){return l.default}});var d=Gu;Object.defineProperty(e,"v6",{enumerable:!0,get:function(){return d.default}});var u=Xu;Object.defineProperty(e,"v6ToV1",{enumerable:!0,get:function(){return u.default}});var f=oo;Object.defineProperty(e,"v7",{enumerable:!0,get:function(){return f.default}});var h=Us;Object.defineProperty(e,"validate",{enumerable:!0,get:function(){return h.default}});var v=Yu;Object.defineProperty(e,"version",{enumerable:!0,get:function(){return v.default}})})(Zv);var Sc={};Object.defineProperty(Sc,"__esModule",{value:!0});Sc.FakeEventTarget=void 0;let NE=class{listeners={};addEventListener(t,n,r){n&&(this.listeners[t]??=[],this.listeners[t].push({callback:typeof n=="function"?n:n.handleEvent,once:typeof r=="object"&&r.once===!0}))}removeEventListener(t,n,r){this.listeners[t]&&n&&(this.listeners[t]=this.listeners[t].filter(s=>s.callback!==(typeof n=="function"?n:n.handleEvent)))}dispatchEvent(t){if(!t||typeof t.type!="string")throw new Error("invalid event object");const n=this.listeners[t.type];if(!n)return!0;for(const r of[...n]){try{r.callback.call(this,t)}catch(s){setTimeout(()=>{throw s},0)}r.once&&this.removeEventListener(t.type,r.callback)}return!t.defaultPrevented}};Sc.FakeEventTarget=NE;var xc={};Object.defineProperty(xc,"__esModule",{value:!0});xc.FakeEvent=void 0;class ME{NONE=0;CAPTURING_PHASE=1;AT_TARGET=2;BUBBLING_PHASE=3;type;bubbles;cancelable;defaultPrevented=!1;composed=!1;currentTarget=null;eventPhase=this.NONE;isTrusted=!0;target=null;timeStamp=0;cancelBubble=!1;returnValue=!0;srcElement=null;constructor(t,n={}){this.type=t,this.bubbles=n.bubbles??!1,this.cancelable=n.cancelable??!1}preventDefault(){this.cancelable&&(this.defaultPrevented=!0)}stopPropagation(){}stopImmediatePropagation(){}composedPath(){return[]}initEvent(t,n,r){}}xc.FakeEvent=ME;var Ju={};Object.defineProperty(Ju,"__esModule",{value:!0});Ju.clone=AE;function AE(e){if(e!==void 0)return Number.isNaN(e)?NaN:typeof structuredClone=="function"?structuredClone(e):JSON.parse(JSON.stringify(e))}Object.defineProperty(yc,"__esModule",{value:!0});yc.FakeMediaStreamTrack=void 0;const Sh=Zv,OE=Sc,es=xc,Ao=Ju;class Zu extends OE.FakeEventTarget{#m;#u;#p;#e;#n;#t;#r;#f;#s;#h;#i;#o=null;#a=null;#c=null;#l=null;#d=null;constructor({kind:t,id:n,label:r,contentHint:s,enabled:i,muted:o,readyState:a,capabilities:c,constraints:l,settings:d,data:u}){super(),this.#m=n??(0,Sh.v4)(),this.#u=t,this.#p=r??"",this.#r=s??"",this.#n=i??!0,this.#t=o??!1,this.#e=a??"live",this.#f=c??{},this.#s=l??{},this.#h=d??{},this.#i=u??{}}get id(){return this.#m}get kind(){return this.#u}get label(){return this.#p}get contentHint(){return this.#r}set contentHint(t){this.#r=t}get enabled(){return this.#n}set enabled(t){const n=this.#n!==t;this.#n=t,n&&this.dispatchEvent(new es.FakeEvent("enabledchange"))}get muted(){return this.#t}get readyState(){return this.#e}get data(){return this.#i}set data(t){this.#i=t}get onmute(){return this.#o}set onmute(t){this.#o&&this.removeEventListener("mute",this.#o),this.#o=t,t&&this.addEventListener("mute",t)}get onunmute(){return this.#a}set onunmute(t){this.#a&&this.removeEventListener("unmute",this.#a),this.#a=t,t&&this.addEventListener("unmute",t)}get onended(){return this.#c}set onended(t){this.#c&&this.removeEventListener("ended",this.#c),this.#c=t,t&&this.addEventListener("ended",t)}get onenabledchange(){return this.#l}set onenabledchange(t){this.#l&&this.removeEventListener("enabledchange",this.#l),this.#l=t,t&&this.addEventListener("enabledchange",t)}get onstopped(){return this.#d}set onstopped(t){this.#d&&this.removeEventListener("stopped",this.#d),this.#d=t,t&&this.addEventListener("stopped",t)}addEventListener(t,n,r){super.addEventListener(t,n,r)}removeEventListener(t,n,r){super.removeEventListener(t,n,r)}stop(){this.#e!=="ended"&&(this.#e="ended",this.dispatchEvent(new es.FakeEvent("stopped")))}clone({id:t,data:n}={}){return new Zu({id:t??(0,Sh.v4)(),kind:this.#u,label:this.#p,contentHint:this.#r,enabled:this.#n,muted:this.#t,readyState:this.#e,capabilities:(0,Ao.clone)(this.#f),constraints:(0,Ao.clone)(this.#s),settings:(0,Ao.clone)(this.#h),data:n??(0,Ao.clone)(this.#i)})}getCapabilities(){return this.#f}getConstraints(){return this.#s}async applyConstraints(t={}){return this.#s=t,Promise.resolve()}getSettings(){return this.#h}remoteStop(){this.#e!=="ended"&&(this.#e="ended",this.dispatchEvent(new es.FakeEvent("stopped")),this.dispatchEvent(new es.FakeEvent("ended")))}remoteMute(){this.#t||(this.#t=!0,this.dispatchEvent(new es.FakeEvent("mute")))}remoteUnmute(){this.#t&&(this.#t=!1,this.dispatchEvent(new es.FakeEvent("unmute")))}}yc.FakeMediaStreamTrack=Zu;var bc={};Object.defineProperty(bc,"__esModule",{value:!0});bc.FakeEventTarget=void 0;class $E{listeners={};addEventListener(t,n,r){n&&(this.listeners[t]??=[],this.listeners[t].push({callback:typeof n=="function"?n:n.handleEvent,once:typeof r=="object"&&r.once===!0}))}removeEventListener(t,n,r){this.listeners[t]&&n&&(this.listeners[t]=this.listeners[t].filter(s=>s.callback!==(typeof n=="function"?n:n.handleEvent)))}dispatchEvent(t){if(!t||typeof t.type!="string")throw new Error("invalid event object");const n=this.listeners[t.type];if(!n)return!0;for(const r of[...n]){try{r.callback.call(this,t)}catch(s){setTimeout(()=>{throw s},0)}r.once&&this.removeEventListener(t.type,r.callback)}return!t.defaultPrevented}}bc.FakeEventTarget=$E;Object.defineProperty(vc,"__esModule",{value:!0});vc.FakeHandler=void 0;const FE=yc,zE=gt,UE=rt,ci=xn,hl=Oe,ay=mt,BE=bc,Ye=new UE.Logger("FakeHandler"),xh="FakeHandler";class Ti extends zE.EnhancedEventEmitter{_closed=!1;_fakeParameters;_getSendExtendedRtpCapabilities;_cname=`CNAME-${ci.generateRandomNumber()}`;_transportReady=!1;_nextLocalId=1;_tracks=new Map;_nextSctpStreamId=0;static createFactory(t){return{name:xh,factory:n=>new Ti(n,t),getNativeRtpCapabilities:async()=>(Ye.debug("getNativeRtpCapabilities()"),Ti.getLocalRtpCapabilities(t)),getNativeSctpCapabilities:async()=>(Ye.debug("getNativeSctpCapabilities()"),t.generateNativeSctpCapabilities())}}static getLocalRtpCapabilities(t){const n=t.generateNativeRtpCapabilities();return hl.validateAndNormalizeRtpCapabilities(n),n}constructor({getSendExtendedRtpCapabilities:t},n){super(),Ye.debug("constructor()"),this._getSendExtendedRtpCapabilities=t,this._fakeParameters=n}get name(){return xh}close(){Ye.debug("close()"),!this._closed&&(this._closed=!0,super.close())}setIceGatheringState(t){this.emit("@icegatheringstatechange",t)}setConnectionState(t){this.emit("@connectionstatechange",t)}async updateIceServers(t){this.assertNotClosed(),Ye.debug("updateIceServers()")}async restartIce(t){this.assertNotClosed(),Ye.debug("restartIce()")}async getTransportStats(){return this.assertNotClosed(),new Map}async send({track:t,encodings:n,codecOptions:r,codec:s}){this.assertNotClosed(),Ye.debug("send() [kind:%s, track.id:%s]",t.kind,t.id),this._transportReady||await this.setupTransport({localDtlsRole:"server"});const i=Ti.getLocalRtpCapabilities(this._fakeParameters),o=this._getSendExtendedRtpCapabilities(i),a=hl.getSendingRtpParameters(t.kind,o);a.codecs=hl.reduceCodecs(a.codecs,s);const c=a.codecs.some(d=>/.+\/rtx$/i.test(d.mimeType));a.mid=`mid-${ci.generateRandomNumber()}`,n||(n=[{}]);for(const d of n)d.ssrc=ci.generateRandomNumber(),c&&(d.rtx={ssrc:ci.generateRandomNumber()});a.encodings=n,a.rtcp={cname:this._cname,reducedSize:!0,mux:!0};const l=this._nextLocalId++;return this._tracks.set(l,t),{localId:String(l),rtpParameters:a}}async stopSending(t){if(Ye.debug("stopSending() [localId:%s]",t),!this._closed){if(!this._tracks.has(Number(t)))throw new Error("local track not found");this._tracks.delete(Number(t))}}async pauseSending(t){this.assertNotClosed()}async resumeSending(t){this.assertNotClosed()}async replaceTrack(t,n){this.assertNotClosed(),n?Ye.debug("replaceTrack() [localId:%s, track.id:%s]",t,n.id):Ye.debug("replaceTrack() [localId:%s, no track]",t),this._tracks.delete(Number(t)),this._tracks.set(Number(t),n)}async setMaxSpatialLayer(t,n){this.assertNotClosed(),Ye.debug("setMaxSpatialLayer() [localId:%s, spatialLayer:%s]",t,n)}async setRtpEncodingParameters(t,n){this.assertNotClosed(),Ye.debug("setRtpEncodingParameters() [localId:%s, params:%o]",t,n)}async getSenderStats(t){return this.assertNotClosed(),new Map}async sendDataChannel({ordered:t,maxPacketLifeTime:n,maxRetransmits:r,label:s,protocol:i}){this.assertNotClosed(),this._transportReady||await this.setupTransport({localDtlsRole:"server"}),Ye.debug("sendDataChannel()");const o=new bh({id:this._nextSctpStreamId++,ordered:t,maxPacketLifeTime:n,maxRetransmits:r,label:s,protocol:i}),a={streamId:this._nextSctpStreamId,ordered:t,maxPacketLifeTime:n,maxRetransmits:r};return{dataChannel:o,sctpStreamParameters:a}}async receive(t){this.assertNotClosed();const n=[];for(const r of t){const{trackId:s,kind:i}=r;this._transportReady||await this.setupTransport({localDtlsRole:"client"}),Ye.debug("receive() [trackId:%s, kind:%s]",s,i);const o=this._nextLocalId++,a=new FE.FakeMediaStreamTrack({kind:i});this._tracks.set(o,a),n.push({localId:String(o),track:a})}return n}async stopReceiving(t){if(!this._closed)for(const n of t)Ye.debug("stopReceiving() [localId:%s]",n),this._tracks.delete(Number(n))}async pauseReceiving(t){this.assertNotClosed()}async resumeReceiving(t){this.assertNotClosed()}async getReceiverStats(t){return this.assertNotClosed(),new Map}async receiveDataChannel({sctpStreamParameters:t,label:n,protocol:r}){return this.assertNotClosed(),this._transportReady||await this.setupTransport({localDtlsRole:"client"}),Ye.debug("receiveDataChannel()"),{dataChannel:new bh({id:t.streamId,ordered:t.ordered,maxPacketLifeTime:t.maxPacketLifeTime,maxRetransmits:t.maxRetransmits,label:n,protocol:r})}}async setupTransport({localDtlsRole:t,localSdpObject:n}){const r=ci.clone(this._fakeParameters.generateLocalDtlsParameters());t&&(r.role=t),this.emit("@connectionstatechange","connecting"),await new Promise((s,i)=>this.emit("@connect",{dtlsParameters:r},s,i)),this._transportReady=!0}assertNotClosed(){if(this._closed)throw new ay.InvalidStateError("method called in a closed handler")}}vc.FakeHandler=Ti;class bh extends BE.FakeEventTarget{_id;_negotiated=!0;_ordered;_maxPacketLifeTime;_maxRetransmits;_label;_protocol;_readyState="connecting";_bufferedAmount=0;_bufferedAmountLowThreshold=0;_binaryType="arraybuffer";_onopen=null;_onclosing=null;_onclose=null;_onmessage=null;_onbufferedamountlow=null;_onerror=null;constructor({id:t,ordered:n=!0,maxPacketLifeTime:r=null,maxRetransmits:s=null,label:i="",protocol:o=""}){super(),Ye.debug(`constructor() [id:${t}, ordered:${n}, maxPacketLifeTime:${r}, maxRetransmits:${s}, label:${i}, protocol:${o}`),this._id=t,this._ordered=n,this._maxPacketLifeTime=r,this._maxRetransmits=s,this._label=i,this._protocol=o}get id(){return this._id}get negotiated(){return this._negotiated}get ordered(){return this._ordered}get maxPacketLifeTime(){return this._maxPacketLifeTime}get maxRetransmits(){return this._maxRetransmits}get label(){return this._label}get protocol(){return this._protocol}get readyState(){return this._readyState}get bufferedAmount(){return this._bufferedAmount}get bufferedAmountLowThreshold(){return this._bufferedAmountLowThreshold}set bufferedAmountLowThreshold(t){this._bufferedAmountLowThreshold=t}get binaryType(){return this._binaryType}set binaryType(t){this._binaryType=t}get onopen(){return this._onopen}set onopen(t){this._onopen&&this.removeEventListener("open",this._onopen),this._onopen=t,t&&this.addEventListener("open",t)}get onclosing(){return this._onclosing}set onclosing(t){this._onclosing&&this.removeEventListener("closing",this._onclosing),this._onclosing=t,t&&this.addEventListener("closing",t)}get onclose(){return this._onclose}set onclose(t){this._onclose&&this.removeEventListener("close",this._onclose),this._onclose=t,t&&this.addEventListener("close",t)}get onmessage(){return this._onmessage}set onmessage(t){this._onmessage&&this.removeEventListener("message",this._onmessage),this._onmessage=t,t&&this.addEventListener("message",t)}get onbufferedamountlow(){return this._onbufferedamountlow}set onbufferedamountlow(t){this._onbufferedamountlow&&this.removeEventListener("bufferedamountlow",this._onbufferedamountlow),this._onbufferedamountlow=t,t&&this.addEventListener("bufferedamountlow",t)}get onerror(){return this._onerror}set onerror(t){this._onerror&&this.removeEventListener("error",this._onerror),this._onerror=t,t&&this.addEventListener("error",t)}addEventListener(t,n,r){super.addEventListener(t,n,r)}removeEventListener(t,n,r){super.removeEventListener(t,n,r)}close(){["closing","closed"].includes(this._readyState)||(this._readyState="closed")}send(t){if(this._readyState!=="open")throw new ay.InvalidStateError("not open")}}var ln={};Object.defineProperty(ln,"__esModule",{value:!0});ln.generateRouterRtpCapabilities=VE;ln.generateNativeRtpCapabilities=WE;ln.generateNativeSctpCapabilities=HE;ln.generateLocalDtlsParameters=QE;ln.generateTransportRemoteParameters=KE;ln.generateProducerRemoteParameters=qE;ln.generateConsumerRemoteParameters=GE;ln.generateDataProducerRemoteParameters=XE;ln.generateDataConsumerRemoteParameters=YE;const yt=xn;function It(){return String(yt.generateRandomNumber())}function VE(){return yt.deepFreeze({codecs:[{mimeType:"audio/opus",kind:"audio",preferredPayloadType:100,clockRate:48e3,channels:2,rtcpFeedback:[{type:"transport-cc"}],parameters:{useinbandfec:1,foo:"bar"}},{mimeType:"video/VP8",kind:"video",preferredPayloadType:101,clockRate:9e4,rtcpFeedback:[{type:"nack"},{type:"nack",parameter:"pli"},{type:"ccm",parameter:"fir"},{type:"goog-remb"},{type:"transport-cc"}],parameters:{"x-google-start-bitrate":1500}},{mimeType:"video/rtx",kind:"video",preferredPayloadType:102,clockRate:9e4,rtcpFeedback:[],parameters:{apt:101}},{mimeType:"video/H264",kind:"video",preferredPayloadType:103,clockRate:9e4,rtcpFeedback:[{type:"nack"},{type:"nack",parameter:"pli"},{type:"ccm",parameter:"fir"},{type:"goog-remb"},{type:"transport-cc"}],parameters:{"level-asymmetry-allowed":1,"packetization-mode":1,"profile-level-id":"42e01f"}},{mimeType:"video/rtx",kind:"video",preferredPayloadType:104,clockRate:9e4,rtcpFeedback:[],parameters:{apt:103}},{mimeType:"video/VP9",kind:"video",preferredPayloadType:105,clockRate:9e4,rtcpFeedback:[{type:"nack"},{type:"nack",parameter:"pli"},{type:"ccm",parameter:"fir"},{type:"goog-remb"},{type:"transport-cc"}],parameters:{"profile-id":0,"x-google-start-bitrate":1500}},{mimeType:"video/rtx",kind:"video",preferredPayloadType:106,clockRate:9e4,rtcpFeedback:[],parameters:{apt:105}}],headerExtensions:[{kind:"audio",uri:"urn:ietf:params:rtp-hdrext:sdes:mid",preferredId:1,preferredEncrypt:!1,direction:"sendrecv"},{kind:"video",uri:"urn:ietf:params:rtp-hdrext:sdes:mid",preferredId:1,preferredEncrypt:!1,direction:"sendrecv"},{kind:"video",uri:"urn:ietf:params:rtp-hdrext:sdes:rtp-stream-id",preferredId:2,preferredEncrypt:!1,direction:"recvonly"},{kind:"video",uri:"urn:ietf:params:rtp-hdrext:sdes:repaired-rtp-stream-id",preferredId:3,preferredEncrypt:!1,direction:"recvonly"},{kind:"audio",uri:"http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time",preferredId:4,preferredEncrypt:!1,direction:"sendrecv"},{kind:"video",uri:"http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time",preferredId:4,preferredEncrypt:!1,direction:"sendrecv"},{kind:"audio",uri:"http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01",preferredId:5,preferredEncrypt:!1,direction:"recvonly"},{kind:"video",uri:"http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01",preferredId:5,preferredEncrypt:!1,direction:"sendrecv"},{kind:"audio",uri:"urn:ietf:params:rtp-hdrext:ssrc-audio-level",preferredId:10,preferredEncrypt:!1,direction:"sendrecv"},{kind:"video",uri:"urn:3gpp:video-orientation",preferredId:11,preferredEncrypt:!1,direction:"sendrecv"},{kind:"video",uri:"urn:ietf:params:rtp-hdrext:toffset",preferredId:12,preferredEncrypt:!1,direction:"sendrecv"}]})}function WE(){return{codecs:[{mimeType:"audio/opus",kind:"audio",preferredPayloadType:111,clockRate:48e3,channels:2,rtcpFeedback:[{type:"transport-cc"}],parameters:{minptime:10,useinbandfec:1}},{mimeType:"audio/ISAC",kind:"audio",preferredPayloadType:103,clockRate:16e3,channels:1,rtcpFeedback:[{type:"transport-cc"}],parameters:{}},{mimeType:"audio/CN",kind:"audio",preferredPayloadType:106,clockRate:32e3,channels:1,rtcpFeedback:[{type:"transport-cc"}],parameters:{}},{mimeType:"audio/foo",kind:"audio",preferredPayloadType:107,clockRate:9e4,channels:4,rtcpFeedback:[{type:"foo-qwe-qwe"}],parameters:{foo:"lalala"}},{mimeType:"video/BAZCODEC",kind:"video",preferredPayloadType:100,clockRate:9e4,rtcpFeedback:[{type:"foo"},{type:"transport-cc"},{type:"ccm",parameter:"fir"},{type:"nack"},{type:"nack",parameter:"pli"}],parameters:{baz:"1234abcd"}},{mimeType:"video/rtx",kind:"video",preferredPayloadType:101,clockRate:9e4,rtcpFeedback:[],parameters:{apt:100}},{mimeType:"video/VP8",kind:"video",preferredPayloadType:96,clockRate:9e4,rtcpFeedback:[{type:"goog-remb"},{type:"transport-cc"},{type:"ccm",parameter:"fir"},{type:"nack"},{type:"nack",parameter:"pli"}],parameters:{baz:"1234abcd"}},{mimeType:"video/rtx",kind:"video",preferredPayloadType:97,clockRate:9e4,rtcpFeedback:[],parameters:{apt:96}},{mimeType:"video/VP9",kind:"video",preferredPayloadType:98,clockRate:9e4,rtcpFeedback:[{type:"goog-remb"},{type:"transport-cc"},{type:"ccm",parameter:"fir"},{type:"nack"},{type:"nack",parameter:"pli"}],parameters:{"profile-id":0}},{mimeType:"video/rtx",kind:"video",preferredPayloadType:99,clockRate:9e4,rtcpFeedback:[],parameters:{apt:98}}],headerExtensions:[{kind:"audio",uri:"urn:ietf:params:rtp-hdrext:sdes:mid",preferredId:1},{kind:"video",uri:"urn:ietf:params:rtp-hdrext:sdes:mid",preferredId:1},{kind:"video",uri:"urn:ietf:params:rtp-hdrext:toffset",preferredId:2},{kind:"video",uri:"http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time",preferredId:3},{kind:"video",uri:"urn:3gpp:video-orientation",preferredId:4},{kind:"video",uri:"http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01",preferredId:5},{kind:"video",uri:"http://www.webrtc.org/experiments/rtp-hdrext/playout-delay",preferredId:6},{kind:"video",uri:"http://www.webrtc.org/experiments/rtp-hdrext/video-content-type",preferredId:7},{kind:"video",uri:"http://www.webrtc.org/experiments/rtp-hdrext/video-timing",preferredId:8},{kind:"audio",uri:"urn:ietf:params:rtp-hdrext:ssrc-audio-level",preferredId:10}]}}function HE(){return yt.deepFreeze({numStreams:{OS:2048,MIS:2048}})}function QE(){return yt.deepFreeze({fingerprints:[{algorithm:"sha-256",value:"82:5A:68:3D:36:C3:0A:DE:AF:E7:32:43:D2:88:83:57:AC:2D:65:E5:80:C4:B6:FB:AF:1A:A0:21:9F:6D:0C:AD"}],role:"auto"})}function KE(){return{id:It(),iceParameters:yt.deepFreeze({iceLite:!0,password:"yku5ej8nvfaor28lvtrabcx0wkrpkztz",usernameFragment:"h3hk1iz6qqlnqlne"}),iceCandidates:yt.deepFreeze([{foundation:"udpcandidate",address:"9.9.9.9",ip:"9.9.9.9",port:40533,priority:1078862079,protocol:"udp",type:"host",tcpType:"passive"},{foundation:"udpcandidate",address:"9.9.9.9",ip:"9:9:9:9:9:9",port:41333,priority:1078862089,protocol:"udp",type:"host",tcpType:"passive"}]),dtlsParameters:yt.deepFreeze({fingerprints:[{algorithm:"sha-256",value:"A9:F4:E0:D2:74:D3:0F:D9:CA:A5:2F:9F:7F:47:FA:F0:C4:72:DD:73:49:D0:3B:14:90:20:51:30:1B:90:8E:71"},{algorithm:"sha-384",value:"03:D9:0B:87:13:98:F6:6D:BC:FC:92:2E:39:D4:E1:97:32:61:30:56:84:70:81:6E:D1:82:97:EA:D9:C1:21:0F:6B:C5:E7:7F:E1:97:0C:17:97:6E:CF:B3:EF:2E:74:B0"},{algorithm:"sha-512",value:"84:27:A4:28:A4:73:AF:43:02:2A:44:68:FF:2F:29:5C:3B:11:9A:60:F4:A8:F0:F5:AC:A0:E3:49:3E:B1:34:53:A9:85:CE:51:9B:ED:87:5E:B8:F4:8E:3D:FA:20:51:B8:96:EE:DA:56:DC:2F:5C:62:79:15:23:E0:21:82:2B:2C"}],role:"auto"}),sctpParameters:yt.deepFreeze({port:5e3,OS:2048,MIS:2048,maxMessageSize:2e6})}}function qE(){return yt.deepFreeze({id:It()})}function GE({id:e,codecMimeType:t}={}){switch(t){case"audio/opus":return{id:e??It(),producerId:It(),kind:"audio",rtpParameters:yt.deepFreeze({codecs:[{mimeType:"audio/opus",payloadType:100,clockRate:48e3,channels:2,rtcpFeedback:[{type:"transport-cc"}],parameters:{useinbandfec:1,foo:"bar"}}],encodings:[{ssrc:46687003}],headerExtensions:[{uri:"urn:ietf:params:rtp-hdrext:sdes:mid",id:1},{uri:"http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01",id:5},{uri:"urn:ietf:params:rtp-hdrext:ssrc-audio-level",id:10}],rtcp:{cname:"wB4Ql4lrsxYLjzuN",reducedSize:!0,mux:!0}})};case"audio/ISAC":return{id:e??It(),producerId:It(),kind:"audio",rtpParameters:yt.deepFreeze({codecs:[{mimeType:"audio/ISAC",payloadType:111,clockRate:16e3,channels:1,rtcpFeedback:[{type:"transport-cc"}],parameters:{}}],encodings:[{ssrc:46687004}],headerExtensions:[{uri:"urn:ietf:params:rtp-hdrext:sdes:mid",id:1},{uri:"http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01",id:5}],rtcp:{cname:"wB4Ql4lrsxYLjzuN",reducedSize:!0,mux:!0}})};case"video/VP8":return{id:e??It(),producerId:It(),kind:"video",rtpParameters:yt.deepFreeze({codecs:[{mimeType:"video/VP8",payloadType:101,clockRate:9e4,rtcpFeedback:[{type:"nack"},{type:"nack",parameter:"pli"},{type:"ccm",parameter:"fir"},{type:"goog-remb"},{type:"transport-cc"}],parameters:{"x-google-start-bitrate":1500}},{mimeType:"video/rtx",payloadType:102,clockRate:9e4,rtcpFeedback:[],parameters:{apt:101}}],encodings:[{ssrc:99991111,rtx:{ssrc:99991112}}],headerExtensions:[{uri:"urn:ietf:params:rtp-hdrext:sdes:mid",id:1},{uri:"http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time",id:4},{uri:"http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01",id:5},{uri:"urn:3gpp:video-orientation",id:11},{uri:"urn:ietf:params:rtp-hdrext:toffset",id:12}],rtcp:{cname:"wB4Ql4lrsxYLjzuN",reducedSize:!0,mux:!0}})};case"video/H264":return{id:e??It(),producerId:It(),kind:"video",rtpParameters:yt.deepFreeze({codecs:[{mimeType:"video/H264",payloadType:103,clockRate:9e4,rtcpFeedback:[{type:"nack"},{type:"nack",parameter:"pli"},{type:"ccm",parameter:"fir"},{type:"goog-remb"},{type:"transport-cc"}],parameters:{"level-asymmetry-allowed":1,"packetization-mode":1,"profile-level-id":"42e01f"}},{mimeType:"video/rtx",payloadType:104,clockRate:9e4,rtcpFeedback:[],parameters:{apt:103}}],encodings:[{ssrc:99991113,rtx:{ssrc:99991114}}],headerExtensions:[{uri:"urn:ietf:params:rtp-hdrext:sdes:mid",id:1},{uri:"http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time",id:4},{uri:"http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01",id:5},{uri:"urn:3gpp:video-orientation",id:11},{uri:"urn:ietf:params:rtp-hdrext:toffset",id:12}],rtcp:{cname:"wB4Ql4lrsxYLjzuN",reducedSize:!0,mux:!0}})};default:throw new TypeError(`unknown codecMimeType '${t}'`)}}function XE(){return yt.deepFreeze({id:It()})}function YE({id:e}={}){return{id:e??It(),dataProducerId:It(),sctpStreamParameters:yt.deepFreeze({streamId:666,maxPacketLifeTime:5e3,maxRetransmits:void 0})}}(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.debug=e.testFakeParameters=e.FakeHandler=e.enhancedEvents=e.ortc=e.parseScalabilityMode=e.detectDeviceAsync=e.detectDevice=e.Device=e.version=e.types=void 0;const t=tc;e.debug=t.default,e.types=Tv,e.version="3.15.6";var n=$s;Object.defineProperty(e,"Device",{enumerable:!0,get:function(){return n.Device}}),Object.defineProperty(e,"detectDevice",{enumerable:!0,get:function(){return n.detectDevice}}),Object.defineProperty(e,"detectDeviceAsync",{enumerable:!0,get:function(){return n.detectDeviceAsync}});var r=_r;Object.defineProperty(e,"parseScalabilityMode",{enumerable:!0,get:function(){return r.parse}}),e.ortc=Oe,e.enhancedEvents=gt;var s=vc;Object.defineProperty(e,"FakeHandler",{enumerable:!0,get:function(){return s.FakeHandler}}),e.testFakeParameters=ln})(kv);const ts=["#FF6B6B","#4CAF50","#2196F3","#FFEB3B","#9C27B0","#8BC34A","#FF9800","#3F51B5","#E91E63","#00BCD4","#795548","#607D8B"],ml="#E8E8E8";class JE{constructor(){this.zoneColors=new Map,this.colorZones=new Map,this.currentColorIndex=0}hashAreaId(t){if(!t)return 0;let n=0;for(let r=0;r<t.length;r++){const s=t.charCodeAt(r);n=(n<<5)-n+s,n=n&n}return Math.abs(n)}getZoneColor(t,n,r=null){if(t==="public")return ml;if(this.zoneColors.has(n))return this.zoneColors.get(n);let s,i;if(t==="private"){const o=this.extractAreaNumber(n);o!==null&&o>=1?(i=(o-1)%ts.length,s=ts[i]):(i=this.hashAreaId(n)%ts.length,s=ts[i])}else i=this.hashAreaId(n)%ts.length,s=ts[i];return this.zoneColors.set(n,s),this.colorZones.has(s)||this.colorZones.set(s,new Set),this.colorZones.get(s).add(n),console.log("🎨 [색상할당]",{areaType:t,areaId:n,areaName:r,selectedColor:s,colorIndex:i,areaNumber:t==="private"?this.extractAreaNumber(n):"N/A"}),s}extractAreaNumber(t){if(!t)return null;const n=t.toString().match(/\d+/);return n?parseInt(n[0],10):null}getZonesByColor(t){const n=this.colorZones.get(t);return n?Array.from(n):[]}getColorFromArea(t){return!t||!t.id?ml:this.getZoneColor(t.type,t.id,t.name)}getColorGroup(t){const n=this.zoneColors.get(t);return n?{color:n,zones:this.getZonesByColor(n)}:{color:ml,zones:[]}}getAllZoneColors(){const t={};return this.zoneColors.forEach((n,r)=>{t[r]=n}),t}getAllColorGroups(){const t={};return this.colorZones.forEach((n,r)=>{t[r]=Array.from(n)}),t}removeZone(t){const n=this.zoneColors.get(t);if(n){this.zoneColors.delete(t);const r=this.colorZones.get(n);r&&(r.delete(t),r.size===0&&this.colorZones.delete(n)),console.log("🎨 [색상제거]",{areaId:t,color:n})}}clear(){this.zoneColors.clear(),this.colorZones.clear(),this.currentColorIndex=0,console.log("🎨 [색상매핑] 전체 초기화")}getColorWithAlpha(t,n=.8){const r=t.replace("#",""),s=parseInt(r.substr(0,2),16),i=parseInt(r.substr(2,2),16),o=parseInt(r.substr(4,2),16);return`rgba(${s}, ${i}, ${o}, ${n})`}getContrastColor(t){const n=t.replace("#",""),r=parseInt(n.substr(0,2),16),s=parseInt(n.substr(2,2),16),i=parseInt(n.substr(4,2),16);return(r*299+s*587+i*114)/1e3>128?"#000000":"#FFFFFF"}}const Rd=new JE,ZE=({socket:e,currentArea:t,isVisible:n})=>{const[r,s]=_.useState(null),[i,o]=_.useState([]),[a,c]=_.useState(!1),[l,d]=_.useState(!1),[u,f]=_.useState(null),[h,v]=_.useState(null),[y,x]=_.useState(new Map),[g,m]=_.useState(null),[w,C]=_.useState(null),[L,A]=_.useState(null),[F,D]=_.useState(new Map),[B,M]=_.useState(new Map),X=_.useRef(null),ee=_.useRef(new Map),V=async()=>{try{const T=await navigator.mediaDevices.getUserMedia({video:{width:200,height:150},audio:!0});f(T),X.current&&(X.current.srcObject=T),console.log("📹 로컬 카메라 시작됨")}catch(T){console.error("카메라 접근 실패:",T)}},Z=async()=>{if(e){d(!0);try{e.emit("end-area-video-call",{},T=>{d(!1),T.success?(c(!1),s(null),o([]),N(),console.log("📹 영역 화상통화 종료 (카메라 유지):",T.result)):console.error("화상통화 종료 실패:",T.error)})}catch(T){d(!1),console.error("화상통화 종료 오류:",T)}}},fe=async()=>{e&&e.emit("get-area-video-session",{},T=>{if(T.success){const P=T.participants&&T.participants.length>0;c(P),o(T.participants||[]),P&&s({areaKey:T.areaKey,participants:T.participants})}})};_.useEffect(()=>{e&&!u&&(console.log("📹 [항상표시] 컴포넌트 마운트 시 카메라 자동 시작"),V().catch(T=>{console.error("📹 [항상표시] 컴포넌트 마운트 시 카메라 시작 실패:",T)}))},[e]),_.useEffect(()=>{if(t&&e){const T=Rd.getColorFromArea(t);v(T),console.log("🎯 [화상통화] 영역 변경 감지:",{area:t,color:T}),fe()}else console.log("🎯 [화상통화] 영역 벗어남 - 상태 초기화 (카메라 유지)"),v(null)},[t?.type,t?.id,e]),_.useEffect(()=>{if(!e)return;const T=ae=>{console.log("🌍 영역 변경 알림:",ae),setTimeout(()=>{fe()},500)},P=ae=>{console.log("📹 화상통화 상태 변경:",ae);const{areaKey:me,participants:H,eventType:de}=ae;switch(o(H||[]),de){case"session-started":c(!0),s({areaKey:me,participants:H});break;case"session-ended":c(!1),s(null);break;case"user-joined":c(!0),s({areaKey:me,participants:H});break;case"user-left":H.length===0&&(c(!1),s(null));break}},q=async ae=>{console.log("📹 [자동시작] 영역 진입으로 인한 자동 화상통화 시작:",ae);const{areaKey:me,areaId:H,participants:de,message:Re}=ae;try{await V(),c(!0),s({areaKey:me,areaId:H,participants:de}),o(de||[]),await Y(de||[]),console.log("📹 [자동시작] 화상통화 자동 참여 완료:",{areaId:H,participantCount:de?.length})}catch(xt){console.error("📹 [자동시작] 자동 화상통화 참여 실패:",xt)}},O=ae=>{console.log("📹 [업데이트] 영역 화상통화 상태 업데이트:",ae);const{areaKey:me,areaId:H,participants:de,isActive:Re}=ae;o(de||[]),Re&&de&&de.length>0&&(c(!0),s({areaKey:me,areaId:H,participants:de}))},ne=ae=>{console.log("📹 [종료] 영역 화상통화 종료:",ae);const{areaKey:me,reason:H}=ae;c(!1),s(null),o([]),N(),console.log(`📹 [종료] 화상통화 종료됨 (카메라 유지): ${H}`)},he=ae=>{console.log("🎨 [색상화상통화] 시작 알림:",ae);const{color:me,sessionKey:H,participants:de,message:Re}=ae;c(!0),s({sessionKey:H,color:me,participants:de}),o(de||[]),v(me),u||V().catch(xt=>{console.error("카메라 시작 실패:",xt)})},_e=async ae=>{console.log("🎥 [자동시작] 영역 화상통화 시작 알림:",ae);const{areaKey:me,participants:H,message:de}=ae;try{u||await V(),c(!0),s({areaKey:me,participants:H}),o(H||[]),await Y(H||[]),console.log("🎥 [자동시작] 영역 화상통화 자동 참여 완료:",{areaKey:me,participantCount:H?.length})}catch(Re){console.error("🎥 [자동시작] 자동 영역 화상통화 참여 실패:",Re)}},K=async ae=>{console.log("🎨 [자동시작] 색상 기반 화상통화 시작 알림:",ae);const{color:me,sessionKey:H,participants:de,message:Re}=ae;try{u||await V(),c(!0),s({sessionKey:H,color:me,participants:de}),o(de||[]),v(me),await Y(de||[]),console.log("🎨 [자동시작] 색상 기반 화상통화 자동 참여 완료:",{color:me,participantCount:de?.length})}catch(xt){console.error("🎨 [자동시작] 자동 색상 화상통화 참여 실패:",xt)}},Ee=ae=>{console.log("🎥 [자동종료] 영역 화상통화 종료 알림:",ae);const{areaKey:me,participants:H,reason:de,message:Re}=ae;c(!1),s(null),o([]),N(),console.log(`🎥 [자동종료] 영역 화상통화 자동 종료됨 (카메라 유지): ${de}`)},it=ae=>{console.log("👥 화상통화 참가자 변경 알림:",ae);const{sessionKey:me,participants:H,added:de,removed:Re,message:xt}=ae;o(H||[]),H.length===0&&(c(!1),s(null)),console.log(`👥 참가자 변경: 추가 ${de.length}명, 제거 ${Re.length}명 (카메라 유지)`)},We=async ae=>{console.log("👤 [자동참여] 영역 화상통화 자동 참여 알림:",ae);const{areaKey:me,participants:H,message:de}=ae;try{u||await V(),c(!0),s({areaKey:me,participants:H}),o(H||[]),await Y(H||[]),console.log("👤 [자동참여] 영역 화상통화 자동 참여 완료:",{areaKey:me,participantCount:H?.length})}catch(Re){console.error("👤 [자동참여] 자동 참여 실패:",Re)}},Me=async ae=>{console.log("🎨 [자동참여] 색상 화상통화 자동 참여 알림:",ae);const{color:me,sessionKey:H,participants:de,message:Re}=ae;try{u||await V(),c(!0),s({sessionKey:H,color:me,participants:de}),o(de||[]),v(me),await Y(de||[]),console.log("🎨 [자동참여] 색상 화상통화 자동 참여 완료:",{color:me,participantCount:de?.length})}catch(xt){console.error("🎨 [자동참여] 자동 참여 실패:",xt)}},Pt=ae=>{console.log("👤 [자동퇴장] 화상통화 자동 퇴장 알림:",ae);const{sessionKey:me,reason:H,message:de}=ae;c(!1),s(null),o([]),N(),console.log(`👤 [자동퇴장] 화상통화 자동 퇴장 완료 (카메라 유지): ${H}`)};e.on("area-changed",T),e.on("area-video-call-changed",P),e.on("auto-video-call-started",q),e.on("area-video-call-update",O),e.on("area-video-call-ended",ne),e.on("color-based-video-call-started",he),e.on("auto-area-video-call-started",_e),e.on("auto-color-video-call-started",K),e.on("auto-area-video-call-ended",Ee),e.on("video-call-participant-changed",it),e.on("user-auto-joined-video-call",We),e.on("user-auto-joined-color-video-call",Me),e.on("user-auto-left-video-call",Pt);const Bn=async ae=>{console.log("📹 [MediaSoup] 새 Producer 감지:",ae);const{producerId:me,userId:H,kind:de}=ae;L&&await U(L,me,H)},Wr=ae=>{console.log("📹 [MediaSoup] Producer 종료:",ae);const{producerId:me,userId:H}=ae;B.forEach((de,Re)=>{Re.startsWith(H)&&(de.close(),M(xt=>{const Hr=new Map(xt);return Hr.delete(Re),Hr}))}),x(de=>{const Re=new Map(de);return Re.delete(H),Re})};return e.on("new-producer",Bn),e.on("producer-closed",Wr),()=>{e.off("area-changed",T),e.off("area-video-call-changed",P),e.off("auto-video-call-started",q),e.off("area-video-call-update",O),e.off("area-video-call-ended",ne),e.off("color-based-video-call-started",he),e.off("auto-area-video-call-started",_e),e.off("auto-color-video-call-started",K),e.off("auto-area-video-call-ended",Ee),e.off("video-call-participant-changed",it),e.off("user-auto-joined-video-call",We),e.off("user-auto-joined-color-video-call",Me),e.off("user-auto-left-video-call",Pt),e.off("new-producer",Bn),e.off("producer-closed",Wr)}},[e]);const Q=_.useCallback(async()=>{if(g)return g;try{const T=new kv.Device;return console.log("📹 [MediaSoup] Device 생성 완료"),m(T),T}catch(T){throw console.error("📹 [MediaSoup] Device 생성 실패:",T),T}},[g]),W=_.useCallback(async T=>{if(!(!e||!T))return new Promise((P,q)=>{let O=!1,ne=!1;const he=()=>{O&&ne&&P()};try{console.log("📹 [MediaSoup] Send Transport 요청"),e.emit("create-webrtc-transport",{direction:"send"},async _e=>{if(_e.success){const K=T.createSendTransport(_e.params);K.on("connect",async({dtlsParameters:Ee},it,We)=>{try{e.emit("connect-transport",{transportId:K.id,dtlsParameters:Ee},Me=>{Me.success?it():We(new Error(Me.error))})}catch(Me){We(Me)}}),K.on("produce",async({kind:Ee,rtpParameters:it},We,Me)=>{try{e.emit("produce",{transportId:K.id,kind:Ee,rtpParameters:it},Pt=>{Pt.success?We({id:Pt.producerId}):Me(new Error(Pt.error))})}catch(Pt){Me(Pt)}}),C(K),console.log("📹 [MediaSoup] Send Transport 생성 완료"),O=!0,he()}else q(new Error("Send Transport 생성 실패"))}),console.log("📹 [MediaSoup] Receive Transport 요청"),e.emit("create-webrtc-transport",{direction:"recv"},async _e=>{if(_e.success){const K=T.createRecvTransport(_e.params);K.on("connect",async({dtlsParameters:Ee},it,We)=>{try{e.emit("connect-transport",{transportId:K.id,dtlsParameters:Ee},Me=>{Me.success?it():We(new Error(Me.error))})}catch(Me){We(Me)}}),A(K),console.log("📹 [MediaSoup] Receive Transport 생성 완료"),ne=!0,he()}else q(new Error("Receive Transport 생성 실패"))})}catch(_e){console.error("📹 [MediaSoup] Transport 생성 실패:",_e),q(_e)}})},[e]),k=_.useCallback(async(T,P)=>{if(!(!T||!P))try{const q=await T.produce({track:P});return D(O=>new Map(O.set(P.kind,q))),console.log("📹 [MediaSoup] Producer 생성 완료:",P.kind,q.id),q}catch(q){console.error("📹 [MediaSoup] Producer 생성 실패:",q)}},[]),U=_.useCallback(async(T,P,q)=>{if(!(!T||!P))try{e.emit("consume",{transportId:T.id,producerId:P,rtpCapabilities:g.rtpCapabilities},async O=>{if(O.success){const ne=await T.consume(O.params);M(K=>new Map(K.set(`${q}_${ne.kind}`,ne)));const he=new MediaStream([ne.track]);x(K=>new Map(K.set(q,he)));const _e=ee.current.get(q);_e&&(_e.srcObject=he),console.log("📹 [MediaSoup] Consumer 생성 완료:",q,ne.kind,ne.id),e.emit("resume-consumer",{consumerId:ne.id})}})}catch(O){console.error("📹 [MediaSoup] Consumer 생성 실패:",O)}},[e,g]),Y=_.useCallback(async T=>{if(!(!u||!e)){console.log("📹 [MediaSoup] 모든 참가자와 연결 시작:",T);try{const P=await Q();e.emit("get-router-rtp-capabilities",{},q=>{q.success&&P.load({routerRtpCapabilities:q.rtpCapabilities}).then(async()=>{console.log("📹 [MediaSoup] Device RTP Capabilities 로드 완료"),await W(P),setTimeout(async()=>{if(u){console.log("📹 [MediaSoup] 로컬 미디어 전송 시작");const O=u.getVideoTracks()[0],ne=u.getAudioTracks()[0],he=w;he?(O&&await k(he,O),ne&&await k(he,ne)):console.log("📹 [MediaSoup] SendTransport가 아직 준비되지 않음")}},100)})})}catch(P){console.error("📹 [MediaSoup] 연결 시작 실패:",P)}}},[u,e,Q,W]),N=_.useCallback(()=>{console.log("📹 [MediaSoup] 모든 연결 정리"),F.forEach(T=>{T.close()}),B.forEach(T=>{T.close()}),w&&(w.close(),C(null)),L&&(L.close(),A(null)),D(new Map),M(new Map),x(new Map),ee.current.clear()},[F,B,w,L]);return!n||!t?null:p.jsxs("div",{className:"area-video-call-ui",children:[p.jsxs("div",{className:"area-video-header",children:[p.jsxs("div",{className:"area-info",children:[p.jsx("span",{className:`area-type ${t.type}`,children:t.type==="private"?"🏠":t.type==="public"?"🌍":"🏛️"}),p.jsx("span",{className:"area-name",children:t.name}),h&&h!=="#E8E8E8"&&p.jsx("div",{className:"zone-color-indicator",style:{backgroundColor:h,width:"16px",height:"16px",borderRadius:"50%",border:"2px solid white",display:"inline-block",marginLeft:"8px",verticalAlign:"middle"},title:`영역 색상: ${h}`})]}),i.length>0&&p.jsxs("div",{className:"participants-count",children:[p.jsx("span",{className:"participants-icon",children:"👥"}),p.jsx("span",{children:i.length})]})]}),p.jsxs("div",{className:"local-video-container",children:[p.jsx("video",{ref:X,autoPlay:!0,muted:!0,playsInline:!0,className:"local-video",style:{width:"200px",height:"150px",backgroundColor:u?"transparent":"#1a1a1a",border:"2px solid #333",borderRadius:"8px"}}),p.jsx("div",{className:"video-label",children:u?"내 카메라":"카메라 연결 중..."}),!u&&p.jsx("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",color:"#fff",fontSize:"48px"},children:"📹"})]}),a&&y.size>0&&p.jsx("div",{className:"remote-videos-container",style:{display:"flex",flexWrap:"wrap",gap:"10px",marginTop:"10px"},children:Array.from(y.entries()).map(([T,P])=>p.jsxs("div",{className:"remote-video-container",style:{position:"relative"},children:[p.jsx("video",{ref:q=>{q&&(ee.current.set(T,q),q.srcObject=P)},autoPlay:!0,playsInline:!0,className:"remote-video",style:{width:"200px",height:"150px",backgroundColor:"#1a1a1a",border:"2px solid #666",borderRadius:"8px"}}),p.jsxs("div",{className:"video-label",style:{position:"absolute",bottom:"5px",left:"5px",backgroundColor:"rgba(0, 0, 0, 0.7)",color:"white",padding:"2px 6px",borderRadius:"3px",fontSize:"12px"},children:["사용자 ",T]})]},T))}),p.jsx("div",{className:"video-call-controls",children:a&&p.jsxs("div",{className:"active-call-controls",children:[p.jsxs("div",{className:"call-status",children:[p.jsx("span",{className:"call-indicator",children:"🔴"}),p.jsx("span",{children:r?.sessionKey?.startsWith("color_")?"색상 기반 화상통화 중":r?.areaKey?"영역 화상통화 중":"자동 화상통화 중"}),p.jsx("span",{className:"auto-indicator",style:{fontSize:"10px",marginLeft:"4px",padding:"2px 4px",backgroundColor:"rgba(0, 255, 0, 0.2)",borderRadius:"3px",color:"#00FF00"},children:"AUTO"}),h&&p.jsx("div",{className:"active-color-indicator",style:{backgroundColor:h,width:"12px",height:"12px",borderRadius:"50%",border:"1px solid white",display:"inline-block",marginLeft:"6px",verticalAlign:"middle"}}),i.length>1&&p.jsxs("span",{className:"participant-list",children:["참여자: ",i.length,"명"]})]}),p.jsxs("button",{className:"end-call-btn",onClick:Z,disabled:l,children:[l?"⏳":"📞"," 통화 종료"]})]})}),a&&i.length>1&&p.jsxs("div",{className:"participants-list",children:[p.jsx("div",{className:"participants-title",children:"참여자 목록:"}),p.jsx("div",{className:"participants-items",children:i.map((T,P)=>p.jsxs("div",{className:"participant-item",children:[p.jsx("span",{className:"participant-icon",children:"👤"}),p.jsxs("span",{className:"participant-id",children:["사용자 ",T]})]},T))})]})]})};const eR=({currentAreaIndex:e=0,currentAreaType:t="public",currentAreaInfo:n=null,userPosition:r={x:0,y:0},isVisible:s=!0})=>{if(!s)return null;const o=(()=>t==="private"?{backgroundColor:"rgba(33, 150, 243, 0.9)",borderColor:"#1976D2",icon:"🔒",textColor:"#ffffff"}:{backgroundColor:"rgba(76, 175, 80, 0.9)",borderColor:"#388E3C",icon:"🌍",textColor:"#ffffff"})(),a=()=>t==="private"&&n?.name?n.name:t==="private"?`프라이빗 영역 ${e}`:"퍼블릭 영역",l=(()=>{if(t==="private"&&n?.area){const d=n.area;return{size:d.size?`${d.size.width} × ${d.size.height}`:d.width&&d.height?`${d.width} × ${d.height}`:"알 수 없음",bounds:d.position?`(${d.position.x}, ${d.position.y})`:d.x!==void 0&&d.y!==void 0?`(${d.x}, ${d.y})`:"알 수 없음"}}return null})();return p.jsxs("div",{className:"area-indicator-panel",style:{backgroundColor:o.backgroundColor,borderColor:o.borderColor,color:o.textColor},children:[p.jsxs("div",{className:"area-main-info",children:[p.jsx("span",{className:"area-icon",role:"img","aria-label":"area-icon",children:o.icon}),p.jsxs("div",{className:"area-text",children:[p.jsx("div",{className:"area-name",children:a()}),p.jsxs("div",{className:"area-index",children:["영역 #",e]})]})]}),t==="private"&&l&&p.jsxs("div",{className:"area-details",children:[p.jsxs("div",{className:"area-detail-item",children:[p.jsx("span",{className:"detail-label",children:"크기:"}),p.jsx("span",{className:"detail-value",children:l.size})]}),p.jsxs("div",{className:"area-detail-item",children:[p.jsx("span",{className:"detail-label",children:"위치:"}),p.jsx("span",{className:"detail-value",children:l.bounds})]})]}),p.jsxs("div",{className:"user-position",children:[p.jsx("span",{className:"position-label",children:"내 위치:"}),p.jsxs("span",{className:"position-value",children:["(",Math.round(r.x),", ",Math.round(r.y),")"]})]}),p.jsx("div",{className:"area-transition-indicator",children:p.jsx("div",{className:`transition-dot ${t}`,style:{backgroundColor:o.borderColor}})})]})};const tR=({onClick:e})=>p.jsx("button",{className:"speech-bubble-button-floating",onClick:e,title:"말풍선 텍스트 입력",children:"💭"});const nR=({isVisible:e,onSendMessage:t,onClose:n})=>{const[r,s]=_.useState(""),i=_.useRef(null);_.useEffect(()=>{e&&i.current&&i.current.focus()},[e]);const o=c=>{c.preventDefault(),r.trim()&&(t(r.trim()),s(""),n())},a=c=>{c.key==="Escape"?n():c.key==="Enter"&&!c.shiftKey&&(c.preventDefault(),o(c))};return e?p.jsx("div",{className:"speech-bubble-input-overlay",onClick:n,children:p.jsxs("div",{className:"speech-bubble-input-container",onClick:c=>c.stopPropagation(),children:[p.jsxs("div",{className:"speech-bubble-input-header",children:[p.jsx("span",{children:"💭 말풍선 메시지"}),p.jsx("button",{className:"close-button",onClick:n,children:"×"})]}),p.jsxs("form",{onSubmit:o,className:"speech-bubble-input-form",children:[p.jsx("textarea",{ref:i,value:r,onChange:c=>s(c.target.value),onKeyDown:a,placeholder:"말풍선으로 표시할 메시지를 입력하세요...",rows:3,maxLength:100,className:"speech-bubble-input-textarea"}),p.jsxs("div",{className:"speech-bubble-input-actions",children:[p.jsxs("span",{className:"character-count",children:[r.length,"/100"]}),p.jsxs("div",{children:[p.jsx("button",{type:"button",onClick:n,className:"cancel-button",children:"취소"}),p.jsx("button",{type:"submit",disabled:!r.trim(),className:"send-button",children:"전송"})]})]})]})]})}):null};function gs(e,t=[]){if(!e||typeof e.x!="number"||typeof e.y!="number")return console.error("❌ [영역판별] 잘못된 위치 데이터:",e),{areaType:"public",areaIndex:0,areaInfo:{type:"public",name:"퍼블릭 영역",error:"Invalid position data"}};if(!Array.isArray(t)||t.length===0)return{areaType:"public",areaIndex:0,areaInfo:{type:"public",name:"퍼블릭 영역",position:e}};for(let n=0;n<t.length;n++){const r=t[n];if(rR(e,r))return{areaType:"private",areaIndex:n+1,areaInfo:{type:"private",id:r.id||`private_${n+1}`,name:r.name||`프라이빗 영역 ${n+1}`,index:n,area:r,position:e}}}return{areaType:"public",areaIndex:0,areaInfo:{type:"public",id:"public",name:"퍼블릭 영역",position:e}}}function rR(e,t){if(!t)return!1;let n,r,s,i;if(t.position&&t.size)n=t.position.x,r=t.position.y,s=n+t.size.width,i=r+t.size.height;else if(t.x!==void 0&&t.y!==void 0&&t.width!==void 0&&t.height!==void 0)n=t.x,r=t.y,s=n+t.width,i=r+t.height;else if(t.startX!==void 0&&t.startY!==void 0&&t.endX!==void 0&&t.endY!==void 0)n=t.startX,r=t.startY,s=t.endX,i=t.endY;else return!1;return n===void 0||r===void 0||s===void 0||i===void 0?!1:e.x>=n&&e.x<=s&&e.y>=r&&e.y<=i}function Ch(e,t=[]){return gs(e,t).areaIndex}function Eh(e,t=[]){return gs(e,t).areaType}const sR=_.forwardRef(({currentMap:e,mapImage:t,characters:n,currentCharacter:r,isEditMode:s=!1,onReturnToLobby:i},o)=>{const{user:a,socket:c}=cn();so();const[l,d]=_.useState("metaverse"),[u,f]=_.useState(!1),[h,v]=_.useState({width:1e3,height:1e3}),[y,x]=_.useState(1),[g,m]=_.useState({x:0,y:0}),[w,C]=_.useState([]),[L,A]=_.useState(!1),[F,D]=_.useState(!1),[B,M]=_.useState([]),[X,ee]=_.useState(new Map),[V,Z]=_.useState(0),[fe,Q]=_.useState("public"),[W,k]=_.useState(null),[U,Y]=_.useState(0),[N,T]=_.useState([]),[P,q]=_.useState(!0),O=_.useCallback(S=>{if(S.position&&N.length>0){const E=gs(S.position,N),I=Ch(S.position,N),z=Eh(S.position,N);return{...S,calculatedAreaIndex:I,calculatedAreaType:z,calculatedAreaInfo:E}}return S},[N]),[ne,he]=_.useState(!1),[_e,K]=_.useState({x:0,y:0}),[Ee,it]=_.useState({x:0,y:0}),[We,Me]=_.useState(!1),Pt=_.useRef(null),Bn=_.useRef(null),[Wr,ae]=_.useState(null),me=_.useRef(!1),H=lx(c,e),de=dx(Wr||e,H.myPosition,c,a);_.useEffect(()=>{me.current=!1,console.log("🎯 [초기영역설정] 새 맵 진입으로 초기화 플래그 리셋"),(async()=>{if(!(!e||!e.id)){console.log("🗺️ [맵로드] 완전한 맵 데이터 로딩 시작:",e.id);try{const E=await fetch(`/api/maps/${e.id}`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});if(E.ok){const I=await E.json();console.log("🗺️ [맵로드] API 응답 전체:",I);const z=I.success?I.map:I;console.log("🗺️ [맵로드] 완전한 맵 데이터 로드 완료:",{id:z?.id,name:z?.name,hasPrivateAreas:!!z?.data?.privateAreas,privateAreasCount:z?.data?.privateAreas?.length||0,privateAreas:z?.data?.privateAreas,fullMapData:z});const G=Array.isArray(z?.private_boxes)?z.private_boxes:Array.isArray(z?.data?.privateAreas)?z.data.privateAreas:Array.isArray(z?.privateAreas)?z.privateAreas:[],re=G.map((ye,Vn)=>{console.log(`🔍 [영역검증] 프라이빗 영역 ${Vn+1} 원본 데이터:`,ye);const jt=ye.x??ye.position?.x??ye.startX,Lt=ye.y??ye.position?.y??ye.startY,Gt=ye.width??ye.size?.width,Wn=ye.height??ye.size?.height,Vs=jt!==void 0&&Gt?jt+Gt:void 0,Ws=Lt!==void 0&&Wn?Lt+Wn:void 0;if(console.log("📐 [영역검증] 시작점/끝점 계산:",{startX:jt,startY:Lt,width:Gt,height:Wn,endX:Vs,endY:Ws,startPoint:{x:jt,y:Lt},endPoint:{x:Vs,y:Ws},areaSize:Gt&&Wn?`${Gt} x ${Wn}`:"unknown"}),jt===void 0||Lt===void 0||!Gt||!Wn){const tp=`⚠️ 프라이빗 영역 "${ye.name||`영역 ${ye.id}`}"의 좌표 정보가 없습니다!
시작점(x,y): (${jt}, ${Lt})
크기(width,height): (${Gt}, ${Wn})
끝점(x,y): (${Vs}, ${Ws})

모든 영역이 퍼블릭 영역으로 처리됩니다.`;return console.error("❌ [영역검증]",tp),alert(tp),{...ye,isValid:!1,error:"좌표 정보 부족"}}const ep={...ye,x:jt,y:Lt,width:Gt,height:Wn,startX:jt,startY:Lt,endX:Vs,endY:Ws,startPoint:{x:jt,y:Lt},endPoint:{x:Vs,y:Ws},isValid:!0};return console.log(`✅ [영역검증] 프라이빗 영역 "${ye.name}" 좌표 검증 완료:`,ep),ep}),Se=re.filter(ye=>ye.isValid),Ue=re.filter(ye=>!ye.isValid);if(G.length===0){const ye=`📍 프라이빗 영역 정보 없음

이 맵에는 프라이빗 영역이 설정되지 않았습니다.
모든 영역이 퍼블릭 영역으로 처리됩니다.`;console.log("📍 [영역검증] 프라이빗 영역 없음"),alert(ye)}else Se.length>0&&console.log("✅ [영역검증] 프라이빗 영역 구하기 성공:",Se);if(Ue.length>0){const ye=`⚠️ ${Ue.length}개의 프라이빗 영역에 좌표 문제가 있습니다.
영역 감지가 정상적으로 작동하지 않을 수 있습니다.`;console.warn("⚠️ [영역검증]",ye),alert(ye)}ae({...e,...z,privateAreas:re,data:{...z?.data,privateAreas:re}}),console.log("🎯 [영역모니터링] 프라이빗 영역 저장:",re.length,"개"),T(re)}else{console.error("🗺️ [맵로드] 맵 데이터 로드 실패:",E.status);const I=Array.isArray(e?.private_boxes)?e.private_boxes:Array.isArray(e?.data?.privateAreas)?e.data.privateAreas:Array.isArray(e?.privateAreas)?e.privateAreas:[];ae({...e,privateAreas:I}),console.log("🎯 [영역모니터링] 프라이빗 영역 저장 (fallback):",I.length,"개"),T(I)}}catch(E){console.error("🗺️ [맵로드] 맵 데이터 로드 에러:",E);const I=Array.isArray(e?.private_boxes)?e.private_boxes:Array.isArray(e?.data?.privateAreas)?e.data.privateAreas:Array.isArray(e?.privateAreas)?e.privateAreas:[];ae({...e,privateAreas:I}),console.log("🎯 [영역모니터링] 프라이빗 영역 저장 (error fallback):",I.length,"개"),T(I)}}})()},[e?.id]),_.useEffect(()=>{H.setOnPositionChange&&H.setOnPositionChange(S=>{console.log("🌍 거리 기반 위치 변경 감지:",S)})},[H.setOnPositionChange]),_.useEffect(()=>{if(!H.myPosition||!N||N.length===0){fe!=="public"&&(console.log("🎯 [영역감지] 위치/영역 정보 부족 - 퍼블릭으로 설정"),Q("public"),Z(0),k(null));return}try{const S=gs(H.myPosition,N);if(S.areaIndex!==V)if(console.log("🔄 [영역변경] 영역 전환:",{from:{type:fe,index:V},to:{type:S.areaType,index:S.areaIndex}}),Y(V),Q(S.areaType),Z(S.areaIndex),k(S.areaInfo),S.areaType==="private"){const E=S.areaInfo?.name||`프라이빗 영역 ${S.areaIndex}`;console.log(`🎯 내 위치 영역: ${E} 진입`)}else console.log("🎯 내 위치 영역: 퍼블릭 영역 진입")}catch(S){console.error("🎯 [영역감지] 오류:",S)}},[H.myPosition,N]),_.useEffect(()=>{if(!N.length||!B.length)return;const E=setInterval(()=>{M(I=>{const z=I.map(O),G=z.filter((re,Se)=>{const Ue=I[Se];return Ue&&(Ue.calculatedAreaIndex!==re.calculatedAreaIndex||Ue.calculatedAreaType!==re.calculatedAreaType)});return G.length>0&&console.log("👥 참가자 영역 변경:",G.map(re=>`${re.username} → ${re.calculatedAreaType} ${re.calculatedAreaIndex}`)),z})},3e3);return()=>clearInterval(E)},[N,O,B.length]),_.useEffect(()=>{if(H.myPosition&&N!==null&&!me.current){console.log("🎯 [초기영역설정] 시작점 영역 감지 시작 (최초 1회):",{startPosition:H.myPosition,privateAreasCount:N.length,currentArea:{type:fe,index:V}});try{const S=gs(H.myPosition,N);if(console.log("🎯 [초기영역설정] 시작점 영역 감지 결과:",S),Q(S.areaType),Z(S.areaIndex),k(S.areaInfo),me.current=!0,console.log("🎯 [초기영역설정] 초기 영역 상태 설정 완료:",{areaType:S.areaType,areaIndex:S.areaIndex,areaName:S.areaInfo?.name}),S.areaType==="private"){const E=S.areaInfo?.name||`프라이빗 영역 ${S.areaIndex}`;console.log(`🎯 시작 위치: ${E}`)}else console.log("🎯 시작 위치: 퍼블릭 영역")}catch(S){console.error("🎯 [초기영역설정] 시작점 영역 감지 오류:",S),me.current=!0}}},[H.myPosition,N]);const Re=_.useRef(new Map),xt=async S=>{if(console.log("👥 참가자 업데이트 처리:",S),S.mapId===e.id&&(console.log(`👥 현재 맵 ${S.mapId}의 참가자:`,S.participants),S.participants&&Array.isArray(S.participants))){const E=S.participants.map(O);console.log("👥 영역 계산된 참가자 정보:",E),M(E),E.length>=2&&c&&(console.log("🎥 [자동시작] setRoomParticipants로 인한 화상통화 자동 시작 시도"),c.emit("trigger-auto-video-call-from-participants",{participants:E,mapId:e?.id},I=>{I?.success?console.log("🎥 [자동시작] 참가자 기반 화상통화 시작 성공:",I):console.log("🎥 [자동시작] 참가자 기반 화상통화 시작 실패:",I?.error)}))}},Hr=S=>{console.log("사용자가 퇴장했습니다:",S)},Cc=S=>{if(!Bn.current)return;const E=Bn.current.getBoundingClientRect(),I=(S.clientX-E.left)/y,z=(S.clientY-E.top)/y;if(H.moveCharacterTo){console.log("🎯 클릭 이동: 목표 위치",{x:Math.round(I),y:Math.round(z)},"zoom:",y);const G=re=>{console.log("🌍 도착 지점 영역 검사:",re)};H.moveCharacterTo({x:I,y:z},G)}},Ec=S=>{s||(S.button===0?(he(!0),K({x:S.clientX,y:S.clientY}),it({x:g.x,y:g.y}),Me(!1)):S.button===2&&(S.preventDefault(),he(!0),it({x:S.clientX-g.x,y:S.clientY-g.y}),Me(!0)))},Rc=S=>{if(s||!ne)return;const E=S.clientX-_e.x,I=S.clientY-_e.y,z=Math.sqrt(E*E+I*I);if(z>5&&Me(!0),We||z>5){const G={x:Ee.x+E,y:Ee.y+I};m(G)}},ao=S=>{if(s)return;const E=S.target,I=E.closest(".modal")||E.closest(".modal-content")||E.closest("button")||E.closest("input")||E.closest("textarea")||E.tagName==="BUTTON"||E.tagName==="INPUT"||E.tagName==="TEXTAREA";S.button===0&&ne&&!We&&!I&&Cc(S),he(!1),Me(!1)},co=_.useCallback(S=>{if(s)return;S.preventDefault();const E=S.deltaY>0?.9:1.1,I=Math.max(.1,Math.min(5,y*E)),z=S.clientX,G=S.clientY,re=I/y,Se=z-(z-g.x)*re,Ue=G-(G-g.y)*re;x(I),m({x:Se,y:Ue})},[s,y,g.x,g.y]);_.useEffect(()=>{const S=Pt.current;if(!S)return;const E=I=>co(I);return S.addEventListener("wheel",E,{passive:!1}),()=>{S.removeEventListener("wheel",E)}},[co]);const lo=()=>{m({x:0,y:0}),x(1)},kc=S=>{S.preventDefault()},uo=S=>{f(!0),v({width:S.target.naturalWidth,height:S.target.naturalHeight})};if(_.useEffect(()=>{if(!c||!e)return;c.on("update-participants",E=>{console.log("👥 참가자 목록 업데이트:",E),xt(E)}),c.on("user-left",E=>{console.log("👋 사용자 퇴장:",E),Hr(E)}),c.on("user-joined",async E=>{console.log("👋 사용자 입장:",E)}),c.on("channel-participants-update",async E=>{console.log("📡 채널 참가자 업데이트:",E)}),c.on("existing-users",E=>{console.log("📋 기존 사용자 정보 수신:",E)}),c.on("private-area-status-changed",E=>{E.mapId===e.id&&console.log(`📍 맵 ${E.mapId}의 프라이빗 영역 ${E.areaId} 상태 변화:`,{사용자수:E.userCount,변화타입:E.changeType})}),c.on("speech-bubble-message",E=>{if(console.log("💭 [수신] 말풍선 메시지:",E),console.log("💭 [수신상태] 현재 사용자:",{userId:a?.id,username:a?.username}),console.log("💭 [수신상태] 현재 chatBubbles:",Array.from(X.entries())),!E.message||E.message.trim()===""){console.log("💭 [무시] 빈 말풍선 메시지");return}const I=Re.current.get(E.userId);I&&clearTimeout(I);const z=Date.now();ee(re=>{const Se=new Map(re),Ue={message:E.message,timestamp:z,type:"speech-bubble"};return Se.set(E.userId,Ue),console.log("💭 [상태업데이트] 말풍선 추가:",{userId:E.userId,username:E.username,bubbleData:Ue,totalBubbles:Se.size,allBubbles:Array.from(Se.entries())}),Se});const G=setTimeout(()=>{ee(re=>{const Se=new Map(re),Ue=Se.get(E.userId);return Ue&&Ue.timestamp===z&&Se.delete(E.userId),Se}),Re.current.delete(E.userId)},15e3);Re.current.set(E.userId,G)}),c.on("auto-rejoin",E=>{console.log("🔄 자동 재입장 처리:",E),E.mapId===e.id&&(H.setMyPosition(E.position),H.setMyDirection(E.direction))}),c.on("error",E=>{console.error("🚨 서버 에러:",E),E.message&&alert(`오류: ${E.message}`)});const S={mapId:e.id,characterId:r?.id,userId:a?.id,username:a?.username,position:H.myPosition||{x:200,y:200},characterInfo:r};return console.log("🏠 맵 입장 요청:",S),c.emit("join-map",S),()=>{console.log("🏠 맵 퇴장 처리"),c.off("update-participants"),c.off("user-left"),c.off("user-joined-private-area"),c.off("user-left-private-area"),c.off("private-area-participants"),c.off("channel-participants-update"),c.off("private-areas-status"),c.off("private-area-status-changed"),c.off("user-joined"),c.off("existing-users"),c.off("chat-message"),c.off("auto-rejoin"),c.off("error"),c.emit("leave-map"),Re.current.forEach(E=>{clearTimeout(E)}),Re.current.clear()}},[c,e,r,a.id,H.myPosition]),_.useEffect(()=>{e?.size?.width&&e?.size?.height&&v({width:e.size.width,height:e.size.height})},[e?.size?.width,e?.size?.height]),_.useImperativeHandle(o,()=>({leaveMapAndReturnToLobby:S=>{c&&S&&c.emit("leave-map")}}),[c]),_.useEffect(()=>{const S=()=>{ne&&he(!1)};return ne&&(document.addEventListener("mouseup",S),document.addEventListener("mouseleave",S)),()=>{document.removeEventListener("mouseup",S),document.removeEventListener("mouseleave",S)}},[ne]),_.useEffect(()=>{const S=E=>{if(E.target.tagName==="INPUT"||E.target.tagName==="TEXTAREA")return;const I=10;let z={...H.myPosition},G=H.myDirection,re=!1;switch(E.key){case"ArrowUp":E.preventDefault(),z.y=Math.max(0,z.y-I),G="up",re=!0;break;case"ArrowDown":E.preventDefault(),z.y=Math.min(h.height-20,z.y+I),G="down",re=!0;break;case"ArrowLeft":E.preventDefault(),z.x=Math.max(0,z.x-I),G="left",re=!0;break;case"ArrowRight":E.preventDefault(),z.x=Math.min(h.width-20,z.x+I),G="right",re=!0;break}if(re&&(H.setMyPosition(z),H.setMyDirection(G)),E.key==="+"||E.key==="="){E.preventDefault();const Se=Math.min(5,y*1.2);x(Se)}else if(E.key==="-"||E.key==="_"){E.preventDefault();const Se=Math.max(.1,y*.8);x(Se)}else E.key==="0"&&(E.preventDefault(),lo())};return document.addEventListener("keydown",S),()=>{document.removeEventListener("keydown",S)}},[y,H,h]),!e)return p.jsxs("div",{className:"metaverse-container metaverse-lobby-message",children:[p.jsx("h2",{children:"맵이 선택되지 않았습니다."}),p.jsx("p",{children:"로비로 돌아가서 맵을 선택해주세요."}),p.jsx("button",{onClick:i,children:"로비로 돌아가기"})]});const b=S=>{const E=S&&S.appearance||{},I=E.head||"😊",z=E.body||"👕",G=E.arms||E.hands||"💪",re=E.legs||E.feet||"👖";return{head:I,body:z,arms:G,legs:re}},R=({body:S,arms:E,direction:I})=>p.jsxs("div",{style:{position:"relative",display:"inline-block",textAlign:"center"},children:[p.jsx("span",{style:{fontSize:10.5},children:S}),I==="left"&&p.jsx("span",{style:{position:"absolute",right:"100%",marginRight:3,top:0,fontSize:10.5},children:E}),I==="right"&&p.jsx("span",{style:{position:"absolute",left:"100%",marginLeft:3,top:0,fontSize:10.5},children:E})]}),pe=({info:S,isCurrent:E,chatBubble:I,style:z={}})=>{const G=S.position||{x:0,y:0},re=S.direction||"down",Se=b(S),Ue=_.useMemo(()=>{if(E)return de.getAreaInfo();if(N.length>0&&G){const jt=gs(G,N),Lt=Ch(G,N),Gt=Eh(G,N);return{type:Gt,id:jt?.id||Lt,name:jt?.name||`영역 ${Lt}`,displayName:Gt==="public"?"공용 영역":jt?.name||`프라이빗 영역 ${Lt}`}}return{type:"public",id:0,name:"공용 영역",displayName:"공용 영역"}},[E,G,N,de]),ye=Rd.getColorFromArea(Ue),Vn=Ue.type==="private";return p.jsxs("div",{className:`dom-character ${E?"current":""}`,style:{position:"absolute",left:`${G.x}px`,top:`${G.y}px`,transform:"translate(-50%, -50%)",zIndex:1,userSelect:"none",pointerEvents:"none",background:Vn?Rd.getColorWithAlpha(ye,.15):"rgba(255, 255, 255, 0.1)",borderRadius:"8px",padding:"2px",border:E?`1px solid ${ye}`:`1px solid ${Vn?ye:"rgba(255, 255, 255, 0.3)"}`,transition:"all 0.15s ease-out",...z},children:[Vn&&p.jsx("div",{style:{position:"absolute",top:"-8px",right:"-8px",width:"12px",height:"12px",borderRadius:"50%",backgroundColor:ye,border:"2px solid white",zIndex:2},title:`영역 색상: ${ye}`}),I&&(()=>(console.log("🎈 말풍선 렌더링:",{chatBubble:I,position:G,username:S?.username||S?.name,isCurrent:E}),!0))()&&p.jsxs("div",{style:{position:"absolute",bottom:"100%",left:"50%",transform:"translateX(-50%)",marginBottom:"10px",background:"rgba(255, 255, 255, 0.95)",color:"#333",padding:"8px 12px",borderRadius:"15px",fontSize:"13px",maxWidth:"200px",wordWrap:"break-word",boxShadow:"0 2px 8px rgba(0, 0, 0, 0.2)",border:"1px solid rgba(0, 0, 0, 0.1)",whiteSpace:"pre-wrap",animation:"fadeIn 0.3s ease-in",zIndex:10},children:[I.message,p.jsx("div",{style:{position:"absolute",top:"100%",left:"50%",transform:"translateX(-50%)",width:0,height:0,borderLeft:"8px solid transparent",borderRight:"8px solid transparent",borderTop:"8px solid rgba(255, 255, 255, 0.95)"}})]}),p.jsxs("div",{style:{textAlign:"center",lineHeight:"1.05"},children:[p.jsx("div",{style:{fontSize:10.5,filter:"drop-shadow(0 1px 2px rgba(0,0,0,0.5))"},children:Se.head}),p.jsx(R,{body:Se.body,arms:Se.arms,direction:re}),p.jsx("div",{style:{fontSize:10.5,filter:"drop-shadow(0 1px 2px rgba(0,0,0,0.5))"},children:Se.legs})]}),(S.name||S.username)&&p.jsx("div",{style:{fontSize:12,color:E?"#4CAF50":"#2196F3",textAlign:"center",marginTop:6,fontWeight:"bold",textShadow:"1px 1px 2px rgba(0,0,0,0.8)"},children:S.name||S.username}),E&&p.jsx("div",{style:{position:"absolute",left:"50%",top:"100%",transform:"translate(-50%, 4px)",width:"20px",height:"4px",borderRadius:"2px",background:"#4CAF50",boxShadow:"0 2px 4px rgba(0,0,0,0.3)"}})]})};return p.jsxs("div",{className:"metaverse-container",children:[p.jsx(px,{currentView:l,onViewChange:d,currentArea:{type:de.currentArea.type,name:de.getAreaInfo().displayName},onReturnToLobby:i,roomName:e?.name,onToggleGroupCall:()=>{},groupCallActive:!1,onOpenUserList:()=>A(S=>!S)}),p.jsx(eR,{currentAreaIndex:V,currentAreaType:fe,currentAreaInfo:W,userPosition:H.myPosition||{x:0,y:0},isVisible:P&&l==="metaverse"}),l==="metaverse"&&p.jsxs("div",{style:{position:"fixed",bottom:"20px",right:"20px",display:"flex",flexDirection:"column",gap:"10px",zIndex:1e3,alignItems:"center"},children:[p.jsxs("div",{style:{position:"relative",width:"90px",height:"90px",marginBottom:"10px"},children:[p.jsx("button",{onClick:()=>m(S=>({...S,y:S.y+50})),style:{position:"absolute",top:"0",left:"30px",width:"30px",height:"30px",borderRadius:"5px 5px 0 0",border:"none",background:"rgba(52, 152, 219, 1)",color:"white",cursor:"pointer",fontSize:"14px",fontWeight:"bold",display:"flex",alignItems:"center",justifyContent:"center",backdropFilter:"blur(5px)",transition:"all 0.2s"},onMouseEnter:S=>S.target.style.background="rgba(41, 128, 185, 1)",onMouseLeave:S=>S.target.style.background="rgba(52, 152, 219, 1)",title:"위로 이동",children:"▲"}),p.jsx("button",{onClick:()=>m(S=>({...S,x:S.x+50})),style:{position:"absolute",top:"30px",left:"0",width:"30px",height:"30px",borderRadius:"5px 0 0 5px",border:"none",background:"rgba(52, 152, 219, 1)",color:"white",cursor:"pointer",fontSize:"14px",fontWeight:"bold",display:"flex",alignItems:"center",justifyContent:"center",backdropFilter:"blur(5px)",transition:"all 0.2s"},onMouseEnter:S=>S.target.style.background="rgba(41, 128, 185, 1)",onMouseLeave:S=>S.target.style.background="rgba(52, 152, 219, 1)",title:"왼쪽으로 이동",children:"◀"}),p.jsx("div",{style:{position:"absolute",top:"30px",left:"30px",width:"30px",height:"30px",borderRadius:"50%",background:"rgba(0, 0, 0, 0.8)",backdropFilter:"blur(5px)",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"10px",color:"rgba(255, 255, 255, 0.5)"},children:"✦"}),p.jsx("button",{onClick:()=>m(S=>({...S,x:S.x-50})),style:{position:"absolute",top:"30px",right:"0",width:"30px",height:"30px",borderRadius:"0 5px 5px 0",border:"none",background:"rgba(52, 152, 219, 1)",color:"white",cursor:"pointer",fontSize:"14px",fontWeight:"bold",display:"flex",alignItems:"center",justifyContent:"center",backdropFilter:"blur(5px)",transition:"all 0.2s"},onMouseEnter:S=>S.target.style.background="rgba(41, 128, 185, 1)",onMouseLeave:S=>S.target.style.background="rgba(52, 152, 219, 1)",title:"오른쪽으로 이동",children:"▶"}),p.jsx("button",{onClick:()=>m(S=>({...S,y:S.y-50})),style:{position:"absolute",bottom:"0",left:"30px",width:"30px",height:"30px",borderRadius:"0 0 5px 5px",border:"none",background:"rgba(52, 152, 219, 1)",color:"white",cursor:"pointer",fontSize:"14px",fontWeight:"bold",display:"flex",alignItems:"center",justifyContent:"center",backdropFilter:"blur(5px)",transition:"all 0.2s"},onMouseEnter:S=>S.target.style.background="rgba(41, 128, 185, 1)",onMouseLeave:S=>S.target.style.background="rgba(52, 152, 219, 1)",title:"아래로 이동",children:"▼"})]}),p.jsx("button",{onClick:()=>q(S=>!S),style:{width:"50px",height:"30px",borderRadius:"15px",border:"none",background:P?"rgba(76, 175, 80, 1)":"rgba(158, 158, 158, 1)",color:"white",cursor:"pointer",fontSize:"12px",fontWeight:"bold",display:"flex",alignItems:"center",justifyContent:"center",backdropFilter:"blur(5px)",transition:"all 0.2s",marginTop:"10px"},onMouseEnter:S=>S.target.style.background=P?"rgba(67, 160, 71, 1)":"rgba(117, 117, 117, 1)",onMouseLeave:S=>S.target.style.background=P?"rgba(76, 175, 80, 1)":"rgba(158, 158, 158, 1)",title:P?"영역 패널 숨기기":"영역 패널 보기",children:P?"🎯":"👁️"})]}),l==="metaverse"&&p.jsx("div",{ref:Pt,style:{position:"relative",width:"100vw",height:"calc(100vh - 60px)",overflow:"hidden",cursor:ne?"grabbing":"default",userSelect:ne?"none":"auto"},onMouseDown:Ec,onMouseMove:Rc,onMouseUp:ao,onMouseLeave:ao,onContextMenu:kc,children:p.jsxs("div",{className:"metaverse-scene",ref:Bn,style:{cursor:s?"crosshair":ne?"grabbing":"grab",position:"absolute",width:`${h.width}px`,height:`${h.height}px`,background:"#2c3e50",userSelect:ne?"none":"auto",transform:`translate(${g.x}px, ${g.y}px) scale(${y})`,transformOrigin:"0 0"},children:[t&&p.jsx("img",{src:t,onLoad:uo,onError:()=>f(!1),alt:"Map Background",style:{position:"absolute",top:0,left:0,width:`${h.width}px`,height:`${h.height}px`,objectFit:"fill",zIndex:0,userSelect:"none",pointerEvents:"none"}}),H.currentPath&&H.currentPath.length>0&&p.jsxs("svg",{width:h.width,height:h.height,style:{position:"absolute",left:0,top:0,zIndex:.5,pointerEvents:"none"},children:[H.currentPath.map((S,E)=>{if(E===0)return p.jsx("line",{x1:H.myPosition.x,y1:H.myPosition.y,x2:S.x,y2:S.y,stroke:"#00FF00",strokeWidth:"2",strokeDasharray:"5,5",opacity:"0.6"},`path-${E}`);{const I=H.currentPath[E-1];return p.jsx("line",{x1:I.x,y1:I.y,x2:S.x,y2:S.y,stroke:"#00FF00",strokeWidth:"2",strokeDasharray:"5,5",opacity:"0.6"},`path-${E}`)}}),H.currentPath.map((S,E)=>p.jsx("circle",{cx:S.x,cy:S.y,r:"3",fill:"#00FF00",opacity:"0.8"},`waypoint-${E}`)),H.currentPath.length>0&&p.jsx("circle",{cx:H.currentPath[H.currentPath.length-1].x,cy:H.currentPath[H.currentPath.length-1].y,r:"8",fill:"#FF0000",opacity:"0.8",children:p.jsx("animate",{attributeName:"r",values:"8;12;8",dur:"1s",repeatCount:"indefinite"})})]}),r?p.jsx(pe,{info:{...r,name:r.name,position:H.myPosition,direction:H.myDirection},isCurrent:!0,chatBubble:(()=>{const S=X.get(a.id);return console.log("🎈 [현재사용자] 말풍선 조회:",{userId:a.id,username:a.username,bubble:S,allBubbles:Array.from(X.entries())}),S})()}):p.jsx(pe,{info:{name:a?.username||"사용자",appearance:{head:"😊",body:"👕",arms:"💪",legs:"👖"},position:H.myPosition,direction:H.myDirection},isCurrent:!0,chatBubble:X.get(a.id)}),Array.from(H.otherCharacters.values()).map(S=>p.jsx(pe,{info:{username:S.username,appearance:S.characterInfo?.appearance||{head:"😊",body:"👕",arms:"💪",legs:"👖"},position:S.position,direction:S.direction,isMoving:S.isMoving},chatBubble:X.get(S.id)},`char-${S.id}`)),t&&!u&&p.jsxs("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",background:"rgba(0, 0, 0, 0.8)",color:"white",padding:"20px",borderRadius:"10px",fontSize:"16px",zIndex:2,display:"flex",alignItems:"center",gap:"10px"},children:[p.jsx("div",{style:{width:"20px",height:"20px",border:"2px solid #fff",borderTop:"2px solid transparent",borderRadius:"50%",animation:"spin 1s linear infinite"}}),"배경 이미지 로딩 중..."]}),p.jsx("button",{onClick:S=>{S.stopPropagation(),A(E=>!E)},style:{position:"absolute",right:20,top:20,zIndex:4,padding:"10px 14px",borderRadius:20,border:"1px solid rgba(255,255,255,0.3)",background:"rgba(0,0,0,0.35)",color:"#fff",cursor:"pointer"},children:L?"사용자 숨기기":"사용자 목록"}),L&&p.jsxs("div",{style:{position:"absolute",right:20,top:60,zIndex:4,width:240,maxHeight:320,overflow:"auto",background:"rgba(0,0,0,0.55)",color:"#fff",border:"1px solid rgba(255,255,255,0.25)",borderRadius:10,padding:10},onClick:S=>S.stopPropagation(),children:[p.jsxs("div",{style:{fontWeight:700,marginBottom:8},children:["입실 사용자 (",H.otherCharacters.size,"명)"]}),Array.from(H.otherCharacters.values()).map(S=>p.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"6px 8px",borderBottom:"1px solid rgba(255,255,255,0.1)"},children:p.jsxs("div",{style:{display:"flex",flexDirection:"column"},children:[p.jsx("span",{style:{fontSize:"14px",fontWeight:"500"},children:S.username}),p.jsxs("span",{style:{fontSize:"11px",opacity:.7,marginTop:"2px"},children:["위치: (",Math.round(S.position.x),", ",Math.round(S.position.y),")"]})]})},S.username)),H.otherCharacters.size===0&&p.jsx("div",{style:{opacity:.8,padding:8},children:"다른 입실 사용자가 없습니다"})]})]})}),l==="metaverse"&&p.jsxs(p.Fragment,{children:[p.jsx(tR,{onClick:S=>{S.stopPropagation(),D(!0)}}),p.jsx(ZE,{socket:c,currentArea:{type:de.currentArea.type,name:de.getAreaInfo().displayName,id:de.currentArea.id},isVisible:l==="metaverse"}),p.jsx(nR,{isVisible:F,onSendMessage:S=>{if(!c){console.error("💭 [ERROR] Socket not available");return}console.log("💭 [전송시도] 말풍선 메시지:",{text:S,userId:a?.id,username:a?.username,socketConnected:c.connected,mapId:c.mapId,currentMapId:e?.id,socketRooms:c?.rooms?Array.from(c.rooms):"not available"}),c.emit("speech-bubble-message",{message:S,mapId:e?.id}),console.log("💭 [전송완료] speech-bubble-message 이벤트 발송됨")},onClose:()=>D(!1)})]}),l==="sns"&&p.jsx(ux,{posts:w,onPostCreate:S=>C(E=>[S,...E]),onPostLike:()=>{},onPostComment:()=>{}})]})});const gl=()=>{const{mapId:e,link:t}=Hg(),n=Sn(),{characters:r,currentMap:s,currentCharacter:i,fetchMaps:o,fetchMap:a,selectMap:c,selectCharacter:l}=so(),{user:d,hasMediaPermission:u,localStream:f,isCameraOn:h,isMicrophoneOn:v,setLocalStream:y,setIsCameraOn:x,setIsMicrophoneOn:g,requestMediaPermission:m}=cn(),[w,C]=_.useState(!1),L=_.useRef(!1);_.useEffect(()=>{t&&!L.current&&(async()=>{try{if(L.current=!0,C(!0),!d){ve.error("가상공간에 입장하려면 로그인이 필요합니다."),n("/login",{state:{redirectTo:`/join/${t}`,message:"가상공간에 입장하려면 로그인해주세요."}});return}const ee=await(await fetch(`/api/maps/public/${t}`)).json();if(ee.success){c(ee.map);const V=d?.username||"사용자",Z=r.find(fe=>fe.name===V);Z&&(!i||i.name!==V)?l(Z):r.length>0&&!i&&l(r[0])}else ve.error(ee.message||"해당 공개 링크의 가상공간을 찾을 수 없습니다."),n("/metaverse")}catch{ve.error("가상공간 입장 중 오류가 발생했습니다."),n("/metaverse")}finally{C(!1)}})()},[t,n,r,i,l,d,c]),_.useEffect(()=>{e&&!L.current&&(async()=>{try{L.current=!0,C(!0);const X=await a(e);if(X){c(X);const ee=d?.username||"사용자",V=r.find(Z=>Z.name===ee);V&&(!i||i.name!==ee)?l(V):r.length>0&&!i&&l(r[0])}else ve.error("해당 가상공간을 찾을 수 없습니다."),n("/metaverse")}catch{ve.error("가상공간 입장 중 오류가 발생했습니다."),n("/metaverse")}finally{C(!1)}})()},[e,a,c,n,r,i,l,d]);const A=()=>{s&&F.current&&(F.current.leaveMapAndReturnToLobby(s.id||s._id),ve.success("대기실로 돌아갔습니다.")),n("/metaverse/waiting-room")},F=_.useRef();_.useEffect(()=>(console.log("🎥 Metaverse 페이지 마운트"),()=>{console.log("🎥 Metaverse 페이지 언마운트")}),[]);const B=(()=>s?.backgroundLayer?.image?.data?`data:${s.backgroundLayer.image.contentType||"image/jpeg"};base64,${s.backgroundLayer.image.data}`:null)();return w?p.jsxs("div",{className:"loading",children:[p.jsx("div",{className:"loading-spinner"}),p.jsx("p",{children:"가상공간을 불러오는 중..."})]}):p.jsx("div",{className:"metaverse",children:p.jsx("div",{className:"metaverse-content",children:p.jsx("div",{className:"metaverse-main",children:p.jsx(sR,{ref:F,currentMap:s,mapImage:B,characters:r,currentCharacter:i,onReturnToLobby:A})})})})};const iR=()=>{console.log("🚀🚀🚀 MetaverseEdit 컴포넌트 렌더링 시작!");const e=Sn(),{mapId:t}=Hg(),{user:n,token:r}=cn(),{fetchMap:s,updateMap:i,fetchMaps:o}=so();console.log("📋 컴포넌트 초기 상태:",{mapId:t,user:!!n,token:!!r});const a=_.useRef(null),c=_.useRef(null),[l,d]=_.useState("select"),[u,f]=_.useState(!1),[h,v]=_.useState(null),[y,x]=_.useState(null),[g,m]=_.useState({x:1,y:1}),[w,C]=_.useState({width:0,height:0});_.useState({x:0,y:0});const[L,A]=_.useState(!1),[F,D]=_.useState(!1),[B,M]=_.useState(!1),[X,ee]=_.useState(null),[V,Z]=_.useState(null),[fe,Q]=_.useState(null),[W,k]=_.useState({background:.3,walls:.7,privateAreas:.5,spawnPoints:1}),[U,Y]=_.useState({name:"",description:"",isPublic:!0,size:{width:1e3,height:1e3}}),[N,T]=_.useState(null),[P,q]=_.useState(null),[O,ne]=_.useState(!1),[he,_e]=_.useState(!0),[K,Ee]=_.useState({id:"",name:"",description:"",size:{width:1e3,height:1e3},backgroundLayer:{image:{data:null,contentType:null,width:0,height:0,filename:null}},walls:[],privateAreas:[],spawnPoints:[],isPublic:!0,viewCount:0,createdBy:n?.id});_.useEffect(()=>{(async()=>{if(console.log("🗺️ 맵 데이터 로드 시작:",{mapId:t,userId:n?.id,token:!!r}),!t){console.log("❌ mapId가 없음 - 랜딩 페이지로 리다이렉트"),ve.error("가상공간 ID가 없습니다."),e("/");return}if(!r){console.log("⏳ token이 아직 준비되지 않음 - 대기 중...");return}try{_e(!0),console.log("📡 fetchMap 호출 중...");const R=await s(t);if(console.log("📡 fetchMap 결과:",R?"성공":"실패"),R){console.log("🗺️ 맵 데이터:",{id:R.id,name:R.name,creatorId:R.creatorId,createdBy:R.createdBy,creator:R.creator}),console.log("🔐 MetaverseEdit 권한 확인:",{mapId:R.id,mapName:R.name,mapCreatorId:R.creatorId,mapCreatedBy:R.createdBy,userId:n?.id,creatorIdMatch:R.creatorId===n?.id,createdByMatch:R.createdBy===n?.id,hasPermission:R.creatorId===n?.id||R.createdBy===n?.id});const pe=R.creatorId===n?.id||R.createdBy&&R.createdBy===n?.id||R.creator&&R.creator.id===n?.id;console.log("🔍 권한 확인 상세:",{mapCreatorId:R.creatorId,mapCreatedBy:R.createdBy,mapCreatorId:R.creator?.id,userId:n?.id,creatorIdMatch:R.creatorId===n?.id,createdByMatch:R.createdBy===n?.id,creatorMatch:R.creator?.id===n?.id,hasPermission:pe}),pe||(console.log("❌ 권한 없음 - 상세 정보:",{mapId:R.id,mapName:R.name,mapCreatorId:R.creatorId,mapCreatedBy:R.createdBy,mapCreatorId:R.creator?.id,userId:n?.id,userName:n?.username}),console.log("⚠️ 테스트: 권한 확인 우회하고 편집 모드 진입")),console.log("✅ 권한 확인됨 - 편집 모드 진입");const S={...R,size:R.size||{width:1e3,height:1e3},walls:Array.isArray(R.walls)?R.walls:[],privateAreas:Array.isArray(R.private_boxes)?R.private_boxes:Array.isArray(R.privateAreas)?R.privateAreas:[],spawnPoints:Array.isArray(R.spawnPoints)?R.spawnPoints:[]};if(console.log("🗺️ 맵 데이터 로드 완료:",{원본_시작점:R.spawnPoints,통일된_시작점:S.spawnPoints}),Ee(S),Y({name:R.name||"",description:R.description||"",isPublic:R.isPublic!==void 0?R.isPublic:!0,size:R.size||{width:1e3,height:1e3}}),R.backgroundLayer?.image?.data){const E=R.backgroundLayer.image.data,z=`data:${R.backgroundLayer.image.contentType||"image/jpeg"};base64,${E}`;q(z);const G=new Image;G.onload=()=>{Y(re=>({...re,size:{width:G.width,height:G.height}})),m({x:1,y:1}),C({width:G.width,height:G.height})},G.src=z}}else console.log("❌ 맵을 찾을 수 없음 - 랜딩 페이지로 리다이렉트"),ve.error("가상공간을 찾을 수 없습니다."),e("/")}catch(R){console.error("❌ 가상공간 로드 오류:",R),ve.error("가상공간을 불러오는데 실패했습니다."),e("/")}finally{_e(!1)}})()},[t,s,n?.id,e,r]);const it=b=>{console.log("🔧 renderOtherLayers 함수 시작");const R=b.canvas.width,pe=b.canvas.height;console.log("🗺️ 맵 크기:",`${R}x${pe}`),console.log("🚨 레이어 2 (벽 + 시작점) 렌더링 시작");try{K.walls&&Array.isArray(K.walls)?(console.log("✅ 벽 데이터 존재, 개수:",K.walls.length),b.globalAlpha=W.walls,b.strokeStyle="red",b.lineWidth=3,K.walls.forEach((E,I)=>{console.log(`벽 ${I}:`,E),b.beginPath();const z=E.start?.x||E.x1||0,G=E.start?.y||E.y1||0,re=E.end?.x||E.x2||100,Se=E.end?.y||E.y2||100;b.moveTo(z,G),b.lineTo(re,Se),b.stroke()})):console.log("❌ 벽 데이터 없음");const S=K.spawnPoints;S&&Array.isArray(S)?(console.log("✅ 시작점 데이터 존재, 개수:",S.length),b.globalAlpha=W.spawnPoints,S.forEach((E,I)=>{const z=E.x,G=E.y;console.log(`📍 시작점 ${I} 핀 렌더링: (${z}, ${G})`),b.fillStyle="rgba(0, 0, 0, 0.3)",b.beginPath(),b.ellipse(z+2,G+2,8,4,0,0,2*Math.PI),b.fill(),b.fillStyle="#666666",b.fillRect(z-2,G,4,25),b.strokeStyle="#444444",b.lineWidth=1,b.strokeRect(z-2,G,4,25),b.fillStyle="#FF4444",b.beginPath(),b.arc(z,G,12,0,2*Math.PI),b.fill(),b.strokeStyle="#CC2222",b.lineWidth=2,b.beginPath(),b.arc(z,G,12,0,2*Math.PI),b.stroke(),b.fillStyle="#FF6666",b.beginPath(),b.arc(z-3,G-3,4,0,2*Math.PI),b.fill(),b.fillStyle="rgba(255, 255, 255, 0.9)",b.font="bold 14px Arial";const re=b.measureText(E.name||"시작점").width;b.fillRect(z-re/2-5,G+35,re+10,18),b.fillStyle="#333333",b.textAlign="center",b.fillText(E.name||"시작점",z,G+47)})):console.log("❌ 시작점 데이터 없음"),b.globalAlpha=1,console.log("✅ 레이어 2 (벽 + 시작점) 렌더링 완료")}catch(S){console.error("❌ 레이어 2 렌더링 오류:",S),b.globalAlpha=1}console.log("🚨 레이어 3 (프라이빗 영역) 렌더링 시작");try{K.privateAreas&&Array.isArray(K.privateAreas)?(console.log("✅ 프라이빗 영역 데이터 존재, 개수:",K.privateAreas.length),b.globalAlpha=W.privateAreas,b.fillStyle="rgba(0, 0, 255, 0.3)",b.strokeStyle="blue",b.lineWidth=2,K.privateAreas.forEach((S,E)=>{console.log(`프라이빗 영역 ${E}:`,S);const I=S.position?.x||S.x1||S.x||0,z=S.position?.y||S.y1||S.y||0,G=S.size?.width||S.x2-S.x1||100,re=S.size?.height||S.y2-S.y1||100;b.fillRect(I,z,G,re),b.strokeRect(I,z,G,re);const Se=I+G/2,Ue=z+re/2,ye=S.name||`프라이빗 영역 ${E+1}`;b.font="bold 14px Arial";const Vn=b.measureText(ye).width;b.fillStyle="rgba(255, 255, 255, 0.9)",b.fillRect(Se-Vn/2-5,Ue-10,Vn+10,20),b.fillStyle="#0000AA",b.textAlign="center",b.textBaseline="middle",b.fillText(ye,Se,Ue),b.fillStyle="rgba(0, 0, 255, 0.3)"}),b.globalAlpha=1,console.log("✅ 레이어 3 (프라이빗 영역) 렌더링 완료")):console.log("❌ 프라이빗 영역 데이터 없음")}catch(S){console.error("❌ 레이어 3 렌더링 오류:",S),b.globalAlpha=1}if(console.log("🚨 레이어 4 (시작점) 렌더링 - Layer 2로 이동되어 비활성화됨"),u&&h&&y&&l==="wall"&&(b.strokeStyle="rgba(255, 0, 0, 0.7)",b.lineWidth=3,b.beginPath(),b.moveTo(h.x,h.y),b.lineTo(y.x,y.y),b.stroke()),u&&h&&y&&l==="private"){b.fillStyle="rgba(0, 0, 255, 0.2)",b.strokeStyle="rgba(0, 0, 255, 0.7)",b.lineWidth=2;const S=y.x-h.x,E=y.y-h.y;b.fillRect(h.x,h.y,S,E),b.strokeRect(h.x,h.y,S,E)}};_.useEffect(()=>{console.log("🗺️🗺️🗺️ currentMap 상태 변경 감지!"),console.log("currentMap:",K),console.log("currentMap.size:",K?.size),console.log("currentMap의 모든 키:",K?Object.keys(K):"currentMap이 null/undefined"),K?.size?console.log("✅ currentMap.size 존재:",K.size):console.log("❌ currentMap.size가 undefined!")},[K]),_.useEffect(()=>{if(console.log("🎨 캔버스 렌더링 시작"),!K||he){console.log("⏳ 맵 데이터 로딩 중 또는 로딩 상태");return}if(!a.current){console.log("❌ 캔버스 ref가 없음");return}const b=a.current,R=b.getContext("2d");if(!R){console.log("❌ 캔버스 컨텍스트를 가져올 수 없음");return}console.log("✅ 캔버스 렌더링 시작");const pe=w?.width||K.size?.width||1e3,S=w?.height||K.size?.height||800;if(b.width=pe,b.height=S,console.log("캔버스 크기 설정:",pe,"x",S),R.clearRect(0,0,b.width,b.height),it(R),K.backgroundImage||P){console.log("🖼️ 배경 이미지 로드 시작");const E=new Image;E.onload=()=>{console.log("✅ 배경 이미지 로드 완료"),b.width=E.naturalWidth,b.height=E.naturalHeight,R.clearRect(0,0,b.width,b.height),R.globalAlpha=W.background,R.drawImage(E,0,0,E.naturalWidth,E.naturalHeight),R.globalAlpha=1,console.log("🖼️ 배경 이미지 그리기 완료"),console.log("🔧 배경 이미지 위에 레이어 렌더링"),it(R),console.log("✅ 모든 레이어 렌더링 완료")},E.onerror=()=>{console.error("❌ 배경 이미지 로드 실패"),it(R)},E.src=P||K.backgroundImage}else console.log("🚫 배경 이미지 없음")},[K,u,h,y,l,he,P,w,W]),_.useEffect(()=>{console.log("📊 currentMap 상태 변경 감지:",{hasCurrentMap:!!K,hasSpawnPoints:!!K?.spawnPoints,spawnPointsCount:K?.spawnPoints?.length||0,spawnPoints:K?.spawnPoints,mapSize:K?.size,timestamp:new Date().toLocaleTimeString()})},[K?.spawnPoints]);const We=b=>{const R=a.current;if(!R)return{x:0,y:0};const pe=R.getBoundingClientRect(),S=b.clientX-pe.left,E=b.clientY-pe.top;if(S<0||S>pe.width||E<0||E>pe.height)return{x:0,y:0};const I=S/pe.width*R.width,z=E/pe.height*R.height;return{x:Math.round(I),y:Math.round(z)}},Me=b=>{if(l!=="wall")return;const R=We(b);v(R),f(!0)},Pt=b=>{if(!u||l!=="wall")return;const R=We(b);x(R)},Bn=()=>{if(!(!u||l!=="wall")){if(h&&y){const b={id:Date.now(),start:h,end:y,name:`벽 ${K.walls.length+1}`};Ee(R=>({...R,walls:[...R.walls,b]}))}f(!1),v(null),x(null)}},Wr=b=>{if(l!=="private")return;const R=We(b);v(R),f(!0)},ae=b=>{if(!u||l!=="private")return;const R=We(b);x(R)},me=()=>{if(!(!u||l!=="private")){if(h&&y){const b={id:Date.now(),position:{x:Math.min(h.x,y.x),y:Math.min(h.y,y.y)},size:{width:Math.abs(y.x-h.x),height:Math.abs(y.y-h.y)},name:`프라이빗 영역 ${K.privateAreas.length+1}`,maxOccupants:4};Ee(R=>({...R,privateAreas:[...R.privateAreas,b]}))}f(!1),v(null),x(null)}},H=b=>{Ee(R=>({...R,walls:R.walls.filter(pe=>pe.id!==b)}))},de=b=>{Ee(R=>({...R,privateAreas:R.privateAreas.filter(pe=>pe.id!==b)}))},Re=b=>{ee(b)},xt=b=>{Z(b)},Hr=b=>{Ee(R=>({...R,walls:R.walls.map(pe=>pe.id===b.id?b:pe)})),ee(null)},Cc=b=>{Ee(R=>({...R,privateAreas:R.privateAreas.map(pe=>pe.id===b.id?b:pe)})),Z(null)},Ec=(b,R)=>{console.log("🎯🎯🎯 시작점 설정 함수 호출!"),console.log("받은 좌표:",{x:b,y:R}),console.log("좌표 타입:",typeof b,typeof R),console.log("좌표 유효성 검사:",!isNaN(b)&&!isNaN(R));const pe={id:Date.now(),x:Math.round(b),y:Math.round(R),name:"시작점",isDefault:!0};console.log("🆕🆕🆕 새 시작점 생성:",pe),console.log("반올림된 좌표:",{x:Math.round(b),y:Math.round(R)});const S=a.current;if(S){const I=S.getContext("2d"),z=Math.round(b),G=Math.round(R);console.log("🎨 즉시 핀 그리기:",{x:z,y:G}),I.fillStyle="rgba(0, 0, 0, 0.3)",I.beginPath(),I.ellipse(z+2,G+2,8,4,0,0,2*Math.PI),I.fill(),I.fillStyle="#666666",I.fillRect(z-2,G,4,25),I.strokeStyle="#444444",I.lineWidth=1,I.strokeRect(z-2,G,4,25),I.fillStyle="#FF4444",I.beginPath(),I.arc(z,G,12,0,2*Math.PI),I.fill(),I.strokeStyle="#CC2222",I.lineWidth=2,I.beginPath(),I.arc(z,G,12,0,2*Math.PI),I.stroke(),I.fillStyle="#FF6666",I.beginPath(),I.arc(z-3,G-3,4,0,2*Math.PI),I.fill(),I.fillStyle="rgba(255, 255, 255, 0.9)",I.font="bold 14px Arial";const re=I.measureText("시작점").width;I.fillRect(z-re/2-5,G+35,re+10,18),I.fillStyle="#333333",I.textAlign="center",I.fillText("시작점",z,G+47),console.log("✅ 즉시 핀 그리기 완료")}Ee(I=>{const z={...I,spawnPoints:[pe]};return console.log("📝 맵 상태 업데이트:",{이전_시작점:I.spawnPoints,새로운_시작점:z.spawnPoints,전체_맵_데이터:z}),z}),(K.spawnPoints?.length||0)>0?ve.success(`시작점이 (${Math.round(b)}, ${Math.round(R)})로 변경되었습니다`):ve.success(`시작점이 (${Math.round(b)}, ${Math.round(R)})에 설정되었습니다`),console.log("✅ 시작점 설정 완료, 렌더링 트리거됨")},Rc=b=>{console.log("🖱️🖱️🖱️ 캔버스 클릭 이벤트 발생!"),console.log("클릭 이벤트 객체:",b),console.log("현재 선택된 도구:",l),console.log('selectedTool === "spawn":',l==="spawn");const R=We(b);console.log("🎯 변환된 좌표:",R),console.log("좌표 유효성:",R.x!==0||R.y!==0),l==="spawn"?(console.log("✅✅✅ 시작점 도구 선택됨! addSpawnPoint 호출 시작"),console.log("전달할 좌표:",{x:R.x,y:R.y}),Ec(R.x,R.y),console.log("✅✅✅ addSpawnPoint 호출 완료"),M(!0)):(console.log("❌❌❌ 시작점 도구가 선택되지 않음!"),console.log("현재 도구:",l),console.log("가능한 도구들: wall, private, spawn"))},ao=b=>{const R=b.target.files[0];if(R){T(R);const pe=new FileReader;pe.onload=S=>{const E=S.target.result;q(E);const I=new Image;I.onload=()=>{const z=a.current;z&&(z.width=I.width,z.height=I.height),m({x:1,y:1}),C({width:I.width,height:I.height}),Ee(G=>({...G,size:{width:I.width,height:I.height},backgroundLayer:{...G.backgroundLayer,image:{data:E,contentType:R.type,width:I.width,height:I.height,filename:R.name}}})),Y(G=>({...G,size:{width:I.width,height:I.height}}))},I.src=E},pe.readAsDataURL(R)}},co=()=>{c.current.click()},lo=async()=>{if(!U.name.trim()){ve.error("가상공간 이름을 입력해주세요.");return}ne(!0);try{let b=null,R=null,pe=U.size.width,S=U.size.height,E=null;if(P){b=P.split(",")[1];const re=P.match(/^data:([^;]+);/);R=re?re[1]:"image/jpeg",E=N?.name||`background_${Date.now()}.jpg`}else K?.backgroundLayer?.image?.data&&(b=K.backgroundLayer.image.data,R=K.backgroundLayer.image.contentType||"image/jpeg",pe=K.backgroundLayer.image.width||U.size.width,S=K.backgroundLayer.image.height||U.size.height,E=K.backgroundLayer.image.filename||`background_${Date.now()}.jpg`);const I={name:U.name,description:U.description,terrain:U.terrain||"grass",coordinates:U.coordinates||{latitude:0,longitude:0},size:U.size,backgroundLayer:{image:{data:b,contentType:R,width:pe,height:S,filename:E,uploadedAt:new Date().toISOString()}},walls:K.walls||[],privateAreas:K.privateAreas||[],spawnPoints:K.spawnPoints||[]};console.log("편집할 데이터 (Z축 레이어 구조):",{"레이어 1 (배경)":I.backgroundLayer?.image?"있음":"없음","레이어 2 (벽)":I.walls?.length||0,"레이어 3 (프라이빗)":I.privateAreas?.length||0,"레이어 4 (시작점)":I.spawnPoints?.length||0});const z=await i(t,I);z&&(ve.success("가상공간이 수정되었습니다!"),await o("all"),e(`/metaverse/${z.id||z._id}`))}catch(b){console.error("가상공간 수정 오류:",b),ve.error("가상공간 수정에 실패했습니다.")}finally{ne(!1)}},kc=()=>K?.backgroundLayer?.image?.data?`data:${K.backgroundLayer.image.contentType||"image/jpeg"};base64,${K.backgroundLayer.image.data}`:null,uo=()=>P||kc();return _.useEffect(()=>{const b=a.current;if(!b)return;const R=b.getContext("2d");R.clearRect(0,0,b.width,b.height),U.size.width&&U.size.height&&(b.width=U.size.width,b.height=U.size.height);const pe=uo();if(pe){const S=new Image;S.onload=()=>{R.globalAlpha=W.background,R.drawImage(S,0,0,b.width,b.height),R.globalAlpha=1},S.src=pe}R.globalAlpha=W.walls,K.walls&&Array.isArray(K.walls)&&K.walls.forEach(S=>{R.strokeStyle="#ff0000",R.lineWidth=3,R.beginPath(),R.moveTo(S.start.x,S.start.y),R.lineTo(S.end.x,S.end.y),R.stroke()}),R.globalAlpha=W.privateAreas,K.privateAreas&&Array.isArray(K.privateAreas)&&K.privateAreas.forEach((S,E)=>{R.fillStyle="rgba(0, 0, 255, 0.3)",R.strokeStyle="blue",R.lineWidth=2,R.fillRect(S.position.x,S.position.y,S.size.width,S.size.height),R.strokeRect(S.position.x,S.position.y,S.size.width,S.size.height);const I=S.position.x+S.size.width/2,z=S.position.y+S.size.height/2,G=S.name||`프라이빗 영역 ${E+1}`;R.font="bold 14px Arial";const re=R.measureText(G).width;R.fillStyle="rgba(255, 255, 255, 0.9)",R.fillRect(I-re/2-5,z-10,re+10,20),R.fillStyle="#0000AA",R.textAlign="center",R.textBaseline="middle",R.fillText(G,I,z)}),R.globalAlpha=1,u&&h&&y&&(R.strokeStyle=l==="wall"?"#ff0000":"#0000ff",R.lineWidth=3,R.setLineDash([5,5]),R.beginPath(),R.moveTo(h.x*g.x,h.y*g.y),R.lineTo(y.x*g.x,y.y*g.y),R.stroke(),R.setLineDash([]))},[K,u,h,y,l,g,W,P,U.size,uo]),he?p.jsxs("div",{className:"loading",children:[p.jsx("div",{className:"loading-spinner"}),p.jsx("p",{children:"가상공간을 불러오는 중..."})]}):p.jsx("div",{className:"metaverse-editor",children:p.jsxs("div",{className:"editor-content",children:[p.jsxs("div",{className:"editor-sidebar",children:[p.jsxs("div",{className:"action-buttons",children:[p.jsxs("button",{onClick:lo,disabled:O,className:"save-btn",title:"가상공간 저장",children:[p.jsx("span",{style:{fontSize:"12px"},children:O?"⏳":"💾"}),p.jsx("span",{children:O?"저장 중...":"저장"})]}),p.jsxs("button",{onClick:()=>e(`/metaverse/${t}`),className:"cancel-btn",title:"편집 취소하고 가상공간으로 돌아가기",children:[p.jsx("span",{style:{fontSize:"12px"},children:"❌"}),p.jsx("span",{children:"취소"})]})]}),p.jsxs("div",{className:"sidebar-section",children:[p.jsx("h4",{children:"도구"}),p.jsxs("div",{className:"tool-group",children:[p.jsxs("button",{className:`tool-btn ${l==="image"?"active":""}`,onClick:co,title:"배경 이미지 로드",children:[p.jsx("span",{style:{fontSize:"14px"},children:"🖼️"}),p.jsx("span",{children:"이미지"})]}),p.jsxs("button",{className:`tool-btn ${l==="wall"?"active":""}`,onClick:()=>d("wall"),title:"가상벽 그리기",children:[p.jsx("span",{style:{fontSize:"14px"},children:"🧱"}),p.jsx("span",{children:"벽"})]}),p.jsxs("button",{className:`tool-btn ${l==="private"?"active":""}`,onClick:()=>d("private"),title:"프라이빗 영역 그리기",children:[p.jsx("span",{style:{fontSize:"14px"},children:"🔒"}),p.jsx("span",{children:"프라이빗"})]}),p.jsxs("button",{className:"tool-btn",onClick:()=>A(!0),title:"가상벽 목록 및 편집",children:[p.jsx("span",{style:{fontSize:"14px"},children:"📋"}),p.jsx("span",{children:"벽 목록"})]}),p.jsxs("button",{className:"tool-btn",onClick:()=>D(!0),title:"프라이빗 영역 목록 및 편집",children:[p.jsx("span",{style:{fontSize:"14px"},children:"📋"}),p.jsx("span",{children:"프라이빗 목록"})]}),p.jsxs("button",{className:`tool-btn ${l==="spawn"?"active":""}`,onClick:()=>d("spawn"),title:"시작점 설정",children:[p.jsx("span",{style:{fontSize:"14px"},children:"🎯"}),p.jsx("span",{children:"시작점"})]}),p.jsxs("button",{className:"tool-btn",onClick:()=>M(!0),title:"시작점 정보 및 편집",children:[p.jsx("span",{style:{fontSize:"14px"},children:"📋"}),p.jsx("span",{children:"시작점 정보"})]})]})]}),p.jsxs("div",{className:"sidebar-section",children:[p.jsx("h4",{children:"레이어 투명도"}),p.jsxs("div",{className:"layer-controls",children:[p.jsxs("label",{title:"배경 이미지 투명도",children:[p.jsx("span",{style:{fontSize:"10px"},children:"🖼️"}),p.jsx("span",{children:"배경"}),p.jsx("input",{type:"range",min:"0",max:"1",step:"0.1",value:W.background,onChange:b=>k(R=>({...R,background:parseFloat(b.target.value)}))})]}),p.jsxs("label",{title:"벽 투명도",children:[p.jsx("span",{style:{fontSize:"10px"},children:"🧱"}),p.jsx("span",{children:"벽"}),p.jsx("input",{type:"range",min:"0",max:"1",step:"0.1",value:W.walls,onChange:b=>k(R=>({...R,walls:parseFloat(b.target.value)}))})]}),p.jsxs("label",{title:"프라이빗 영역 투명도",children:[p.jsx("span",{style:{fontSize:"10px"},children:"🔒"}),p.jsx("span",{children:"프라이빗"}),p.jsx("input",{type:"range",min:"0",max:"1",step:"0.1",value:W.privateAreas,onChange:b=>k(R=>({...R,privateAreas:parseFloat(b.target.value)}))})]}),p.jsxs("label",{title:"시작점 투명도",children:[p.jsx("span",{style:{fontSize:"10px"},children:"🎯"}),p.jsx("span",{children:"시작점"}),p.jsx("input",{type:"range",min:"0",max:"1",step:"0.1",value:W.spawnPoints,onChange:b=>k(R=>({...R,spawnPoints:parseFloat(b.target.value)}))})]})]})]})]}),p.jsxs("div",{className:"editor-canvas-container",children:[p.jsx("canvas",{ref:a,className:"editor-canvas",onClick:Rc,onMouseDown:l==="wall"?Me:Wr,onMouseMove:l==="wall"?Pt:ae,onMouseUp:l==="wall"?Bn:me,onMouseLeave:()=>f(!1),style:{border:"1px solid #ccc",backgroundColor:"white",cursor:l==="spawn"?"crosshair":"default",display:!K||he?"none":"block"}}),(!K||he)&&p.jsxs("div",{className:"canvas-loading",children:[p.jsx("div",{className:"loading-spinner"}),p.jsx("p",{children:"맵 데이터를 불러오는 중..."})]}),p.jsx("input",{type:"file",ref:c,id:"image",accept:"image/*",onChange:ao,style:{display:"none"}})]}),L&&p.jsx("div",{className:"modal-overlay",children:p.jsxs("div",{className:"modal-content",children:[p.jsx("h3",{children:"벽 목록"}),p.jsx("div",{className:"list-container",children:K.walls.map((b,R)=>p.jsxs("div",{className:"list-item",children:[p.jsx("span",{children:b.name||`벽 ${R+1}`}),p.jsxs("span",{children:["(",b.start.x,", ",b.start.y,") → (",b.end.x,", ",b.end.y,")"]}),p.jsxs("div",{className:"item-actions",children:[p.jsx("button",{onClick:()=>Re(b),children:"✏️"}),p.jsx("button",{onClick:()=>H(b.id),children:"🗑️"})]})]},b.id))}),p.jsx("button",{onClick:()=>A(!1),children:"닫기"})]})}),F&&p.jsx("div",{className:"modal-overlay",children:p.jsxs("div",{className:"modal-content",children:[p.jsx("h3",{children:"프라이빗 영역 목록"}),p.jsx("div",{className:"list-container",children:K.privateAreas.map((b,R)=>p.jsxs("div",{className:"list-item",children:[p.jsx("span",{children:b.name||`프라이빗 영역 ${R+1}`}),p.jsxs("span",{children:["위치: (",b.position.x,", ",b.position.y,"), 크기: ",b.size.width," x ",b.size.height]}),p.jsxs("div",{className:"item-actions",children:[p.jsx("button",{onClick:()=>xt(b),children:"✏️"}),p.jsx("button",{onClick:()=>de(b.id),children:"🗑️"})]})]},b.id))}),p.jsx("button",{onClick:()=>D(!1),children:"닫기"})]})}),X&&p.jsx("div",{className:"modal-overlay",children:p.jsxs("div",{className:"modal-content",children:[p.jsx("h3",{children:"벽 편집"}),p.jsxs("form",{onSubmit:b=>{b.preventDefault(),Hr(X)},children:[p.jsxs("label",{children:["이름: ",p.jsx("input",{type:"text",value:X.name||"",onChange:b=>ee({...X,name:b.target.value})})]}),p.jsxs("label",{children:["시작 X: ",p.jsx("input",{type:"number",value:X.start.x,onChange:b=>ee({...X,start:{...X.start,x:parseInt(b.target.value)}})})]}),p.jsxs("label",{children:["시작 Y: ",p.jsx("input",{type:"number",value:X.start.y,onChange:b=>ee({...X,start:{...X.start,y:parseInt(b.target.value)}})})]}),p.jsxs("label",{children:["끝 X: ",p.jsx("input",{type:"number",value:X.end.x,onChange:b=>ee({...X,end:{...X.end,x:parseInt(b.target.value)}})})]}),p.jsxs("label",{children:["끝 Y: ",p.jsx("input",{type:"number",value:X.end.y,onChange:b=>ee({...X,end:{...X.end,y:parseInt(b.target.value)}})})]}),p.jsxs("div",{className:"modal-actions",children:[p.jsx("button",{type:"submit",children:"저장"}),p.jsx("button",{type:"button",onClick:()=>ee(null),children:"취소"})]})]})]})}),B&&p.jsx("div",{className:"modal-overlay",children:p.jsxs("div",{className:"modal-content",children:[p.jsx("h3",{children:"시작점 정보"}),p.jsx("div",{className:"list-container",children:(K.spawnPoints||[]).length===0?p.jsxs("div",{className:"no-spawn-point",children:[p.jsx("p",{children:"시작점이 설정되지 않았습니다."}),p.jsx("p",{children:"맵을 클릭하여 시작점을 설정하세요."})]}):(K.spawnPoints||[]).map(b=>p.jsxs("div",{className:"list-item",children:[p.jsx("span",{children:b.name}),p.jsxs("span",{children:["위치: (",b.x,", ",b.y,")"]}),p.jsxs("div",{className:"item-actions",children:[p.jsx("button",{onClick:()=>Q(b),title:"편집",children:"✏️"}),p.jsx("button",{onClick:lo,disabled:O,title:"저장",style:{backgroundColor:"#4CAF50",color:"white",border:"none",padding:"4px 8px",borderRadius:"4px",cursor:O?"not-allowed":"pointer"},children:O?"저장 중...":"저장"}),p.jsx("button",{onClick:()=>M(!1),title:"취소",style:{backgroundColor:"#f44336",color:"white",border:"none",padding:"4px 8px",borderRadius:"4px",cursor:"pointer"},children:"취소"})]})]},b.id))}),p.jsx("button",{onClick:()=>M(!1),children:"닫기"})]})}),V&&p.jsx("div",{className:"modal-overlay",children:p.jsxs("div",{className:"modal-content",children:[p.jsx("h3",{children:"프라이빗 영역 편집"}),p.jsxs("form",{onSubmit:b=>{b.preventDefault(),Cc(V)},children:[p.jsxs("label",{children:["이름: ",p.jsx("input",{type:"text",value:V.name||"",onChange:b=>Z({...V,name:b.target.value})})]}),p.jsxs("label",{children:["위치 X: ",p.jsx("input",{type:"number",value:V.position.x,onChange:b=>Z({...V,position:{...V.position,x:parseInt(b.target.value)}})})]}),p.jsxs("label",{children:["위치 Y: ",p.jsx("input",{type:"number",value:V.position.y,onChange:b=>Z({...V,position:{...V.position,y:parseInt(b.target.value)}})})]}),p.jsxs("label",{children:["너비: ",p.jsx("input",{type:"number",value:V.size.width,onChange:b=>Z({...V,size:{...V.size,width:parseInt(b.target.value)}})})]}),p.jsxs("label",{children:["높이: ",p.jsx("input",{type:"number",value:V.size.height,onChange:b=>Z({...V,size:{...V.size,height:parseInt(b.target.value)}})})]}),p.jsxs("label",{children:["최대 인원: ",p.jsx("input",{type:"number",value:V.maxOccupants,onChange:b=>Z({...V,maxOccupants:parseInt(b.target.value)})})]}),p.jsxs("div",{className:"modal-actions",children:[p.jsx("button",{type:"submit",children:"저장"}),p.jsx("button",{type:"button",onClick:()=>Z(null),children:"취소"})]})]})]})})]})})};const oR=({isOpen:e,onClose:t})=>{const{currentCharacter:n,createCharacter:r,selectCharacter:s,fetchCharacters:i,updateCharacter:o,characters:a}=so(),{user:c,socket:l}=cn(),u=Kt().pathname==="/metaverse/waiting-room",[f,h]=_.useState({head:"😊",body:"👕",arms:"💪",legs:"👖"}),v={head:["😊","😄","😃","😀","😉","😋","😎","🤔","😴","😍","🥰","😇","🤠","👻","🤖","👽","🙂","😐","😑","😶"],body:["👕","👔","🥋","🦺","👚","🎽","🧥","🥼","👘"],arms:["💪","👐","🤲","🙌","👏","🤝","🙏","✌️","🤞","🤟","🤘","👌","👍","👎","👊","✊"],legs:["👖","🩳"]};_.useEffect(()=>{e&&n&&n.appearance&&h(n.appearance)},[e,n]);const y=(g,m)=>{h(w=>({...w,[g]:m}))},x=async()=>{if(u){ve("대기실에서는 캐릭터 저장이 적용되지 않습니다.");return}try{const g=c?.username||"사용자",m={name:g,appearance:f,size:32},w=a.find(L=>L.name===g);let C;w?C=await o(w.id,m):C=await r(m),C?(u||(await i(),s(C)),l&&!u&&l.emit("character-updated",{characterId:C.id,appearance:f}),ve.success("캐릭터가 저장되고 적용되었습니다!"),t()):ve.error("캐릭터 저장에 실패했습니다.")}catch(g){console.error("캐릭터 저장 오류:",g),ve.error("캐릭터 저장에 실패했습니다: "+g.message)}};return e?p.jsx("div",{className:"character-customizer-overlay",children:p.jsxs("div",{className:"character-customizer-modal",children:[p.jsxs("div",{className:"modal-header",children:[p.jsx("h2",{children:"캐릭터 커스터마이징"}),p.jsx("button",{className:"close-btn",onClick:t,children:"✕"})]}),p.jsxs("div",{className:"modal-content",children:[p.jsxs("div",{className:"character-section",children:[p.jsx("h3",{children:"이모지 캐릭터 커스터마이징"}),p.jsx("div",{className:"emoji-preview-container",children:p.jsxs("div",{className:"emoji-character-preview",children:[p.jsx("div",{className:"emoji-part head",children:f.head}),p.jsx("div",{className:"emoji-part body",children:f.body}),p.jsx("div",{className:"emoji-part arms",children:f.arms}),p.jsx("div",{className:"emoji-part legs",children:f.legs})]})}),p.jsxs("div",{className:"emoji-options-container",children:[p.jsxs("div",{className:"emoji-option-group",children:[p.jsx("label",{children:"머리/얼굴:"}),p.jsx("div",{className:"emoji-grid",children:v.head.map((g,m)=>p.jsx("button",{className:`emoji-btn ${f.head===g?"selected":""}`,onClick:()=>y("head",g),children:g},`head-${m}`))})]}),p.jsxs("div",{className:"emoji-option-group",children:[p.jsx("label",{children:"몸/상의:"}),p.jsx("div",{className:"emoji-grid",children:v.body.map((g,m)=>p.jsx("button",{className:`emoji-btn ${f.body===g?"selected":""}`,onClick:()=>y("body",g),children:g},`body-${m}`))})]}),p.jsxs("div",{className:"emoji-option-group",children:[p.jsx("label",{children:"팔:"}),p.jsx("div",{className:"emoji-grid",children:v.arms.map((g,m)=>p.jsx("button",{className:`emoji-btn ${f.arms===g?"selected":""}`,onClick:()=>y("arms",g),children:g},`arms-${m}`))})]}),p.jsxs("div",{className:"emoji-option-group",children:[p.jsx("label",{children:"다리/하의:"}),p.jsx("div",{className:"emoji-grid",children:v.legs.map((g,m)=>p.jsx("button",{className:`emoji-btn ${f.legs===g?"selected":""}`,onClick:()=>y("legs",g),children:g},`legs-${m}`))})]})]})]}),p.jsxs("div",{className:"action-buttons",children:[p.jsx("button",{className:"save-btn",onClick:x,children:"캐릭터 저장"}),p.jsx("button",{className:"cancel-btn",onClick:t,children:"취소"})]})]})]})}):null};const aR=()=>{const e=Sn(),{user:t}=cn(),{maps:n,fetchMaps:r,loading:s,updateMap:i,createMap:o,socket:a}=so(),[c,l]=_.useState(null),[d,u]=_.useState(""),[f,h]=_.useState(!1),[v,y]=_.useState(!1),[x,g]=_.useState(""),[m,w]=_.useState(""),[C,L]=_.useState(1),A=10;_.useEffect(()=>{r()},[]),_.useEffect(()=>{const P=()=>{y(!!document.fullscreenElement)};return document.addEventListener("fullscreenchange",P),()=>document.removeEventListener("fullscreenchange",P)},[]),_.useEffect(()=>{if(!a||!t)return;const P=()=>{a.emit("update-lobby-status",{userId:t.id,username:t.username,mapId:"wait",입실공간:"대기실"})},q=()=>{a.emit("waiting-room-heartbeat"),console.log("💓 대기실 heartbeat 전송")};P();const O=setInterval(q,1e4),ne=he=>{console.log("📢 대기실 사용자 목록 업데이트:",he)};return a.on("waiting-room-users-updated",ne),()=>{clearInterval(O),a.off("waiting-room-users-updated",ne)}},[a,t]);const D=(Array.isArray(n)?n:[]).filter(P=>(P.name||"").toLowerCase().includes(x.toLowerCase())),B=Math.max(1,Math.ceil(D.length/A)),M=Math.min(C,B),X=(M-1)*A,ee=D.slice(X,X+A),V=Array.from({length:A}).map((P,q)=>ee[q]||null),Z=n?.lobbyParticipantCount||0,fe=P=>P.creatorId===t?.id||P.createdBy===t?.id||P.creator?.id===t?.id,Q=()=>{r()};_.useEffect(()=>{L(1)},[x]);const W=()=>{g(m)},k=P=>{fe(P)&&(l(P.id),u(P.name))},U=()=>{l(null),u("")},Y=async P=>{if(d.trim())try{await i(P.id,{name:d.trim()}),l(null),u(""),r()}catch{}},N=async(P,q)=>{if(q.stopPropagation(),!(!window.confirm(`⚠️ 방 삭제 확인

방 이름: ${P.name}
현재 참가자: ${P.participantCount||0}명

정말로 이 방을 삭제하시겠습니까?
이 작업은 되돌릴 수 없습니다.`)||!window.confirm(`🔴 최종 확인

"${P.name}" 방을 완전히 삭제합니다.
계속하시겠습니까?`)))try{const he=localStorage.getItem("token"),_e=await fetch(`/api/maps/${P.id}`,{method:"DELETE",headers:{Authorization:`Bearer ${he}`,"Content-Type":"application/json"}});if(_e.ok)alert("✅ 방이 성공적으로 삭제되었습니다."),r();else{let K="알 수 없는 오류";try{const Ee=_e.headers.get("content-type");Ee&&Ee.includes("application/json")?K=(await _e.json()).message||K:K=`서버 오류 (${_e.status})`}catch(Ee){console.error("응답 파싱 오류:",Ee),K=`서버 오류 (${_e.status})`}alert(`❌ 방 삭제 실패: ${K}`)}}catch(he){console.error("방 삭제 오류:",he),alert("❌ 방 삭제 중 오류가 발생했습니다.")}},T=async()=>{const P=prompt("새 방 이름을 입력하세요:");if(!(!P||P.trim()===""))try{const q=await o({name:P.trim(),createdBy:t?.id||t?.username});q&&q.id&&e(`/metaverse/edit/${q.id}`)}catch(q){console.error("방 생성 실패:",q),alert("방 생성에 실패했습니다.")}};return s?p.jsx("div",{className:"waiting-room",children:p.jsx("div",{className:"loading",children:"방 목록을 불러오는 중..."})}):p.jsxs("div",{className:"waiting-room",children:[p.jsxs("div",{className:"waiting-room-header compact",style:{position:"sticky",top:0,zIndex:2},children:[p.jsxs("div",{className:"header-top compact",children:[p.jsx("h1",{className:"title-compact",children:"Waiting Room"}),p.jsxs("div",{className:"header-actions",children:[p.jsx("input",{className:"search-input",placeholder:"가상공간 검색",value:m,onChange:P=>w(P.target.value),onKeyDown:P=>{P.key==="Enter"&&W()},style:{padding:"5px 8px",borderRadius:14,border:"1px solid rgba(255,255,255,0.3)",marginRight:4,fontSize:"0.85rem",width:"120px",background:"rgba(255,255,255,0.1)",color:"#fff"}}),p.jsx("button",{className:"icon-btn",title:"검색",onClick:W,style:{marginRight:4},children:"🔍"}),p.jsx("button",{className:"icon-btn fullscreen-btn",title:v?"전체화면 종료":"전체화면",onClick:()=>{document.fullscreenElement?document.exitFullscreen():document.documentElement.requestFullscreen().catch(P=>{console.log(`전체화면 오류: ${P.message}`)})},style:{marginRight:4},children:v?"🔳":"🔲"}),p.jsx("button",{className:"icon-btn refresh-btn",title:"새로고침",onClick:Q,children:"🔄"}),p.jsx("button",{className:"icon-btn character-btn",title:"캐릭터 설정",onClick:()=>h(!0),children:"👤"}),p.jsx("button",{className:"create-room-btn",title:"새 방 만들기",onClick:T,style:{backgroundColor:"#4CAF50",color:"white",border:"none",padding:"6px 12px",borderRadius:"16px",cursor:"pointer",fontSize:"0.85rem",fontWeight:"600",marginLeft:"6px"},children:"✨ 새 방 만들기"})]})]}),p.jsxs("div",{className:"header-stats",children:[p.jsxs("span",{children:["대기실 인원: ",p.jsx("strong",{children:Z})]}),p.jsxs("span",{children:["입실 인원 합계: ",p.jsx("strong",{children:Array.isArray(n)?n.reduce((P,q)=>P+(q.participantCount||0),0):0})]})]})]}),p.jsx("div",{className:"waiting-room-main",style:{paddingLeft:0},children:p.jsxs("div",{className:"map-selection",style:{width:"100%"},children:[p.jsxs("div",{className:"flip-board",style:{minHeight:"calc(100vh - 90px)"},children:[D.length===0&&p.jsx("div",{className:"flip-empty",children:"표시할 가상공간이 없습니다."}),V.map((P,q)=>P?p.jsxs("div",{className:"flip-row single-line",onClick:()=>e(`/metaverse/${P.id}`),style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"12px 20px",borderBottom:"1px solid rgba(255, 255, 255, 0.1)",cursor:"pointer",transition:"background 0.2s",":hover":{background:"rgba(255, 255, 255, 0.05)"}},onMouseEnter:O=>O.currentTarget.style.background="rgba(255, 255, 255, 0.05)",onMouseLeave:O=>O.currentTarget.style.background="transparent",children:[p.jsxs("div",{className:"room-info-left",style:{display:"flex",alignItems:"center",gap:"20px",flex:1},children:[p.jsxs("span",{className:"room-number",style:{color:"#888",fontSize:"14px",minWidth:"30px"},children:["#",q+1]}),p.jsx("div",{className:"room-name-section",style:{minWidth:"200px",flex:1},children:c===P.id?p.jsxs("div",{className:"name-edit-container",onClick:O=>O.stopPropagation(),style:{display:"flex",gap:"8px",alignItems:"center"},children:[p.jsx("input",{className:"name-edit-input",value:d,onChange:O=>u(O.target.value),onKeyDown:O=>{O.key==="Enter"&&Y(P),O.key==="Escape"&&U()},autoFocus:!0,style:{background:"rgba(255, 255, 255, 0.1)",border:"1px solid rgba(255, 255, 255, 0.3)",borderRadius:"4px",padding:"4px 8px",color:"white",flex:1}}),p.jsx("button",{className:"save-name-btn",onClick:()=>Y(P),style:{padding:"4px 8px",borderRadius:"4px",background:"#4CAF50",color:"white",border:"none",cursor:"pointer"},children:"✓"}),p.jsx("button",{className:"cancel-name-btn",onClick:U,style:{padding:"4px 8px",borderRadius:"4px",background:"#f44336",color:"white",border:"none",cursor:"pointer"},children:"✗"})]}):p.jsx("span",{className:"room-name",style:{fontSize:"16px",fontWeight:"bold",color:"white"},children:P.name})}),p.jsxs("span",{className:"room-creator",style:{color:"#aaa",fontSize:"14px",minWidth:"120px"},children:["👤 ",P.creatorInfo?.username||P.creator?.username||"알 수 없음"]}),p.jsxs("span",{className:"room-participants",style:{color:"#4CAF50",fontSize:"14px",minWidth:"80px"},children:["👥 ",P.participantCount||0,"명"]})]}),p.jsxs("div",{className:"room-info-right",style:{display:"flex",alignItems:"center",gap:"8px"},children:[fe(P)&&p.jsxs(p.Fragment,{children:[p.jsx("button",{className:"control-btn edit-btn",title:"방 이름 수정",onClick:O=>{O.stopPropagation(),k(P)},style:{background:"rgba(76, 175, 80, 0.2)",border:"1px solid rgba(76, 175, 80, 0.5)",borderRadius:"4px",padding:"4px 10px",cursor:"pointer",fontSize:"13px",color:"#4CAF50",transition:"all 0.2s"},onMouseEnter:O=>{O.target.style.background="rgba(76, 175, 80, 0.4)"},onMouseLeave:O=>{O.target.style.background="rgba(76, 175, 80, 0.2)"},children:"✏️"}),p.jsx("button",{className:"control-btn settings-btn",title:"방 설정 편집",onClick:O=>{O.stopPropagation(),e(`/metaverse/edit/${P.id}`)},style:{background:"rgba(33, 150, 243, 0.2)",border:"1px solid rgba(33, 150, 243, 0.5)",borderRadius:"4px",padding:"4px 10px",cursor:"pointer",fontSize:"13px",color:"#2196F3",transition:"all 0.2s"},onMouseEnter:O=>{O.target.style.background="rgba(33, 150, 243, 0.4)"},onMouseLeave:O=>{O.target.style.background="rgba(33, 150, 243, 0.2)"},children:"⚙️"}),p.jsx("button",{className:"control-btn delete-btn",title:"방 삭제",onClick:O=>N(P,O),style:{background:"rgba(244, 67, 54, 0.2)",border:"1px solid rgba(244, 67, 54, 0.5)",borderRadius:"4px",padding:"4px 10px",cursor:"pointer",fontSize:"13px",color:"#f44336",transition:"all 0.2s"},onMouseEnter:O=>{O.target.style.background="rgba(244, 67, 54, 0.4)"},onMouseLeave:O=>{O.target.style.background="rgba(244, 67, 54, 0.2)"},children:"🗑️"})]}),p.jsx("button",{className:"enter-room-btn",style:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",border:"none",borderRadius:"20px",padding:"6px 16px",color:"white",cursor:"pointer",fontSize:"14px",fontWeight:"bold",transition:"all 0.3s",marginLeft:"8px"},onMouseEnter:O=>{O.target.style.transform="scale(1.05)",O.target.style.boxShadow="0 4px 15px rgba(102, 126, 234, 0.4)"},onMouseLeave:O=>{O.target.style.transform="scale(1)",O.target.style.boxShadow="none"},children:"입장 →"})]})]},P.id):p.jsxs("div",{className:"flip-row placeholder",style:{opacity:.35},children:[p.jsx("div",{className:"flip-cell name",children:p.jsx("span",{className:"flip-text",children:" "})}),p.jsx("div",{className:"flip-cell creator",children:" "}),p.jsx("div",{className:"flip-cell counts",children:" "})]},`placeholder-${q}`))]}),p.jsxs("div",{style:{display:"flex",justifyContent:"center",gap:12,padding:"12px 0"},children:[p.jsx("button",{className:"icon-btn",disabled:M<=1,onClick:()=>L(P=>Math.max(1,P-1)),children:"⬅ 이전 리스트"}),p.jsxs("span",{style:{color:"#fff"},children:[M," / ",B]}),p.jsx("button",{className:"icon-btn",disabled:M>=B,onClick:()=>L(P=>Math.min(B,P+1)),children:"다음 리스트 ➡"})]})]})}),f&&p.jsx(oR,{isOpen:f,onClose:()=>h(!1)})]})},li=({children:e})=>{const{user:t,loading:n}=cn(),r=Kt();return n?p.jsx("div",{className:"loading",children:"로딩 중..."}):t?e:p.jsx(Gg,{to:"/login",replace:!0,state:{from:r}})};function cR(){const e=Sn(),{user:t,logout:n}=cn(),r=()=>{n(),e("/login")},s=()=>{window.location.href="/metaverse/waiting-room"};return p.jsx("div",{className:"main-page",children:p.jsxs("div",{className:"sky-background",children:[p.jsxs("div",{className:"clouds",children:[p.jsx("div",{className:"cloud cloud1"}),p.jsx("div",{className:"cloud cloud2"}),p.jsx("div",{className:"cloud cloud3"})]}),p.jsxs("div",{className:"mini-area-text",children:[p.jsx("h1",{children:"MINI AREA"}),p.jsx("p",{children:"당신만의 가상공간을 만들어보세요"})]}),p.jsxs("div",{className:"main-buttons",children:[p.jsx("button",{className:"enter-metaverse-btn",onClick:s,children:"가상공간 입장"}),p.jsx("button",{className:"logout-btn",onClick:r,children:"로그아웃"})]}),p.jsx("div",{className:"user-info",children:p.jsxs("p",{children:["환영합니다, ",t?.username||"사용자","님!"]})})]})})}const lR=()=>p.jsx(nx,{children:p.jsx(sx,{children:p.jsx("div",{className:"App",children:p.jsxs(k_,{children:[p.jsx(Yt,{path:"/login",element:p.jsx(ix,{})}),p.jsx(Yt,{path:"/register",element:p.jsx(ox,{})}),p.jsx(Yt,{path:"/verify-email",element:p.jsx(ax,{})}),p.jsx(Yt,{path:"/metaverse",element:p.jsx(Gg,{to:"/"})}),p.jsx(Yt,{path:"/metaverse/waiting-room",element:p.jsx(li,{children:p.jsx(aR,{})})}),p.jsx(Yt,{path:"/metaverse/lobby",element:p.jsx(li,{children:p.jsx(gl,{})})}),p.jsx(Yt,{path:"/metaverse/:mapId",element:p.jsx(li,{children:p.jsx(gl,{})})}),p.jsx(Yt,{path:"/join/:link",element:p.jsx(gl,{})}),p.jsx(Yt,{path:"/metaverse/edit/:mapId",element:p.jsx(li,{children:p.jsx(iR,{})})}),p.jsx(Yt,{path:"/",element:p.jsx(li,{children:p.jsx(cR,{})})})]})})})});vl.createRoot(document.getElementById("root")).render(p.jsx(Ah.StrictMode,{children:p.jsx(M_,{children:p.jsx(lR,{})})}));
