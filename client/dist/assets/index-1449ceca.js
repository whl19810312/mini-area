import{l as qv}from"./webrtc-d9998155.js";function Gv(e,t){for(var n=0;n<t.length;n++){const r=t[n];if(typeof r!="string"&&!Array.isArray(r)){for(const i in r)if(i!=="default"&&!(i in e)){const o=Object.getOwnPropertyDescriptor(r,i);o&&Object.defineProperty(e,i,o.get?o:{enumerable:!0,get:()=>r[i]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const s of o.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&r(s)}).observe(document,{childList:!0,subtree:!0});function n(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(i){if(i.ep)return;i.ep=!0;const o=n(i);fetch(i.href,o)}})();var ue=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Xv(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function Jv(e){if(e.__esModule)return e;var t=e.default;if(typeof t=="function"){var n=function r(){return this instanceof r?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};n.prototype=t.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(e).forEach(function(r){var i=Object.getOwnPropertyDescriptor(e,r);Object.defineProperty(n,r,i.get?i:{enumerable:!0,get:function(){return e[r]}})}),n}var bp={exports:{}},da={},Cp={exports:{}},Ee={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Co=Symbol.for("react.element"),Kv=Symbol.for("react.portal"),Qv=Symbol.for("react.fragment"),Yv=Symbol.for("react.strict_mode"),Zv=Symbol.for("react.profiler"),eg=Symbol.for("react.provider"),tg=Symbol.for("react.context"),ng=Symbol.for("react.forward_ref"),rg=Symbol.for("react.suspense"),ig=Symbol.for("react.memo"),og=Symbol.for("react.lazy"),pd=Symbol.iterator;function sg(e){return e===null||typeof e!="object"?null:(e=pd&&e[pd]||e["@@iterator"],typeof e=="function"?e:null)}var xp={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},kp=Object.assign,Pp={};function di(e,t,n){this.props=e,this.context=t,this.refs=Pp,this.updater=n||xp}di.prototype.isReactComponent={};di.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};di.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function Op(){}Op.prototype=di.prototype;function Jc(e,t,n){this.props=e,this.context=t,this.refs=Pp,this.updater=n||xp}var Kc=Jc.prototype=new Op;Kc.constructor=Jc;kp(Kc,di.prototype);Kc.isPureReactComponent=!0;var hd=Array.isArray,Rp=Object.prototype.hasOwnProperty,Qc={current:null},_p={key:!0,ref:!0,__self:!0,__source:!0};function Ip(e,t,n){var r,i={},o=null,s=null;if(t!=null)for(r in t.ref!==void 0&&(s=t.ref),t.key!==void 0&&(o=""+t.key),t)Rp.call(t,r)&&!_p.hasOwnProperty(r)&&(i[r]=t[r]);var a=arguments.length-2;if(a===1)i.children=n;else if(1<a){for(var c=Array(a),l=0;l<a;l++)c[l]=arguments[l+2];i.children=c}if(e&&e.defaultProps)for(r in a=e.defaultProps,a)i[r]===void 0&&(i[r]=a[r]);return{$$typeof:Co,type:e,key:o,ref:s,props:i,_owner:Qc.current}}function ag(e,t){return{$$typeof:Co,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function Yc(e){return typeof e=="object"&&e!==null&&e.$$typeof===Co}function lg(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(n){return t[n]})}var md=/\/+/g;function Xa(e,t){return typeof e=="object"&&e!==null&&e.key!=null?lg(""+e.key):t.toString(36)}function hs(e,t,n,r,i){var o=typeof e;(o==="undefined"||o==="boolean")&&(e=null);var s=!1;if(e===null)s=!0;else switch(o){case"string":case"number":s=!0;break;case"object":switch(e.$$typeof){case Co:case Kv:s=!0}}if(s)return s=e,i=i(s),e=r===""?"."+Xa(s,0):r,hd(i)?(n="",e!=null&&(n=e.replace(md,"$&/")+"/"),hs(i,t,n,"",function(l){return l})):i!=null&&(Yc(i)&&(i=ag(i,n+(!i.key||s&&s.key===i.key?"":(""+i.key).replace(md,"$&/")+"/")+e)),t.push(i)),1;if(s=0,r=r===""?".":r+":",hd(e))for(var a=0;a<e.length;a++){o=e[a];var c=r+Xa(o,a);s+=hs(o,t,n,c,i)}else if(c=sg(e),typeof c=="function")for(e=c.call(e),a=0;!(o=e.next()).done;)o=o.value,c=r+Xa(o,a++),s+=hs(o,t,n,c,i);else if(o==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return s}function Ho(e,t,n){if(e==null)return e;var r=[],i=0;return hs(e,r,"","",function(o){return t.call(n,o,i++)}),r}function cg(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(n){(e._status===0||e._status===-1)&&(e._status=1,e._result=n)},function(n){(e._status===0||e._status===-1)&&(e._status=2,e._result=n)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var bt={current:null},ms={transition:null},ug={ReactCurrentDispatcher:bt,ReactCurrentBatchConfig:ms,ReactCurrentOwner:Qc};function Np(){throw Error("act(...) is not supported in production builds of React.")}Ee.Children={map:Ho,forEach:function(e,t,n){Ho(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return Ho(e,function(){t++}),t},toArray:function(e){return Ho(e,function(t){return t})||[]},only:function(e){if(!Yc(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Ee.Component=di;Ee.Fragment=Qv;Ee.Profiler=Zv;Ee.PureComponent=Jc;Ee.StrictMode=Yv;Ee.Suspense=rg;Ee.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ug;Ee.act=Np;Ee.cloneElement=function(e,t,n){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var r=kp({},e.props),i=e.key,o=e.ref,s=e._owner;if(t!=null){if(t.ref!==void 0&&(o=t.ref,s=Qc.current),t.key!==void 0&&(i=""+t.key),e.type&&e.type.defaultProps)var a=e.type.defaultProps;for(c in t)Rp.call(t,c)&&!_p.hasOwnProperty(c)&&(r[c]=t[c]===void 0&&a!==void 0?a[c]:t[c])}var c=arguments.length-2;if(c===1)r.children=n;else if(1<c){a=Array(c);for(var l=0;l<c;l++)a[l]=arguments[l+2];r.children=a}return{$$typeof:Co,type:e.type,key:i,ref:o,props:r,_owner:s}};Ee.createContext=function(e){return e={$$typeof:tg,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:eg,_context:e},e.Consumer=e};Ee.createElement=Ip;Ee.createFactory=function(e){var t=Ip.bind(null,e);return t.type=e,t};Ee.createRef=function(){return{current:null}};Ee.forwardRef=function(e){return{$$typeof:ng,render:e}};Ee.isValidElement=Yc;Ee.lazy=function(e){return{$$typeof:og,_payload:{_status:-1,_result:e},_init:cg}};Ee.memo=function(e,t){return{$$typeof:ig,type:e,compare:t===void 0?null:t}};Ee.startTransition=function(e){var t=ms.transition;ms.transition={};try{e()}finally{ms.transition=t}};Ee.unstable_act=Np;Ee.useCallback=function(e,t){return bt.current.useCallback(e,t)};Ee.useContext=function(e){return bt.current.useContext(e)};Ee.useDebugValue=function(){};Ee.useDeferredValue=function(e){return bt.current.useDeferredValue(e)};Ee.useEffect=function(e,t){return bt.current.useEffect(e,t)};Ee.useId=function(){return bt.current.useId()};Ee.useImperativeHandle=function(e,t,n){return bt.current.useImperativeHandle(e,t,n)};Ee.useInsertionEffect=function(e,t){return bt.current.useInsertionEffect(e,t)};Ee.useLayoutEffect=function(e,t){return bt.current.useLayoutEffect(e,t)};Ee.useMemo=function(e,t){return bt.current.useMemo(e,t)};Ee.useReducer=function(e,t,n){return bt.current.useReducer(e,t,n)};Ee.useRef=function(e){return bt.current.useRef(e)};Ee.useState=function(e){return bt.current.useState(e)};Ee.useSyncExternalStore=function(e,t,n){return bt.current.useSyncExternalStore(e,t,n)};Ee.useTransition=function(){return bt.current.useTransition()};Ee.version="18.3.1";Cp.exports=Ee;var R=Cp.exports;const Tp=Xv(R),dg=Gv({__proto__:null,default:Tp},[R]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var fg=R,pg=Symbol.for("react.element"),hg=Symbol.for("react.fragment"),mg=Object.prototype.hasOwnProperty,vg=fg.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,gg={key:!0,ref:!0,__self:!0,__source:!0};function Lp(e,t,n){var r,i={},o=null,s=null;n!==void 0&&(o=""+n),t.key!==void 0&&(o=""+t.key),t.ref!==void 0&&(s=t.ref);for(r in t)mg.call(t,r)&&!gg.hasOwnProperty(r)&&(i[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps,t)i[r]===void 0&&(i[r]=t[r]);return{$$typeof:pg,type:e,key:o,ref:s,props:i,_owner:vg.current}}da.Fragment=hg;da.jsx=Lp;da.jsxs=Lp;bp.exports=da;var h=bp.exports,Ul={},Ap={exports:{}},jt={},Mp={exports:{}},jp={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(O,F){var W=O.length;O.push(F);e:for(;0<W;){var $=W-1>>>1,q=O[$];if(0<i(q,F))O[$]=F,O[W]=q,W=$;else break e}}function n(O){return O.length===0?null:O[0]}function r(O){if(O.length===0)return null;var F=O[0],W=O.pop();if(W!==F){O[0]=W;e:for(var $=0,q=O.length,H=q>>>1;$<H;){var Q=2*($+1)-1,Y=O[Q],L=Q+1,J=O[L];if(0>i(Y,W))L<q&&0>i(J,Y)?(O[$]=J,O[L]=W,$=L):(O[$]=Y,O[Q]=W,$=Q);else if(L<q&&0>i(J,W))O[$]=J,O[L]=W,$=L;else break e}}return F}function i(O,F){var W=O.sortIndex-F.sortIndex;return W!==0?W:O.id-F.id}if(typeof performance=="object"&&typeof performance.now=="function"){var o=performance;e.unstable_now=function(){return o.now()}}else{var s=Date,a=s.now();e.unstable_now=function(){return s.now()-a}}var c=[],l=[],u=1,d=null,m=3,g=!1,b=!1,P=!1,k=typeof setTimeout=="function"?setTimeout:null,f=typeof clearTimeout=="function"?clearTimeout:null,v=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function w(O){for(var F=n(l);F!==null;){if(F.callback===null)r(l);else if(F.startTime<=O)r(l),F.sortIndex=F.expirationTime,t(c,F);else break;F=n(l)}}function y(O){if(P=!1,w(O),!b)if(n(c)!==null)b=!0,_(T);else{var F=n(l);F!==null&&C(y,F.startTime-O)}}function T(O,F){b=!1,P&&(P=!1,f(S),S=-1),g=!0;var W=m;try{for(w(F),d=n(c);d!==null&&(!(d.expirationTime>F)||O&&!I());){var $=d.callback;if(typeof $=="function"){d.callback=null,m=d.priorityLevel;var q=$(d.expirationTime<=F);F=e.unstable_now(),typeof q=="function"?d.callback=q:d===n(c)&&r(c),w(F)}else r(c);d=n(c)}if(d!==null)var H=!0;else{var Q=n(l);Q!==null&&C(y,Q.startTime-F),H=!1}return H}finally{d=null,m=W,g=!1}}var M=!1,U=null,S=-1,p=5,E=-1;function I(){return!(e.unstable_now()-E<p)}function x(){if(U!==null){var O=e.unstable_now();E=O;var F=!0;try{F=U(!0,O)}finally{F?N():(M=!1,U=null)}}else M=!1}var N;if(typeof v=="function")N=function(){v(x)};else if(typeof MessageChannel<"u"){var j=new MessageChannel,X=j.port2;j.port1.onmessage=x,N=function(){X.postMessage(null)}}else N=function(){k(x,0)};function _(O){U=O,M||(M=!0,N())}function C(O,F){S=k(function(){O(e.unstable_now())},F)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(O){O.callback=null},e.unstable_continueExecution=function(){b||g||(b=!0,_(T))},e.unstable_forceFrameRate=function(O){0>O||125<O?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):p=0<O?Math.floor(1e3/O):5},e.unstable_getCurrentPriorityLevel=function(){return m},e.unstable_getFirstCallbackNode=function(){return n(c)},e.unstable_next=function(O){switch(m){case 1:case 2:case 3:var F=3;break;default:F=m}var W=m;m=F;try{return O()}finally{m=W}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(O,F){switch(O){case 1:case 2:case 3:case 4:case 5:break;default:O=3}var W=m;m=O;try{return F()}finally{m=W}},e.unstable_scheduleCallback=function(O,F,W){var $=e.unstable_now();switch(typeof W=="object"&&W!==null?(W=W.delay,W=typeof W=="number"&&0<W?$+W:$):W=$,O){case 1:var q=-1;break;case 2:q=250;break;case 5:q=1073741823;break;case 4:q=1e4;break;default:q=5e3}return q=W+q,O={id:u++,callback:F,priorityLevel:O,startTime:W,expirationTime:q,sortIndex:-1},W>$?(O.sortIndex=W,t(l,O),n(c)===null&&O===n(l)&&(P?(f(S),S=-1):P=!0,C(y,W-$))):(O.sortIndex=q,t(c,O),b||g||(b=!0,_(T))),O},e.unstable_shouldYield=I,e.unstable_wrapCallback=function(O){var F=m;return function(){var W=m;m=F;try{return O.apply(this,arguments)}finally{m=W}}}})(jp);Mp.exports=jp;var yg=Mp.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Sg=R,Mt=yg;function te(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Dp=new Set,no={};function Pr(e,t){ii(e,t),ii(e+"Capture",t)}function ii(e,t){for(no[e]=t,e=0;e<t.length;e++)Dp.add(t[e])}var xn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),$l=Object.prototype.hasOwnProperty,wg=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,vd={},gd={};function Eg(e){return $l.call(gd,e)?!0:$l.call(vd,e)?!1:wg.test(e)?gd[e]=!0:(vd[e]=!0,!1)}function bg(e,t,n,r){if(n!==null&&n.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function Cg(e,t,n,r){if(t===null||typeof t>"u"||bg(e,t,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Ct(e,t,n,r,i,o,s){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=o,this.removeEmptyString=s}var ot={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){ot[e]=new Ct(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];ot[t]=new Ct(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){ot[e]=new Ct(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){ot[e]=new Ct(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){ot[e]=new Ct(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){ot[e]=new Ct(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){ot[e]=new Ct(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){ot[e]=new Ct(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){ot[e]=new Ct(e,5,!1,e.toLowerCase(),null,!1,!1)});var Zc=/[\-:]([a-z])/g;function eu(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(Zc,eu);ot[t]=new Ct(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(Zc,eu);ot[t]=new Ct(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(Zc,eu);ot[t]=new Ct(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){ot[e]=new Ct(e,1,!1,e.toLowerCase(),null,!1,!1)});ot.xlinkHref=new Ct("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){ot[e]=new Ct(e,1,!1,e.toLowerCase(),null,!0,!0)});function tu(e,t,n,r){var i=ot.hasOwnProperty(t)?ot[t]:null;(i!==null?i.type!==0:r||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(Cg(t,n,i,r)&&(n=null),r||i===null?Eg(t)&&(n===null?e.removeAttribute(t):e.setAttribute(t,""+n)):i.mustUseProperty?e[i.propertyName]=n===null?i.type===3?!1:"":n:(t=i.attributeName,r=i.attributeNamespace,n===null?e.removeAttribute(t):(i=i.type,n=i===3||i===4&&n===!0?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}var _n=Sg.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,qo=Symbol.for("react.element"),Vr=Symbol.for("react.portal"),Fr=Symbol.for("react.fragment"),nu=Symbol.for("react.strict_mode"),Bl=Symbol.for("react.profiler"),Vp=Symbol.for("react.provider"),Fp=Symbol.for("react.context"),ru=Symbol.for("react.forward_ref"),zl=Symbol.for("react.suspense"),Wl=Symbol.for("react.suspense_list"),iu=Symbol.for("react.memo"),jn=Symbol.for("react.lazy"),Up=Symbol.for("react.offscreen"),yd=Symbol.iterator;function Ii(e){return e===null||typeof e!="object"?null:(e=yd&&e[yd]||e["@@iterator"],typeof e=="function"?e:null)}var Ue=Object.assign,Ja;function zi(e){if(Ja===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);Ja=t&&t[1]||""}return`
`+Ja+e}var Ka=!1;function Qa(e,t){if(!e||Ka)return"";Ka=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(l){var r=l}Reflect.construct(e,[],t)}else{try{t.call()}catch(l){r=l}e.call(t.prototype)}else{try{throw Error()}catch(l){r=l}e()}}catch(l){if(l&&r&&typeof l.stack=="string"){for(var i=l.stack.split(`
`),o=r.stack.split(`
`),s=i.length-1,a=o.length-1;1<=s&&0<=a&&i[s]!==o[a];)a--;for(;1<=s&&0<=a;s--,a--)if(i[s]!==o[a]){if(s!==1||a!==1)do if(s--,a--,0>a||i[s]!==o[a]){var c=`
`+i[s].replace(" at new "," at ");return e.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",e.displayName)),c}while(1<=s&&0<=a);break}}}finally{Ka=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?zi(e):""}function xg(e){switch(e.tag){case 5:return zi(e.type);case 16:return zi("Lazy");case 13:return zi("Suspense");case 19:return zi("SuspenseList");case 0:case 2:case 15:return e=Qa(e.type,!1),e;case 11:return e=Qa(e.type.render,!1),e;case 1:return e=Qa(e.type,!0),e;default:return""}}function Hl(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Fr:return"Fragment";case Vr:return"Portal";case Bl:return"Profiler";case nu:return"StrictMode";case zl:return"Suspense";case Wl:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case Fp:return(e.displayName||"Context")+".Consumer";case Vp:return(e._context.displayName||"Context")+".Provider";case ru:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case iu:return t=e.displayName||null,t!==null?t:Hl(e.type)||"Memo";case jn:t=e._payload,e=e._init;try{return Hl(e(t))}catch{}}return null}function kg(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Hl(t);case 8:return t===nu?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function nr(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function $p(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function Pg(e){var t=$p(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var i=n.get,o=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(s){r=""+s,o.call(this,s)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(s){r=""+s},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Go(e){e._valueTracker||(e._valueTracker=Pg(e))}function Bp(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=$p(e)?e.checked?"true":"false":e.value),e=r,e!==n?(t.setValue(e),!0):!1}function Ns(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function ql(e,t){var n=t.checked;return Ue({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??e._wrapperState.initialChecked})}function Sd(e,t){var n=t.defaultValue==null?"":t.defaultValue,r=t.checked!=null?t.checked:t.defaultChecked;n=nr(t.value!=null?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function zp(e,t){t=t.checked,t!=null&&tu(e,"checked",t,!1)}function Gl(e,t){zp(e,t);var n=nr(t.value),r=t.type;if(n!=null)r==="number"?(n===0&&e.value===""||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if(r==="submit"||r==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?Xl(e,t.type,n):t.hasOwnProperty("defaultValue")&&Xl(e,t.type,nr(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function wd(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!(r!=="submit"&&r!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}n=e.name,n!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,n!==""&&(e.name=n)}function Xl(e,t,n){(t!=="number"||Ns(e.ownerDocument)!==e)&&(n==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var Wi=Array.isArray;function Qr(e,t,n,r){if(e=e.options,t){t={};for(var i=0;i<n.length;i++)t["$"+n[i]]=!0;for(n=0;n<e.length;n++)i=t.hasOwnProperty("$"+e[n].value),e[n].selected!==i&&(e[n].selected=i),i&&r&&(e[n].defaultSelected=!0)}else{for(n=""+nr(n),t=null,i=0;i<e.length;i++){if(e[i].value===n){e[i].selected=!0,r&&(e[i].defaultSelected=!0);return}t!==null||e[i].disabled||(t=e[i])}t!==null&&(t.selected=!0)}}function Jl(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(te(91));return Ue({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function Ed(e,t){var n=t.value;if(n==null){if(n=t.children,t=t.defaultValue,n!=null){if(t!=null)throw Error(te(92));if(Wi(n)){if(1<n.length)throw Error(te(93));n=n[0]}t=n}t==null&&(t=""),n=t}e._wrapperState={initialValue:nr(n)}}function Wp(e,t){var n=nr(t.value),r=nr(t.defaultValue);n!=null&&(n=""+n,n!==e.value&&(e.value=n),t.defaultValue==null&&e.defaultValue!==n&&(e.defaultValue=n)),r!=null&&(e.defaultValue=""+r)}function bd(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function Hp(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Kl(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?Hp(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var Xo,qp=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,n,r,i){MSApp.execUnsafeLocalFunction(function(){return e(t,n,r,i)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(Xo=Xo||document.createElement("div"),Xo.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=Xo.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function ro(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var Gi={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Og=["Webkit","ms","Moz","O"];Object.keys(Gi).forEach(function(e){Og.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Gi[t]=Gi[e]})});function Gp(e,t,n){return t==null||typeof t=="boolean"||t===""?"":n||typeof t!="number"||t===0||Gi.hasOwnProperty(e)&&Gi[e]?(""+t).trim():t+"px"}function Xp(e,t){e=e.style;for(var n in t)if(t.hasOwnProperty(n)){var r=n.indexOf("--")===0,i=Gp(n,t[n],r);n==="float"&&(n="cssFloat"),r?e.setProperty(n,i):e[n]=i}}var Rg=Ue({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Ql(e,t){if(t){if(Rg[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(te(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(te(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(te(61))}if(t.style!=null&&typeof t.style!="object")throw Error(te(62))}}function Yl(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Zl=null;function ou(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var ec=null,Yr=null,Zr=null;function Cd(e){if(e=Po(e)){if(typeof ec!="function")throw Error(te(280));var t=e.stateNode;t&&(t=va(t),ec(e.stateNode,e.type,t))}}function Jp(e){Yr?Zr?Zr.push(e):Zr=[e]:Yr=e}function Kp(){if(Yr){var e=Yr,t=Zr;if(Zr=Yr=null,Cd(e),t)for(e=0;e<t.length;e++)Cd(t[e])}}function Qp(e,t){return e(t)}function Yp(){}var Ya=!1;function Zp(e,t,n){if(Ya)return e(t,n);Ya=!0;try{return Qp(e,t,n)}finally{Ya=!1,(Yr!==null||Zr!==null)&&(Yp(),Kp())}}function io(e,t){var n=e.stateNode;if(n===null)return null;var r=va(n);if(r===null)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(e=e.type,r=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!r;break e;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(te(231,t,typeof n));return n}var tc=!1;if(xn)try{var Ni={};Object.defineProperty(Ni,"passive",{get:function(){tc=!0}}),window.addEventListener("test",Ni,Ni),window.removeEventListener("test",Ni,Ni)}catch{tc=!1}function _g(e,t,n,r,i,o,s,a,c){var l=Array.prototype.slice.call(arguments,3);try{t.apply(n,l)}catch(u){this.onError(u)}}var Xi=!1,Ts=null,Ls=!1,nc=null,Ig={onError:function(e){Xi=!0,Ts=e}};function Ng(e,t,n,r,i,o,s,a,c){Xi=!1,Ts=null,_g.apply(Ig,arguments)}function Tg(e,t,n,r,i,o,s,a,c){if(Ng.apply(this,arguments),Xi){if(Xi){var l=Ts;Xi=!1,Ts=null}else throw Error(te(198));Ls||(Ls=!0,nc=l)}}function Or(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function eh(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function xd(e){if(Or(e)!==e)throw Error(te(188))}function Lg(e){var t=e.alternate;if(!t){if(t=Or(e),t===null)throw Error(te(188));return t!==e?null:e}for(var n=e,r=t;;){var i=n.return;if(i===null)break;var o=i.alternate;if(o===null){if(r=i.return,r!==null){n=r;continue}break}if(i.child===o.child){for(o=i.child;o;){if(o===n)return xd(i),e;if(o===r)return xd(i),t;o=o.sibling}throw Error(te(188))}if(n.return!==r.return)n=i,r=o;else{for(var s=!1,a=i.child;a;){if(a===n){s=!0,n=i,r=o;break}if(a===r){s=!0,r=i,n=o;break}a=a.sibling}if(!s){for(a=o.child;a;){if(a===n){s=!0,n=o,r=i;break}if(a===r){s=!0,r=o,n=i;break}a=a.sibling}if(!s)throw Error(te(189))}}if(n.alternate!==r)throw Error(te(190))}if(n.tag!==3)throw Error(te(188));return n.stateNode.current===n?e:t}function th(e){return e=Lg(e),e!==null?nh(e):null}function nh(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=nh(e);if(t!==null)return t;e=e.sibling}return null}var rh=Mt.unstable_scheduleCallback,kd=Mt.unstable_cancelCallback,Ag=Mt.unstable_shouldYield,Mg=Mt.unstable_requestPaint,ze=Mt.unstable_now,jg=Mt.unstable_getCurrentPriorityLevel,su=Mt.unstable_ImmediatePriority,ih=Mt.unstable_UserBlockingPriority,As=Mt.unstable_NormalPriority,Dg=Mt.unstable_LowPriority,oh=Mt.unstable_IdlePriority,fa=null,hn=null;function Vg(e){if(hn&&typeof hn.onCommitFiberRoot=="function")try{hn.onCommitFiberRoot(fa,e,void 0,(e.current.flags&128)===128)}catch{}}var Zt=Math.clz32?Math.clz32:$g,Fg=Math.log,Ug=Math.LN2;function $g(e){return e>>>=0,e===0?32:31-(Fg(e)/Ug|0)|0}var Jo=64,Ko=4194304;function Hi(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Ms(e,t){var n=e.pendingLanes;if(n===0)return 0;var r=0,i=e.suspendedLanes,o=e.pingedLanes,s=n&268435455;if(s!==0){var a=s&~i;a!==0?r=Hi(a):(o&=s,o!==0&&(r=Hi(o)))}else s=n&~i,s!==0?r=Hi(s):o!==0&&(r=Hi(o));if(r===0)return 0;if(t!==0&&t!==r&&!(t&i)&&(i=r&-r,o=t&-t,i>=o||i===16&&(o&4194240)!==0))return t;if(r&4&&(r|=n&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=r;0<t;)n=31-Zt(t),i=1<<n,r|=e[n],t&=~i;return r}function Bg(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function zg(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,i=e.expirationTimes,o=e.pendingLanes;0<o;){var s=31-Zt(o),a=1<<s,c=i[s];c===-1?(!(a&n)||a&r)&&(i[s]=Bg(a,t)):c<=t&&(e.expiredLanes|=a),o&=~a}}function rc(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function sh(){var e=Jo;return Jo<<=1,!(Jo&4194240)&&(Jo=64),e}function Za(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function xo(e,t,n){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Zt(t),e[t]=n}function Wg(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var i=31-Zt(n),o=1<<i;t[i]=0,r[i]=-1,e[i]=-1,n&=~o}}function au(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-Zt(n),i=1<<r;i&t|e[r]&t&&(e[r]|=t),n&=~i}}var Re=0;function ah(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var lh,lu,ch,uh,dh,ic=!1,Qo=[],Hn=null,qn=null,Gn=null,oo=new Map,so=new Map,Vn=[],Hg="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Pd(e,t){switch(e){case"focusin":case"focusout":Hn=null;break;case"dragenter":case"dragleave":qn=null;break;case"mouseover":case"mouseout":Gn=null;break;case"pointerover":case"pointerout":oo.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":so.delete(t.pointerId)}}function Ti(e,t,n,r,i,o){return e===null||e.nativeEvent!==o?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:o,targetContainers:[i]},t!==null&&(t=Po(t),t!==null&&lu(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,i!==null&&t.indexOf(i)===-1&&t.push(i),e)}function qg(e,t,n,r,i){switch(t){case"focusin":return Hn=Ti(Hn,e,t,n,r,i),!0;case"dragenter":return qn=Ti(qn,e,t,n,r,i),!0;case"mouseover":return Gn=Ti(Gn,e,t,n,r,i),!0;case"pointerover":var o=i.pointerId;return oo.set(o,Ti(oo.get(o)||null,e,t,n,r,i)),!0;case"gotpointercapture":return o=i.pointerId,so.set(o,Ti(so.get(o)||null,e,t,n,r,i)),!0}return!1}function fh(e){var t=hr(e.target);if(t!==null){var n=Or(t);if(n!==null){if(t=n.tag,t===13){if(t=eh(n),t!==null){e.blockedOn=t,dh(e.priority,function(){ch(n)});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function vs(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=oc(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(n===null){n=e.nativeEvent;var r=new n.constructor(n.type,n);Zl=r,n.target.dispatchEvent(r),Zl=null}else return t=Po(n),t!==null&&lu(t),e.blockedOn=n,!1;t.shift()}return!0}function Od(e,t,n){vs(e)&&n.delete(t)}function Gg(){ic=!1,Hn!==null&&vs(Hn)&&(Hn=null),qn!==null&&vs(qn)&&(qn=null),Gn!==null&&vs(Gn)&&(Gn=null),oo.forEach(Od),so.forEach(Od)}function Li(e,t){e.blockedOn===t&&(e.blockedOn=null,ic||(ic=!0,Mt.unstable_scheduleCallback(Mt.unstable_NormalPriority,Gg)))}function ao(e){function t(i){return Li(i,e)}if(0<Qo.length){Li(Qo[0],e);for(var n=1;n<Qo.length;n++){var r=Qo[n];r.blockedOn===e&&(r.blockedOn=null)}}for(Hn!==null&&Li(Hn,e),qn!==null&&Li(qn,e),Gn!==null&&Li(Gn,e),oo.forEach(t),so.forEach(t),n=0;n<Vn.length;n++)r=Vn[n],r.blockedOn===e&&(r.blockedOn=null);for(;0<Vn.length&&(n=Vn[0],n.blockedOn===null);)fh(n),n.blockedOn===null&&Vn.shift()}var ei=_n.ReactCurrentBatchConfig,js=!0;function Xg(e,t,n,r){var i=Re,o=ei.transition;ei.transition=null;try{Re=1,cu(e,t,n,r)}finally{Re=i,ei.transition=o}}function Jg(e,t,n,r){var i=Re,o=ei.transition;ei.transition=null;try{Re=4,cu(e,t,n,r)}finally{Re=i,ei.transition=o}}function cu(e,t,n,r){if(js){var i=oc(e,t,n,r);if(i===null)cl(e,t,r,Ds,n),Pd(e,r);else if(qg(i,e,t,n,r))r.stopPropagation();else if(Pd(e,r),t&4&&-1<Hg.indexOf(e)){for(;i!==null;){var o=Po(i);if(o!==null&&lh(o),o=oc(e,t,n,r),o===null&&cl(e,t,r,Ds,n),o===i)break;i=o}i!==null&&r.stopPropagation()}else cl(e,t,r,null,n)}}var Ds=null;function oc(e,t,n,r){if(Ds=null,e=ou(r),e=hr(e),e!==null)if(t=Or(e),t===null)e=null;else if(n=t.tag,n===13){if(e=eh(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Ds=e,null}function ph(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(jg()){case su:return 1;case ih:return 4;case As:case Dg:return 16;case oh:return 536870912;default:return 16}default:return 16}}var $n=null,uu=null,gs=null;function hh(){if(gs)return gs;var e,t=uu,n=t.length,r,i="value"in $n?$n.value:$n.textContent,o=i.length;for(e=0;e<n&&t[e]===i[e];e++);var s=n-e;for(r=1;r<=s&&t[n-r]===i[o-r];r++);return gs=i.slice(e,1<r?1-r:void 0)}function ys(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Yo(){return!0}function Rd(){return!1}function Dt(e){function t(n,r,i,o,s){this._reactName=n,this._targetInst=i,this.type=r,this.nativeEvent=o,this.target=s,this.currentTarget=null;for(var a in e)e.hasOwnProperty(a)&&(n=e[a],this[a]=n?n(o):o[a]);return this.isDefaultPrevented=(o.defaultPrevented!=null?o.defaultPrevented:o.returnValue===!1)?Yo:Rd,this.isPropagationStopped=Rd,this}return Ue(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Yo)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Yo)},persist:function(){},isPersistent:Yo}),t}var fi={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},du=Dt(fi),ko=Ue({},fi,{view:0,detail:0}),Kg=Dt(ko),el,tl,Ai,pa=Ue({},ko,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:fu,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Ai&&(Ai&&e.type==="mousemove"?(el=e.screenX-Ai.screenX,tl=e.screenY-Ai.screenY):tl=el=0,Ai=e),el)},movementY:function(e){return"movementY"in e?e.movementY:tl}}),_d=Dt(pa),Qg=Ue({},pa,{dataTransfer:0}),Yg=Dt(Qg),Zg=Ue({},ko,{relatedTarget:0}),nl=Dt(Zg),ey=Ue({},fi,{animationName:0,elapsedTime:0,pseudoElement:0}),ty=Dt(ey),ny=Ue({},fi,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),ry=Dt(ny),iy=Ue({},fi,{data:0}),Id=Dt(iy),oy={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},sy={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},ay={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function ly(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=ay[e])?!!t[e]:!1}function fu(){return ly}var cy=Ue({},ko,{key:function(e){if(e.key){var t=oy[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=ys(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?sy[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:fu,charCode:function(e){return e.type==="keypress"?ys(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?ys(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),uy=Dt(cy),dy=Ue({},pa,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Nd=Dt(dy),fy=Ue({},ko,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:fu}),py=Dt(fy),hy=Ue({},fi,{propertyName:0,elapsedTime:0,pseudoElement:0}),my=Dt(hy),vy=Ue({},pa,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),gy=Dt(vy),yy=[9,13,27,32],pu=xn&&"CompositionEvent"in window,Ji=null;xn&&"documentMode"in document&&(Ji=document.documentMode);var Sy=xn&&"TextEvent"in window&&!Ji,mh=xn&&(!pu||Ji&&8<Ji&&11>=Ji),Td=String.fromCharCode(32),Ld=!1;function vh(e,t){switch(e){case"keyup":return yy.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function gh(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Ur=!1;function wy(e,t){switch(e){case"compositionend":return gh(t);case"keypress":return t.which!==32?null:(Ld=!0,Td);case"textInput":return e=t.data,e===Td&&Ld?null:e;default:return null}}function Ey(e,t){if(Ur)return e==="compositionend"||!pu&&vh(e,t)?(e=hh(),gs=uu=$n=null,Ur=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return mh&&t.locale!=="ko"?null:t.data;default:return null}}var by={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Ad(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!by[e.type]:t==="textarea"}function yh(e,t,n,r){Jp(r),t=Vs(t,"onChange"),0<t.length&&(n=new du("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var Ki=null,lo=null;function Cy(e){_h(e,0)}function ha(e){var t=zr(e);if(Bp(t))return e}function xy(e,t){if(e==="change")return t}var Sh=!1;if(xn){var rl;if(xn){var il="oninput"in document;if(!il){var Md=document.createElement("div");Md.setAttribute("oninput","return;"),il=typeof Md.oninput=="function"}rl=il}else rl=!1;Sh=rl&&(!document.documentMode||9<document.documentMode)}function jd(){Ki&&(Ki.detachEvent("onpropertychange",wh),lo=Ki=null)}function wh(e){if(e.propertyName==="value"&&ha(lo)){var t=[];yh(t,lo,e,ou(e)),Zp(Cy,t)}}function ky(e,t,n){e==="focusin"?(jd(),Ki=t,lo=n,Ki.attachEvent("onpropertychange",wh)):e==="focusout"&&jd()}function Py(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return ha(lo)}function Oy(e,t){if(e==="click")return ha(t)}function Ry(e,t){if(e==="input"||e==="change")return ha(t)}function _y(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var nn=typeof Object.is=="function"?Object.is:_y;function co(e,t){if(nn(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!$l.call(t,i)||!nn(e[i],t[i]))return!1}return!0}function Dd(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Vd(e,t){var n=Dd(e);e=0;for(var r;n;){if(n.nodeType===3){if(r=e+n.textContent.length,e<=t&&r>=t)return{node:n,offset:t-e};e=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=Dd(n)}}function Eh(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?Eh(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function bh(){for(var e=window,t=Ns();t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)e=t.contentWindow;else break;t=Ns(e.document)}return t}function hu(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function Iy(e){var t=bh(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&Eh(n.ownerDocument.documentElement,n)){if(r!==null&&hu(n)){if(t=r.start,e=r.end,e===void 0&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if(e=(t=n.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var i=n.textContent.length,o=Math.min(r.start,i);r=r.end===void 0?o:Math.min(r.end,i),!e.extend&&o>r&&(i=r,r=o,o=i),i=Vd(n,o);var s=Vd(n,r);i&&s&&(e.rangeCount!==1||e.anchorNode!==i.node||e.anchorOffset!==i.offset||e.focusNode!==s.node||e.focusOffset!==s.offset)&&(t=t.createRange(),t.setStart(i.node,i.offset),e.removeAllRanges(),o>r?(e.addRange(t),e.extend(s.node,s.offset)):(t.setEnd(s.node,s.offset),e.addRange(t)))}}for(t=[],e=n;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<t.length;n++)e=t[n],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var Ny=xn&&"documentMode"in document&&11>=document.documentMode,$r=null,sc=null,Qi=null,ac=!1;function Fd(e,t,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;ac||$r==null||$r!==Ns(r)||(r=$r,"selectionStart"in r&&hu(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Qi&&co(Qi,r)||(Qi=r,r=Vs(sc,"onSelect"),0<r.length&&(t=new du("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=$r)))}function Zo(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var Br={animationend:Zo("Animation","AnimationEnd"),animationiteration:Zo("Animation","AnimationIteration"),animationstart:Zo("Animation","AnimationStart"),transitionend:Zo("Transition","TransitionEnd")},ol={},Ch={};xn&&(Ch=document.createElement("div").style,"AnimationEvent"in window||(delete Br.animationend.animation,delete Br.animationiteration.animation,delete Br.animationstart.animation),"TransitionEvent"in window||delete Br.transitionend.transition);function ma(e){if(ol[e])return ol[e];if(!Br[e])return e;var t=Br[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in Ch)return ol[e]=t[n];return e}var xh=ma("animationend"),kh=ma("animationiteration"),Ph=ma("animationstart"),Oh=ma("transitionend"),Rh=new Map,Ud="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ir(e,t){Rh.set(e,t),Pr(t,[e])}for(var sl=0;sl<Ud.length;sl++){var al=Ud[sl],Ty=al.toLowerCase(),Ly=al[0].toUpperCase()+al.slice(1);ir(Ty,"on"+Ly)}ir(xh,"onAnimationEnd");ir(kh,"onAnimationIteration");ir(Ph,"onAnimationStart");ir("dblclick","onDoubleClick");ir("focusin","onFocus");ir("focusout","onBlur");ir(Oh,"onTransitionEnd");ii("onMouseEnter",["mouseout","mouseover"]);ii("onMouseLeave",["mouseout","mouseover"]);ii("onPointerEnter",["pointerout","pointerover"]);ii("onPointerLeave",["pointerout","pointerover"]);Pr("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Pr("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Pr("onBeforeInput",["compositionend","keypress","textInput","paste"]);Pr("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Pr("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Pr("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var qi="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Ay=new Set("cancel close invalid load scroll toggle".split(" ").concat(qi));function $d(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,Tg(r,t,void 0,e),e.currentTarget=null}function _h(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var r=e[n],i=r.event;r=r.listeners;e:{var o=void 0;if(t)for(var s=r.length-1;0<=s;s--){var a=r[s],c=a.instance,l=a.currentTarget;if(a=a.listener,c!==o&&i.isPropagationStopped())break e;$d(i,a,l),o=c}else for(s=0;s<r.length;s++){if(a=r[s],c=a.instance,l=a.currentTarget,a=a.listener,c!==o&&i.isPropagationStopped())break e;$d(i,a,l),o=c}}}if(Ls)throw e=nc,Ls=!1,nc=null,e}function Me(e,t){var n=t[fc];n===void 0&&(n=t[fc]=new Set);var r=e+"__bubble";n.has(r)||(Ih(t,e,2,!1),n.add(r))}function ll(e,t,n){var r=0;t&&(r|=4),Ih(n,e,r,t)}var es="_reactListening"+Math.random().toString(36).slice(2);function uo(e){if(!e[es]){e[es]=!0,Dp.forEach(function(n){n!=="selectionchange"&&(Ay.has(n)||ll(n,!1,e),ll(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[es]||(t[es]=!0,ll("selectionchange",!1,t))}}function Ih(e,t,n,r){switch(ph(t)){case 1:var i=Xg;break;case 4:i=Jg;break;default:i=cu}n=i.bind(null,t,n,e),i=void 0,!tc||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(i=!0),r?i!==void 0?e.addEventListener(t,n,{capture:!0,passive:i}):e.addEventListener(t,n,!0):i!==void 0?e.addEventListener(t,n,{passive:i}):e.addEventListener(t,n,!1)}function cl(e,t,n,r,i){var o=r;if(!(t&1)&&!(t&2)&&r!==null)e:for(;;){if(r===null)return;var s=r.tag;if(s===3||s===4){var a=r.stateNode.containerInfo;if(a===i||a.nodeType===8&&a.parentNode===i)break;if(s===4)for(s=r.return;s!==null;){var c=s.tag;if((c===3||c===4)&&(c=s.stateNode.containerInfo,c===i||c.nodeType===8&&c.parentNode===i))return;s=s.return}for(;a!==null;){if(s=hr(a),s===null)return;if(c=s.tag,c===5||c===6){r=o=s;continue e}a=a.parentNode}}r=r.return}Zp(function(){var l=o,u=ou(n),d=[];e:{var m=Rh.get(e);if(m!==void 0){var g=du,b=e;switch(e){case"keypress":if(ys(n)===0)break e;case"keydown":case"keyup":g=uy;break;case"focusin":b="focus",g=nl;break;case"focusout":b="blur",g=nl;break;case"beforeblur":case"afterblur":g=nl;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":g=_d;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":g=Yg;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":g=py;break;case xh:case kh:case Ph:g=ty;break;case Oh:g=my;break;case"scroll":g=Kg;break;case"wheel":g=gy;break;case"copy":case"cut":case"paste":g=ry;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":g=Nd}var P=(t&4)!==0,k=!P&&e==="scroll",f=P?m!==null?m+"Capture":null:m;P=[];for(var v=l,w;v!==null;){w=v;var y=w.stateNode;if(w.tag===5&&y!==null&&(w=y,f!==null&&(y=io(v,f),y!=null&&P.push(fo(v,y,w)))),k)break;v=v.return}0<P.length&&(m=new g(m,b,null,n,u),d.push({event:m,listeners:P}))}}if(!(t&7)){e:{if(m=e==="mouseover"||e==="pointerover",g=e==="mouseout"||e==="pointerout",m&&n!==Zl&&(b=n.relatedTarget||n.fromElement)&&(hr(b)||b[kn]))break e;if((g||m)&&(m=u.window===u?u:(m=u.ownerDocument)?m.defaultView||m.parentWindow:window,g?(b=n.relatedTarget||n.toElement,g=l,b=b?hr(b):null,b!==null&&(k=Or(b),b!==k||b.tag!==5&&b.tag!==6)&&(b=null)):(g=null,b=l),g!==b)){if(P=_d,y="onMouseLeave",f="onMouseEnter",v="mouse",(e==="pointerout"||e==="pointerover")&&(P=Nd,y="onPointerLeave",f="onPointerEnter",v="pointer"),k=g==null?m:zr(g),w=b==null?m:zr(b),m=new P(y,v+"leave",g,n,u),m.target=k,m.relatedTarget=w,y=null,hr(u)===l&&(P=new P(f,v+"enter",b,n,u),P.target=w,P.relatedTarget=k,y=P),k=y,g&&b)t:{for(P=g,f=b,v=0,w=P;w;w=Nr(w))v++;for(w=0,y=f;y;y=Nr(y))w++;for(;0<v-w;)P=Nr(P),v--;for(;0<w-v;)f=Nr(f),w--;for(;v--;){if(P===f||f!==null&&P===f.alternate)break t;P=Nr(P),f=Nr(f)}P=null}else P=null;g!==null&&Bd(d,m,g,P,!1),b!==null&&k!==null&&Bd(d,k,b,P,!0)}}e:{if(m=l?zr(l):window,g=m.nodeName&&m.nodeName.toLowerCase(),g==="select"||g==="input"&&m.type==="file")var T=xy;else if(Ad(m))if(Sh)T=Ry;else{T=Py;var M=ky}else(g=m.nodeName)&&g.toLowerCase()==="input"&&(m.type==="checkbox"||m.type==="radio")&&(T=Oy);if(T&&(T=T(e,l))){yh(d,T,n,u);break e}M&&M(e,m,l),e==="focusout"&&(M=m._wrapperState)&&M.controlled&&m.type==="number"&&Xl(m,"number",m.value)}switch(M=l?zr(l):window,e){case"focusin":(Ad(M)||M.contentEditable==="true")&&($r=M,sc=l,Qi=null);break;case"focusout":Qi=sc=$r=null;break;case"mousedown":ac=!0;break;case"contextmenu":case"mouseup":case"dragend":ac=!1,Fd(d,n,u);break;case"selectionchange":if(Ny)break;case"keydown":case"keyup":Fd(d,n,u)}var U;if(pu)e:{switch(e){case"compositionstart":var S="onCompositionStart";break e;case"compositionend":S="onCompositionEnd";break e;case"compositionupdate":S="onCompositionUpdate";break e}S=void 0}else Ur?vh(e,n)&&(S="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(S="onCompositionStart");S&&(mh&&n.locale!=="ko"&&(Ur||S!=="onCompositionStart"?S==="onCompositionEnd"&&Ur&&(U=hh()):($n=u,uu="value"in $n?$n.value:$n.textContent,Ur=!0)),M=Vs(l,S),0<M.length&&(S=new Id(S,e,null,n,u),d.push({event:S,listeners:M}),U?S.data=U:(U=gh(n),U!==null&&(S.data=U)))),(U=Sy?wy(e,n):Ey(e,n))&&(l=Vs(l,"onBeforeInput"),0<l.length&&(u=new Id("onBeforeInput","beforeinput",null,n,u),d.push({event:u,listeners:l}),u.data=U))}_h(d,t)})}function fo(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Vs(e,t){for(var n=t+"Capture",r=[];e!==null;){var i=e,o=i.stateNode;i.tag===5&&o!==null&&(i=o,o=io(e,n),o!=null&&r.unshift(fo(e,o,i)),o=io(e,t),o!=null&&r.push(fo(e,o,i))),e=e.return}return r}function Nr(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function Bd(e,t,n,r,i){for(var o=t._reactName,s=[];n!==null&&n!==r;){var a=n,c=a.alternate,l=a.stateNode;if(c!==null&&c===r)break;a.tag===5&&l!==null&&(a=l,i?(c=io(n,o),c!=null&&s.unshift(fo(n,c,a))):i||(c=io(n,o),c!=null&&s.push(fo(n,c,a)))),n=n.return}s.length!==0&&e.push({event:t,listeners:s})}var My=/\r\n?/g,jy=/\u0000|\uFFFD/g;function zd(e){return(typeof e=="string"?e:""+e).replace(My,`
`).replace(jy,"")}function ts(e,t,n){if(t=zd(t),zd(e)!==t&&n)throw Error(te(425))}function Fs(){}var lc=null,cc=null;function uc(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var dc=typeof setTimeout=="function"?setTimeout:void 0,Dy=typeof clearTimeout=="function"?clearTimeout:void 0,Wd=typeof Promise=="function"?Promise:void 0,Vy=typeof queueMicrotask=="function"?queueMicrotask:typeof Wd<"u"?function(e){return Wd.resolve(null).then(e).catch(Fy)}:dc;function Fy(e){setTimeout(function(){throw e})}function ul(e,t){var n=t,r=0;do{var i=n.nextSibling;if(e.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(r===0){e.removeChild(i),ao(t);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=i}while(n);ao(t)}function Xn(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function Hd(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"){if(t===0)return e;t--}else n==="/$"&&t++}e=e.previousSibling}return null}var pi=Math.random().toString(36).slice(2),fn="__reactFiber$"+pi,po="__reactProps$"+pi,kn="__reactContainer$"+pi,fc="__reactEvents$"+pi,Uy="__reactListeners$"+pi,$y="__reactHandles$"+pi;function hr(e){var t=e[fn];if(t)return t;for(var n=e.parentNode;n;){if(t=n[kn]||n[fn]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=Hd(e);e!==null;){if(n=e[fn])return n;e=Hd(e)}return t}e=n,n=e.parentNode}return null}function Po(e){return e=e[fn]||e[kn],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function zr(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(te(33))}function va(e){return e[po]||null}var pc=[],Wr=-1;function or(e){return{current:e}}function je(e){0>Wr||(e.current=pc[Wr],pc[Wr]=null,Wr--)}function Le(e,t){Wr++,pc[Wr]=e.current,e.current=t}var rr={},gt=or(rr),Ot=or(!1),wr=rr;function oi(e,t){var n=e.type.contextTypes;if(!n)return rr;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var i={},o;for(o in n)i[o]=t[o];return r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=i),i}function Rt(e){return e=e.childContextTypes,e!=null}function Us(){je(Ot),je(gt)}function qd(e,t,n){if(gt.current!==rr)throw Error(te(168));Le(gt,t),Le(Ot,n)}function Nh(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var i in r)if(!(i in t))throw Error(te(108,kg(e)||"Unknown",i));return Ue({},n,r)}function $s(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||rr,wr=gt.current,Le(gt,e),Le(Ot,Ot.current),!0}function Gd(e,t,n){var r=e.stateNode;if(!r)throw Error(te(169));n?(e=Nh(e,t,wr),r.__reactInternalMemoizedMergedChildContext=e,je(Ot),je(gt),Le(gt,e)):je(Ot),Le(Ot,n)}var wn=null,ga=!1,dl=!1;function Th(e){wn===null?wn=[e]:wn.push(e)}function By(e){ga=!0,Th(e)}function sr(){if(!dl&&wn!==null){dl=!0;var e=0,t=Re;try{var n=wn;for(Re=1;e<n.length;e++){var r=n[e];do r=r(!0);while(r!==null)}wn=null,ga=!1}catch(i){throw wn!==null&&(wn=wn.slice(e+1)),rh(su,sr),i}finally{Re=t,dl=!1}}return null}var Hr=[],qr=0,Bs=null,zs=0,Ft=[],Ut=0,Er=null,En=1,bn="";function fr(e,t){Hr[qr++]=zs,Hr[qr++]=Bs,Bs=e,zs=t}function Lh(e,t,n){Ft[Ut++]=En,Ft[Ut++]=bn,Ft[Ut++]=Er,Er=e;var r=En;e=bn;var i=32-Zt(r)-1;r&=~(1<<i),n+=1;var o=32-Zt(t)+i;if(30<o){var s=i-i%5;o=(r&(1<<s)-1).toString(32),r>>=s,i-=s,En=1<<32-Zt(t)+i|n<<i|r,bn=o+e}else En=1<<o|n<<i|r,bn=e}function mu(e){e.return!==null&&(fr(e,1),Lh(e,1,0))}function vu(e){for(;e===Bs;)Bs=Hr[--qr],Hr[qr]=null,zs=Hr[--qr],Hr[qr]=null;for(;e===Er;)Er=Ft[--Ut],Ft[Ut]=null,bn=Ft[--Ut],Ft[Ut]=null,En=Ft[--Ut],Ft[Ut]=null}var At=null,Lt=null,De=!1,Yt=null;function Ah(e,t){var n=$t(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)}function Xd(e,t){switch(e.tag){case 5:var n=e.type;return t=t.nodeType!==1||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,At=e,Lt=Xn(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,At=e,Lt=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(n=Er!==null?{id:En,overflow:bn}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},n=$t(18,null,null,0),n.stateNode=t,n.return=e,e.child=n,At=e,Lt=null,!0):!1;default:return!1}}function hc(e){return(e.mode&1)!==0&&(e.flags&128)===0}function mc(e){if(De){var t=Lt;if(t){var n=t;if(!Xd(e,t)){if(hc(e))throw Error(te(418));t=Xn(n.nextSibling);var r=At;t&&Xd(e,t)?Ah(r,n):(e.flags=e.flags&-4097|2,De=!1,At=e)}}else{if(hc(e))throw Error(te(418));e.flags=e.flags&-4097|2,De=!1,At=e}}}function Jd(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;At=e}function ns(e){if(e!==At)return!1;if(!De)return Jd(e),De=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!uc(e.type,e.memoizedProps)),t&&(t=Lt)){if(hc(e))throw Mh(),Error(te(418));for(;t;)Ah(e,t),t=Xn(t.nextSibling)}if(Jd(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(te(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="/$"){if(t===0){Lt=Xn(e.nextSibling);break e}t--}else n!=="$"&&n!=="$!"&&n!=="$?"||t++}e=e.nextSibling}Lt=null}}else Lt=At?Xn(e.stateNode.nextSibling):null;return!0}function Mh(){for(var e=Lt;e;)e=Xn(e.nextSibling)}function si(){Lt=At=null,De=!1}function gu(e){Yt===null?Yt=[e]:Yt.push(e)}var zy=_n.ReactCurrentBatchConfig;function Mi(e,t,n){if(e=n.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(te(309));var r=n.stateNode}if(!r)throw Error(te(147,e));var i=r,o=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===o?t.ref:(t=function(s){var a=i.refs;s===null?delete a[o]:a[o]=s},t._stringRef=o,t)}if(typeof e!="string")throw Error(te(284));if(!n._owner)throw Error(te(290,e))}return e}function rs(e,t){throw e=Object.prototype.toString.call(t),Error(te(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Kd(e){var t=e._init;return t(e._payload)}function jh(e){function t(f,v){if(e){var w=f.deletions;w===null?(f.deletions=[v],f.flags|=16):w.push(v)}}function n(f,v){if(!e)return null;for(;v!==null;)t(f,v),v=v.sibling;return null}function r(f,v){for(f=new Map;v!==null;)v.key!==null?f.set(v.key,v):f.set(v.index,v),v=v.sibling;return f}function i(f,v){return f=Yn(f,v),f.index=0,f.sibling=null,f}function o(f,v,w){return f.index=w,e?(w=f.alternate,w!==null?(w=w.index,w<v?(f.flags|=2,v):w):(f.flags|=2,v)):(f.flags|=1048576,v)}function s(f){return e&&f.alternate===null&&(f.flags|=2),f}function a(f,v,w,y){return v===null||v.tag!==6?(v=yl(w,f.mode,y),v.return=f,v):(v=i(v,w),v.return=f,v)}function c(f,v,w,y){var T=w.type;return T===Fr?u(f,v,w.props.children,y,w.key):v!==null&&(v.elementType===T||typeof T=="object"&&T!==null&&T.$$typeof===jn&&Kd(T)===v.type)?(y=i(v,w.props),y.ref=Mi(f,v,w),y.return=f,y):(y=ks(w.type,w.key,w.props,null,f.mode,y),y.ref=Mi(f,v,w),y.return=f,y)}function l(f,v,w,y){return v===null||v.tag!==4||v.stateNode.containerInfo!==w.containerInfo||v.stateNode.implementation!==w.implementation?(v=Sl(w,f.mode,y),v.return=f,v):(v=i(v,w.children||[]),v.return=f,v)}function u(f,v,w,y,T){return v===null||v.tag!==7?(v=Sr(w,f.mode,y,T),v.return=f,v):(v=i(v,w),v.return=f,v)}function d(f,v,w){if(typeof v=="string"&&v!==""||typeof v=="number")return v=yl(""+v,f.mode,w),v.return=f,v;if(typeof v=="object"&&v!==null){switch(v.$$typeof){case qo:return w=ks(v.type,v.key,v.props,null,f.mode,w),w.ref=Mi(f,null,v),w.return=f,w;case Vr:return v=Sl(v,f.mode,w),v.return=f,v;case jn:var y=v._init;return d(f,y(v._payload),w)}if(Wi(v)||Ii(v))return v=Sr(v,f.mode,w,null),v.return=f,v;rs(f,v)}return null}function m(f,v,w,y){var T=v!==null?v.key:null;if(typeof w=="string"&&w!==""||typeof w=="number")return T!==null?null:a(f,v,""+w,y);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case qo:return w.key===T?c(f,v,w,y):null;case Vr:return w.key===T?l(f,v,w,y):null;case jn:return T=w._init,m(f,v,T(w._payload),y)}if(Wi(w)||Ii(w))return T!==null?null:u(f,v,w,y,null);rs(f,w)}return null}function g(f,v,w,y,T){if(typeof y=="string"&&y!==""||typeof y=="number")return f=f.get(w)||null,a(v,f,""+y,T);if(typeof y=="object"&&y!==null){switch(y.$$typeof){case qo:return f=f.get(y.key===null?w:y.key)||null,c(v,f,y,T);case Vr:return f=f.get(y.key===null?w:y.key)||null,l(v,f,y,T);case jn:var M=y._init;return g(f,v,w,M(y._payload),T)}if(Wi(y)||Ii(y))return f=f.get(w)||null,u(v,f,y,T,null);rs(v,y)}return null}function b(f,v,w,y){for(var T=null,M=null,U=v,S=v=0,p=null;U!==null&&S<w.length;S++){U.index>S?(p=U,U=null):p=U.sibling;var E=m(f,U,w[S],y);if(E===null){U===null&&(U=p);break}e&&U&&E.alternate===null&&t(f,U),v=o(E,v,S),M===null?T=E:M.sibling=E,M=E,U=p}if(S===w.length)return n(f,U),De&&fr(f,S),T;if(U===null){for(;S<w.length;S++)U=d(f,w[S],y),U!==null&&(v=o(U,v,S),M===null?T=U:M.sibling=U,M=U);return De&&fr(f,S),T}for(U=r(f,U);S<w.length;S++)p=g(U,f,S,w[S],y),p!==null&&(e&&p.alternate!==null&&U.delete(p.key===null?S:p.key),v=o(p,v,S),M===null?T=p:M.sibling=p,M=p);return e&&U.forEach(function(I){return t(f,I)}),De&&fr(f,S),T}function P(f,v,w,y){var T=Ii(w);if(typeof T!="function")throw Error(te(150));if(w=T.call(w),w==null)throw Error(te(151));for(var M=T=null,U=v,S=v=0,p=null,E=w.next();U!==null&&!E.done;S++,E=w.next()){U.index>S?(p=U,U=null):p=U.sibling;var I=m(f,U,E.value,y);if(I===null){U===null&&(U=p);break}e&&U&&I.alternate===null&&t(f,U),v=o(I,v,S),M===null?T=I:M.sibling=I,M=I,U=p}if(E.done)return n(f,U),De&&fr(f,S),T;if(U===null){for(;!E.done;S++,E=w.next())E=d(f,E.value,y),E!==null&&(v=o(E,v,S),M===null?T=E:M.sibling=E,M=E);return De&&fr(f,S),T}for(U=r(f,U);!E.done;S++,E=w.next())E=g(U,f,S,E.value,y),E!==null&&(e&&E.alternate!==null&&U.delete(E.key===null?S:E.key),v=o(E,v,S),M===null?T=E:M.sibling=E,M=E);return e&&U.forEach(function(x){return t(f,x)}),De&&fr(f,S),T}function k(f,v,w,y){if(typeof w=="object"&&w!==null&&w.type===Fr&&w.key===null&&(w=w.props.children),typeof w=="object"&&w!==null){switch(w.$$typeof){case qo:e:{for(var T=w.key,M=v;M!==null;){if(M.key===T){if(T=w.type,T===Fr){if(M.tag===7){n(f,M.sibling),v=i(M,w.props.children),v.return=f,f=v;break e}}else if(M.elementType===T||typeof T=="object"&&T!==null&&T.$$typeof===jn&&Kd(T)===M.type){n(f,M.sibling),v=i(M,w.props),v.ref=Mi(f,M,w),v.return=f,f=v;break e}n(f,M);break}else t(f,M);M=M.sibling}w.type===Fr?(v=Sr(w.props.children,f.mode,y,w.key),v.return=f,f=v):(y=ks(w.type,w.key,w.props,null,f.mode,y),y.ref=Mi(f,v,w),y.return=f,f=y)}return s(f);case Vr:e:{for(M=w.key;v!==null;){if(v.key===M)if(v.tag===4&&v.stateNode.containerInfo===w.containerInfo&&v.stateNode.implementation===w.implementation){n(f,v.sibling),v=i(v,w.children||[]),v.return=f,f=v;break e}else{n(f,v);break}else t(f,v);v=v.sibling}v=Sl(w,f.mode,y),v.return=f,f=v}return s(f);case jn:return M=w._init,k(f,v,M(w._payload),y)}if(Wi(w))return b(f,v,w,y);if(Ii(w))return P(f,v,w,y);rs(f,w)}return typeof w=="string"&&w!==""||typeof w=="number"?(w=""+w,v!==null&&v.tag===6?(n(f,v.sibling),v=i(v,w),v.return=f,f=v):(n(f,v),v=yl(w,f.mode,y),v.return=f,f=v),s(f)):n(f,v)}return k}var ai=jh(!0),Dh=jh(!1),Ws=or(null),Hs=null,Gr=null,yu=null;function Su(){yu=Gr=Hs=null}function wu(e){var t=Ws.current;je(Ws),e._currentValue=t}function vc(e,t,n){for(;e!==null;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,r!==null&&(r.childLanes|=t)):r!==null&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function ti(e,t){Hs=e,yu=Gr=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(Pt=!0),e.firstContext=null)}function zt(e){var t=e._currentValue;if(yu!==e)if(e={context:e,memoizedValue:t,next:null},Gr===null){if(Hs===null)throw Error(te(308));Gr=e,Hs.dependencies={lanes:0,firstContext:e}}else Gr=Gr.next=e;return t}var mr=null;function Eu(e){mr===null?mr=[e]:mr.push(e)}function Vh(e,t,n,r){var i=t.interleaved;return i===null?(n.next=n,Eu(t)):(n.next=i.next,i.next=n),t.interleaved=n,Pn(e,r)}function Pn(e,t){e.lanes|=t;var n=e.alternate;for(n!==null&&(n.lanes|=t),n=e,e=e.return;e!==null;)e.childLanes|=t,n=e.alternate,n!==null&&(n.childLanes|=t),n=e,e=e.return;return n.tag===3?n.stateNode:null}var Dn=!1;function bu(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Fh(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Cn(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Jn(e,t,n){var r=e.updateQueue;if(r===null)return null;if(r=r.shared,ke&2){var i=r.pending;return i===null?t.next=t:(t.next=i.next,i.next=t),r.pending=t,Pn(e,n)}return i=r.interleaved,i===null?(t.next=t,Eu(r)):(t.next=i.next,i.next=t),r.interleaved=t,Pn(e,n)}function Ss(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194240)!==0)){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,au(e,n)}}function Qd(e,t){var n=e.updateQueue,r=e.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var i=null,o=null;if(n=n.firstBaseUpdate,n!==null){do{var s={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};o===null?i=o=s:o=o.next=s,n=n.next}while(n!==null);o===null?i=o=t:o=o.next=t}else i=o=t;n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:o,shared:r.shared,effects:r.effects},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function qs(e,t,n,r){var i=e.updateQueue;Dn=!1;var o=i.firstBaseUpdate,s=i.lastBaseUpdate,a=i.shared.pending;if(a!==null){i.shared.pending=null;var c=a,l=c.next;c.next=null,s===null?o=l:s.next=l,s=c;var u=e.alternate;u!==null&&(u=u.updateQueue,a=u.lastBaseUpdate,a!==s&&(a===null?u.firstBaseUpdate=l:a.next=l,u.lastBaseUpdate=c))}if(o!==null){var d=i.baseState;s=0,u=l=c=null,a=o;do{var m=a.lane,g=a.eventTime;if((r&m)===m){u!==null&&(u=u.next={eventTime:g,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var b=e,P=a;switch(m=t,g=n,P.tag){case 1:if(b=P.payload,typeof b=="function"){d=b.call(g,d,m);break e}d=b;break e;case 3:b.flags=b.flags&-65537|128;case 0:if(b=P.payload,m=typeof b=="function"?b.call(g,d,m):b,m==null)break e;d=Ue({},d,m);break e;case 2:Dn=!0}}a.callback!==null&&a.lane!==0&&(e.flags|=64,m=i.effects,m===null?i.effects=[a]:m.push(a))}else g={eventTime:g,lane:m,tag:a.tag,payload:a.payload,callback:a.callback,next:null},u===null?(l=u=g,c=d):u=u.next=g,s|=m;if(a=a.next,a===null){if(a=i.shared.pending,a===null)break;m=a,a=m.next,m.next=null,i.lastBaseUpdate=m,i.shared.pending=null}}while(1);if(u===null&&(c=d),i.baseState=c,i.firstBaseUpdate=l,i.lastBaseUpdate=u,t=i.shared.interleaved,t!==null){i=t;do s|=i.lane,i=i.next;while(i!==t)}else o===null&&(i.shared.lanes=0);Cr|=s,e.lanes=s,e.memoizedState=d}}function Yd(e,t,n){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var r=e[t],i=r.callback;if(i!==null){if(r.callback=null,r=n,typeof i!="function")throw Error(te(191,i));i.call(r)}}}var Oo={},mn=or(Oo),ho=or(Oo),mo=or(Oo);function vr(e){if(e===Oo)throw Error(te(174));return e}function Cu(e,t){switch(Le(mo,t),Le(ho,e),Le(mn,Oo),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:Kl(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=Kl(t,e)}je(mn),Le(mn,t)}function li(){je(mn),je(ho),je(mo)}function Uh(e){vr(mo.current);var t=vr(mn.current),n=Kl(t,e.type);t!==n&&(Le(ho,e),Le(mn,n))}function xu(e){ho.current===e&&(je(mn),je(ho))}var Ve=or(0);function Gs(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var fl=[];function ku(){for(var e=0;e<fl.length;e++)fl[e]._workInProgressVersionPrimary=null;fl.length=0}var ws=_n.ReactCurrentDispatcher,pl=_n.ReactCurrentBatchConfig,br=0,Fe=null,Xe=null,Ze=null,Xs=!1,Yi=!1,vo=0,Wy=0;function ct(){throw Error(te(321))}function Pu(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!nn(e[n],t[n]))return!1;return!0}function Ou(e,t,n,r,i,o){if(br=o,Fe=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,ws.current=e===null||e.memoizedState===null?Xy:Jy,e=n(r,i),Yi){o=0;do{if(Yi=!1,vo=0,25<=o)throw Error(te(301));o+=1,Ze=Xe=null,t.updateQueue=null,ws.current=Ky,e=n(r,i)}while(Yi)}if(ws.current=Js,t=Xe!==null&&Xe.next!==null,br=0,Ze=Xe=Fe=null,Xs=!1,t)throw Error(te(300));return e}function Ru(){var e=vo!==0;return vo=0,e}function dn(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ze===null?Fe.memoizedState=Ze=e:Ze=Ze.next=e,Ze}function Wt(){if(Xe===null){var e=Fe.alternate;e=e!==null?e.memoizedState:null}else e=Xe.next;var t=Ze===null?Fe.memoizedState:Ze.next;if(t!==null)Ze=t,Xe=e;else{if(e===null)throw Error(te(310));Xe=e,e={memoizedState:Xe.memoizedState,baseState:Xe.baseState,baseQueue:Xe.baseQueue,queue:Xe.queue,next:null},Ze===null?Fe.memoizedState=Ze=e:Ze=Ze.next=e}return Ze}function go(e,t){return typeof t=="function"?t(e):t}function hl(e){var t=Wt(),n=t.queue;if(n===null)throw Error(te(311));n.lastRenderedReducer=e;var r=Xe,i=r.baseQueue,o=n.pending;if(o!==null){if(i!==null){var s=i.next;i.next=o.next,o.next=s}r.baseQueue=i=o,n.pending=null}if(i!==null){o=i.next,r=r.baseState;var a=s=null,c=null,l=o;do{var u=l.lane;if((br&u)===u)c!==null&&(c=c.next={lane:0,action:l.action,hasEagerState:l.hasEagerState,eagerState:l.eagerState,next:null}),r=l.hasEagerState?l.eagerState:e(r,l.action);else{var d={lane:u,action:l.action,hasEagerState:l.hasEagerState,eagerState:l.eagerState,next:null};c===null?(a=c=d,s=r):c=c.next=d,Fe.lanes|=u,Cr|=u}l=l.next}while(l!==null&&l!==o);c===null?s=r:c.next=a,nn(r,t.memoizedState)||(Pt=!0),t.memoizedState=r,t.baseState=s,t.baseQueue=c,n.lastRenderedState=r}if(e=n.interleaved,e!==null){i=e;do o=i.lane,Fe.lanes|=o,Cr|=o,i=i.next;while(i!==e)}else i===null&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function ml(e){var t=Wt(),n=t.queue;if(n===null)throw Error(te(311));n.lastRenderedReducer=e;var r=n.dispatch,i=n.pending,o=t.memoizedState;if(i!==null){n.pending=null;var s=i=i.next;do o=e(o,s.action),s=s.next;while(s!==i);nn(o,t.memoizedState)||(Pt=!0),t.memoizedState=o,t.baseQueue===null&&(t.baseState=o),n.lastRenderedState=o}return[o,r]}function $h(){}function Bh(e,t){var n=Fe,r=Wt(),i=t(),o=!nn(r.memoizedState,i);if(o&&(r.memoizedState=i,Pt=!0),r=r.queue,_u(Hh.bind(null,n,r,e),[e]),r.getSnapshot!==t||o||Ze!==null&&Ze.memoizedState.tag&1){if(n.flags|=2048,yo(9,Wh.bind(null,n,r,i,t),void 0,null),et===null)throw Error(te(349));br&30||zh(n,t,i)}return i}function zh(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=Fe.updateQueue,t===null?(t={lastEffect:null,stores:null},Fe.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function Wh(e,t,n,r){t.value=n,t.getSnapshot=r,qh(t)&&Gh(e)}function Hh(e,t,n){return n(function(){qh(t)&&Gh(e)})}function qh(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!nn(e,n)}catch{return!0}}function Gh(e){var t=Pn(e,1);t!==null&&en(t,e,1,-1)}function Zd(e){var t=dn();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:go,lastRenderedState:e},t.queue=e,e=e.dispatch=Gy.bind(null,Fe,e),[t.memoizedState,e]}function yo(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},t=Fe.updateQueue,t===null?(t={lastEffect:null,stores:null},Fe.updateQueue=t,t.lastEffect=e.next=e):(n=t.lastEffect,n===null?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e)),e}function Xh(){return Wt().memoizedState}function Es(e,t,n,r){var i=dn();Fe.flags|=e,i.memoizedState=yo(1|t,n,void 0,r===void 0?null:r)}function ya(e,t,n,r){var i=Wt();r=r===void 0?null:r;var o=void 0;if(Xe!==null){var s=Xe.memoizedState;if(o=s.destroy,r!==null&&Pu(r,s.deps)){i.memoizedState=yo(t,n,o,r);return}}Fe.flags|=e,i.memoizedState=yo(1|t,n,o,r)}function ef(e,t){return Es(8390656,8,e,t)}function _u(e,t){return ya(2048,8,e,t)}function Jh(e,t){return ya(4,2,e,t)}function Kh(e,t){return ya(4,4,e,t)}function Qh(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function Yh(e,t,n){return n=n!=null?n.concat([e]):null,ya(4,4,Qh.bind(null,t,e),n)}function Iu(){}function Zh(e,t){var n=Wt();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&Pu(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function em(e,t){var n=Wt();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&Pu(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function tm(e,t,n){return br&21?(nn(n,t)||(n=sh(),Fe.lanes|=n,Cr|=n,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,Pt=!0),e.memoizedState=n)}function Hy(e,t){var n=Re;Re=n!==0&&4>n?n:4,e(!0);var r=pl.transition;pl.transition={};try{e(!1),t()}finally{Re=n,pl.transition=r}}function nm(){return Wt().memoizedState}function qy(e,t,n){var r=Qn(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},rm(e))im(t,n);else if(n=Vh(e,t,n,r),n!==null){var i=Et();en(n,e,r,i),om(n,t,r)}}function Gy(e,t,n){var r=Qn(e),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(rm(e))im(t,i);else{var o=e.alternate;if(e.lanes===0&&(o===null||o.lanes===0)&&(o=t.lastRenderedReducer,o!==null))try{var s=t.lastRenderedState,a=o(s,n);if(i.hasEagerState=!0,i.eagerState=a,nn(a,s)){var c=t.interleaved;c===null?(i.next=i,Eu(t)):(i.next=c.next,c.next=i),t.interleaved=i;return}}catch{}finally{}n=Vh(e,t,i,r),n!==null&&(i=Et(),en(n,e,r,i),om(n,t,r))}}function rm(e){var t=e.alternate;return e===Fe||t!==null&&t===Fe}function im(e,t){Yi=Xs=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function om(e,t,n){if(n&4194240){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,au(e,n)}}var Js={readContext:zt,useCallback:ct,useContext:ct,useEffect:ct,useImperativeHandle:ct,useInsertionEffect:ct,useLayoutEffect:ct,useMemo:ct,useReducer:ct,useRef:ct,useState:ct,useDebugValue:ct,useDeferredValue:ct,useTransition:ct,useMutableSource:ct,useSyncExternalStore:ct,useId:ct,unstable_isNewReconciler:!1},Xy={readContext:zt,useCallback:function(e,t){return dn().memoizedState=[e,t===void 0?null:t],e},useContext:zt,useEffect:ef,useImperativeHandle:function(e,t,n){return n=n!=null?n.concat([e]):null,Es(4194308,4,Qh.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Es(4194308,4,e,t)},useInsertionEffect:function(e,t){return Es(4,2,e,t)},useMemo:function(e,t){var n=dn();return t=t===void 0?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=dn();return t=n!==void 0?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=qy.bind(null,Fe,e),[r.memoizedState,e]},useRef:function(e){var t=dn();return e={current:e},t.memoizedState=e},useState:Zd,useDebugValue:Iu,useDeferredValue:function(e){return dn().memoizedState=e},useTransition:function(){var e=Zd(!1),t=e[0];return e=Hy.bind(null,e[1]),dn().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=Fe,i=dn();if(De){if(n===void 0)throw Error(te(407));n=n()}else{if(n=t(),et===null)throw Error(te(349));br&30||zh(r,t,n)}i.memoizedState=n;var o={value:n,getSnapshot:t};return i.queue=o,ef(Hh.bind(null,r,o,e),[e]),r.flags|=2048,yo(9,Wh.bind(null,r,o,n,t),void 0,null),n},useId:function(){var e=dn(),t=et.identifierPrefix;if(De){var n=bn,r=En;n=(r&~(1<<32-Zt(r)-1)).toString(32)+n,t=":"+t+"R"+n,n=vo++,0<n&&(t+="H"+n.toString(32)),t+=":"}else n=Wy++,t=":"+t+"r"+n.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},Jy={readContext:zt,useCallback:Zh,useContext:zt,useEffect:_u,useImperativeHandle:Yh,useInsertionEffect:Jh,useLayoutEffect:Kh,useMemo:em,useReducer:hl,useRef:Xh,useState:function(){return hl(go)},useDebugValue:Iu,useDeferredValue:function(e){var t=Wt();return tm(t,Xe.memoizedState,e)},useTransition:function(){var e=hl(go)[0],t=Wt().memoizedState;return[e,t]},useMutableSource:$h,useSyncExternalStore:Bh,useId:nm,unstable_isNewReconciler:!1},Ky={readContext:zt,useCallback:Zh,useContext:zt,useEffect:_u,useImperativeHandle:Yh,useInsertionEffect:Jh,useLayoutEffect:Kh,useMemo:em,useReducer:ml,useRef:Xh,useState:function(){return ml(go)},useDebugValue:Iu,useDeferredValue:function(e){var t=Wt();return Xe===null?t.memoizedState=e:tm(t,Xe.memoizedState,e)},useTransition:function(){var e=ml(go)[0],t=Wt().memoizedState;return[e,t]},useMutableSource:$h,useSyncExternalStore:Bh,useId:nm,unstable_isNewReconciler:!1};function Kt(e,t){if(e&&e.defaultProps){t=Ue({},t),e=e.defaultProps;for(var n in e)t[n]===void 0&&(t[n]=e[n]);return t}return t}function gc(e,t,n,r){t=e.memoizedState,n=n(r,t),n=n==null?t:Ue({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var Sa={isMounted:function(e){return(e=e._reactInternals)?Or(e)===e:!1},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=Et(),i=Qn(e),o=Cn(r,i);o.payload=t,n!=null&&(o.callback=n),t=Jn(e,o,i),t!==null&&(en(t,e,i,r),Ss(t,e,i))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=Et(),i=Qn(e),o=Cn(r,i);o.tag=1,o.payload=t,n!=null&&(o.callback=n),t=Jn(e,o,i),t!==null&&(en(t,e,i,r),Ss(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=Et(),r=Qn(e),i=Cn(n,r);i.tag=2,t!=null&&(i.callback=t),t=Jn(e,i,r),t!==null&&(en(t,e,r,n),Ss(t,e,r))}};function tf(e,t,n,r,i,o,s){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(r,o,s):t.prototype&&t.prototype.isPureReactComponent?!co(n,r)||!co(i,o):!0}function sm(e,t,n){var r=!1,i=rr,o=t.contextType;return typeof o=="object"&&o!==null?o=zt(o):(i=Rt(t)?wr:gt.current,r=t.contextTypes,o=(r=r!=null)?oi(e,i):rr),t=new t(n,o),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=Sa,e.stateNode=t,t._reactInternals=e,r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=o),t}function nf(e,t,n,r){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,r),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&Sa.enqueueReplaceState(t,t.state,null)}function yc(e,t,n,r){var i=e.stateNode;i.props=n,i.state=e.memoizedState,i.refs={},bu(e);var o=t.contextType;typeof o=="object"&&o!==null?i.context=zt(o):(o=Rt(t)?wr:gt.current,i.context=oi(e,o)),i.state=e.memoizedState,o=t.getDerivedStateFromProps,typeof o=="function"&&(gc(e,t,o,n),i.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(t=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),t!==i.state&&Sa.enqueueReplaceState(i,i.state,null),qs(e,n,i,r),i.state=e.memoizedState),typeof i.componentDidMount=="function"&&(e.flags|=4194308)}function ci(e,t){try{var n="",r=t;do n+=xg(r),r=r.return;while(r);var i=n}catch(o){i=`
Error generating stack: `+o.message+`
`+o.stack}return{value:e,source:t,stack:i,digest:null}}function vl(e,t,n){return{value:e,source:null,stack:n??null,digest:t??null}}function Sc(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var Qy=typeof WeakMap=="function"?WeakMap:Map;function am(e,t,n){n=Cn(-1,n),n.tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){Qs||(Qs=!0,_c=r),Sc(e,t)},n}function lm(e,t,n){n=Cn(-1,n),n.tag=3;var r=e.type.getDerivedStateFromError;if(typeof r=="function"){var i=t.value;n.payload=function(){return r(i)},n.callback=function(){Sc(e,t)}}var o=e.stateNode;return o!==null&&typeof o.componentDidCatch=="function"&&(n.callback=function(){Sc(e,t),typeof r!="function"&&(Kn===null?Kn=new Set([this]):Kn.add(this));var s=t.stack;this.componentDidCatch(t.value,{componentStack:s!==null?s:""})}),n}function rf(e,t,n){var r=e.pingCache;if(r===null){r=e.pingCache=new Qy;var i=new Set;r.set(t,i)}else i=r.get(t),i===void 0&&(i=new Set,r.set(t,i));i.has(n)||(i.add(n),e=d0.bind(null,e,t,n),t.then(e,e))}function of(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function sf(e,t,n,r,i){return e.mode&1?(e.flags|=65536,e.lanes=i,e):(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(t=Cn(-1,1),t.tag=2,Jn(n,t,1))),n.lanes|=1),e)}var Yy=_n.ReactCurrentOwner,Pt=!1;function St(e,t,n,r){t.child=e===null?Dh(t,null,n,r):ai(t,e.child,n,r)}function af(e,t,n,r,i){n=n.render;var o=t.ref;return ti(t,i),r=Ou(e,t,n,r,o,i),n=Ru(),e!==null&&!Pt?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,On(e,t,i)):(De&&n&&mu(t),t.flags|=1,St(e,t,r,i),t.child)}function lf(e,t,n,r,i){if(e===null){var o=n.type;return typeof o=="function"&&!Vu(o)&&o.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(t.tag=15,t.type=o,cm(e,t,o,r,i)):(e=ks(n.type,null,r,t,t.mode,i),e.ref=t.ref,e.return=t,t.child=e)}if(o=e.child,!(e.lanes&i)){var s=o.memoizedProps;if(n=n.compare,n=n!==null?n:co,n(s,r)&&e.ref===t.ref)return On(e,t,i)}return t.flags|=1,e=Yn(o,r),e.ref=t.ref,e.return=t,t.child=e}function cm(e,t,n,r,i){if(e!==null){var o=e.memoizedProps;if(co(o,r)&&e.ref===t.ref)if(Pt=!1,t.pendingProps=r=o,(e.lanes&i)!==0)e.flags&131072&&(Pt=!0);else return t.lanes=e.lanes,On(e,t,i)}return wc(e,t,n,r,i)}function um(e,t,n){var r=t.pendingProps,i=r.children,o=e!==null?e.memoizedState:null;if(r.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Le(Jr,Nt),Nt|=n;else{if(!(n&1073741824))return e=o!==null?o.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Le(Jr,Nt),Nt|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=o!==null?o.baseLanes:n,Le(Jr,Nt),Nt|=r}else o!==null?(r=o.baseLanes|n,t.memoizedState=null):r=n,Le(Jr,Nt),Nt|=r;return St(e,t,i,n),t.child}function dm(e,t){var n=t.ref;(e===null&&n!==null||e!==null&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function wc(e,t,n,r,i){var o=Rt(n)?wr:gt.current;return o=oi(t,o),ti(t,i),n=Ou(e,t,n,r,o,i),r=Ru(),e!==null&&!Pt?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,On(e,t,i)):(De&&r&&mu(t),t.flags|=1,St(e,t,n,i),t.child)}function cf(e,t,n,r,i){if(Rt(n)){var o=!0;$s(t)}else o=!1;if(ti(t,i),t.stateNode===null)bs(e,t),sm(t,n,r),yc(t,n,r,i),r=!0;else if(e===null){var s=t.stateNode,a=t.memoizedProps;s.props=a;var c=s.context,l=n.contextType;typeof l=="object"&&l!==null?l=zt(l):(l=Rt(n)?wr:gt.current,l=oi(t,l));var u=n.getDerivedStateFromProps,d=typeof u=="function"||typeof s.getSnapshotBeforeUpdate=="function";d||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(a!==r||c!==l)&&nf(t,s,r,l),Dn=!1;var m=t.memoizedState;s.state=m,qs(t,r,s,i),c=t.memoizedState,a!==r||m!==c||Ot.current||Dn?(typeof u=="function"&&(gc(t,n,u,r),c=t.memoizedState),(a=Dn||tf(t,n,a,r,m,c,l))?(d||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount()),typeof s.componentDidMount=="function"&&(t.flags|=4194308)):(typeof s.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=c),s.props=r,s.state=c,s.context=l,r=a):(typeof s.componentDidMount=="function"&&(t.flags|=4194308),r=!1)}else{s=t.stateNode,Fh(e,t),a=t.memoizedProps,l=t.type===t.elementType?a:Kt(t.type,a),s.props=l,d=t.pendingProps,m=s.context,c=n.contextType,typeof c=="object"&&c!==null?c=zt(c):(c=Rt(n)?wr:gt.current,c=oi(t,c));var g=n.getDerivedStateFromProps;(u=typeof g=="function"||typeof s.getSnapshotBeforeUpdate=="function")||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(a!==d||m!==c)&&nf(t,s,r,c),Dn=!1,m=t.memoizedState,s.state=m,qs(t,r,s,i);var b=t.memoizedState;a!==d||m!==b||Ot.current||Dn?(typeof g=="function"&&(gc(t,n,g,r),b=t.memoizedState),(l=Dn||tf(t,n,l,r,m,b,c)||!1)?(u||typeof s.UNSAFE_componentWillUpdate!="function"&&typeof s.componentWillUpdate!="function"||(typeof s.componentWillUpdate=="function"&&s.componentWillUpdate(r,b,c),typeof s.UNSAFE_componentWillUpdate=="function"&&s.UNSAFE_componentWillUpdate(r,b,c)),typeof s.componentDidUpdate=="function"&&(t.flags|=4),typeof s.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof s.componentDidUpdate!="function"||a===e.memoizedProps&&m===e.memoizedState||(t.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||a===e.memoizedProps&&m===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=b),s.props=r,s.state=b,s.context=c,r=l):(typeof s.componentDidUpdate!="function"||a===e.memoizedProps&&m===e.memoizedState||(t.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||a===e.memoizedProps&&m===e.memoizedState||(t.flags|=1024),r=!1)}return Ec(e,t,n,r,o,i)}function Ec(e,t,n,r,i,o){dm(e,t);var s=(t.flags&128)!==0;if(!r&&!s)return i&&Gd(t,n,!1),On(e,t,o);r=t.stateNode,Yy.current=t;var a=s&&typeof n.getDerivedStateFromError!="function"?null:r.render();return t.flags|=1,e!==null&&s?(t.child=ai(t,e.child,null,o),t.child=ai(t,null,a,o)):St(e,t,a,o),t.memoizedState=r.state,i&&Gd(t,n,!0),t.child}function fm(e){var t=e.stateNode;t.pendingContext?qd(e,t.pendingContext,t.pendingContext!==t.context):t.context&&qd(e,t.context,!1),Cu(e,t.containerInfo)}function uf(e,t,n,r,i){return si(),gu(i),t.flags|=256,St(e,t,n,r),t.child}var bc={dehydrated:null,treeContext:null,retryLane:0};function Cc(e){return{baseLanes:e,cachePool:null,transitions:null}}function pm(e,t,n){var r=t.pendingProps,i=Ve.current,o=!1,s=(t.flags&128)!==0,a;if((a=s)||(a=e!==null&&e.memoizedState===null?!1:(i&2)!==0),a?(o=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(i|=1),Le(Ve,i&1),e===null)return mc(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(s=r.children,e=r.fallback,o?(r=t.mode,o=t.child,s={mode:"hidden",children:s},!(r&1)&&o!==null?(o.childLanes=0,o.pendingProps=s):o=ba(s,r,0,null),e=Sr(e,r,n,null),o.return=t,e.return=t,o.sibling=e,t.child=o,t.child.memoizedState=Cc(n),t.memoizedState=bc,e):Nu(t,s));if(i=e.memoizedState,i!==null&&(a=i.dehydrated,a!==null))return Zy(e,t,s,r,a,i,n);if(o){o=r.fallback,s=t.mode,i=e.child,a=i.sibling;var c={mode:"hidden",children:r.children};return!(s&1)&&t.child!==i?(r=t.child,r.childLanes=0,r.pendingProps=c,t.deletions=null):(r=Yn(i,c),r.subtreeFlags=i.subtreeFlags&14680064),a!==null?o=Yn(a,o):(o=Sr(o,s,n,null),o.flags|=2),o.return=t,r.return=t,r.sibling=o,t.child=r,r=o,o=t.child,s=e.child.memoizedState,s=s===null?Cc(n):{baseLanes:s.baseLanes|n,cachePool:null,transitions:s.transitions},o.memoizedState=s,o.childLanes=e.childLanes&~n,t.memoizedState=bc,r}return o=e.child,e=o.sibling,r=Yn(o,{mode:"visible",children:r.children}),!(t.mode&1)&&(r.lanes=n),r.return=t,r.sibling=null,e!==null&&(n=t.deletions,n===null?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=r,t.memoizedState=null,r}function Nu(e,t){return t=ba({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function is(e,t,n,r){return r!==null&&gu(r),ai(t,e.child,null,n),e=Nu(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function Zy(e,t,n,r,i,o,s){if(n)return t.flags&256?(t.flags&=-257,r=vl(Error(te(422))),is(e,t,s,r)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(o=r.fallback,i=t.mode,r=ba({mode:"visible",children:r.children},i,0,null),o=Sr(o,i,s,null),o.flags|=2,r.return=t,o.return=t,r.sibling=o,t.child=r,t.mode&1&&ai(t,e.child,null,s),t.child.memoizedState=Cc(s),t.memoizedState=bc,o);if(!(t.mode&1))return is(e,t,s,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var a=r.dgst;return r=a,o=Error(te(419)),r=vl(o,r,void 0),is(e,t,s,r)}if(a=(s&e.childLanes)!==0,Pt||a){if(r=et,r!==null){switch(s&-s){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|s)?0:i,i!==0&&i!==o.retryLane&&(o.retryLane=i,Pn(e,i),en(r,e,i,-1))}return Du(),r=vl(Error(te(421))),is(e,t,s,r)}return i.data==="$?"?(t.flags|=128,t.child=e.child,t=f0.bind(null,e),i._reactRetry=t,null):(e=o.treeContext,Lt=Xn(i.nextSibling),At=t,De=!0,Yt=null,e!==null&&(Ft[Ut++]=En,Ft[Ut++]=bn,Ft[Ut++]=Er,En=e.id,bn=e.overflow,Er=t),t=Nu(t,r.children),t.flags|=4096,t)}function df(e,t,n){e.lanes|=t;var r=e.alternate;r!==null&&(r.lanes|=t),vc(e.return,t,n)}function gl(e,t,n,r,i){var o=e.memoizedState;o===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(o.isBackwards=t,o.rendering=null,o.renderingStartTime=0,o.last=r,o.tail=n,o.tailMode=i)}function hm(e,t,n){var r=t.pendingProps,i=r.revealOrder,o=r.tail;if(St(e,t,r.children,n),r=Ve.current,r&2)r=r&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&df(e,n,t);else if(e.tag===19)df(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(Le(Ve,r),!(t.mode&1))t.memoizedState=null;else switch(i){case"forwards":for(n=t.child,i=null;n!==null;)e=n.alternate,e!==null&&Gs(e)===null&&(i=n),n=n.sibling;n=i,n===null?(i=t.child,t.child=null):(i=n.sibling,n.sibling=null),gl(t,!1,i,n,o);break;case"backwards":for(n=null,i=t.child,t.child=null;i!==null;){if(e=i.alternate,e!==null&&Gs(e)===null){t.child=i;break}e=i.sibling,i.sibling=n,n=i,i=e}gl(t,!0,n,null,o);break;case"together":gl(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function bs(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function On(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),Cr|=t.lanes,!(n&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(te(153));if(t.child!==null){for(e=t.child,n=Yn(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=Yn(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function e0(e,t,n){switch(t.tag){case 3:fm(t),si();break;case 5:Uh(t);break;case 1:Rt(t.type)&&$s(t);break;case 4:Cu(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,i=t.memoizedProps.value;Le(Ws,r._currentValue),r._currentValue=i;break;case 13:if(r=t.memoizedState,r!==null)return r.dehydrated!==null?(Le(Ve,Ve.current&1),t.flags|=128,null):n&t.child.childLanes?pm(e,t,n):(Le(Ve,Ve.current&1),e=On(e,t,n),e!==null?e.sibling:null);Le(Ve,Ve.current&1);break;case 19:if(r=(n&t.childLanes)!==0,e.flags&128){if(r)return hm(e,t,n);t.flags|=128}if(i=t.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),Le(Ve,Ve.current),r)break;return null;case 22:case 23:return t.lanes=0,um(e,t,n)}return On(e,t,n)}var mm,xc,vm,gm;mm=function(e,t){for(var n=t.child;n!==null;){if(n.tag===5||n.tag===6)e.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};xc=function(){};vm=function(e,t,n,r){var i=e.memoizedProps;if(i!==r){e=t.stateNode,vr(mn.current);var o=null;switch(n){case"input":i=ql(e,i),r=ql(e,r),o=[];break;case"select":i=Ue({},i,{value:void 0}),r=Ue({},r,{value:void 0}),o=[];break;case"textarea":i=Jl(e,i),r=Jl(e,r),o=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(e.onclick=Fs)}Ql(n,r);var s;n=null;for(l in i)if(!r.hasOwnProperty(l)&&i.hasOwnProperty(l)&&i[l]!=null)if(l==="style"){var a=i[l];for(s in a)a.hasOwnProperty(s)&&(n||(n={}),n[s]="")}else l!=="dangerouslySetInnerHTML"&&l!=="children"&&l!=="suppressContentEditableWarning"&&l!=="suppressHydrationWarning"&&l!=="autoFocus"&&(no.hasOwnProperty(l)?o||(o=[]):(o=o||[]).push(l,null));for(l in r){var c=r[l];if(a=i?.[l],r.hasOwnProperty(l)&&c!==a&&(c!=null||a!=null))if(l==="style")if(a){for(s in a)!a.hasOwnProperty(s)||c&&c.hasOwnProperty(s)||(n||(n={}),n[s]="");for(s in c)c.hasOwnProperty(s)&&a[s]!==c[s]&&(n||(n={}),n[s]=c[s])}else n||(o||(o=[]),o.push(l,n)),n=c;else l==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,a=a?a.__html:void 0,c!=null&&a!==c&&(o=o||[]).push(l,c)):l==="children"?typeof c!="string"&&typeof c!="number"||(o=o||[]).push(l,""+c):l!=="suppressContentEditableWarning"&&l!=="suppressHydrationWarning"&&(no.hasOwnProperty(l)?(c!=null&&l==="onScroll"&&Me("scroll",e),o||a===c||(o=[])):(o=o||[]).push(l,c))}n&&(o=o||[]).push("style",n);var l=o;(t.updateQueue=l)&&(t.flags|=4)}};gm=function(e,t,n,r){n!==r&&(t.flags|=4)};function ji(e,t){if(!De)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:r.sibling=null}}function ut(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,r=0;if(t)for(var i=e.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=e,i=i.sibling;else for(i=e.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function t0(e,t,n){var r=t.pendingProps;switch(vu(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ut(t),null;case 1:return Rt(t.type)&&Us(),ut(t),null;case 3:return r=t.stateNode,li(),je(Ot),je(gt),ku(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(e===null||e.child===null)&&(ns(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,Yt!==null&&(Tc(Yt),Yt=null))),xc(e,t),ut(t),null;case 5:xu(t);var i=vr(mo.current);if(n=t.type,e!==null&&t.stateNode!=null)vm(e,t,n,r,i),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(t.stateNode===null)throw Error(te(166));return ut(t),null}if(e=vr(mn.current),ns(t)){r=t.stateNode,n=t.type;var o=t.memoizedProps;switch(r[fn]=t,r[po]=o,e=(t.mode&1)!==0,n){case"dialog":Me("cancel",r),Me("close",r);break;case"iframe":case"object":case"embed":Me("load",r);break;case"video":case"audio":for(i=0;i<qi.length;i++)Me(qi[i],r);break;case"source":Me("error",r);break;case"img":case"image":case"link":Me("error",r),Me("load",r);break;case"details":Me("toggle",r);break;case"input":Sd(r,o),Me("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!o.multiple},Me("invalid",r);break;case"textarea":Ed(r,o),Me("invalid",r)}Ql(n,o),i=null;for(var s in o)if(o.hasOwnProperty(s)){var a=o[s];s==="children"?typeof a=="string"?r.textContent!==a&&(o.suppressHydrationWarning!==!0&&ts(r.textContent,a,e),i=["children",a]):typeof a=="number"&&r.textContent!==""+a&&(o.suppressHydrationWarning!==!0&&ts(r.textContent,a,e),i=["children",""+a]):no.hasOwnProperty(s)&&a!=null&&s==="onScroll"&&Me("scroll",r)}switch(n){case"input":Go(r),wd(r,o,!0);break;case"textarea":Go(r),bd(r);break;case"select":case"option":break;default:typeof o.onClick=="function"&&(r.onclick=Fs)}r=i,t.updateQueue=r,r!==null&&(t.flags|=4)}else{s=i.nodeType===9?i:i.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=Hp(n)),e==="http://www.w3.org/1999/xhtml"?n==="script"?(e=s.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof r.is=="string"?e=s.createElement(n,{is:r.is}):(e=s.createElement(n),n==="select"&&(s=e,r.multiple?s.multiple=!0:r.size&&(s.size=r.size))):e=s.createElementNS(e,n),e[fn]=t,e[po]=r,mm(e,t,!1,!1),t.stateNode=e;e:{switch(s=Yl(n,r),n){case"dialog":Me("cancel",e),Me("close",e),i=r;break;case"iframe":case"object":case"embed":Me("load",e),i=r;break;case"video":case"audio":for(i=0;i<qi.length;i++)Me(qi[i],e);i=r;break;case"source":Me("error",e),i=r;break;case"img":case"image":case"link":Me("error",e),Me("load",e),i=r;break;case"details":Me("toggle",e),i=r;break;case"input":Sd(e,r),i=ql(e,r),Me("invalid",e);break;case"option":i=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},i=Ue({},r,{value:void 0}),Me("invalid",e);break;case"textarea":Ed(e,r),i=Jl(e,r),Me("invalid",e);break;default:i=r}Ql(n,i),a=i;for(o in a)if(a.hasOwnProperty(o)){var c=a[o];o==="style"?Xp(e,c):o==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&qp(e,c)):o==="children"?typeof c=="string"?(n!=="textarea"||c!=="")&&ro(e,c):typeof c=="number"&&ro(e,""+c):o!=="suppressContentEditableWarning"&&o!=="suppressHydrationWarning"&&o!=="autoFocus"&&(no.hasOwnProperty(o)?c!=null&&o==="onScroll"&&Me("scroll",e):c!=null&&tu(e,o,c,s))}switch(n){case"input":Go(e),wd(e,r,!1);break;case"textarea":Go(e),bd(e);break;case"option":r.value!=null&&e.setAttribute("value",""+nr(r.value));break;case"select":e.multiple=!!r.multiple,o=r.value,o!=null?Qr(e,!!r.multiple,o,!1):r.defaultValue!=null&&Qr(e,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(e.onclick=Fs)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return ut(t),null;case 6:if(e&&t.stateNode!=null)gm(e,t,e.memoizedProps,r);else{if(typeof r!="string"&&t.stateNode===null)throw Error(te(166));if(n=vr(mo.current),vr(mn.current),ns(t)){if(r=t.stateNode,n=t.memoizedProps,r[fn]=t,(o=r.nodeValue!==n)&&(e=At,e!==null))switch(e.tag){case 3:ts(r.nodeValue,n,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&ts(r.nodeValue,n,(e.mode&1)!==0)}o&&(t.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[fn]=t,t.stateNode=r}return ut(t),null;case 13:if(je(Ve),r=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(De&&Lt!==null&&t.mode&1&&!(t.flags&128))Mh(),si(),t.flags|=98560,o=!1;else if(o=ns(t),r!==null&&r.dehydrated!==null){if(e===null){if(!o)throw Error(te(318));if(o=t.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(te(317));o[fn]=t}else si(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;ut(t),o=!1}else Yt!==null&&(Tc(Yt),Yt=null),o=!0;if(!o)return t.flags&65536?t:null}return t.flags&128?(t.lanes=n,t):(r=r!==null,r!==(e!==null&&e.memoizedState!==null)&&r&&(t.child.flags|=8192,t.mode&1&&(e===null||Ve.current&1?Je===0&&(Je=3):Du())),t.updateQueue!==null&&(t.flags|=4),ut(t),null);case 4:return li(),xc(e,t),e===null&&uo(t.stateNode.containerInfo),ut(t),null;case 10:return wu(t.type._context),ut(t),null;case 17:return Rt(t.type)&&Us(),ut(t),null;case 19:if(je(Ve),o=t.memoizedState,o===null)return ut(t),null;if(r=(t.flags&128)!==0,s=o.rendering,s===null)if(r)ji(o,!1);else{if(Je!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(s=Gs(e),s!==null){for(t.flags|=128,ji(o,!1),r=s.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;n!==null;)o=n,e=r,o.flags&=14680066,s=o.alternate,s===null?(o.childLanes=0,o.lanes=e,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=s.childLanes,o.lanes=s.lanes,o.child=s.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=s.memoizedProps,o.memoizedState=s.memoizedState,o.updateQueue=s.updateQueue,o.type=s.type,e=s.dependencies,o.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Le(Ve,Ve.current&1|2),t.child}e=e.sibling}o.tail!==null&&ze()>ui&&(t.flags|=128,r=!0,ji(o,!1),t.lanes=4194304)}else{if(!r)if(e=Gs(s),e!==null){if(t.flags|=128,r=!0,n=e.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),ji(o,!0),o.tail===null&&o.tailMode==="hidden"&&!s.alternate&&!De)return ut(t),null}else 2*ze()-o.renderingStartTime>ui&&n!==1073741824&&(t.flags|=128,r=!0,ji(o,!1),t.lanes=4194304);o.isBackwards?(s.sibling=t.child,t.child=s):(n=o.last,n!==null?n.sibling=s:t.child=s,o.last=s)}return o.tail!==null?(t=o.tail,o.rendering=t,o.tail=t.sibling,o.renderingStartTime=ze(),t.sibling=null,n=Ve.current,Le(Ve,r?n&1|2:n&1),t):(ut(t),null);case 22:case 23:return ju(),r=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==r&&(t.flags|=8192),r&&t.mode&1?Nt&1073741824&&(ut(t),t.subtreeFlags&6&&(t.flags|=8192)):ut(t),null;case 24:return null;case 25:return null}throw Error(te(156,t.tag))}function n0(e,t){switch(vu(t),t.tag){case 1:return Rt(t.type)&&Us(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return li(),je(Ot),je(gt),ku(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return xu(t),null;case 13:if(je(Ve),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(te(340));si()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return je(Ve),null;case 4:return li(),null;case 10:return wu(t.type._context),null;case 22:case 23:return ju(),null;case 24:return null;default:return null}}var os=!1,mt=!1,r0=typeof WeakSet=="function"?WeakSet:Set,ae=null;function Xr(e,t){var n=e.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){$e(e,t,r)}else n.current=null}function kc(e,t,n){try{n()}catch(r){$e(e,t,r)}}var ff=!1;function i0(e,t){if(lc=js,e=bh(),hu(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{n=(n=e.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var i=r.anchorOffset,o=r.focusNode;r=r.focusOffset;try{n.nodeType,o.nodeType}catch{n=null;break e}var s=0,a=-1,c=-1,l=0,u=0,d=e,m=null;t:for(;;){for(var g;d!==n||i!==0&&d.nodeType!==3||(a=s+i),d!==o||r!==0&&d.nodeType!==3||(c=s+r),d.nodeType===3&&(s+=d.nodeValue.length),(g=d.firstChild)!==null;)m=d,d=g;for(;;){if(d===e)break t;if(m===n&&++l===i&&(a=s),m===o&&++u===r&&(c=s),(g=d.nextSibling)!==null)break;d=m,m=d.parentNode}d=g}n=a===-1||c===-1?null:{start:a,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(cc={focusedElem:e,selectionRange:n},js=!1,ae=t;ae!==null;)if(t=ae,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,ae=e;else for(;ae!==null;){t=ae;try{var b=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(b!==null){var P=b.memoizedProps,k=b.memoizedState,f=t.stateNode,v=f.getSnapshotBeforeUpdate(t.elementType===t.type?P:Kt(t.type,P),k);f.__reactInternalSnapshotBeforeUpdate=v}break;case 3:var w=t.stateNode.containerInfo;w.nodeType===1?w.textContent="":w.nodeType===9&&w.documentElement&&w.removeChild(w.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(te(163))}}catch(y){$e(t,t.return,y)}if(e=t.sibling,e!==null){e.return=t.return,ae=e;break}ae=t.return}return b=ff,ff=!1,b}function Zi(e,t,n){var r=t.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&e)===e){var o=i.destroy;i.destroy=void 0,o!==void 0&&kc(t,n,o)}i=i.next}while(i!==r)}}function wa(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function Pc(e){var t=e.ref;if(t!==null){var n=e.stateNode;switch(e.tag){case 5:e=n;break;default:e=n}typeof t=="function"?t(e):t.current=e}}function ym(e){var t=e.alternate;t!==null&&(e.alternate=null,ym(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[fn],delete t[po],delete t[fc],delete t[Uy],delete t[$y])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function Sm(e){return e.tag===5||e.tag===3||e.tag===4}function pf(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||Sm(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Oc(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.nodeType===8?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(n.nodeType===8?(t=n.parentNode,t.insertBefore(e,n)):(t=n,t.appendChild(e)),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=Fs));else if(r!==4&&(e=e.child,e!==null))for(Oc(e,t,n),e=e.sibling;e!==null;)Oc(e,t,n),e=e.sibling}function Rc(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(r!==4&&(e=e.child,e!==null))for(Rc(e,t,n),e=e.sibling;e!==null;)Rc(e,t,n),e=e.sibling}var rt=null,Qt=!1;function An(e,t,n){for(n=n.child;n!==null;)wm(e,t,n),n=n.sibling}function wm(e,t,n){if(hn&&typeof hn.onCommitFiberUnmount=="function")try{hn.onCommitFiberUnmount(fa,n)}catch{}switch(n.tag){case 5:mt||Xr(n,t);case 6:var r=rt,i=Qt;rt=null,An(e,t,n),rt=r,Qt=i,rt!==null&&(Qt?(e=rt,n=n.stateNode,e.nodeType===8?e.parentNode.removeChild(n):e.removeChild(n)):rt.removeChild(n.stateNode));break;case 18:rt!==null&&(Qt?(e=rt,n=n.stateNode,e.nodeType===8?ul(e.parentNode,n):e.nodeType===1&&ul(e,n),ao(e)):ul(rt,n.stateNode));break;case 4:r=rt,i=Qt,rt=n.stateNode.containerInfo,Qt=!0,An(e,t,n),rt=r,Qt=i;break;case 0:case 11:case 14:case 15:if(!mt&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var o=i,s=o.destroy;o=o.tag,s!==void 0&&(o&2||o&4)&&kc(n,t,s),i=i.next}while(i!==r)}An(e,t,n);break;case 1:if(!mt&&(Xr(n,t),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(a){$e(n,t,a)}An(e,t,n);break;case 21:An(e,t,n);break;case 22:n.mode&1?(mt=(r=mt)||n.memoizedState!==null,An(e,t,n),mt=r):An(e,t,n);break;default:An(e,t,n)}}function hf(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var n=e.stateNode;n===null&&(n=e.stateNode=new r0),t.forEach(function(r){var i=p0.bind(null,e,r);n.has(r)||(n.add(r),r.then(i,i))})}}function Gt(e,t){var n=t.deletions;if(n!==null)for(var r=0;r<n.length;r++){var i=n[r];try{var o=e,s=t,a=s;e:for(;a!==null;){switch(a.tag){case 5:rt=a.stateNode,Qt=!1;break e;case 3:rt=a.stateNode.containerInfo,Qt=!0;break e;case 4:rt=a.stateNode.containerInfo,Qt=!0;break e}a=a.return}if(rt===null)throw Error(te(160));wm(o,s,i),rt=null,Qt=!1;var c=i.alternate;c!==null&&(c.return=null),i.return=null}catch(l){$e(i,t,l)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)Em(t,e),t=t.sibling}function Em(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Gt(t,e),an(e),r&4){try{Zi(3,e,e.return),wa(3,e)}catch(P){$e(e,e.return,P)}try{Zi(5,e,e.return)}catch(P){$e(e,e.return,P)}}break;case 1:Gt(t,e),an(e),r&512&&n!==null&&Xr(n,n.return);break;case 5:if(Gt(t,e),an(e),r&512&&n!==null&&Xr(n,n.return),e.flags&32){var i=e.stateNode;try{ro(i,"")}catch(P){$e(e,e.return,P)}}if(r&4&&(i=e.stateNode,i!=null)){var o=e.memoizedProps,s=n!==null?n.memoizedProps:o,a=e.type,c=e.updateQueue;if(e.updateQueue=null,c!==null)try{a==="input"&&o.type==="radio"&&o.name!=null&&zp(i,o),Yl(a,s);var l=Yl(a,o);for(s=0;s<c.length;s+=2){var u=c[s],d=c[s+1];u==="style"?Xp(i,d):u==="dangerouslySetInnerHTML"?qp(i,d):u==="children"?ro(i,d):tu(i,u,d,l)}switch(a){case"input":Gl(i,o);break;case"textarea":Wp(i,o);break;case"select":var m=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!o.multiple;var g=o.value;g!=null?Qr(i,!!o.multiple,g,!1):m!==!!o.multiple&&(o.defaultValue!=null?Qr(i,!!o.multiple,o.defaultValue,!0):Qr(i,!!o.multiple,o.multiple?[]:"",!1))}i[po]=o}catch(P){$e(e,e.return,P)}}break;case 6:if(Gt(t,e),an(e),r&4){if(e.stateNode===null)throw Error(te(162));i=e.stateNode,o=e.memoizedProps;try{i.nodeValue=o}catch(P){$e(e,e.return,P)}}break;case 3:if(Gt(t,e),an(e),r&4&&n!==null&&n.memoizedState.isDehydrated)try{ao(t.containerInfo)}catch(P){$e(e,e.return,P)}break;case 4:Gt(t,e),an(e);break;case 13:Gt(t,e),an(e),i=e.child,i.flags&8192&&(o=i.memoizedState!==null,i.stateNode.isHidden=o,!o||i.alternate!==null&&i.alternate.memoizedState!==null||(Au=ze())),r&4&&hf(e);break;case 22:if(u=n!==null&&n.memoizedState!==null,e.mode&1?(mt=(l=mt)||u,Gt(t,e),mt=l):Gt(t,e),an(e),r&8192){if(l=e.memoizedState!==null,(e.stateNode.isHidden=l)&&!u&&e.mode&1)for(ae=e,u=e.child;u!==null;){for(d=ae=u;ae!==null;){switch(m=ae,g=m.child,m.tag){case 0:case 11:case 14:case 15:Zi(4,m,m.return);break;case 1:Xr(m,m.return);var b=m.stateNode;if(typeof b.componentWillUnmount=="function"){r=m,n=m.return;try{t=r,b.props=t.memoizedProps,b.state=t.memoizedState,b.componentWillUnmount()}catch(P){$e(r,n,P)}}break;case 5:Xr(m,m.return);break;case 22:if(m.memoizedState!==null){vf(d);continue}}g!==null?(g.return=m,ae=g):vf(d)}u=u.sibling}e:for(u=null,d=e;;){if(d.tag===5){if(u===null){u=d;try{i=d.stateNode,l?(o=i.style,typeof o.setProperty=="function"?o.setProperty("display","none","important"):o.display="none"):(a=d.stateNode,c=d.memoizedProps.style,s=c!=null&&c.hasOwnProperty("display")?c.display:null,a.style.display=Gp("display",s))}catch(P){$e(e,e.return,P)}}}else if(d.tag===6){if(u===null)try{d.stateNode.nodeValue=l?"":d.memoizedProps}catch(P){$e(e,e.return,P)}}else if((d.tag!==22&&d.tag!==23||d.memoizedState===null||d===e)&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===e)break e;for(;d.sibling===null;){if(d.return===null||d.return===e)break e;u===d&&(u=null),d=d.return}u===d&&(u=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:Gt(t,e),an(e),r&4&&hf(e);break;case 21:break;default:Gt(t,e),an(e)}}function an(e){var t=e.flags;if(t&2){try{e:{for(var n=e.return;n!==null;){if(Sm(n)){var r=n;break e}n=n.return}throw Error(te(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(ro(i,""),r.flags&=-33);var o=pf(e);Rc(e,o,i);break;case 3:case 4:var s=r.stateNode.containerInfo,a=pf(e);Oc(e,a,s);break;default:throw Error(te(161))}}catch(c){$e(e,e.return,c)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function o0(e,t,n){ae=e,bm(e)}function bm(e,t,n){for(var r=(e.mode&1)!==0;ae!==null;){var i=ae,o=i.child;if(i.tag===22&&r){var s=i.memoizedState!==null||os;if(!s){var a=i.alternate,c=a!==null&&a.memoizedState!==null||mt;a=os;var l=mt;if(os=s,(mt=c)&&!l)for(ae=i;ae!==null;)s=ae,c=s.child,s.tag===22&&s.memoizedState!==null?gf(i):c!==null?(c.return=s,ae=c):gf(i);for(;o!==null;)ae=o,bm(o),o=o.sibling;ae=i,os=a,mt=l}mf(e)}else i.subtreeFlags&8772&&o!==null?(o.return=i,ae=o):mf(e)}}function mf(e){for(;ae!==null;){var t=ae;if(t.flags&8772){var n=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:mt||wa(5,t);break;case 1:var r=t.stateNode;if(t.flags&4&&!mt)if(n===null)r.componentDidMount();else{var i=t.elementType===t.type?n.memoizedProps:Kt(t.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var o=t.updateQueue;o!==null&&Yd(t,o,r);break;case 3:var s=t.updateQueue;if(s!==null){if(n=null,t.child!==null)switch(t.child.tag){case 5:n=t.child.stateNode;break;case 1:n=t.child.stateNode}Yd(t,s,n)}break;case 5:var a=t.stateNode;if(n===null&&t.flags&4){n=a;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var l=t.alternate;if(l!==null){var u=l.memoizedState;if(u!==null){var d=u.dehydrated;d!==null&&ao(d)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(te(163))}mt||t.flags&512&&Pc(t)}catch(m){$e(t,t.return,m)}}if(t===e){ae=null;break}if(n=t.sibling,n!==null){n.return=t.return,ae=n;break}ae=t.return}}function vf(e){for(;ae!==null;){var t=ae;if(t===e){ae=null;break}var n=t.sibling;if(n!==null){n.return=t.return,ae=n;break}ae=t.return}}function gf(e){for(;ae!==null;){var t=ae;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{wa(4,t)}catch(c){$e(t,n,c)}break;case 1:var r=t.stateNode;if(typeof r.componentDidMount=="function"){var i=t.return;try{r.componentDidMount()}catch(c){$e(t,i,c)}}var o=t.return;try{Pc(t)}catch(c){$e(t,o,c)}break;case 5:var s=t.return;try{Pc(t)}catch(c){$e(t,s,c)}}}catch(c){$e(t,t.return,c)}if(t===e){ae=null;break}var a=t.sibling;if(a!==null){a.return=t.return,ae=a;break}ae=t.return}}var s0=Math.ceil,Ks=_n.ReactCurrentDispatcher,Tu=_n.ReactCurrentOwner,Bt=_n.ReactCurrentBatchConfig,ke=0,et=null,qe=null,it=0,Nt=0,Jr=or(0),Je=0,So=null,Cr=0,Ea=0,Lu=0,eo=null,kt=null,Au=0,ui=1/0,Sn=null,Qs=!1,_c=null,Kn=null,ss=!1,Bn=null,Ys=0,to=0,Ic=null,Cs=-1,xs=0;function Et(){return ke&6?ze():Cs!==-1?Cs:Cs=ze()}function Qn(e){return e.mode&1?ke&2&&it!==0?it&-it:zy.transition!==null?(xs===0&&(xs=sh()),xs):(e=Re,e!==0||(e=window.event,e=e===void 0?16:ph(e.type)),e):1}function en(e,t,n,r){if(50<to)throw to=0,Ic=null,Error(te(185));xo(e,n,r),(!(ke&2)||e!==et)&&(e===et&&(!(ke&2)&&(Ea|=n),Je===4&&Fn(e,it)),_t(e,r),n===1&&ke===0&&!(t.mode&1)&&(ui=ze()+500,ga&&sr()))}function _t(e,t){var n=e.callbackNode;zg(e,t);var r=Ms(e,e===et?it:0);if(r===0)n!==null&&kd(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(n!=null&&kd(n),t===1)e.tag===0?By(yf.bind(null,e)):Th(yf.bind(null,e)),Vy(function(){!(ke&6)&&sr()}),n=null;else{switch(ah(r)){case 1:n=su;break;case 4:n=ih;break;case 16:n=As;break;case 536870912:n=oh;break;default:n=As}n=Im(n,Cm.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function Cm(e,t){if(Cs=-1,xs=0,ke&6)throw Error(te(327));var n=e.callbackNode;if(ni()&&e.callbackNode!==n)return null;var r=Ms(e,e===et?it:0);if(r===0)return null;if(r&30||r&e.expiredLanes||t)t=Zs(e,r);else{t=r;var i=ke;ke|=2;var o=km();(et!==e||it!==t)&&(Sn=null,ui=ze()+500,yr(e,t));do try{c0();break}catch(a){xm(e,a)}while(1);Su(),Ks.current=o,ke=i,qe!==null?t=0:(et=null,it=0,t=Je)}if(t!==0){if(t===2&&(i=rc(e),i!==0&&(r=i,t=Nc(e,i))),t===1)throw n=So,yr(e,0),Fn(e,r),_t(e,ze()),n;if(t===6)Fn(e,r);else{if(i=e.current.alternate,!(r&30)&&!a0(i)&&(t=Zs(e,r),t===2&&(o=rc(e),o!==0&&(r=o,t=Nc(e,o))),t===1))throw n=So,yr(e,0),Fn(e,r),_t(e,ze()),n;switch(e.finishedWork=i,e.finishedLanes=r,t){case 0:case 1:throw Error(te(345));case 2:pr(e,kt,Sn);break;case 3:if(Fn(e,r),(r&130023424)===r&&(t=Au+500-ze(),10<t)){if(Ms(e,0)!==0)break;if(i=e.suspendedLanes,(i&r)!==r){Et(),e.pingedLanes|=e.suspendedLanes&i;break}e.timeoutHandle=dc(pr.bind(null,e,kt,Sn),t);break}pr(e,kt,Sn);break;case 4:if(Fn(e,r),(r&4194240)===r)break;for(t=e.eventTimes,i=-1;0<r;){var s=31-Zt(r);o=1<<s,s=t[s],s>i&&(i=s),r&=~o}if(r=i,r=ze()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*s0(r/1960))-r,10<r){e.timeoutHandle=dc(pr.bind(null,e,kt,Sn),r);break}pr(e,kt,Sn);break;case 5:pr(e,kt,Sn);break;default:throw Error(te(329))}}}return _t(e,ze()),e.callbackNode===n?Cm.bind(null,e):null}function Nc(e,t){var n=eo;return e.current.memoizedState.isDehydrated&&(yr(e,t).flags|=256),e=Zs(e,t),e!==2&&(t=kt,kt=n,t!==null&&Tc(t)),e}function Tc(e){kt===null?kt=e:kt.push.apply(kt,e)}function a0(e){for(var t=e;;){if(t.flags&16384){var n=t.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var i=n[r],o=i.getSnapshot;i=i.value;try{if(!nn(o(),i))return!1}catch{return!1}}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Fn(e,t){for(t&=~Lu,t&=~Ea,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-Zt(t),r=1<<n;e[n]=-1,t&=~r}}function yf(e){if(ke&6)throw Error(te(327));ni();var t=Ms(e,0);if(!(t&1))return _t(e,ze()),null;var n=Zs(e,t);if(e.tag!==0&&n===2){var r=rc(e);r!==0&&(t=r,n=Nc(e,r))}if(n===1)throw n=So,yr(e,0),Fn(e,t),_t(e,ze()),n;if(n===6)throw Error(te(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,pr(e,kt,Sn),_t(e,ze()),null}function Mu(e,t){var n=ke;ke|=1;try{return e(t)}finally{ke=n,ke===0&&(ui=ze()+500,ga&&sr())}}function xr(e){Bn!==null&&Bn.tag===0&&!(ke&6)&&ni();var t=ke;ke|=1;var n=Bt.transition,r=Re;try{if(Bt.transition=null,Re=1,e)return e()}finally{Re=r,Bt.transition=n,ke=t,!(ke&6)&&sr()}}function ju(){Nt=Jr.current,je(Jr)}function yr(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(n!==-1&&(e.timeoutHandle=-1,Dy(n)),qe!==null)for(n=qe.return;n!==null;){var r=n;switch(vu(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Us();break;case 3:li(),je(Ot),je(gt),ku();break;case 5:xu(r);break;case 4:li();break;case 13:je(Ve);break;case 19:je(Ve);break;case 10:wu(r.type._context);break;case 22:case 23:ju()}n=n.return}if(et=e,qe=e=Yn(e.current,null),it=Nt=t,Je=0,So=null,Lu=Ea=Cr=0,kt=eo=null,mr!==null){for(t=0;t<mr.length;t++)if(n=mr[t],r=n.interleaved,r!==null){n.interleaved=null;var i=r.next,o=n.pending;if(o!==null){var s=o.next;o.next=i,r.next=s}n.pending=r}mr=null}return e}function xm(e,t){do{var n=qe;try{if(Su(),ws.current=Js,Xs){for(var r=Fe.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}Xs=!1}if(br=0,Ze=Xe=Fe=null,Yi=!1,vo=0,Tu.current=null,n===null||n.return===null){Je=1,So=t,qe=null;break}e:{var o=e,s=n.return,a=n,c=t;if(t=it,a.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var l=c,u=a,d=u.tag;if(!(u.mode&1)&&(d===0||d===11||d===15)){var m=u.alternate;m?(u.updateQueue=m.updateQueue,u.memoizedState=m.memoizedState,u.lanes=m.lanes):(u.updateQueue=null,u.memoizedState=null)}var g=of(s);if(g!==null){g.flags&=-257,sf(g,s,a,o,t),g.mode&1&&rf(o,l,t),t=g,c=l;var b=t.updateQueue;if(b===null){var P=new Set;P.add(c),t.updateQueue=P}else b.add(c);break e}else{if(!(t&1)){rf(o,l,t),Du();break e}c=Error(te(426))}}else if(De&&a.mode&1){var k=of(s);if(k!==null){!(k.flags&65536)&&(k.flags|=256),sf(k,s,a,o,t),gu(ci(c,a));break e}}o=c=ci(c,a),Je!==4&&(Je=2),eo===null?eo=[o]:eo.push(o),o=s;do{switch(o.tag){case 3:o.flags|=65536,t&=-t,o.lanes|=t;var f=am(o,c,t);Qd(o,f);break e;case 1:a=c;var v=o.type,w=o.stateNode;if(!(o.flags&128)&&(typeof v.getDerivedStateFromError=="function"||w!==null&&typeof w.componentDidCatch=="function"&&(Kn===null||!Kn.has(w)))){o.flags|=65536,t&=-t,o.lanes|=t;var y=lm(o,a,t);Qd(o,y);break e}}o=o.return}while(o!==null)}Om(n)}catch(T){t=T,qe===n&&n!==null&&(qe=n=n.return);continue}break}while(1)}function km(){var e=Ks.current;return Ks.current=Js,e===null?Js:e}function Du(){(Je===0||Je===3||Je===2)&&(Je=4),et===null||!(Cr&268435455)&&!(Ea&268435455)||Fn(et,it)}function Zs(e,t){var n=ke;ke|=2;var r=km();(et!==e||it!==t)&&(Sn=null,yr(e,t));do try{l0();break}catch(i){xm(e,i)}while(1);if(Su(),ke=n,Ks.current=r,qe!==null)throw Error(te(261));return et=null,it=0,Je}function l0(){for(;qe!==null;)Pm(qe)}function c0(){for(;qe!==null&&!Ag();)Pm(qe)}function Pm(e){var t=_m(e.alternate,e,Nt);e.memoizedProps=e.pendingProps,t===null?Om(e):qe=t,Tu.current=null}function Om(e){var t=e;do{var n=t.alternate;if(e=t.return,t.flags&32768){if(n=n0(n,t),n!==null){n.flags&=32767,qe=n;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Je=6,qe=null;return}}else if(n=t0(n,t,Nt),n!==null){qe=n;return}if(t=t.sibling,t!==null){qe=t;return}qe=t=e}while(t!==null);Je===0&&(Je=5)}function pr(e,t,n){var r=Re,i=Bt.transition;try{Bt.transition=null,Re=1,u0(e,t,n,r)}finally{Bt.transition=i,Re=r}return null}function u0(e,t,n,r){do ni();while(Bn!==null);if(ke&6)throw Error(te(327));n=e.finishedWork;var i=e.finishedLanes;if(n===null)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(te(177));e.callbackNode=null,e.callbackPriority=0;var o=n.lanes|n.childLanes;if(Wg(e,o),e===et&&(qe=et=null,it=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||ss||(ss=!0,Im(As,function(){return ni(),null})),o=(n.flags&15990)!==0,n.subtreeFlags&15990||o){o=Bt.transition,Bt.transition=null;var s=Re;Re=1;var a=ke;ke|=4,Tu.current=null,i0(e,n),Em(n,e),Iy(cc),js=!!lc,cc=lc=null,e.current=n,o0(n),Mg(),ke=a,Re=s,Bt.transition=o}else e.current=n;if(ss&&(ss=!1,Bn=e,Ys=i),o=e.pendingLanes,o===0&&(Kn=null),Vg(n.stateNode),_t(e,ze()),t!==null)for(r=e.onRecoverableError,n=0;n<t.length;n++)i=t[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(Qs)throw Qs=!1,e=_c,_c=null,e;return Ys&1&&e.tag!==0&&ni(),o=e.pendingLanes,o&1?e===Ic?to++:(to=0,Ic=e):to=0,sr(),null}function ni(){if(Bn!==null){var e=ah(Ys),t=Bt.transition,n=Re;try{if(Bt.transition=null,Re=16>e?16:e,Bn===null)var r=!1;else{if(e=Bn,Bn=null,Ys=0,ke&6)throw Error(te(331));var i=ke;for(ke|=4,ae=e.current;ae!==null;){var o=ae,s=o.child;if(ae.flags&16){var a=o.deletions;if(a!==null){for(var c=0;c<a.length;c++){var l=a[c];for(ae=l;ae!==null;){var u=ae;switch(u.tag){case 0:case 11:case 15:Zi(8,u,o)}var d=u.child;if(d!==null)d.return=u,ae=d;else for(;ae!==null;){u=ae;var m=u.sibling,g=u.return;if(ym(u),u===l){ae=null;break}if(m!==null){m.return=g,ae=m;break}ae=g}}}var b=o.alternate;if(b!==null){var P=b.child;if(P!==null){b.child=null;do{var k=P.sibling;P.sibling=null,P=k}while(P!==null)}}ae=o}}if(o.subtreeFlags&2064&&s!==null)s.return=o,ae=s;else e:for(;ae!==null;){if(o=ae,o.flags&2048)switch(o.tag){case 0:case 11:case 15:Zi(9,o,o.return)}var f=o.sibling;if(f!==null){f.return=o.return,ae=f;break e}ae=o.return}}var v=e.current;for(ae=v;ae!==null;){s=ae;var w=s.child;if(s.subtreeFlags&2064&&w!==null)w.return=s,ae=w;else e:for(s=v;ae!==null;){if(a=ae,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:wa(9,a)}}catch(T){$e(a,a.return,T)}if(a===s){ae=null;break e}var y=a.sibling;if(y!==null){y.return=a.return,ae=y;break e}ae=a.return}}if(ke=i,sr(),hn&&typeof hn.onPostCommitFiberRoot=="function")try{hn.onPostCommitFiberRoot(fa,e)}catch{}r=!0}return r}finally{Re=n,Bt.transition=t}}return!1}function Sf(e,t,n){t=ci(n,t),t=am(e,t,1),e=Jn(e,t,1),t=Et(),e!==null&&(xo(e,1,t),_t(e,t))}function $e(e,t,n){if(e.tag===3)Sf(e,e,n);else for(;t!==null;){if(t.tag===3){Sf(t,e,n);break}else if(t.tag===1){var r=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Kn===null||!Kn.has(r))){e=ci(n,e),e=lm(t,e,1),t=Jn(t,e,1),e=Et(),t!==null&&(xo(t,1,e),_t(t,e));break}}t=t.return}}function d0(e,t,n){var r=e.pingCache;r!==null&&r.delete(t),t=Et(),e.pingedLanes|=e.suspendedLanes&n,et===e&&(it&n)===n&&(Je===4||Je===3&&(it&130023424)===it&&500>ze()-Au?yr(e,0):Lu|=n),_t(e,t)}function Rm(e,t){t===0&&(e.mode&1?(t=Ko,Ko<<=1,!(Ko&130023424)&&(Ko=4194304)):t=1);var n=Et();e=Pn(e,t),e!==null&&(xo(e,t,n),_t(e,n))}function f0(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),Rm(e,n)}function p0(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,i=e.memoizedState;i!==null&&(n=i.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(te(314))}r!==null&&r.delete(t),Rm(e,n)}var _m;_m=function(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps||Ot.current)Pt=!0;else{if(!(e.lanes&n)&&!(t.flags&128))return Pt=!1,e0(e,t,n);Pt=!!(e.flags&131072)}else Pt=!1,De&&t.flags&1048576&&Lh(t,zs,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;bs(e,t),e=t.pendingProps;var i=oi(t,gt.current);ti(t,n),i=Ou(null,t,r,e,i,n);var o=Ru();return t.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Rt(r)?(o=!0,$s(t)):o=!1,t.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,bu(t),i.updater=Sa,t.stateNode=i,i._reactInternals=t,yc(t,r,e,n),t=Ec(null,t,r,!0,o,n)):(t.tag=0,De&&o&&mu(t),St(null,t,i,n),t=t.child),t;case 16:r=t.elementType;e:{switch(bs(e,t),e=t.pendingProps,i=r._init,r=i(r._payload),t.type=r,i=t.tag=m0(r),e=Kt(r,e),i){case 0:t=wc(null,t,r,e,n);break e;case 1:t=cf(null,t,r,e,n);break e;case 11:t=af(null,t,r,e,n);break e;case 14:t=lf(null,t,r,Kt(r.type,e),n);break e}throw Error(te(306,r,""))}return t;case 0:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:Kt(r,i),wc(e,t,r,i,n);case 1:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:Kt(r,i),cf(e,t,r,i,n);case 3:e:{if(fm(t),e===null)throw Error(te(387));r=t.pendingProps,o=t.memoizedState,i=o.element,Fh(e,t),qs(t,r,null,n);var s=t.memoizedState;if(r=s.element,o.isDehydrated)if(o={element:r,isDehydrated:!1,cache:s.cache,pendingSuspenseBoundaries:s.pendingSuspenseBoundaries,transitions:s.transitions},t.updateQueue.baseState=o,t.memoizedState=o,t.flags&256){i=ci(Error(te(423)),t),t=uf(e,t,r,n,i);break e}else if(r!==i){i=ci(Error(te(424)),t),t=uf(e,t,r,n,i);break e}else for(Lt=Xn(t.stateNode.containerInfo.firstChild),At=t,De=!0,Yt=null,n=Dh(t,null,r,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(si(),r===i){t=On(e,t,n);break e}St(e,t,r,n)}t=t.child}return t;case 5:return Uh(t),e===null&&mc(t),r=t.type,i=t.pendingProps,o=e!==null?e.memoizedProps:null,s=i.children,uc(r,i)?s=null:o!==null&&uc(r,o)&&(t.flags|=32),dm(e,t),St(e,t,s,n),t.child;case 6:return e===null&&mc(t),null;case 13:return pm(e,t,n);case 4:return Cu(t,t.stateNode.containerInfo),r=t.pendingProps,e===null?t.child=ai(t,null,r,n):St(e,t,r,n),t.child;case 11:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:Kt(r,i),af(e,t,r,i,n);case 7:return St(e,t,t.pendingProps,n),t.child;case 8:return St(e,t,t.pendingProps.children,n),t.child;case 12:return St(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,i=t.pendingProps,o=t.memoizedProps,s=i.value,Le(Ws,r._currentValue),r._currentValue=s,o!==null)if(nn(o.value,s)){if(o.children===i.children&&!Ot.current){t=On(e,t,n);break e}}else for(o=t.child,o!==null&&(o.return=t);o!==null;){var a=o.dependencies;if(a!==null){s=o.child;for(var c=a.firstContext;c!==null;){if(c.context===r){if(o.tag===1){c=Cn(-1,n&-n),c.tag=2;var l=o.updateQueue;if(l!==null){l=l.shared;var u=l.pending;u===null?c.next=c:(c.next=u.next,u.next=c),l.pending=c}}o.lanes|=n,c=o.alternate,c!==null&&(c.lanes|=n),vc(o.return,n,t),a.lanes|=n;break}c=c.next}}else if(o.tag===10)s=o.type===t.type?null:o.child;else if(o.tag===18){if(s=o.return,s===null)throw Error(te(341));s.lanes|=n,a=s.alternate,a!==null&&(a.lanes|=n),vc(s,n,t),s=o.sibling}else s=o.child;if(s!==null)s.return=o;else for(s=o;s!==null;){if(s===t){s=null;break}if(o=s.sibling,o!==null){o.return=s.return,s=o;break}s=s.return}o=s}St(e,t,i.children,n),t=t.child}return t;case 9:return i=t.type,r=t.pendingProps.children,ti(t,n),i=zt(i),r=r(i),t.flags|=1,St(e,t,r,n),t.child;case 14:return r=t.type,i=Kt(r,t.pendingProps),i=Kt(r.type,i),lf(e,t,r,i,n);case 15:return cm(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:Kt(r,i),bs(e,t),t.tag=1,Rt(r)?(e=!0,$s(t)):e=!1,ti(t,n),sm(t,r,i),yc(t,r,i,n),Ec(null,t,r,!0,e,n);case 19:return hm(e,t,n);case 22:return um(e,t,n)}throw Error(te(156,t.tag))};function Im(e,t){return rh(e,t)}function h0(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function $t(e,t,n,r){return new h0(e,t,n,r)}function Vu(e){return e=e.prototype,!(!e||!e.isReactComponent)}function m0(e){if(typeof e=="function")return Vu(e)?1:0;if(e!=null){if(e=e.$$typeof,e===ru)return 11;if(e===iu)return 14}return 2}function Yn(e,t){var n=e.alternate;return n===null?(n=$t(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&14680064,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function ks(e,t,n,r,i,o){var s=2;if(r=e,typeof e=="function")Vu(e)&&(s=1);else if(typeof e=="string")s=5;else e:switch(e){case Fr:return Sr(n.children,i,o,t);case nu:s=8,i|=8;break;case Bl:return e=$t(12,n,t,i|2),e.elementType=Bl,e.lanes=o,e;case zl:return e=$t(13,n,t,i),e.elementType=zl,e.lanes=o,e;case Wl:return e=$t(19,n,t,i),e.elementType=Wl,e.lanes=o,e;case Up:return ba(n,i,o,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case Vp:s=10;break e;case Fp:s=9;break e;case ru:s=11;break e;case iu:s=14;break e;case jn:s=16,r=null;break e}throw Error(te(130,e==null?e:typeof e,""))}return t=$t(s,n,t,i),t.elementType=e,t.type=r,t.lanes=o,t}function Sr(e,t,n,r){return e=$t(7,e,r,t),e.lanes=n,e}function ba(e,t,n,r){return e=$t(22,e,r,t),e.elementType=Up,e.lanes=n,e.stateNode={isHidden:!1},e}function yl(e,t,n){return e=$t(6,e,null,t),e.lanes=n,e}function Sl(e,t,n){return t=$t(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function v0(e,t,n,r,i){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Za(0),this.expirationTimes=Za(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Za(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function Fu(e,t,n,r,i,o,s,a,c){return e=new v0(e,t,n,a,c),t===1?(t=1,o===!0&&(t|=8)):t=0,o=$t(3,null,null,t),e.current=o,o.stateNode=e,o.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},bu(o),e}function g0(e,t,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Vr,key:r==null?null:""+r,children:e,containerInfo:t,implementation:n}}function Nm(e){if(!e)return rr;e=e._reactInternals;e:{if(Or(e)!==e||e.tag!==1)throw Error(te(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Rt(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(te(171))}if(e.tag===1){var n=e.type;if(Rt(n))return Nh(e,n,t)}return t}function Tm(e,t,n,r,i,o,s,a,c){return e=Fu(n,r,!0,e,i,o,s,a,c),e.context=Nm(null),n=e.current,r=Et(),i=Qn(n),o=Cn(r,i),o.callback=t??null,Jn(n,o,i),e.current.lanes=i,xo(e,i,r),_t(e,r),e}function Ca(e,t,n,r){var i=t.current,o=Et(),s=Qn(i);return n=Nm(n),t.context===null?t.context=n:t.pendingContext=n,t=Cn(o,s),t.payload={element:e},r=r===void 0?null:r,r!==null&&(t.callback=r),e=Jn(i,t,s),e!==null&&(en(e,i,s,o),Ss(e,i,s)),s}function ea(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function wf(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function Uu(e,t){wf(e,t),(e=e.alternate)&&wf(e,t)}function y0(){return null}var Lm=typeof reportError=="function"?reportError:function(e){console.error(e)};function $u(e){this._internalRoot=e}xa.prototype.render=$u.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(te(409));Ca(e,t,null,null)};xa.prototype.unmount=$u.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;xr(function(){Ca(null,e,null,null)}),t[kn]=null}};function xa(e){this._internalRoot=e}xa.prototype.unstable_scheduleHydration=function(e){if(e){var t=uh();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Vn.length&&t!==0&&t<Vn[n].priority;n++);Vn.splice(n,0,e),n===0&&fh(e)}};function Bu(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function ka(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function Ef(){}function S0(e,t,n,r,i){if(i){if(typeof r=="function"){var o=r;r=function(){var l=ea(s);o.call(l)}}var s=Tm(t,r,e,0,null,!1,!1,"",Ef);return e._reactRootContainer=s,e[kn]=s.current,uo(e.nodeType===8?e.parentNode:e),xr(),s}for(;i=e.lastChild;)e.removeChild(i);if(typeof r=="function"){var a=r;r=function(){var l=ea(c);a.call(l)}}var c=Fu(e,0,!1,null,null,!1,!1,"",Ef);return e._reactRootContainer=c,e[kn]=c.current,uo(e.nodeType===8?e.parentNode:e),xr(function(){Ca(t,c,n,r)}),c}function Pa(e,t,n,r,i){var o=n._reactRootContainer;if(o){var s=o;if(typeof i=="function"){var a=i;i=function(){var c=ea(s);a.call(c)}}Ca(t,s,e,i)}else s=S0(n,t,e,i,r);return ea(s)}lh=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=Hi(t.pendingLanes);n!==0&&(au(t,n|1),_t(t,ze()),!(ke&6)&&(ui=ze()+500,sr()))}break;case 13:xr(function(){var r=Pn(e,1);if(r!==null){var i=Et();en(r,e,1,i)}}),Uu(e,1)}};lu=function(e){if(e.tag===13){var t=Pn(e,134217728);if(t!==null){var n=Et();en(t,e,134217728,n)}Uu(e,134217728)}};ch=function(e){if(e.tag===13){var t=Qn(e),n=Pn(e,t);if(n!==null){var r=Et();en(n,e,t,r)}Uu(e,t)}};uh=function(){return Re};dh=function(e,t){var n=Re;try{return Re=e,t()}finally{Re=n}};ec=function(e,t,n){switch(t){case"input":if(Gl(e,n),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var i=va(r);if(!i)throw Error(te(90));Bp(r),Gl(r,i)}}}break;case"textarea":Wp(e,n);break;case"select":t=n.value,t!=null&&Qr(e,!!n.multiple,t,!1)}};Qp=Mu;Yp=xr;var w0={usingClientEntryPoint:!1,Events:[Po,zr,va,Jp,Kp,Mu]},Di={findFiberByHostInstance:hr,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},E0={bundleType:Di.bundleType,version:Di.version,rendererPackageName:Di.rendererPackageName,rendererConfig:Di.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:_n.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=th(e),e===null?null:e.stateNode},findFiberByHostInstance:Di.findFiberByHostInstance||y0,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var as=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!as.isDisabled&&as.supportsFiber)try{fa=as.inject(E0),hn=as}catch{}}jt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=w0;jt.createPortal=function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Bu(t))throw Error(te(200));return g0(e,t,null,n)};jt.createRoot=function(e,t){if(!Bu(e))throw Error(te(299));var n=!1,r="",i=Lm;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(r=t.identifierPrefix),t.onRecoverableError!==void 0&&(i=t.onRecoverableError)),t=Fu(e,1,!1,null,null,n,!1,r,i),e[kn]=t.current,uo(e.nodeType===8?e.parentNode:e),new $u(t)};jt.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(te(188)):(e=Object.keys(e).join(","),Error(te(268,e)));return e=th(t),e=e===null?null:e.stateNode,e};jt.flushSync=function(e){return xr(e)};jt.hydrate=function(e,t,n){if(!ka(t))throw Error(te(200));return Pa(null,e,t,!0,n)};jt.hydrateRoot=function(e,t,n){if(!Bu(e))throw Error(te(405));var r=n!=null&&n.hydratedSources||null,i=!1,o="",s=Lm;if(n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(o=n.identifierPrefix),n.onRecoverableError!==void 0&&(s=n.onRecoverableError)),t=Tm(t,null,e,1,n??null,i,!1,o,s),e[kn]=t.current,uo(e),r)for(e=0;e<r.length;e++)n=r[e],i=n._getVersion,i=i(n._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[n,i]:t.mutableSourceEagerHydrationData.push(n,i);return new xa(t)};jt.render=function(e,t,n){if(!ka(t))throw Error(te(200));return Pa(null,e,t,!1,n)};jt.unmountComponentAtNode=function(e){if(!ka(e))throw Error(te(40));return e._reactRootContainer?(xr(function(){Pa(null,null,e,!1,function(){e._reactRootContainer=null,e[kn]=null})}),!0):!1};jt.unstable_batchedUpdates=Mu;jt.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!ka(n))throw Error(te(200));if(e==null||e._reactInternals===void 0)throw Error(te(38));return Pa(e,t,n,!1,r)};jt.version="18.3.1-next-f1338f8080-20240426";function Am(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Am)}catch(e){console.error(e)}}Am(),Ap.exports=jt;var b0=Ap.exports,bf=b0;Ul.createRoot=bf.createRoot,Ul.hydrateRoot=bf.hydrateRoot;/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function wo(){return wo=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},wo.apply(this,arguments)}var zn;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(zn||(zn={}));const Cf="popstate";function C0(e){e===void 0&&(e={});function t(r,i){let{pathname:o,search:s,hash:a}=r.location;return Lc("",{pathname:o,search:s,hash:a},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function n(r,i){return typeof i=="string"?i:ta(i)}return k0(t,n,null,e)}function We(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function Mm(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function x0(){return Math.random().toString(36).substr(2,8)}function xf(e,t){return{usr:e.state,key:e.key,idx:t}}function Lc(e,t,n,r){return n===void 0&&(n=null),wo({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof t=="string"?hi(t):t,{state:n,key:t&&t.key||r||x0()})}function ta(e){let{pathname:t="/",search:n="",hash:r=""}=e;return n&&n!=="?"&&(t+=n.charAt(0)==="?"?n:"?"+n),r&&r!=="#"&&(t+=r.charAt(0)==="#"?r:"#"+r),t}function hi(e){let t={};if(e){let n=e.indexOf("#");n>=0&&(t.hash=e.substr(n),e=e.substr(0,n));let r=e.indexOf("?");r>=0&&(t.search=e.substr(r),e=e.substr(0,r)),e&&(t.pathname=e)}return t}function k0(e,t,n,r){r===void 0&&(r={});let{window:i=document.defaultView,v5Compat:o=!1}=r,s=i.history,a=zn.Pop,c=null,l=u();l==null&&(l=0,s.replaceState(wo({},s.state,{idx:l}),""));function u(){return(s.state||{idx:null}).idx}function d(){a=zn.Pop;let k=u(),f=k==null?null:k-l;l=k,c&&c({action:a,location:P.location,delta:f})}function m(k,f){a=zn.Push;let v=Lc(P.location,k,f);n&&n(v,k),l=u()+1;let w=xf(v,l),y=P.createHref(v);try{s.pushState(w,"",y)}catch(T){if(T instanceof DOMException&&T.name==="DataCloneError")throw T;i.location.assign(y)}o&&c&&c({action:a,location:P.location,delta:1})}function g(k,f){a=zn.Replace;let v=Lc(P.location,k,f);n&&n(v,k),l=u();let w=xf(v,l),y=P.createHref(v);s.replaceState(w,"",y),o&&c&&c({action:a,location:P.location,delta:0})}function b(k){let f=i.location.origin!=="null"?i.location.origin:i.location.href,v=typeof k=="string"?k:ta(k);return v=v.replace(/ $/,"%20"),We(f,"No window.location.(origin|href) available to create URL for href: "+v),new URL(v,f)}let P={get action(){return a},get location(){return e(i,s)},listen(k){if(c)throw new Error("A history only accepts one active listener");return i.addEventListener(Cf,d),c=k,()=>{i.removeEventListener(Cf,d),c=null}},createHref(k){return t(i,k)},createURL:b,encodeLocation(k){let f=b(k);return{pathname:f.pathname,search:f.search,hash:f.hash}},push:m,replace:g,go(k){return s.go(k)}};return P}var kf;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(kf||(kf={}));function P0(e,t,n){return n===void 0&&(n="/"),O0(e,t,n,!1)}function O0(e,t,n,r){let i=typeof t=="string"?hi(t):t,o=zu(i.pathname||"/",n);if(o==null)return null;let s=jm(e);R0(s);let a=null;for(let c=0;a==null&&c<s.length;++c){let l=F0(o);a=D0(s[c],l,r)}return a}function jm(e,t,n,r){t===void 0&&(t=[]),n===void 0&&(n=[]),r===void 0&&(r="");let i=(o,s,a)=>{let c={relativePath:a===void 0?o.path||"":a,caseSensitive:o.caseSensitive===!0,childrenIndex:s,route:o};c.relativePath.startsWith("/")&&(We(c.relativePath.startsWith(r),'Absolute route path "'+c.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),c.relativePath=c.relativePath.slice(r.length));let l=Zn([r,c.relativePath]),u=n.concat(c);o.children&&o.children.length>0&&(We(o.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+l+'".')),jm(o.children,t,u,l)),!(o.path==null&&!o.index)&&t.push({path:l,score:M0(l,o.index),routesMeta:u})};return e.forEach((o,s)=>{var a;if(o.path===""||!((a=o.path)!=null&&a.includes("?")))i(o,s);else for(let c of Dm(o.path))i(o,s,c)}),t}function Dm(e){let t=e.split("/");if(t.length===0)return[];let[n,...r]=t,i=n.endsWith("?"),o=n.replace(/\?$/,"");if(r.length===0)return i?[o,""]:[o];let s=Dm(r.join("/")),a=[];return a.push(...s.map(c=>c===""?o:[o,c].join("/"))),i&&a.push(...s),a.map(c=>e.startsWith("/")&&c===""?"/":c)}function R0(e){e.sort((t,n)=>t.score!==n.score?n.score-t.score:j0(t.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}const _0=/^:[\w-]+$/,I0=3,N0=2,T0=1,L0=10,A0=-2,Pf=e=>e==="*";function M0(e,t){let n=e.split("/"),r=n.length;return n.some(Pf)&&(r+=A0),t&&(r+=N0),n.filter(i=>!Pf(i)).reduce((i,o)=>i+(_0.test(o)?I0:o===""?T0:L0),r)}function j0(e,t){return e.length===t.length&&e.slice(0,-1).every((r,i)=>r===t[i])?e[e.length-1]-t[t.length-1]:0}function D0(e,t,n){n===void 0&&(n=!1);let{routesMeta:r}=e,i={},o="/",s=[];for(let a=0;a<r.length;++a){let c=r[a],l=a===r.length-1,u=o==="/"?t:t.slice(o.length)||"/",d=Of({path:c.relativePath,caseSensitive:c.caseSensitive,end:l},u),m=c.route;if(!d&&l&&n&&!r[r.length-1].route.index&&(d=Of({path:c.relativePath,caseSensitive:c.caseSensitive,end:!1},u)),!d)return null;Object.assign(i,d.params),s.push({params:i,pathname:Zn([o,d.pathname]),pathnameBase:z0(Zn([o,d.pathnameBase])),route:m}),d.pathnameBase!=="/"&&(o=Zn([o,d.pathnameBase]))}return s}function Of(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[n,r]=V0(e.path,e.caseSensitive,e.end),i=t.match(n);if(!i)return null;let o=i[0],s=o.replace(/(.)\/+$/,"$1"),a=i.slice(1);return{params:r.reduce((l,u,d)=>{let{paramName:m,isOptional:g}=u;if(m==="*"){let P=a[d]||"";s=o.slice(0,o.length-P.length).replace(/(.)\/+$/,"$1")}const b=a[d];return g&&!b?l[m]=void 0:l[m]=(b||"").replace(/%2F/g,"/"),l},{}),pathname:o,pathnameBase:s,pattern:e}}function V0(e,t,n){t===void 0&&(t=!1),n===void 0&&(n=!0),Mm(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let r=[],i="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(s,a,c)=>(r.push({paramName:a,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(r.push({paramName:"*"}),i+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?i+="\\/*$":e!==""&&e!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,t?void 0:"i"),r]}function F0(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return Mm(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),e}}function zu(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let n=t.endsWith("/")?t.length-1:t.length,r=e.charAt(n);return r&&r!=="/"?null:e.slice(n)||"/"}function U0(e,t){t===void 0&&(t="/");let{pathname:n,search:r="",hash:i=""}=typeof e=="string"?hi(e):e;return{pathname:n?n.startsWith("/")?n:$0(n,t):t,search:W0(r),hash:H0(i)}}function $0(e,t){let n=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(i=>{i===".."?n.length>1&&n.pop():i!=="."&&n.push(i)}),n.length>1?n.join("/"):"/"}function wl(e,t,n,r){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function B0(e){return e.filter((t,n)=>n===0||t.route.path&&t.route.path.length>0)}function Wu(e,t){let n=B0(e);return t?n.map((r,i)=>i===n.length-1?r.pathname:r.pathnameBase):n.map(r=>r.pathnameBase)}function Hu(e,t,n,r){r===void 0&&(r=!1);let i;typeof e=="string"?i=hi(e):(i=wo({},e),We(!i.pathname||!i.pathname.includes("?"),wl("?","pathname","search",i)),We(!i.pathname||!i.pathname.includes("#"),wl("#","pathname","hash",i)),We(!i.search||!i.search.includes("#"),wl("#","search","hash",i)));let o=e===""||i.pathname==="",s=o?"/":i.pathname,a;if(s==null)a=n;else{let d=t.length-1;if(!r&&s.startsWith("..")){let m=s.split("/");for(;m[0]==="..";)m.shift(),d-=1;i.pathname=m.join("/")}a=d>=0?t[d]:"/"}let c=U0(i,a),l=s&&s!=="/"&&s.endsWith("/"),u=(o||s===".")&&n.endsWith("/");return!c.pathname.endsWith("/")&&(l||u)&&(c.pathname+="/"),c}const Zn=e=>e.join("/").replace(/\/\/+/g,"/"),z0=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),W0=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,H0=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function q0(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const Vm=["post","put","patch","delete"];new Set(Vm);const G0=["get",...Vm];new Set(G0);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Eo(){return Eo=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Eo.apply(this,arguments)}const qu=R.createContext(null),X0=R.createContext(null),ar=R.createContext(null),Oa=R.createContext(null),In=R.createContext({outlet:null,matches:[],isDataRoute:!1}),Fm=R.createContext(null);function J0(e,t){let{relative:n}=t===void 0?{}:t;mi()||We(!1);let{basename:r,navigator:i}=R.useContext(ar),{hash:o,pathname:s,search:a}=Bm(e,{relative:n}),c=s;return r!=="/"&&(c=s==="/"?r:Zn([r,s])),i.createHref({pathname:c,search:a,hash:o})}function mi(){return R.useContext(Oa)!=null}function Ht(){return mi()||We(!1),R.useContext(Oa).location}function Um(e){R.useContext(ar).static||R.useLayoutEffect(e)}function vn(){let{isDataRoute:e}=R.useContext(In);return e?lS():K0()}function K0(){mi()||We(!1);let e=R.useContext(qu),{basename:t,future:n,navigator:r}=R.useContext(ar),{matches:i}=R.useContext(In),{pathname:o}=Ht(),s=JSON.stringify(Wu(i,n.v7_relativeSplatPath)),a=R.useRef(!1);return Um(()=>{a.current=!0}),R.useCallback(function(l,u){if(u===void 0&&(u={}),!a.current)return;if(typeof l=="number"){r.go(l);return}let d=Hu(l,JSON.parse(s),o,u.relative==="path");e==null&&t!=="/"&&(d.pathname=d.pathname==="/"?t:Zn([t,d.pathname])),(u.replace?r.replace:r.push)(d,u.state,u)},[t,r,s,o,e])}function $m(){let{matches:e}=R.useContext(In),t=e[e.length-1];return t?t.params:{}}function Bm(e,t){let{relative:n}=t===void 0?{}:t,{future:r}=R.useContext(ar),{matches:i}=R.useContext(In),{pathname:o}=Ht(),s=JSON.stringify(Wu(i,r.v7_relativeSplatPath));return R.useMemo(()=>Hu(e,JSON.parse(s),o,n==="path"),[e,s,o,n])}function Q0(e,t){return Y0(e,t)}function Y0(e,t,n,r){mi()||We(!1);let{navigator:i}=R.useContext(ar),{matches:o}=R.useContext(In),s=o[o.length-1],a=s?s.params:{};s&&s.pathname;let c=s?s.pathnameBase:"/";s&&s.route;let l=Ht(),u;if(t){var d;let k=typeof t=="string"?hi(t):t;c==="/"||(d=k.pathname)!=null&&d.startsWith(c)||We(!1),u=k}else u=l;let m=u.pathname||"/",g=m;if(c!=="/"){let k=c.replace(/^\//,"").split("/");g="/"+m.replace(/^\//,"").split("/").slice(k.length).join("/")}let b=P0(e,{pathname:g}),P=rS(b&&b.map(k=>Object.assign({},k,{params:Object.assign({},a,k.params),pathname:Zn([c,i.encodeLocation?i.encodeLocation(k.pathname).pathname:k.pathname]),pathnameBase:k.pathnameBase==="/"?c:Zn([c,i.encodeLocation?i.encodeLocation(k.pathnameBase).pathname:k.pathnameBase])})),o,n,r);return t&&P?R.createElement(Oa.Provider,{value:{location:Eo({pathname:"/",search:"",hash:"",state:null,key:"default"},u),navigationType:zn.Pop}},P):P}function Z0(){let e=aS(),t=q0(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),n=e instanceof Error?e.stack:null,i={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"},o=null;return R.createElement(R.Fragment,null,R.createElement("h2",null,"Unexpected Application Error!"),R.createElement("h3",{style:{fontStyle:"italic"}},t),n?R.createElement("pre",{style:i},n):null,o)}const eS=R.createElement(Z0,null);class tS extends R.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,n){return n.location!==t.location||n.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:n.error,location:n.location,revalidation:t.revalidation||n.revalidation}}componentDidCatch(t,n){console.error("React Router caught the following error during render",t,n)}render(){return this.state.error!==void 0?R.createElement(In.Provider,{value:this.props.routeContext},R.createElement(Fm.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function nS(e){let{routeContext:t,match:n,children:r}=e,i=R.useContext(qu);return i&&i.static&&i.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=n.route.id),R.createElement(In.Provider,{value:t},r)}function rS(e,t,n,r){var i;if(t===void 0&&(t=[]),n===void 0&&(n=null),r===void 0&&(r=null),e==null){var o;if(!n)return null;if(n.errors)e=n.matches;else if((o=r)!=null&&o.v7_partialHydration&&t.length===0&&!n.initialized&&n.matches.length>0)e=n.matches;else return null}let s=e,a=(i=n)==null?void 0:i.errors;if(a!=null){let u=s.findIndex(d=>d.route.id&&a?.[d.route.id]!==void 0);u>=0||We(!1),s=s.slice(0,Math.min(s.length,u+1))}let c=!1,l=-1;if(n&&r&&r.v7_partialHydration)for(let u=0;u<s.length;u++){let d=s[u];if((d.route.HydrateFallback||d.route.hydrateFallbackElement)&&(l=u),d.route.id){let{loaderData:m,errors:g}=n,b=d.route.loader&&m[d.route.id]===void 0&&(!g||g[d.route.id]===void 0);if(d.route.lazy||b){c=!0,l>=0?s=s.slice(0,l+1):s=[s[0]];break}}}return s.reduceRight((u,d,m)=>{let g,b=!1,P=null,k=null;n&&(g=a&&d.route.id?a[d.route.id]:void 0,P=d.route.errorElement||eS,c&&(l<0&&m===0?(cS("route-fallback",!1),b=!0,k=null):l===m&&(b=!0,k=d.route.hydrateFallbackElement||null)));let f=t.concat(s.slice(0,m+1)),v=()=>{let w;return g?w=P:b?w=k:d.route.Component?w=R.createElement(d.route.Component,null):d.route.element?w=d.route.element:w=u,R.createElement(nS,{match:d,routeContext:{outlet:u,matches:f,isDataRoute:n!=null},children:w})};return n&&(d.route.ErrorBoundary||d.route.errorElement||m===0)?R.createElement(tS,{location:n.location,revalidation:n.revalidation,component:P,error:g,children:v(),routeContext:{outlet:null,matches:f,isDataRoute:!0}}):v()},null)}var zm=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(zm||{}),na=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(na||{});function iS(e){let t=R.useContext(qu);return t||We(!1),t}function oS(e){let t=R.useContext(X0);return t||We(!1),t}function sS(e){let t=R.useContext(In);return t||We(!1),t}function Wm(e){let t=sS(),n=t.matches[t.matches.length-1];return n.route.id||We(!1),n.route.id}function aS(){var e;let t=R.useContext(Fm),n=oS(na.UseRouteError),r=Wm(na.UseRouteError);return t!==void 0?t:(e=n.errors)==null?void 0:e[r]}function lS(){let{router:e}=iS(zm.UseNavigateStable),t=Wm(na.UseNavigateStable),n=R.useRef(!1);return Um(()=>{n.current=!0}),R.useCallback(function(i,o){o===void 0&&(o={}),n.current&&(typeof i=="number"?e.navigate(i):e.navigate(i,Eo({fromRouteId:t},o)))},[e,t])}const Rf={};function cS(e,t,n){!t&&!Rf[e]&&(Rf[e]=!0)}function uS(e,t){e?.v7_startTransition,e?.v7_relativeSplatPath===void 0&&(!t||t.v7_relativeSplatPath),t&&(t.v7_fetcherPersist,t.v7_normalizeFormMethod,t.v7_partialHydration,t.v7_skipActionErrorRevalidation)}function Hm(e){let{to:t,replace:n,state:r,relative:i}=e;mi()||We(!1);let{future:o,static:s}=R.useContext(ar),{matches:a}=R.useContext(In),{pathname:c}=Ht(),l=vn(),u=Hu(t,Wu(a,o.v7_relativeSplatPath),c,i==="path"),d=JSON.stringify(u);return R.useEffect(()=>l(JSON.parse(d),{replace:n,state:r,relative:i}),[l,d,i,n,r]),null}function Jt(e){We(!1)}function dS(e){let{basename:t="/",children:n=null,location:r,navigationType:i=zn.Pop,navigator:o,static:s=!1,future:a}=e;mi()&&We(!1);let c=t.replace(/^\/*/,"/"),l=R.useMemo(()=>({basename:c,navigator:o,static:s,future:Eo({v7_relativeSplatPath:!1},a)}),[c,a,o,s]);typeof r=="string"&&(r=hi(r));let{pathname:u="/",search:d="",hash:m="",state:g=null,key:b="default"}=r,P=R.useMemo(()=>{let k=zu(u,c);return k==null?null:{location:{pathname:k,search:d,hash:m,state:g,key:b},navigationType:i}},[c,u,d,m,g,b,i]);return P==null?null:R.createElement(ar.Provider,{value:l},R.createElement(Oa.Provider,{children:n,value:P}))}function fS(e){let{children:t,location:n}=e;return Q0(Ac(t),n)}new Promise(()=>{});function Ac(e,t){t===void 0&&(t=[]);let n=[];return R.Children.forEach(e,(r,i)=>{if(!R.isValidElement(r))return;let o=[...t,i];if(r.type===R.Fragment){n.push.apply(n,Ac(r.props.children,o));return}r.type!==Jt&&We(!1),!r.props.index||!r.props.children||We(!1);let s={id:r.props.id||o.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(s.children=Ac(r.props.children,o)),n.push(s)}),n}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Mc(){return Mc=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Mc.apply(this,arguments)}function pS(e,t){if(e==null)return{};var n={},r=Object.keys(e),i,o;for(o=0;o<r.length;o++)i=r[o],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}function hS(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function mS(e,t){return e.button===0&&(!t||t==="_self")&&!hS(e)}function jc(e){return e===void 0&&(e=""),new URLSearchParams(typeof e=="string"||Array.isArray(e)||e instanceof URLSearchParams?e:Object.keys(e).reduce((t,n)=>{let r=e[n];return t.concat(Array.isArray(r)?r.map(i=>[n,i]):[[n,r]])},[]))}function vS(e,t){let n=jc(e);return t&&t.forEach((r,i)=>{n.has(i)||t.getAll(i).forEach(o=>{n.append(i,o)})}),n}const gS=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],yS="6";try{window.__reactRouterVersion=yS}catch{}const SS="startTransition",_f=dg[SS];function wS(e){let{basename:t,children:n,future:r,window:i}=e,o=R.useRef();o.current==null&&(o.current=C0({window:i,v5Compat:!0}));let s=o.current,[a,c]=R.useState({action:s.action,location:s.location}),{v7_startTransition:l}=r||{},u=R.useCallback(d=>{l&&_f?_f(()=>c(d)):c(d)},[c,l]);return R.useLayoutEffect(()=>s.listen(u),[s,u]),R.useEffect(()=>uS(r),[r]),R.createElement(dS,{basename:t,children:n,location:a.location,navigationType:a.action,navigator:s,future:r})}const ES=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",bS=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,qm=R.forwardRef(function(t,n){let{onClick:r,relative:i,reloadDocument:o,replace:s,state:a,target:c,to:l,preventScrollReset:u,viewTransition:d}=t,m=pS(t,gS),{basename:g}=R.useContext(ar),b,P=!1;if(typeof l=="string"&&bS.test(l)&&(b=l,ES))try{let w=new URL(window.location.href),y=l.startsWith("//")?new URL(w.protocol+l):new URL(l),T=zu(y.pathname,g);y.origin===w.origin&&T!=null?l=T+y.search+y.hash:P=!0}catch{}let k=J0(l,{relative:i}),f=CS(l,{replace:s,state:a,target:c,preventScrollReset:u,relative:i,viewTransition:d});function v(w){r&&r(w),w.defaultPrevented||f(w)}return R.createElement("a",Mc({},m,{href:b||k,onClick:P||o?r:v,ref:n,target:c}))});var If;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(If||(If={}));var Nf;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(Nf||(Nf={}));function CS(e,t){let{target:n,replace:r,state:i,preventScrollReset:o,relative:s,viewTransition:a}=t===void 0?{}:t,c=vn(),l=Ht(),u=Bm(e,{relative:s});return R.useCallback(d=>{if(mS(d,n)){d.preventDefault();let m=r!==void 0?r:ta(l)===ta(u);c(e,{replace:m,state:i,preventScrollReset:o,relative:s,viewTransition:a})}},[l,c,u,r,i,n,e,o,s,a])}function xS(e){let t=R.useRef(jc(e)),n=R.useRef(!1),r=Ht(),i=R.useMemo(()=>vS(r.search,n.current?null:t.current),[r.search]),o=vn(),s=R.useCallback((a,c)=>{const l=jc(typeof a=="function"?a(i):a);n.current=!0,o("?"+l,c)},[o,i]);return[i,s]}function Gm(e,t){return function(){return e.apply(t,arguments)}}const{toString:kS}=Object.prototype,{getPrototypeOf:Gu}=Object,{iterator:Ra,toStringTag:Xm}=Symbol,_a=(e=>t=>{const n=kS.call(t);return e[n]||(e[n]=n.slice(8,-1).toLowerCase())})(Object.create(null)),rn=e=>(e=e.toLowerCase(),t=>_a(t)===e),Ia=e=>t=>typeof t===e,{isArray:vi}=Array,bo=Ia("undefined");function Ro(e){return e!==null&&!bo(e)&&e.constructor!==null&&!bo(e.constructor)&&It(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const Jm=rn("ArrayBuffer");function PS(e){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(e):t=e&&e.buffer&&Jm(e.buffer),t}const OS=Ia("string"),It=Ia("function"),Km=Ia("number"),_o=e=>e!==null&&typeof e=="object",RS=e=>e===!0||e===!1,Ps=e=>{if(_a(e)!=="object")return!1;const t=Gu(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Xm in e)&&!(Ra in e)},_S=e=>{if(!_o(e)||Ro(e))return!1;try{return Object.keys(e).length===0&&Object.getPrototypeOf(e)===Object.prototype}catch{return!1}},IS=rn("Date"),NS=rn("File"),TS=rn("Blob"),LS=rn("FileList"),AS=e=>_o(e)&&It(e.pipe),MS=e=>{let t;return e&&(typeof FormData=="function"&&e instanceof FormData||It(e.append)&&((t=_a(e))==="formdata"||t==="object"&&It(e.toString)&&e.toString()==="[object FormData]"))},jS=rn("URLSearchParams"),[DS,VS,FS,US]=["ReadableStream","Request","Response","Headers"].map(rn),$S=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function Io(e,t,{allOwnKeys:n=!1}={}){if(e===null||typeof e>"u")return;let r,i;if(typeof e!="object"&&(e=[e]),vi(e))for(r=0,i=e.length;r<i;r++)t.call(null,e[r],r,e);else{if(Ro(e))return;const o=n?Object.getOwnPropertyNames(e):Object.keys(e),s=o.length;let a;for(r=0;r<s;r++)a=o[r],t.call(null,e[a],a,e)}}function Qm(e,t){if(Ro(e))return null;t=t.toLowerCase();const n=Object.keys(e);let r=n.length,i;for(;r-- >0;)if(i=n[r],t===i.toLowerCase())return i;return null}const gr=(()=>typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global)(),Ym=e=>!bo(e)&&e!==gr;function Dc(){const{caseless:e}=Ym(this)&&this||{},t={},n=(r,i)=>{const o=e&&Qm(t,i)||i;Ps(t[o])&&Ps(r)?t[o]=Dc(t[o],r):Ps(r)?t[o]=Dc({},r):vi(r)?t[o]=r.slice():t[o]=r};for(let r=0,i=arguments.length;r<i;r++)arguments[r]&&Io(arguments[r],n);return t}const BS=(e,t,n,{allOwnKeys:r}={})=>(Io(t,(i,o)=>{n&&It(i)?e[o]=Gm(i,n):e[o]=i},{allOwnKeys:r}),e),zS=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),WS=(e,t,n,r)=>{e.prototype=Object.create(t.prototype,r),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),n&&Object.assign(e.prototype,n)},HS=(e,t,n,r)=>{let i,o,s;const a={};if(t=t||{},e==null)return t;do{for(i=Object.getOwnPropertyNames(e),o=i.length;o-- >0;)s=i[o],(!r||r(s,e,t))&&!a[s]&&(t[s]=e[s],a[s]=!0);e=n!==!1&&Gu(e)}while(e&&(!n||n(e,t))&&e!==Object.prototype);return t},qS=(e,t,n)=>{e=String(e),(n===void 0||n>e.length)&&(n=e.length),n-=t.length;const r=e.indexOf(t,n);return r!==-1&&r===n},GS=e=>{if(!e)return null;if(vi(e))return e;let t=e.length;if(!Km(t))return null;const n=new Array(t);for(;t-- >0;)n[t]=e[t];return n},XS=(e=>t=>e&&t instanceof e)(typeof Uint8Array<"u"&&Gu(Uint8Array)),JS=(e,t)=>{const r=(e&&e[Ra]).call(e);let i;for(;(i=r.next())&&!i.done;){const o=i.value;t.call(e,o[0],o[1])}},KS=(e,t)=>{let n;const r=[];for(;(n=e.exec(t))!==null;)r.push(n);return r},QS=rn("HTMLFormElement"),YS=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(n,r,i){return r.toUpperCase()+i}),Tf=(({hasOwnProperty:e})=>(t,n)=>e.call(t,n))(Object.prototype),ZS=rn("RegExp"),Zm=(e,t)=>{const n=Object.getOwnPropertyDescriptors(e),r={};Io(n,(i,o)=>{let s;(s=t(i,o,e))!==!1&&(r[o]=s||i)}),Object.defineProperties(e,r)},ew=e=>{Zm(e,(t,n)=>{if(It(e)&&["arguments","caller","callee"].indexOf(n)!==-1)return!1;const r=e[n];if(It(r)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+n+"'")})}})},tw=(e,t)=>{const n={},r=i=>{i.forEach(o=>{n[o]=!0})};return vi(e)?r(e):r(String(e).split(t)),n},nw=()=>{},rw=(e,t)=>e!=null&&Number.isFinite(e=+e)?e:t;function iw(e){return!!(e&&It(e.append)&&e[Xm]==="FormData"&&e[Ra])}const ow=e=>{const t=new Array(10),n=(r,i)=>{if(_o(r)){if(t.indexOf(r)>=0)return;if(Ro(r))return r;if(!("toJSON"in r)){t[i]=r;const o=vi(r)?[]:{};return Io(r,(s,a)=>{const c=n(s,i+1);!bo(c)&&(o[a]=c)}),t[i]=void 0,o}}return r};return n(e,0)},sw=rn("AsyncFunction"),aw=e=>e&&(_o(e)||It(e))&&It(e.then)&&It(e.catch),ev=((e,t)=>e?setImmediate:t?((n,r)=>(gr.addEventListener("message",({source:i,data:o})=>{i===gr&&o===n&&r.length&&r.shift()()},!1),i=>{r.push(i),gr.postMessage(n,"*")}))(`axios@${Math.random()}`,[]):n=>setTimeout(n))(typeof setImmediate=="function",It(gr.postMessage)),lw=typeof queueMicrotask<"u"?queueMicrotask.bind(gr):typeof process<"u"&&process.nextTick||ev,cw=e=>e!=null&&It(e[Ra]),z={isArray:vi,isArrayBuffer:Jm,isBuffer:Ro,isFormData:MS,isArrayBufferView:PS,isString:OS,isNumber:Km,isBoolean:RS,isObject:_o,isPlainObject:Ps,isEmptyObject:_S,isReadableStream:DS,isRequest:VS,isResponse:FS,isHeaders:US,isUndefined:bo,isDate:IS,isFile:NS,isBlob:TS,isRegExp:ZS,isFunction:It,isStream:AS,isURLSearchParams:jS,isTypedArray:XS,isFileList:LS,forEach:Io,merge:Dc,extend:BS,trim:$S,stripBOM:zS,inherits:WS,toFlatObject:HS,kindOf:_a,kindOfTest:rn,endsWith:qS,toArray:GS,forEachEntry:JS,matchAll:KS,isHTMLForm:QS,hasOwnProperty:Tf,hasOwnProp:Tf,reduceDescriptors:Zm,freezeMethods:ew,toObjectSet:tw,toCamelCase:YS,noop:nw,toFiniteNumber:rw,findKey:Qm,global:gr,isContextDefined:Ym,isSpecCompliantForm:iw,toJSONObject:ow,isAsyncFn:sw,isThenable:aw,setImmediate:ev,asap:lw,isIterable:cw};function ge(e,t,n,r,i){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",t&&(this.code=t),n&&(this.config=n),r&&(this.request=r),i&&(this.response=i,this.status=i.status?i.status:null)}z.inherits(ge,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:z.toJSONObject(this.config),code:this.code,status:this.status}}});const tv=ge.prototype,nv={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{nv[e]={value:e}});Object.defineProperties(ge,nv);Object.defineProperty(tv,"isAxiosError",{value:!0});ge.from=(e,t,n,r,i,o)=>{const s=Object.create(tv);return z.toFlatObject(e,s,function(c){return c!==Error.prototype},a=>a!=="isAxiosError"),ge.call(s,e.message,t,n,r,i),s.cause=e,s.name=e.name,o&&Object.assign(s,o),s};const uw=null;function Vc(e){return z.isPlainObject(e)||z.isArray(e)}function rv(e){return z.endsWith(e,"[]")?e.slice(0,-2):e}function Lf(e,t,n){return e?e.concat(t).map(function(i,o){return i=rv(i),!n&&o?"["+i+"]":i}).join(n?".":""):t}function dw(e){return z.isArray(e)&&!e.some(Vc)}const fw=z.toFlatObject(z,{},null,function(t){return/^is[A-Z]/.test(t)});function Na(e,t,n){if(!z.isObject(e))throw new TypeError("target must be an object");t=t||new FormData,n=z.toFlatObject(n,{metaTokens:!0,dots:!1,indexes:!1},!1,function(P,k){return!z.isUndefined(k[P])});const r=n.metaTokens,i=n.visitor||u,o=n.dots,s=n.indexes,c=(n.Blob||typeof Blob<"u"&&Blob)&&z.isSpecCompliantForm(t);if(!z.isFunction(i))throw new TypeError("visitor must be a function");function l(b){if(b===null)return"";if(z.isDate(b))return b.toISOString();if(z.isBoolean(b))return b.toString();if(!c&&z.isBlob(b))throw new ge("Blob is not supported. Use a Buffer instead.");return z.isArrayBuffer(b)||z.isTypedArray(b)?c&&typeof Blob=="function"?new Blob([b]):Buffer.from(b):b}function u(b,P,k){let f=b;if(b&&!k&&typeof b=="object"){if(z.endsWith(P,"{}"))P=r?P:P.slice(0,-2),b=JSON.stringify(b);else if(z.isArray(b)&&dw(b)||(z.isFileList(b)||z.endsWith(P,"[]"))&&(f=z.toArray(b)))return P=rv(P),f.forEach(function(w,y){!(z.isUndefined(w)||w===null)&&t.append(s===!0?Lf([P],y,o):s===null?P:P+"[]",l(w))}),!1}return Vc(b)?!0:(t.append(Lf(k,P,o),l(b)),!1)}const d=[],m=Object.assign(fw,{defaultVisitor:u,convertValue:l,isVisitable:Vc});function g(b,P){if(!z.isUndefined(b)){if(d.indexOf(b)!==-1)throw Error("Circular reference detected in "+P.join("."));d.push(b),z.forEach(b,function(f,v){(!(z.isUndefined(f)||f===null)&&i.call(t,f,z.isString(v)?v.trim():v,P,m))===!0&&g(f,P?P.concat(v):[v])}),d.pop()}}if(!z.isObject(e))throw new TypeError("data must be an object");return g(e),t}function Af(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(r){return t[r]})}function Xu(e,t){this._pairs=[],e&&Na(e,this,t)}const iv=Xu.prototype;iv.append=function(t,n){this._pairs.push([t,n])};iv.toString=function(t){const n=t?function(r){return t.call(this,r,Af)}:Af;return this._pairs.map(function(i){return n(i[0])+"="+n(i[1])},"").join("&")};function pw(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function ov(e,t,n){if(!t)return e;const r=n&&n.encode||pw;z.isFunction(n)&&(n={serialize:n});const i=n&&n.serialize;let o;if(i?o=i(t,n):o=z.isURLSearchParams(t)?t.toString():new Xu(t,n).toString(r),o){const s=e.indexOf("#");s!==-1&&(e=e.slice(0,s)),e+=(e.indexOf("?")===-1?"?":"&")+o}return e}class hw{constructor(){this.handlers=[]}use(t,n,r){return this.handlers.push({fulfilled:t,rejected:n,synchronous:r?r.synchronous:!1,runWhen:r?r.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){z.forEach(this.handlers,function(r){r!==null&&t(r)})}}const Mf=hw,sv={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},mw=typeof URLSearchParams<"u"?URLSearchParams:Xu,vw=typeof FormData<"u"?FormData:null,gw=typeof Blob<"u"?Blob:null,yw={isBrowser:!0,classes:{URLSearchParams:mw,FormData:vw,Blob:gw},protocols:["http","https","file","blob","url","data"]},Ju=typeof window<"u"&&typeof document<"u",Fc=typeof navigator=="object"&&navigator||void 0,Sw=Ju&&(!Fc||["ReactNative","NativeScript","NS"].indexOf(Fc.product)<0),ww=(()=>typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function")(),Ew=Ju&&window.location.href||"http://localhost",bw=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:Ju,hasStandardBrowserEnv:Sw,hasStandardBrowserWebWorkerEnv:ww,navigator:Fc,origin:Ew},Symbol.toStringTag,{value:"Module"})),vt={...bw,...yw};function Cw(e,t){return Na(e,new vt.classes.URLSearchParams,{visitor:function(n,r,i,o){return vt.isNode&&z.isBuffer(n)?(this.append(r,n.toString("base64")),!1):o.defaultVisitor.apply(this,arguments)},...t})}function xw(e){return z.matchAll(/\w+|\[(\w*)]/g,e).map(t=>t[0]==="[]"?"":t[1]||t[0])}function kw(e){const t={},n=Object.keys(e);let r;const i=n.length;let o;for(r=0;r<i;r++)o=n[r],t[o]=e[o];return t}function av(e){function t(n,r,i,o){let s=n[o++];if(s==="__proto__")return!0;const a=Number.isFinite(+s),c=o>=n.length;return s=!s&&z.isArray(i)?i.length:s,c?(z.hasOwnProp(i,s)?i[s]=[i[s],r]:i[s]=r,!a):((!i[s]||!z.isObject(i[s]))&&(i[s]=[]),t(n,r,i[s],o)&&z.isArray(i[s])&&(i[s]=kw(i[s])),!a)}if(z.isFormData(e)&&z.isFunction(e.entries)){const n={};return z.forEachEntry(e,(r,i)=>{t(xw(r),i,n,0)}),n}return null}function Pw(e,t,n){if(z.isString(e))try{return(t||JSON.parse)(e),z.trim(e)}catch(r){if(r.name!=="SyntaxError")throw r}return(n||JSON.stringify)(e)}const Ku={transitional:sv,adapter:["xhr","http","fetch"],transformRequest:[function(t,n){const r=n.getContentType()||"",i=r.indexOf("application/json")>-1,o=z.isObject(t);if(o&&z.isHTMLForm(t)&&(t=new FormData(t)),z.isFormData(t))return i?JSON.stringify(av(t)):t;if(z.isArrayBuffer(t)||z.isBuffer(t)||z.isStream(t)||z.isFile(t)||z.isBlob(t)||z.isReadableStream(t))return t;if(z.isArrayBufferView(t))return t.buffer;if(z.isURLSearchParams(t))return n.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let a;if(o){if(r.indexOf("application/x-www-form-urlencoded")>-1)return Cw(t,this.formSerializer).toString();if((a=z.isFileList(t))||r.indexOf("multipart/form-data")>-1){const c=this.env&&this.env.FormData;return Na(a?{"files[]":t}:t,c&&new c,this.formSerializer)}}return o||i?(n.setContentType("application/json",!1),Pw(t)):t}],transformResponse:[function(t){const n=this.transitional||Ku.transitional,r=n&&n.forcedJSONParsing,i=this.responseType==="json";if(z.isResponse(t)||z.isReadableStream(t))return t;if(t&&z.isString(t)&&(r&&!this.responseType||i)){const s=!(n&&n.silentJSONParsing)&&i;try{return JSON.parse(t)}catch(a){if(s)throw a.name==="SyntaxError"?ge.from(a,ge.ERR_BAD_RESPONSE,this,null,this.response):a}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:vt.classes.FormData,Blob:vt.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};z.forEach(["delete","get","head","post","put","patch"],e=>{Ku.headers[e]={}});const Qu=Ku,Ow=z.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),Rw=e=>{const t={};let n,r,i;return e&&e.split(`
`).forEach(function(s){i=s.indexOf(":"),n=s.substring(0,i).trim().toLowerCase(),r=s.substring(i+1).trim(),!(!n||t[n]&&Ow[n])&&(n==="set-cookie"?t[n]?t[n].push(r):t[n]=[r]:t[n]=t[n]?t[n]+", "+r:r)}),t},jf=Symbol("internals");function Vi(e){return e&&String(e).trim().toLowerCase()}function Os(e){return e===!1||e==null?e:z.isArray(e)?e.map(Os):String(e)}function _w(e){const t=Object.create(null),n=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let r;for(;r=n.exec(e);)t[r[1]]=r[2];return t}const Iw=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function El(e,t,n,r,i){if(z.isFunction(r))return r.call(this,t,n);if(i&&(t=n),!!z.isString(t)){if(z.isString(r))return t.indexOf(r)!==-1;if(z.isRegExp(r))return r.test(t)}}function Nw(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,n,r)=>n.toUpperCase()+r)}function Tw(e,t){const n=z.toCamelCase(" "+t);["get","set","has"].forEach(r=>{Object.defineProperty(e,r+n,{value:function(i,o,s){return this[r].call(this,t,i,o,s)},configurable:!0})})}class Ta{constructor(t){t&&this.set(t)}set(t,n,r){const i=this;function o(a,c,l){const u=Vi(c);if(!u)throw new Error("header name must be a non-empty string");const d=z.findKey(i,u);(!d||i[d]===void 0||l===!0||l===void 0&&i[d]!==!1)&&(i[d||c]=Os(a))}const s=(a,c)=>z.forEach(a,(l,u)=>o(l,u,c));if(z.isPlainObject(t)||t instanceof this.constructor)s(t,n);else if(z.isString(t)&&(t=t.trim())&&!Iw(t))s(Rw(t),n);else if(z.isObject(t)&&z.isIterable(t)){let a={},c,l;for(const u of t){if(!z.isArray(u))throw TypeError("Object iterator must return a key-value pair");a[l=u[0]]=(c=a[l])?z.isArray(c)?[...c,u[1]]:[c,u[1]]:u[1]}s(a,n)}else t!=null&&o(n,t,r);return this}get(t,n){if(t=Vi(t),t){const r=z.findKey(this,t);if(r){const i=this[r];if(!n)return i;if(n===!0)return _w(i);if(z.isFunction(n))return n.call(this,i,r);if(z.isRegExp(n))return n.exec(i);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,n){if(t=Vi(t),t){const r=z.findKey(this,t);return!!(r&&this[r]!==void 0&&(!n||El(this,this[r],r,n)))}return!1}delete(t,n){const r=this;let i=!1;function o(s){if(s=Vi(s),s){const a=z.findKey(r,s);a&&(!n||El(r,r[a],a,n))&&(delete r[a],i=!0)}}return z.isArray(t)?t.forEach(o):o(t),i}clear(t){const n=Object.keys(this);let r=n.length,i=!1;for(;r--;){const o=n[r];(!t||El(this,this[o],o,t,!0))&&(delete this[o],i=!0)}return i}normalize(t){const n=this,r={};return z.forEach(this,(i,o)=>{const s=z.findKey(r,o);if(s){n[s]=Os(i),delete n[o];return}const a=t?Nw(o):String(o).trim();a!==o&&delete n[o],n[a]=Os(i),r[a]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const n=Object.create(null);return z.forEach(this,(r,i)=>{r!=null&&r!==!1&&(n[i]=t&&z.isArray(r)?r.join(", "):r)}),n}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,n])=>t+": "+n).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...n){const r=new this(t);return n.forEach(i=>r.set(i)),r}static accessor(t){const r=(this[jf]=this[jf]={accessors:{}}).accessors,i=this.prototype;function o(s){const a=Vi(s);r[a]||(Tw(i,s),r[a]=!0)}return z.isArray(t)?t.forEach(o):o(t),this}}Ta.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);z.reduceDescriptors(Ta.prototype,({value:e},t)=>{let n=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(r){this[n]=r}}});z.freezeMethods(Ta);const tn=Ta;function bl(e,t){const n=this||Qu,r=t||n,i=tn.from(r.headers);let o=r.data;return z.forEach(e,function(a){o=a.call(n,o,i.normalize(),t?t.status:void 0)}),i.normalize(),o}function lv(e){return!!(e&&e.__CANCEL__)}function gi(e,t,n){ge.call(this,e??"canceled",ge.ERR_CANCELED,t,n),this.name="CanceledError"}z.inherits(gi,ge,{__CANCEL__:!0});function cv(e,t,n){const r=n.config.validateStatus;!n.status||!r||r(n.status)?e(n):t(new ge("Request failed with status code "+n.status,[ge.ERR_BAD_REQUEST,ge.ERR_BAD_RESPONSE][Math.floor(n.status/100)-4],n.config,n.request,n))}function Lw(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}function Aw(e,t){e=e||10;const n=new Array(e),r=new Array(e);let i=0,o=0,s;return t=t!==void 0?t:1e3,function(c){const l=Date.now(),u=r[o];s||(s=l),n[i]=c,r[i]=l;let d=o,m=0;for(;d!==i;)m+=n[d++],d=d%e;if(i=(i+1)%e,i===o&&(o=(o+1)%e),l-s<t)return;const g=u&&l-u;return g?Math.round(m*1e3/g):void 0}}function Mw(e,t){let n=0,r=1e3/t,i,o;const s=(l,u=Date.now())=>{n=u,i=null,o&&(clearTimeout(o),o=null),e(...l)};return[(...l)=>{const u=Date.now(),d=u-n;d>=r?s(l,u):(i=l,o||(o=setTimeout(()=>{o=null,s(i)},r-d)))},()=>i&&s(i)]}const ra=(e,t,n=3)=>{let r=0;const i=Aw(50,250);return Mw(o=>{const s=o.loaded,a=o.lengthComputable?o.total:void 0,c=s-r,l=i(c),u=s<=a;r=s;const d={loaded:s,total:a,progress:a?s/a:void 0,bytes:c,rate:l||void 0,estimated:l&&a&&u?(a-s)/l:void 0,event:o,lengthComputable:a!=null,[t?"download":"upload"]:!0};e(d)},n)},Df=(e,t)=>{const n=e!=null;return[r=>t[0]({lengthComputable:n,total:e,loaded:r}),t[1]]},Vf=e=>(...t)=>z.asap(()=>e(...t)),jw=vt.hasStandardBrowserEnv?((e,t)=>n=>(n=new URL(n,vt.origin),e.protocol===n.protocol&&e.host===n.host&&(t||e.port===n.port)))(new URL(vt.origin),vt.navigator&&/(msie|trident)/i.test(vt.navigator.userAgent)):()=>!0,Dw=vt.hasStandardBrowserEnv?{write(e,t,n,r,i,o){const s=[e+"="+encodeURIComponent(t)];z.isNumber(n)&&s.push("expires="+new Date(n).toGMTString()),z.isString(r)&&s.push("path="+r),z.isString(i)&&s.push("domain="+i),o===!0&&s.push("secure"),document.cookie=s.join("; ")},read(e){const t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function Vw(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function Fw(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}function uv(e,t,n){let r=!Vw(t);return e&&(r||n==!1)?Fw(e,t):t}const Ff=e=>e instanceof tn?{...e}:e;function kr(e,t){t=t||{};const n={};function r(l,u,d,m){return z.isPlainObject(l)&&z.isPlainObject(u)?z.merge.call({caseless:m},l,u):z.isPlainObject(u)?z.merge({},u):z.isArray(u)?u.slice():u}function i(l,u,d,m){if(z.isUndefined(u)){if(!z.isUndefined(l))return r(void 0,l,d,m)}else return r(l,u,d,m)}function o(l,u){if(!z.isUndefined(u))return r(void 0,u)}function s(l,u){if(z.isUndefined(u)){if(!z.isUndefined(l))return r(void 0,l)}else return r(void 0,u)}function a(l,u,d){if(d in t)return r(l,u);if(d in e)return r(void 0,l)}const c={url:o,method:o,data:o,baseURL:s,transformRequest:s,transformResponse:s,paramsSerializer:s,timeout:s,timeoutMessage:s,withCredentials:s,withXSRFToken:s,adapter:s,responseType:s,xsrfCookieName:s,xsrfHeaderName:s,onUploadProgress:s,onDownloadProgress:s,decompress:s,maxContentLength:s,maxBodyLength:s,beforeRedirect:s,transport:s,httpAgent:s,httpsAgent:s,cancelToken:s,socketPath:s,responseEncoding:s,validateStatus:a,headers:(l,u,d)=>i(Ff(l),Ff(u),d,!0)};return z.forEach(Object.keys({...e,...t}),function(u){const d=c[u]||i,m=d(e[u],t[u],u);z.isUndefined(m)&&d!==a||(n[u]=m)}),n}const dv=e=>{const t=kr({},e);let{data:n,withXSRFToken:r,xsrfHeaderName:i,xsrfCookieName:o,headers:s,auth:a}=t;t.headers=s=tn.from(s),t.url=ov(uv(t.baseURL,t.url,t.allowAbsoluteUrls),e.params,e.paramsSerializer),a&&s.set("Authorization","Basic "+btoa((a.username||"")+":"+(a.password?unescape(encodeURIComponent(a.password)):"")));let c;if(z.isFormData(n)){if(vt.hasStandardBrowserEnv||vt.hasStandardBrowserWebWorkerEnv)s.setContentType(void 0);else if((c=s.getContentType())!==!1){const[l,...u]=c?c.split(";").map(d=>d.trim()).filter(Boolean):[];s.setContentType([l||"multipart/form-data",...u].join("; "))}}if(vt.hasStandardBrowserEnv&&(r&&z.isFunction(r)&&(r=r(t)),r||r!==!1&&jw(t.url))){const l=i&&o&&Dw.read(o);l&&s.set(i,l)}return t},Uw=typeof XMLHttpRequest<"u",$w=Uw&&function(e){return new Promise(function(n,r){const i=dv(e);let o=i.data;const s=tn.from(i.headers).normalize();let{responseType:a,onUploadProgress:c,onDownloadProgress:l}=i,u,d,m,g,b;function P(){g&&g(),b&&b(),i.cancelToken&&i.cancelToken.unsubscribe(u),i.signal&&i.signal.removeEventListener("abort",u)}let k=new XMLHttpRequest;k.open(i.method.toUpperCase(),i.url,!0),k.timeout=i.timeout;function f(){if(!k)return;const w=tn.from("getAllResponseHeaders"in k&&k.getAllResponseHeaders()),T={data:!a||a==="text"||a==="json"?k.responseText:k.response,status:k.status,statusText:k.statusText,headers:w,config:e,request:k};cv(function(U){n(U),P()},function(U){r(U),P()},T),k=null}"onloadend"in k?k.onloadend=f:k.onreadystatechange=function(){!k||k.readyState!==4||k.status===0&&!(k.responseURL&&k.responseURL.indexOf("file:")===0)||setTimeout(f)},k.onabort=function(){k&&(r(new ge("Request aborted",ge.ECONNABORTED,e,k)),k=null)},k.onerror=function(){r(new ge("Network Error",ge.ERR_NETWORK,e,k)),k=null},k.ontimeout=function(){let y=i.timeout?"timeout of "+i.timeout+"ms exceeded":"timeout exceeded";const T=i.transitional||sv;i.timeoutErrorMessage&&(y=i.timeoutErrorMessage),r(new ge(y,T.clarifyTimeoutError?ge.ETIMEDOUT:ge.ECONNABORTED,e,k)),k=null},o===void 0&&s.setContentType(null),"setRequestHeader"in k&&z.forEach(s.toJSON(),function(y,T){k.setRequestHeader(T,y)}),z.isUndefined(i.withCredentials)||(k.withCredentials=!!i.withCredentials),a&&a!=="json"&&(k.responseType=i.responseType),l&&([m,b]=ra(l,!0),k.addEventListener("progress",m)),c&&k.upload&&([d,g]=ra(c),k.upload.addEventListener("progress",d),k.upload.addEventListener("loadend",g)),(i.cancelToken||i.signal)&&(u=w=>{k&&(r(!w||w.type?new gi(null,e,k):w),k.abort(),k=null)},i.cancelToken&&i.cancelToken.subscribe(u),i.signal&&(i.signal.aborted?u():i.signal.addEventListener("abort",u)));const v=Lw(i.url);if(v&&vt.protocols.indexOf(v)===-1){r(new ge("Unsupported protocol "+v+":",ge.ERR_BAD_REQUEST,e));return}k.send(o||null)})},Bw=(e,t)=>{const{length:n}=e=e?e.filter(Boolean):[];if(t||n){let r=new AbortController,i;const o=function(l){if(!i){i=!0,a();const u=l instanceof Error?l:this.reason;r.abort(u instanceof ge?u:new gi(u instanceof Error?u.message:u))}};let s=t&&setTimeout(()=>{s=null,o(new ge(`timeout ${t} of ms exceeded`,ge.ETIMEDOUT))},t);const a=()=>{e&&(s&&clearTimeout(s),s=null,e.forEach(l=>{l.unsubscribe?l.unsubscribe(o):l.removeEventListener("abort",o)}),e=null)};e.forEach(l=>l.addEventListener("abort",o));const{signal:c}=r;return c.unsubscribe=()=>z.asap(a),c}},zw=Bw,Ww=function*(e,t){let n=e.byteLength;if(!t||n<t){yield e;return}let r=0,i;for(;r<n;)i=r+t,yield e.slice(r,i),r=i},Hw=async function*(e,t){for await(const n of qw(e))yield*Ww(n,t)},qw=async function*(e){if(e[Symbol.asyncIterator]){yield*e;return}const t=e.getReader();try{for(;;){const{done:n,value:r}=await t.read();if(n)break;yield r}}finally{await t.cancel()}},Uf=(e,t,n,r)=>{const i=Hw(e,t);let o=0,s,a=c=>{s||(s=!0,r&&r(c))};return new ReadableStream({async pull(c){try{const{done:l,value:u}=await i.next();if(l){a(),c.close();return}let d=u.byteLength;if(n){let m=o+=d;n(m)}c.enqueue(new Uint8Array(u))}catch(l){throw a(l),l}},cancel(c){return a(c),i.return()}},{highWaterMark:2})},La=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",fv=La&&typeof ReadableStream=="function",Gw=La&&(typeof TextEncoder=="function"?(e=>t=>e.encode(t))(new TextEncoder):async e=>new Uint8Array(await new Response(e).arrayBuffer())),pv=(e,...t)=>{try{return!!e(...t)}catch{return!1}},Xw=fv&&pv(()=>{let e=!1;const t=new Request(vt.origin,{body:new ReadableStream,method:"POST",get duplex(){return e=!0,"half"}}).headers.has("Content-Type");return e&&!t}),$f=64*1024,Uc=fv&&pv(()=>z.isReadableStream(new Response("").body)),ia={stream:Uc&&(e=>e.body)};La&&(e=>{["text","arrayBuffer","blob","formData","stream"].forEach(t=>{!ia[t]&&(ia[t]=z.isFunction(e[t])?n=>n[t]():(n,r)=>{throw new ge(`Response type '${t}' is not supported`,ge.ERR_NOT_SUPPORT,r)})})})(new Response);const Jw=async e=>{if(e==null)return 0;if(z.isBlob(e))return e.size;if(z.isSpecCompliantForm(e))return(await new Request(vt.origin,{method:"POST",body:e}).arrayBuffer()).byteLength;if(z.isArrayBufferView(e)||z.isArrayBuffer(e))return e.byteLength;if(z.isURLSearchParams(e)&&(e=e+""),z.isString(e))return(await Gw(e)).byteLength},Kw=async(e,t)=>{const n=z.toFiniteNumber(e.getContentLength());return n??Jw(t)},Qw=La&&(async e=>{let{url:t,method:n,data:r,signal:i,cancelToken:o,timeout:s,onDownloadProgress:a,onUploadProgress:c,responseType:l,headers:u,withCredentials:d="same-origin",fetchOptions:m}=dv(e);l=l?(l+"").toLowerCase():"text";let g=zw([i,o&&o.toAbortSignal()],s),b;const P=g&&g.unsubscribe&&(()=>{g.unsubscribe()});let k;try{if(c&&Xw&&n!=="get"&&n!=="head"&&(k=await Kw(u,r))!==0){let T=new Request(t,{method:"POST",body:r,duplex:"half"}),M;if(z.isFormData(r)&&(M=T.headers.get("content-type"))&&u.setContentType(M),T.body){const[U,S]=Df(k,ra(Vf(c)));r=Uf(T.body,$f,U,S)}}z.isString(d)||(d=d?"include":"omit");const f="credentials"in Request.prototype;b=new Request(t,{...m,signal:g,method:n.toUpperCase(),headers:u.normalize().toJSON(),body:r,duplex:"half",credentials:f?d:void 0});let v=await fetch(b,m);const w=Uc&&(l==="stream"||l==="response");if(Uc&&(a||w&&P)){const T={};["status","statusText","headers"].forEach(p=>{T[p]=v[p]});const M=z.toFiniteNumber(v.headers.get("content-length")),[U,S]=a&&Df(M,ra(Vf(a),!0))||[];v=new Response(Uf(v.body,$f,U,()=>{S&&S(),P&&P()}),T)}l=l||"text";let y=await ia[z.findKey(ia,l)||"text"](v,e);return!w&&P&&P(),await new Promise((T,M)=>{cv(T,M,{data:y,headers:tn.from(v.headers),status:v.status,statusText:v.statusText,config:e,request:b})})}catch(f){throw P&&P(),f&&f.name==="TypeError"&&/Load failed|fetch/i.test(f.message)?Object.assign(new ge("Network Error",ge.ERR_NETWORK,e,b),{cause:f.cause||f}):ge.from(f,f&&f.code,e,b)}}),$c={http:uw,xhr:$w,fetch:Qw};z.forEach($c,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch{}Object.defineProperty(e,"adapterName",{value:t})}});const Bf=e=>`- ${e}`,Yw=e=>z.isFunction(e)||e===null||e===!1,hv={getAdapter:e=>{e=z.isArray(e)?e:[e];const{length:t}=e;let n,r;const i={};for(let o=0;o<t;o++){n=e[o];let s;if(r=n,!Yw(n)&&(r=$c[(s=String(n)).toLowerCase()],r===void 0))throw new ge(`Unknown adapter '${s}'`);if(r)break;i[s||"#"+o]=r}if(!r){const o=Object.entries(i).map(([a,c])=>`adapter ${a} `+(c===!1?"is not supported by the environment":"is not available in the build"));let s=t?o.length>1?`since :
`+o.map(Bf).join(`
`):" "+Bf(o[0]):"as no adapter specified";throw new ge("There is no suitable adapter to dispatch the request "+s,"ERR_NOT_SUPPORT")}return r},adapters:$c};function Cl(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new gi(null,e)}function zf(e){return Cl(e),e.headers=tn.from(e.headers),e.data=bl.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),hv.getAdapter(e.adapter||Qu.adapter)(e).then(function(r){return Cl(e),r.data=bl.call(e,e.transformResponse,r),r.headers=tn.from(r.headers),r},function(r){return lv(r)||(Cl(e),r&&r.response&&(r.response.data=bl.call(e,e.transformResponse,r.response),r.response.headers=tn.from(r.response.headers))),Promise.reject(r)})}const mv="1.11.0",Aa={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{Aa[e]=function(r){return typeof r===e||"a"+(t<1?"n ":" ")+e}});const Wf={};Aa.transitional=function(t,n,r){function i(o,s){return"[Axios v"+mv+"] Transitional option '"+o+"'"+s+(r?". "+r:"")}return(o,s,a)=>{if(t===!1)throw new ge(i(s," has been removed"+(n?" in "+n:"")),ge.ERR_DEPRECATED);return n&&!Wf[s]&&(Wf[s]=!0,console.warn(i(s," has been deprecated since v"+n+" and will be removed in the near future"))),t?t(o,s,a):!0}};Aa.spelling=function(t){return(n,r)=>(console.warn(`${r} is likely a misspelling of ${t}`),!0)};function Zw(e,t,n){if(typeof e!="object")throw new ge("options must be an object",ge.ERR_BAD_OPTION_VALUE);const r=Object.keys(e);let i=r.length;for(;i-- >0;){const o=r[i],s=t[o];if(s){const a=e[o],c=a===void 0||s(a,o,e);if(c!==!0)throw new ge("option "+o+" must be "+c,ge.ERR_BAD_OPTION_VALUE);continue}if(n!==!0)throw new ge("Unknown option "+o,ge.ERR_BAD_OPTION)}}const Rs={assertOptions:Zw,validators:Aa},ln=Rs.validators;class oa{constructor(t){this.defaults=t||{},this.interceptors={request:new Mf,response:new Mf}}async request(t,n){try{return await this._request(t,n)}catch(r){if(r instanceof Error){let i={};Error.captureStackTrace?Error.captureStackTrace(i):i=new Error;const o=i.stack?i.stack.replace(/^.+\n/,""):"";try{r.stack?o&&!String(r.stack).endsWith(o.replace(/^.+\n.+\n/,""))&&(r.stack+=`
`+o):r.stack=o}catch{}}throw r}}_request(t,n){typeof t=="string"?(n=n||{},n.url=t):n=t||{},n=kr(this.defaults,n);const{transitional:r,paramsSerializer:i,headers:o}=n;r!==void 0&&Rs.assertOptions(r,{silentJSONParsing:ln.transitional(ln.boolean),forcedJSONParsing:ln.transitional(ln.boolean),clarifyTimeoutError:ln.transitional(ln.boolean)},!1),i!=null&&(z.isFunction(i)?n.paramsSerializer={serialize:i}:Rs.assertOptions(i,{encode:ln.function,serialize:ln.function},!0)),n.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?n.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:n.allowAbsoluteUrls=!0),Rs.assertOptions(n,{baseUrl:ln.spelling("baseURL"),withXsrfToken:ln.spelling("withXSRFToken")},!0),n.method=(n.method||this.defaults.method||"get").toLowerCase();let s=o&&z.merge(o.common,o[n.method]);o&&z.forEach(["delete","get","head","post","put","patch","common"],b=>{delete o[b]}),n.headers=tn.concat(s,o);const a=[];let c=!0;this.interceptors.request.forEach(function(P){typeof P.runWhen=="function"&&P.runWhen(n)===!1||(c=c&&P.synchronous,a.unshift(P.fulfilled,P.rejected))});const l=[];this.interceptors.response.forEach(function(P){l.push(P.fulfilled,P.rejected)});let u,d=0,m;if(!c){const b=[zf.bind(this),void 0];for(b.unshift(...a),b.push(...l),m=b.length,u=Promise.resolve(n);d<m;)u=u.then(b[d++],b[d++]);return u}m=a.length;let g=n;for(d=0;d<m;){const b=a[d++],P=a[d++];try{g=b(g)}catch(k){P.call(this,k);break}}try{u=zf.call(this,g)}catch(b){return Promise.reject(b)}for(d=0,m=l.length;d<m;)u=u.then(l[d++],l[d++]);return u}getUri(t){t=kr(this.defaults,t);const n=uv(t.baseURL,t.url,t.allowAbsoluteUrls);return ov(n,t.params,t.paramsSerializer)}}z.forEach(["delete","get","head","options"],function(t){oa.prototype[t]=function(n,r){return this.request(kr(r||{},{method:t,url:n,data:(r||{}).data}))}});z.forEach(["post","put","patch"],function(t){function n(r){return function(o,s,a){return this.request(kr(a||{},{method:t,headers:r?{"Content-Type":"multipart/form-data"}:{},url:o,data:s}))}}oa.prototype[t]=n(),oa.prototype[t+"Form"]=n(!0)});const _s=oa;class Yu{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let n;this.promise=new Promise(function(o){n=o});const r=this;this.promise.then(i=>{if(!r._listeners)return;let o=r._listeners.length;for(;o-- >0;)r._listeners[o](i);r._listeners=null}),this.promise.then=i=>{let o;const s=new Promise(a=>{r.subscribe(a),o=a}).then(i);return s.cancel=function(){r.unsubscribe(o)},s},t(function(o,s,a){r.reason||(r.reason=new gi(o,s,a),n(r.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const n=this._listeners.indexOf(t);n!==-1&&this._listeners.splice(n,1)}toAbortSignal(){const t=new AbortController,n=r=>{t.abort(r)};return this.subscribe(n),t.signal.unsubscribe=()=>this.unsubscribe(n),t.signal}static source(){let t;return{token:new Yu(function(i){t=i}),cancel:t}}}const eE=Yu;function tE(e){return function(n){return e.apply(null,n)}}function nE(e){return z.isObject(e)&&e.isAxiosError===!0}const Bc={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(Bc).forEach(([e,t])=>{Bc[t]=e});const rE=Bc;function vv(e){const t=new _s(e),n=Gm(_s.prototype.request,t);return z.extend(n,_s.prototype,t,{allOwnKeys:!0}),z.extend(n,t,null,{allOwnKeys:!0}),n.create=function(i){return vv(kr(e,i))},n}const Ge=vv(Qu);Ge.Axios=_s;Ge.CanceledError=gi;Ge.CancelToken=eE;Ge.isCancel=lv;Ge.VERSION=mv;Ge.toFormData=Na;Ge.AxiosError=ge;Ge.Cancel=Ge.CanceledError;Ge.all=function(t){return Promise.all(t)};Ge.spread=tE;Ge.isAxiosError=nE;Ge.mergeConfig=kr;Ge.AxiosHeaders=tn;Ge.formToJSON=e=>av(z.isHTMLForm(e)?new FormData(e):e);Ge.getAdapter=hv.getAdapter;Ge.HttpStatusCode=rE;Ge.default=Ge;const Ie=Ge;let iE={data:""},oE=e=>typeof window=="object"?((e?e.querySelector("#_goober"):window._goober)||Object.assign((e||document.head).appendChild(document.createElement("style")),{innerHTML:" ",id:"_goober"})).firstChild:e||iE,sE=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,aE=/\/\*[^]*?\*\/|  +/g,Hf=/\n+/g,Un=(e,t)=>{let n="",r="",i="";for(let o in e){let s=e[o];o[0]=="@"?o[1]=="i"?n=o+" "+s+";":r+=o[1]=="f"?Un(s,o):o+"{"+Un(s,o[1]=="k"?"":t)+"}":typeof s=="object"?r+=Un(s,t?t.replace(/([^,])+/g,a=>o.replace(/([^,]*:\S+\([^)]*\))|([^,])+/g,c=>/&/.test(c)?c.replace(/&/g,a):a?a+" "+c:c)):o):s!=null&&(o=/^--/.test(o)?o:o.replace(/[A-Z]/g,"-$&").toLowerCase(),i+=Un.p?Un.p(o,s):o+":"+s+";")}return n+(t&&i?t+"{"+i+"}":i)+r},gn={},gv=e=>{if(typeof e=="object"){let t="";for(let n in e)t+=n+gv(e[n]);return t}return e},lE=(e,t,n,r,i)=>{let o=gv(e),s=gn[o]||(gn[o]=(c=>{let l=0,u=11;for(;l<c.length;)u=101*u+c.charCodeAt(l++)>>>0;return"go"+u})(o));if(!gn[s]){let c=o!==e?e:(l=>{let u,d,m=[{}];for(;u=sE.exec(l.replace(aE,""));)u[4]?m.shift():u[3]?(d=u[3].replace(Hf," ").trim(),m.unshift(m[0][d]=m[0][d]||{})):m[0][u[1]]=u[2].replace(Hf," ").trim();return m[0]})(e);gn[s]=Un(i?{["@keyframes "+s]:c}:c,n?"":"."+s)}let a=n&&gn.g?gn.g:null;return n&&(gn.g=gn[s]),((c,l,u,d)=>{d?l.data=l.data.replace(d,c):l.data.indexOf(c)===-1&&(l.data=u?c+l.data:l.data+c)})(gn[s],t,r,a),s},cE=(e,t,n)=>e.reduce((r,i,o)=>{let s=t[o];if(s&&s.call){let a=s(n),c=a&&a.props&&a.props.className||/^go/.test(a)&&a;s=c?"."+c:a&&typeof a=="object"?a.props?"":Un(a,""):a===!1?"":a}return r+i+(s??"")},"");function Ma(e){let t=this||{},n=e.call?e(t.p):e;return lE(n.unshift?n.raw?cE(n,[].slice.call(arguments,1),t.p):n.reduce((r,i)=>Object.assign(r,i&&i.call?i(t.p):i),{}):n,oE(t.target),t.g,t.o,t.k)}let yv,zc,Wc;Ma.bind({g:1});let Rn=Ma.bind({k:1});function uE(e,t,n,r){Un.p=t,yv=e,zc=n,Wc=r}function lr(e,t){let n=this||{};return function(){let r=arguments;function i(o,s){let a=Object.assign({},o),c=a.className||i.className;n.p=Object.assign({theme:zc&&zc()},a),n.o=/ *go\d+/.test(c),a.className=Ma.apply(n,r)+(c?" "+c:""),t&&(a.ref=s);let l=e;return e[0]&&(l=a.as||e,delete a.as),Wc&&l[0]&&Wc(a),yv(l,a)}return t?t(i):i}}var dE=e=>typeof e=="function",Hc=(e,t)=>dE(e)?e(t):e,fE=(()=>{let e=0;return()=>(++e).toString()})(),pE=(()=>{let e;return()=>{if(e===void 0&&typeof window<"u"){let t=matchMedia("(prefers-reduced-motion: reduce)");e=!t||t.matches}return e}})(),hE=20,Sv=(e,t)=>{switch(t.type){case 0:return{...e,toasts:[t.toast,...e.toasts].slice(0,hE)};case 1:return{...e,toasts:e.toasts.map(o=>o.id===t.toast.id?{...o,...t.toast}:o)};case 2:let{toast:n}=t;return Sv(e,{type:e.toasts.find(o=>o.id===n.id)?1:0,toast:n});case 3:let{toastId:r}=t;return{...e,toasts:e.toasts.map(o=>o.id===r||r===void 0?{...o,dismissed:!0,visible:!1}:o)};case 4:return t.toastId===void 0?{...e,toasts:[]}:{...e,toasts:e.toasts.filter(o=>o.id!==t.toastId)};case 5:return{...e,pausedAt:t.time};case 6:let i=t.time-(e.pausedAt||0);return{...e,pausedAt:void 0,toasts:e.toasts.map(o=>({...o,pauseDuration:o.pauseDuration+i}))}}},mE=[],xl={toasts:[],pausedAt:void 0},Zu=e=>{xl=Sv(xl,e),mE.forEach(t=>{t(xl)})},vE=(e,t="blank",n)=>({createdAt:Date.now(),visible:!0,dismissed:!1,type:t,ariaProps:{role:"status","aria-live":"polite"},message:e,pauseDuration:0,...n,id:n?.id||fE()}),No=e=>(t,n)=>{let r=vE(t,e,n);return Zu({type:2,toast:r}),r.id},Tt=(e,t)=>No("blank")(e,t);Tt.error=No("error");Tt.success=No("success");Tt.loading=No("loading");Tt.custom=No("custom");Tt.dismiss=e=>{Zu({type:3,toastId:e})};Tt.remove=e=>Zu({type:4,toastId:e});Tt.promise=(e,t,n)=>{let r=Tt.loading(t.loading,{...n,...n?.loading});return typeof e=="function"&&(e=e()),e.then(i=>{let o=t.success?Hc(t.success,i):void 0;return o?Tt.success(o,{id:r,...n,...n?.success}):Tt.dismiss(r),i}).catch(i=>{let o=t.error?Hc(t.error,i):void 0;o?Tt.error(o,{id:r,...n,...n?.error}):Tt.dismiss(r)}),e};var gE=Rn`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
 transform: scale(1) rotate(45deg);
  opacity: 1;
}`,yE=Rn`
from {
  transform: scale(0);
  opacity: 0;
}
to {
  transform: scale(1);
  opacity: 1;
}`,SE=Rn`
from {
  transform: scale(0) rotate(90deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(90deg);
	opacity: 1;
}`,wE=lr("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${e=>e.primary||"#ff4b4b"};
  position: relative;
  transform: rotate(45deg);

  animation: ${gE} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;

  &:after,
  &:before {
    content: '';
    animation: ${yE} 0.15s ease-out forwards;
    animation-delay: 150ms;
    position: absolute;
    border-radius: 3px;
    opacity: 0;
    background: ${e=>e.secondary||"#fff"};
    bottom: 9px;
    left: 4px;
    height: 2px;
    width: 12px;
  }

  &:before {
    animation: ${SE} 0.15s ease-out forwards;
    animation-delay: 180ms;
    transform: rotate(90deg);
  }
`,EE=Rn`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
`,bE=lr("div")`
  width: 12px;
  height: 12px;
  box-sizing: border-box;
  border: 2px solid;
  border-radius: 100%;
  border-color: ${e=>e.secondary||"#e0e0e0"};
  border-right-color: ${e=>e.primary||"#616161"};
  animation: ${EE} 1s linear infinite;
`,CE=Rn`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(45deg);
	opacity: 1;
}`,xE=Rn`
0% {
	height: 0;
	width: 0;
	opacity: 0;
}
40% {
  height: 0;
	width: 6px;
	opacity: 1;
}
100% {
  opacity: 1;
  height: 10px;
}`,kE=lr("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${e=>e.primary||"#61d345"};
  position: relative;
  transform: rotate(45deg);

  animation: ${CE} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;
  &:after {
    content: '';
    box-sizing: border-box;
    animation: ${xE} 0.2s ease-out forwards;
    opacity: 0;
    animation-delay: 200ms;
    position: absolute;
    border-right: 2px solid;
    border-bottom: 2px solid;
    border-color: ${e=>e.secondary||"#fff"};
    bottom: 6px;
    left: 6px;
    height: 10px;
    width: 6px;
  }
`,PE=lr("div")`
  position: absolute;
`,OE=lr("div")`
  position: relative;
  display: flex;
  justify-content: center;
  align-items: center;
  min-width: 20px;
  min-height: 20px;
`,RE=Rn`
from {
  transform: scale(0.6);
  opacity: 0.4;
}
to {
  transform: scale(1);
  opacity: 1;
}`,_E=lr("div")`
  position: relative;
  transform: scale(0.6);
  opacity: 0.4;
  min-width: 20px;
  animation: ${RE} 0.3s 0.12s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
`,IE=({toast:e})=>{let{icon:t,type:n,iconTheme:r}=e;return t!==void 0?typeof t=="string"?R.createElement(_E,null,t):t:n==="blank"?null:R.createElement(OE,null,R.createElement(bE,{...r}),n!=="loading"&&R.createElement(PE,null,n==="error"?R.createElement(wE,{...r}):R.createElement(kE,{...r})))},NE=e=>`
0% {transform: translate3d(0,${e*-200}%,0) scale(.6); opacity:.5;}
100% {transform: translate3d(0,0,0) scale(1); opacity:1;}
`,TE=e=>`
0% {transform: translate3d(0,0,-1px) scale(1); opacity:1;}
100% {transform: translate3d(0,${e*-150}%,-1px) scale(.6); opacity:0;}
`,LE="0%{opacity:0;} 100%{opacity:1;}",AE="0%{opacity:1;} 100%{opacity:0;}",ME=lr("div")`
  display: flex;
  align-items: center;
  background: #fff;
  color: #363636;
  line-height: 1.3;
  will-change: transform;
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1), 0 3px 3px rgba(0, 0, 0, 0.05);
  max-width: 350px;
  pointer-events: auto;
  padding: 8px 10px;
  border-radius: 8px;
`,jE=lr("div")`
  display: flex;
  justify-content: center;
  margin: 4px 10px;
  color: inherit;
  flex: 1 1 auto;
  white-space: pre-line;
`,DE=(e,t)=>{let n=e.includes("top")?1:-1,[r,i]=pE()?[LE,AE]:[NE(n),TE(n)];return{animation:t?`${Rn(r)} 0.35s cubic-bezier(.21,1.02,.73,1) forwards`:`${Rn(i)} 0.4s forwards cubic-bezier(.06,.71,.55,1)`}};R.memo(({toast:e,position:t,style:n,children:r})=>{let i=e.height?DE(e.position||t||"top-center",e.visible):{opacity:0},o=R.createElement(IE,{toast:e}),s=R.createElement(jE,{...e.ariaProps},Hc(e.message,e));return R.createElement(ME,{className:e.className,style:{...i,...n,...e.style}},typeof r=="function"?r({icon:o,message:s}):R.createElement(R.Fragment,null,o,s))});uE(R.createElement);Ma`
  z-index: 9999;
  > * {
    pointer-events: auto;
  }
`;var fe=Tt;const wv=()=>({}).VITE_SERVER_IP?{}.VITE_SERVER_IP:window.location.hostname,Ev=()=>!0,VE=()=>{const e=wv(),t={}.VITE_SERVER_PORT||"7000";return`https://${e}:${t}`},sa=()=>{const e=VE(),t=Ev();if(Ie.defaults.baseURL=e,Ie.defaults.timeout=3e4,Ie.defaults.maxContentLength=100*1024*1024,t&&typeof window>"u"){const n=require("https");Ie.defaults.httpsAgent=new n.Agent({rejectUnauthorized:!1})}return sa._tokenInterceptorAttached||(Ie.interceptors.request.use(n=>{try{const r=typeof window<"u"?localStorage.getItem("token"):null;r&&(n.headers=n.headers||{},n.headers.Authorization||(n.headers.Authorization=`Bearer ${r}`))}catch{}return n}),sa._tokenInterceptorAttached=!0),console.log("🔗 API Base URL 설정 (HTTPS → HTTPS):",e),e},FE=()=>{const e=wv(),t={}.VITE_SERVER_PORT||"7000";return`wss://${e}:${t}`},UE=()=>{const e=Ev(),t={getUserMedia:!!(navigator.mediaDevices&&navigator.mediaDevices.getUserMedia),RTCPeerConnection:!!window.RTCPeerConnection,RTCSessionDescription:!!window.RTCSessionDescription,RTCIceCandidate:!!window.RTCIceCandidate,https:e,wss:e,secure:e};return console.log("🎥 WebRTC 지원 상태:",t),e||console.warn("⚠️ WebRTC는 HTTPS 환경에서만 완전히 지원됩니다. 일부 기능이 제한될 수 있습니다."),t};sa();const bv=R.createContext(),on=()=>{const e=R.useContext(bv);if(!e)throw new Error("useAuth must be used within an AuthProvider");return e},$E=({children:e})=>{Ht();const[t,n]=R.useState(null),[r,i]=R.useState(!0),[o,s]=R.useState(!1),a=R.useRef(null),[c,l]=R.useState(!1),[u,d]=R.useState(null),[m,g]=R.useState(!1),[b,P]=R.useState(!1),[k,f]=R.useState(!1),v=async()=>{if(k)return console.log("⏳ 이미 미디어 권한 요청 중..."),!1;try{if(f(!0),console.log("🎥 미디어 권한 요청"),c&&u){const C=u.getVideoTracks(),O=u.getAudioTracks();if(C.length>0&&O.length>0){const F=C.some($=>$.readyState==="live"),W=O.some($=>$.readyState==="live");if(F&&W)return console.log("✅ 이미 미디어 권한이 있음 - 스트림 재사용"),f(!1),!0}}u&&(console.log("🧹 기존 스트림 정리"),u.getTracks().forEach(C=>{C.stop(),C.enabled=!1}),d(null),await new Promise(C=>setTimeout(C,500)));const _=await navigator.mediaDevices.getUserMedia({video:{width:{ideal:1280},height:{ideal:720},facingMode:"user"},audio:{echoCancellation:!0,noiseSuppression:!0,autoGainControl:!0}});return console.log("✅ 미디어 권한 획득 성공"),console.log("비디오 트랙:",_.getVideoTracks().length),console.log("오디오 트랙:",_.getAudioTracks().length),d(_),g(!0),P(!0),l(!0),fe.success("카메라와 마이크 권한이 허용되었습니다."),!0}catch(_){console.error("❌ 앱 시작 시 미디어 권한 요청 실패:",_);let C="카메라/마이크 권한이 필요합니다.";switch(_.name){case"NotAllowedError":C="카메라/마이크 권한이 거부되었습니다.";break;case"NotFoundError":C="카메라 또는 마이크 장치를 찾을 수 없습니다.";break;case"NotReadableError":C="카메라 또는 마이크가 다른 애플리케이션에서 사용 중입니다.";break;default:C=`미디어 접근 오류: ${_.message}`}return fe.error(C),l(!1),!1}finally{f(!1)}},w=async()=>{if(navigator.permissions)try{const _=await navigator.permissions.query({name:"camera"}),C=await navigator.permissions.query({name:"microphone"}),O=_.state==="granted"&&C.state==="granted";if(l(O),O&&!u){const F=await navigator.mediaDevices.getUserMedia({video:!0,audio:!0});d(F),g(!0),P(!0)}return O}catch(_){return console.log("권한 상태 확인 실패:",_),!1}return!1},y=()=>{if(a.current?.connected)return console.log("✅ Socket.IO 이미 연결됨 - 재사용"),a.current;if(a.current&&a.current.connecting)return console.log("⏳ Socket.IO 연결 중 - 대기"),a.current;const _=localStorage.getItem("token");if(!_)return console.log("토큰이 없어 Socket.IO 연결하지 않음"),null;console.log("🔗 Socket.IO 신규 연결 시작");const C=FE();return console.log("🔗 WebSocket URL:",C),a.current=qv(C,{transports:["websocket","polling"],auth:{token:_},reconnection:!0,reconnectionAttempts:1/0,reconnectionDelay:1e3,reconnectionDelayMax:5e3,timeout:2e4,forceNew:!1,upgrade:!0,rememberUpgrade:!0,pingTimeout:6e4,pingInterval:25e3,autoConnect:!0,rejectUnauthorized:!1,secure:!0}),a.current.on("connect",()=>{console.log("✅ Socket.IO 연결 성공:",a.current.id),s(!0);try{const O=localStorage.getItem("token");O&&a.current.emit("authenticate",{token:O})}catch(O){console.error("소켓 인증 이벤트 전송 실패:",O)}}),a.current.on("disconnect",O=>{console.log("⚠️ Socket.IO 연결 종료:",O),s(!1),O==="io server disconnect"||O==="transport close"||O==="transport error"?console.log("🔄 Socket.IO 자동 재연결 활성화"):O==="io client disconnect"&&console.log("📴 클라이언트가 의도적으로 연결 종료함")}),a.current.on("connect_error",O=>{console.error("❌ Socket.IO 연결 오류:",O),s(!1)}),a.current.on("reconnect",O=>{console.log("🔄 Socket.IO 재연결 성공:",O),s(!0)}),a.current.on("reconnect_attempt",O=>{console.log("🔄 Socket.IO 재연결 시도:",O)}),a.current.on("reconnect_error",O=>{console.error("❌ Socket.IO 재연결 오류:",O)}),a.current.on("reconnect_failed",()=>{console.error("❌ Socket.IO 재연결 실패"),fe.error("서버 연결에 실패했습니다. 페이지를 새로고침해주세요.")}),a.current.on("authenticated",()=>{console.log("✅ Socket.IO 인증 완료"),a.current.emit("request-server-state")}),a.current.on("ping",O=>{a.current.emit("pong",O),console.log("🏓 Ping 수신 → Pong 응답")}),a.current.on("connection-timeout",O=>{console.error("⏱️ 연결 타임아웃:",O.message),alert("서버와의 연결이 끊어졌습니다. 페이지를 새로고침해주세요.")}),a.current.on("auto-rejoin",O=>{console.log("🔄 자동 재입장 알림:",O),fe(O.message||"이전 입실 상태가 복원되었습니다."),window.location.pathname!==`/metaverse/${O.mapId}`&&(window.location.href=`/metaverse/${O.mapId}`)}),a.current},T=()=>{a.current&&(console.log("Socket.IO 연결 종료"),a.current.disconnect(),a.current=null,s(!1))};R.useEffect(()=>{const _=localStorage.getItem("token");_?M(_):i(!1)},[]),R.useEffect(()=>{t&&y()},[t]);const M=async _=>{try{console.log("checkAuth 호출 - token:",_?"존재":"없음");const C=await Ie.get("/api/auth/user/me",{headers:{Authorization:`Bearer ${_}`}});console.log("checkAuth 응답:",C.data),n(C.data.user)}catch(C){if(console.error("checkAuth 오류:",C.response?.status,C.response?.data),_){const O=localStorage.getItem("user");if(O)try{n(JSON.parse(O))}catch{}}}finally{i(!1)}},U=async(_,C)=>{try{console.log("로그인 시도 - email:",_,"password:",C?"제공됨":"없음"),console.log("API URL:",Ie.defaults.baseURL);const O=await Ie.post("/api/auth/login",{email:_,password:C});console.log("로그인 응답:",O.data);const{token:F,user:W}=O.data;return localStorage.setItem("token",F),localStorage.setItem("user",JSON.stringify(W)),n(W),fe.success("로그인되었습니다."),!0}catch(O){return console.error("로그인 오류:",O.response?.status,O.response?.data),console.error("로그인 오류 상세:",O),O.response?.data?.needsEmailVerification?(fe.error("이메일 인증이 필요합니다. 이메일을 확인하여 인증을 완료해주세요."),{needsEmailVerification:!0,email:_}):(fe.error(O.response?.data?.message||"로그인에 실패했습니다."),!1)}},S=async(_,C,O)=>{try{return console.log("회원가입 시도 - API URL:",Ie.defaults.baseURL),(await Ie.post("/api/auth/register",{username:_,email:C,password:O})).data.success?(fe.success("회원가입이 완료되었습니다. 이메일을 확인하여 인증을 완료해주세요."),{success:!0,needsEmailVerification:!0,email:C}):!1}catch(F){console.error("회원가입 오류:",F.response?.data);const W=F.response?.data?.message||"회원가입에 실패했습니다.";return fe.error(W),{success:!1,error:W,errorDetails:F.response?.data}}},p=async()=>{try{const _=localStorage.getItem("token");_&&await Ie.post("/api/auth/logout",{},{headers:{Authorization:`Bearer ${_}`}})}catch(_){console.error("로그아웃 오류:",_)}finally{localStorage.removeItem("token"),n(null),T(),fe.success("로그아웃되었습니다.")}},E=async()=>{try{const _=localStorage.getItem("token");if(!_)return fe.error("로그인이 필요합니다."),!1;if(!window.confirm(`정말로 계정을 삭제하시겠습니까?

이 작업은 되돌릴 수 없으며, 모든 데이터가 영구적으로 삭제됩니다.`))return!1;const O=await Ie.delete("/api/auth/delete-account",{headers:{Authorization:`Bearer ${_}`}});return O.data.success?(localStorage.removeItem("token"),n(null),T(),fe.success("계정이 성공적으로 삭제되었습니다."),!0):(fe.error(O.data.message||"계정 삭제에 실패했습니다."),!1)}catch(_){return console.error("계정 삭제 오류:",_),fe.error(_.response?.data?.message||"계정 삭제 중 오류가 발생했습니다."),!1}},I=async _=>{try{console.log("📧 이메일 인증 재전송 요청:",_);const C=await Ie.post("/api/auth/resend-verification",{email:_});return C.data.success?(fe.success("인증 이메일이 재전송되었습니다. 이메일을 확인해주세요."),{success:!0}):(fe.error(C.data.message||"이메일 재전송에 실패했습니다."),{success:!1,error:C.data.message})}catch(C){console.error("이메일 재전송 오류:",C);const O=C.response?.data?.message||"이메일 재전송 중 오류가 발생했습니다.";return fe.error(O),{success:!1,error:O}}},x=()=>{window.location.href="/api/auth/google"},[N,j]=R.useState(null);R.useEffect(()=>{j(a.current)},[o]);const X={user:t,loading:r,token:localStorage.getItem("token"),login:U,register:S,logout:p,deleteAccount:E,resendVerification:I,googleLogin:x,socket:N,socketConnected:o,connectSocket:y,hasMediaPermission:c,localStream:u,isCameraOn:m,isMicrophoneOn:b,requestMediaPermission:v,checkMediaPermission:w,setLocalStream:d,setIsCameraOn:g,setIsMicrophoneOn:P};return h.jsx(bv.Provider,{value:X,children:e})},BE=(e="향상된 캐릭터")=>{const t=document.createElement("canvas"),n=t.getContext("2d");t.width=32,t.height=32;const r={up:{head:"😊",body:"👕",arms:"👐",legs:"👖"},down:{head:"😊",body:"👕",arms:"👐",legs:"👖"},left:{head:"😊",body:"👕",arms:"👐",legs:"👖"},right:{head:"😊",body:"👕",arms:"👐",legs:"👖"}},i={};return Object.keys(r).forEach(o=>{n.clearRect(0,0,32,32),n.clearRect(0,0,32,32);const s=r[o];n.font="12px Arial",n.textAlign="center",n.fillStyle="#000000",n.fillText(s.head,16,8),n.font="10px Arial",n.fillText(s.body,16,18),n.font="8px Arial",o==="left"?n.fillText(s.arms,8,18):o==="right"?n.fillText(s.arms,24,18):(n.fillText(s.arms,12,18),n.fillText(s.arms,20,18)),n.font="8px Arial",n.fillText(s.legs,16,28),i[o]=t.toDataURL("image/png")}),{name:e,images:i,size:32,position:{x:0,y:0}}};sa();const Cv=R.createContext(),To=()=>{const e=R.useContext(Cv);if(!e)throw new Error("useMetaverse must be used within a MetaverseProvider");return e},zE=({children:e})=>{const{user:t,token:n,loading:r,socket:i}=on();Ht();const[o,s]=R.useState([]),[a,c]=R.useState([]),[l,u]=R.useState([]),[d,m]=R.useState(null),[g,b]=R.useState(null),[P,k]=R.useState(!1),[f,v]=R.useState(null),[w,y]=R.useState({}),[T,M]=R.useState([]),U=async()=>{if(n)try{k(!0);const $=await Ie.get("/api/maps"),q=await Ie.get("/api/user/logged-in-users");if($.data.success&&q.data.success){const H=$.data.maps||[],Q=q.data,Y=Q.mapUserCounts||{},L=H.map(J=>({...J,participantCount:Y[J.id]||0,participants:Q.mapUsers?.[J.id]||[]}));L.lobbyParticipantCount=Q.lobbyCount||0,s(L),v(null),console.log("맵별 사용자 수:",Y),console.log("대기실 사용자 수:",Q.lobbyCount)}else v("방 목록을 불러오는데 실패했습니다.")}catch($){console.error("방 목록 조회 오류:",$),v("방 목록을 불러오는데 실패했습니다.")}finally{k(!1)}},S=async()=>{if(n)try{const $=await Ie.get("/api/maps/active");$.data.success&&c($.data.maps||[])}catch($){console.error("활성화된 방 목록 조회 오류:",$)}},p=async $=>{if(console.log("🔍 fetchMap 호출:",{mapId:$,token:!!n}),!n||!$)return console.log("❌ fetchMap: token 또는 mapId 없음"),null;try{console.log("📡 API 호출:",`/maps/${$}`);const q=await Ie.get(`/api/maps/${$}`);return console.log("📡 API 응답:",q.data),q.data.success?(console.log("✅ fetchMap 성공:",q.data.map),q.data.map):(console.log("❌ fetchMap: API 응답 실패"),v("방을 찾을 수 없습니다."),null)}catch(q){return console.error("❌ fetchMap 오류:",q.response||q),v("방을 불러오는데 실패했습니다."),null}},E=async()=>{if(n)try{const $=await Ie.get("/api/characters");if($.data.success){const q=$.data.characters||[];u(q),q.length>0&&!d&&m(q[0])}}catch($){console.error("캐릭터 목록 조회 오류:",$)}},I=async $=>{if(!n)return null;try{const q=await Ie.post("/api/maps",$);if(q.data.success){const H=q.data.map;return s(Q=>[H,...Q]),H}else return v("방 생성에 실패했습니다."),null}catch(q){return console.error("방 생성 오류:",q),v("방 생성에 실패했습니다."),null}},x=async($,q)=>{if(!n||!$)return null;try{const H=await Ie.put(`/api/maps/${$}`,q);if(H.data.success){const Q=H.data.map;return s(Y=>Y.map(L=>L.id===$?Q:L)),Q}else return v("방 업데이트에 실패했습니다."),null}catch(H){return console.error("방 업데이트 오류:",H),v("방 업데이트에 실패했습니다."),null}},N=async $=>{if(!n||!$)return!1;try{return(await Ie.delete(`/api/maps/${$}`)).data.success?(s(H=>H.filter(Q=>Q.id!==$)),g&&g.id===$&&b(null),!0):(v("방 삭제에 실패했습니다."),!1)}catch(q){return console.error("방 삭제 오류:",q),v("방 삭제에 실패했습니다."),!1}},j=async($,q)=>{if(!n||!$)return null;try{const H=await Ie.put(`/api/characters/${$}`,q);if(H.data.success){const Q=H.data.character;return u(Y=>Y.map(L=>L.id===$?Q:L)),d&&d.id===$&&m(Q),Q}else return v("캐릭터 업데이트에 실패했습니다."),null}catch(H){return console.error("캐릭터 업데이트 오류:",H),v("캐릭터 업데이트에 실패했습니다."),null}},X=async $=>{if(!n)return null;try{const q=await Ie.post("/api/characters",$);if(q.data.success){const H=q.data.character;return u(Q=>[...Q,H]),H}else return v("캐릭터 생성에 실패했습니다."),null}catch(q){return console.error("캐릭터 생성 오류:",q),v("캐릭터 생성에 실패했습니다."),null}},_=$=>{m($)},C=$=>{b($)},O=async $=>{if(!n)return null;try{const q=BE($),H=await X(q);return H?(m(H),H):null}catch(q){return console.error("이모지 캐릭터 생성 오류:",q),null}};R.useEffect(()=>{console.log("🔍 MetaverseContext useEffect:",{user:!!t,token:!!n,authLoading:r}),t&&n&&!r?(console.log("✅ 사용자 인증 완료 - 데이터 로드 시작"),U(),E()):console.log("⏳ 사용자 인증 대기 중 또는 로딩 중")},[t,n,r]),R.useEffect(()=>{if(!t||!i)return;const $=Y=>{},q=Y=>{Y.mapId&&Y.occupants!==void 0&&y(L=>({...L,[Y.mapId]:Y.occupants}))},H=Y=>{Y.mapParticipants&&y(Y.mapParticipants)},Q=Y=>{Y.users&&M(Y.users)};return i.on("maps-list-updated",$),i.on("update-occupants",q),i.on("update-participants",H),i.on("all-logged-in-users-updated",Q),()=>{i.off("maps-list-updated",$),i.off("update-occupants",q),i.off("update-participants",H),i.off("all-logged-in-users-updated",Q)}},[t,i]),R.useEffect(()=>{if(l.length>0&&!d){const $=localStorage.getItem("selectedCharacterId");if($){const q=l.find(H=>H.id.toString()===$);if(q){m(q);return}}m(l[0])}},[l,d]),R.useEffect(()=>{d&&localStorage.setItem("selectedCharacterId",d.id.toString())},[d]);const W={maps:o,activeMaps:a,characters:l,currentCharacter:d,currentMap:g,loading:P,error:f,mapParticipants:w,allLoggedInUsers:T,fetchMaps:U,fetchActiveMaps:S,fetchMap:p,fetchCharacters:E,createMap:I,updateMap:x,deleteMap:N,updateCharacter:j,createCharacter:X,selectCharacter:_,selectMap:C,createEmojiCharacter:O,refreshMaps:()=>{U(),S()},setError:v};return h.jsx(Cv.Provider,{value:W,children:e})};const WE=()=>{const[e,t]=R.useState({email:"",password:""}),[n,r]=R.useState(!1),[i,o]=R.useState(""),[s,a]=R.useState(!1),[c,l]=R.useState(!1),{login:u,resendVerification:d}=on(),m=vn(),g=Ht(),P=new URLSearchParams(g.search).get("duplicate"),k=async w=>{w.preventDefault(),r(!0),o("");try{const y=await u(e.email,e.password);if(y&&typeof y=="object"&&y.needsEmailVerification)o("이메일 인증이 필요합니다. 이메일을 확인하여 인증을 완료해주세요."),a(!0);else if(y===!0){const T=g.state?.redirectTo||g.state?.from?.pathname||"/";m(T,{replace:!0})}else o("로그인에 실패했습니다. 이메일과 비밀번호를 확인해주세요.")}catch{o("로그인 중 오류가 발생했습니다.")}finally{r(!1)}},f=w=>{t({...e,[w.target.name]:w.target.value})},v=async()=>{l(!0);try{const w=await d(e.email);w.success?(o("인증 이메일이 재전송되었습니다. 이메일을 확인해주세요."),a(!1)):o(w.error||"이메일 재전송에 실패했습니다.")}catch{o("이메일 재전송 중 오류가 발생했습니다.")}finally{l(!1)}};return h.jsx("div",{className:"auth-container",children:h.jsxs("div",{className:"auth-card",children:[h.jsx("h1",{children:"mini area 로그인"}),h.jsx("p",{className:"auth-subtitle",children:"가상공간을 만들어보세요!"}),g.state?.message&&h.jsx("div",{className:"info-message",children:g.state.message}),P&&h.jsx("div",{className:"warning-message",children:"⚠️ 이미 다른 창에서 로그인되어 있습니다. 기존 연결을 종료한 후 다시 시도해주세요."}),i&&h.jsx("div",{className:"error-message",children:i}),s&&h.jsxs("div",{className:"resend-verification",children:[h.jsx("p",{children:"이메일을 받지 못하셨나요?"}),h.jsx("button",{type:"button",onClick:v,disabled:c,className:"resend-btn",children:c?"전송 중...":"인증 이메일 재전송"})]}),h.jsxs("form",{onSubmit:k,className:"register-form",children:[h.jsx("div",{className:"form-group",children:h.jsx("input",{type:"email",name:"email",value:e.email,onChange:f,required:!0,placeholder:"이메일을 입력하세요",className:"form-input"})}),h.jsx("div",{className:"form-group",children:h.jsx("input",{type:"password",name:"password",value:e.password,onChange:f,required:!0,placeholder:"비밀번호를 입력하세요",className:"form-input"})}),h.jsx("button",{type:"submit",disabled:n,children:n?"로그인 중...":"로그인"})]}),h.jsx("div",{className:"auth-footer",children:h.jsxs("p",{children:["계정이 없으신가요? ",h.jsx(qm,{to:"/register",children:"회원가입"})]})})]})})},HE=()=>{const[e,t]=R.useState({username:"",email:"",password:"",confirmPassword:""}),[n,r]=R.useState(!1),[i,o]=R.useState(""),[s,a]=R.useState(!1),[c,l]=R.useState(""),[u,d]=R.useState(!1),{register:m,resendVerification:g}=on(),b=vn(),P=Ht(),k=async w=>{if(w.preventDefault(),r(!0),o(""),e.password!==e.confirmPassword){o("비밀번호가 일치하지 않습니다."),r(!1);return}try{const y=await m(e.username,e.email,e.password);if(y&&y.success&&y.needsEmailVerification)l(e.email),a(!0),o("");else if(y&&y.success){const T=P.state?.from?.pathname||"/";b(T,{replace:!0})}else y&&y.error?(o(y.error),y.errorDetails?.canResend&&(l(y.errorDetails.email),a(!0))):o("회원가입에 실패했습니다. 다시 시도해주세요.")}catch{o("회원가입 중 오류가 발생했습니다.")}finally{r(!1)}},f=w=>{t({...e,[w.target.name]:w.target.value})},v=async()=>{d(!0);try{const w=await g(c);w.success?o("인증 이메일이 재전송되었습니다. 이메일을 확인해주세요."):o(w.error||"이메일 재전송에 실패했습니다.")}catch{o("이메일 재전송 중 오류가 발생했습니다.")}finally{d(!1)}};return h.jsx("div",{className:"auth-container",children:h.jsx("div",{className:"auth-card",children:s?h.jsxs("div",{className:"email-verification-success",children:[h.jsx("div",{className:"success-icon",children:"✓"}),h.jsx("h2",{children:"회원가입 완료!"}),h.jsx("p",{children:"이메일 인증이 필요합니다."}),h.jsxs("p",{children:[h.jsx("strong",{children:c}),"로 인증 이메일을 전송했습니다."]}),h.jsx("p",{children:"이메일을 확인하여 인증을 완료해주세요."}),h.jsxs("div",{className:"verification-actions",children:[h.jsx("button",{onClick:()=>b("/login"),className:"auth-button",children:"로그인 페이지로 이동"}),h.jsx("button",{onClick:()=>a(!1),className:"auth-button secondary",children:"다른 이메일로 다시 가입"}),h.jsx("button",{onClick:v,disabled:u,className:"auth-button resend",children:u?"전송 중...":"인증 이메일 재전송"})]})]}):h.jsxs(h.Fragment,{children:[h.jsx("h1",{children:"mini area 회원가입"}),h.jsx("p",{className:"auth-subtitle",children:"가상공간을 만들어보세요!"}),i&&h.jsx("div",{className:"error-message",children:i}),h.jsxs("form",{onSubmit:k,className:"register-form",children:[h.jsx("div",{className:"form-group",children:h.jsx("input",{id:"username",type:"text",name:"username",value:e.username,onChange:f,required:!0,placeholder:"사용자명을 입력하세요",className:"form-input"})}),h.jsx("div",{className:"form-group",children:h.jsx("input",{id:"email",type:"email",name:"email",value:e.email,onChange:f,required:!0,placeholder:"이메일을 입력하세요",className:"form-input"})}),h.jsx("div",{className:"form-group",children:h.jsx("input",{id:"password",type:"password",name:"password",value:e.password,onChange:f,required:!0,placeholder:"비밀번호를 입력하세요",className:"form-input"})}),h.jsx("div",{className:"form-group",children:h.jsx("input",{id:"confirmPassword",type:"password",name:"confirmPassword",value:e.confirmPassword,onChange:f,required:!0,placeholder:"비밀번호를 다시 입력하세요",className:"form-input"})}),h.jsx("button",{type:"submit",disabled:n,className:"auth-btn",children:n?"회원가입 중...":"회원가입"})]}),h.jsx("div",{className:"auth-footer",children:h.jsxs("p",{children:["이미 계정이 있으신가요? ",h.jsx(qm,{to:"/login",children:"로그인"})]})})]})})})},qE=()=>{const[e]=xS(),t=vn(),[n,r]=R.useState("verifying"),[i,o]=R.useState(""),[s,a]=R.useState(""),[c,l]=R.useState(!1);R.useEffect(()=>{const g=e.get("token");g?u(g):(r("error"),o("유효하지 않은 인증 링크입니다."))},[e]);const u=async g=>{try{const b=await Ie.get(`/api/auth/verify-email/${g}`);b.data.success?(r("success"),o(b.data.message)):(r("error"),o(b.data.message))}catch(b){r("error"),o(b.response?.data?.message||"이메일 인증 중 오류가 발생했습니다.")}},d=async()=>{if(!s){o("이메일 주소를 입력해주세요.");return}l(!0);try{const g=await Ie.post("/api/auth/resend-verification",{email:s});g.data.success?o("인증 이메일이 재전송되었습니다. 이메일을 확인해주세요."):o(g.data.message)}catch(g){o(g.response?.data?.message||"이메일 재전송 중 오류가 발생했습니다.")}finally{l(!1)}},m=()=>{switch(n){case"verifying":return h.jsxs("div",{className:"verifying",children:[h.jsx("div",{className:"loading-spinner"}),h.jsx("h3",{children:"이메일 인증 중..."}),h.jsx("p",{children:"잠시만 기다려주세요."})]});case"success":return h.jsxs("div",{className:"success",children:[h.jsx("div",{className:"success-icon",children:"✓"}),h.jsx("h3",{children:"이메일 인증 완료!"}),h.jsx("p",{children:i}),h.jsx("div",{className:"verification-actions",children:h.jsx("button",{onClick:()=>t("/login"),className:"auth-button",children:"로그인하기"})})]});case"error":return h.jsxs("div",{className:"error",children:[h.jsx("div",{className:"error-icon",children:"✗"}),h.jsx("h3",{children:"인증 실패"}),h.jsx("p",{children:i}),h.jsxs("div",{className:"resend-section",children:[h.jsx("p",{children:"인증 이메일을 다시 받으시겠습니까?"}),h.jsx("input",{type:"email",placeholder:"이메일 주소를 입력하세요",value:s,onChange:g=>a(g.target.value),className:"auth-input"}),h.jsx("button",{onClick:d,disabled:c,className:"auth-button",children:c?"전송 중...":"인증 이메일 재전송"})]}),h.jsx("div",{className:"verification-actions",children:h.jsx("button",{onClick:()=>t("/login"),className:"auth-button secondary",children:"로그인 페이지로 이동"})})]});default:return null}};return h.jsx("div",{className:"auth-container",children:h.jsx("div",{className:"auth-card",children:m()})})};var xv={},ed={};(function(e){var t=ue&&ue.__extends||function(){var r=function(i,o){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(s,a){s.__proto__=a}||function(s,a){for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(s[c]=a[c])},r(i,o)};return function(i,o){r(i,o);function s(){this.constructor=i}i.prototype=o===null?Object.create(o):(s.prototype=o.prototype,new s)}}();function n(r){if(!r)return n.__;Array.prototype.reduce||(Array.prototype.reduce=function(s,a){for(var c=a,l=0;l<this.length;l++)c=s(c,this[l],l,this);return c});var i="",o=("."+r).split(".").reduce(function(s,a,c,l){i?i+="."+a:i=a;var u=s["__"+i];return u===void 0&&(n.Logger.prototype=s,u=new n.Logger(i),s["__"+i]=u),u},n.__);return o}(function(r){r.requestId="",r.entryId=0,r._createXMLHttpRequest=function(){return new XMLHttpRequest},r._getTime=function(){return new Date().getTime()},r._console=console,r._appenderNames=[];function i(_,C,O){if(C[_]!==void 0){if(C[_]===null){delete O[_];return}O[_]=C[_]}}function o(_){if(r.enabled!=null&&!r.enabled)return!1;try{if(_.userAgentRegex&&!new RegExp(_.userAgentRegex).test(navigator.userAgent))return!1}catch{}try{if(_.ipRegex&&r.clientIP&&!new RegExp(_.ipRegex).test(r.clientIP))return!1}catch{}return!0}function s(_,C){try{if(_.disallow&&new RegExp(_.disallow).test(C))return!1}catch{}return!0}function a(_){return typeof _=="function"?_ instanceof RegExp?_.toString():_():_}var c=function(){function _(C,O,F){this.msg=C,this.meta=O,this.finalString=F}return _}();function l(_){var C=a(_),O;switch(typeof C){case"string":return new c(C,null,C);case"number":return O=C.toString(),new c(O,null,O);case"boolean":return O=C.toString(),new c(O,null,O);case"undefined":return new c("undefined",null,"undefined");case"object":return C instanceof RegExp||C instanceof String||C instanceof Number||C instanceof Boolean?(O=C.toString(),new c(O,null,O)):(typeof r.serialize=="function"?O=r.serialize.call(this,C):O=JSON.stringify(C),new c("",C,O));default:return new c("unknown",null,"unknown")}}function u(_){return i("enabled",_,this),i("maxMessages",_,this),i("defaultAjaxUrl",_,this),i("clientIP",_,this),i("requestId",_,this),i("defaultBeforeSend",_,this),i("serialize",_,this),this}r.setOptions=u;function d(){return-2147483648}r.getAllLevel=d;function m(){return 1e3}r.getTraceLevel=m;function g(){return 2e3}r.getDebugLevel=g;function b(){return 3e3}r.getInfoLevel=b;function P(){return 4e3}r.getWarnLevel=P;function k(){return 5e3}r.getErrorLevel=k;function f(){return 6e3}r.getFatalLevel=f;function v(){return 2147483647}r.getOffLevel=v;function w(_){return _<=1e3?"trace":_<=2e3?"debug":_<=3e3?"info":_<=4e3?"warn":_<=5e3?"error":"fatal"}var y=function(){function _(C,O){this.inner=O,this.name="JL.Exception",this.message=l(C).finalString}return _}();r.Exception=y,y.prototype=new Error;var T=function(){function _(C,O,F,W,$){this.l=C,this.m=O,this.n=F,this.t=W,this.u=$}return _}();r.LogItem=T;function M(_,C,O){return r.entryId++,new T(_,C,O,r._getTime(),r.entryId)}function U(_){_.id&&(clearTimeout(_.id),_.id=null)}function S(_,C,O){var F=this;_.id||(_.id=setTimeout(function(){O.call(F)},C))}var p=function(){function _(C,O){this.appenderName=C,this.sendLogItems=O,this.level=r.getTraceLevel(),this.sendWithBufferLevel=2147483647,this.storeInBufferLevel=-2147483648,this.bufferSize=0,this.batchSize=1,this.maxBatchSize=20,this.batchTimeout=2147483647,this.sendTimeout=5e3,this.buffer=[],this.batchBuffer=[],this.batchTimeoutTimer={id:null},this.sendTimeoutTimer={id:null},this.nbrLogItemsSkipped=0,this.nbrLogItemsBeingSent=0;var F="Trying to create an appender without a name or with an empty name";if(C==null)throw F;if(r._appenderNames.indexOf(C)!=-1)throw C?"Multiple appenders use the same name "+C:F;r._appenderNames.push(C)}return _.prototype.addLogItemsToBuffer=function(C){if(this.batchBuffer.length>=this.maxBatchSize){this.nbrLogItemsSkipped+=C.length;return}if(r.maxMessages!=null){if(r.maxMessages<1)return;r.maxMessages-=C.length}this.batchBuffer=this.batchBuffer.concat(C);var O=this;S(this.batchTimeoutTimer,this.batchTimeout,function(){O.sendBatch.call(O)})},_.prototype.batchBufferHasOverdueMessages=function(){for(var C=0;C<this.batchBuffer.length;C++){var O=r._getTime()-this.batchBuffer[C].t;if(O>this.batchTimeout)return!0}return!1},_.prototype.batchBufferHasStrandedMessage=function(){return r.maxMessages!=null&&r.maxMessages<1&&this.batchBuffer.length>0},_.prototype.sendBatchIfComplete=function(){(this.batchBuffer.length>=this.batchSize||this.batchBufferHasOverdueMessages()||this.batchBufferHasStrandedMessage())&&this.sendBatch()},_.prototype.onSendingEnded=function(){U(this.sendTimeoutTimer),this.nbrLogItemsBeingSent=0,this.sendBatchIfComplete()},_.prototype.setOptions=function(C){if(i("level",C,this),i("ipRegex",C,this),i("userAgentRegex",C,this),i("disallow",C,this),i("sendWithBufferLevel",C,this),i("storeInBufferLevel",C,this),i("bufferSize",C,this),i("batchSize",C,this),i("maxBatchSize",C,this),i("batchTimeout",C,this),i("sendTimeout",C,this),this.bufferSize<this.buffer.length&&(this.buffer.length=this.bufferSize),this.maxBatchSize<this.batchSize)throw new r.Exception({message:"maxBatchSize cannot be smaller than batchSize",maxBatchSize:this.maxBatchSize,batchSize:this.batchSize});return this},_.prototype.log=function(C,O,F,W,$,q,H){var Q;if(o(this)&&s(this,q)&&!($<this.storeInBufferLevel)){if(Q=M($,q,H),$<this.level){this.bufferSize>0&&(this.buffer.push(Q),this.buffer.length>this.bufferSize&&this.buffer.shift());return}this.addLogItemsToBuffer([Q]),$>=this.sendWithBufferLevel&&this.buffer.length&&(this.addLogItemsToBuffer(this.buffer),this.buffer.length=0),this.sendBatchIfComplete()}},_.prototype.sendBatch=function(){if(!(this.nbrLogItemsBeingSent>0)&&(U(this.batchTimeoutTimer),this.batchBuffer.length!=0)){this.nbrLogItemsBeingSent=this.batchBuffer.length;var C=this;S(this.sendTimeoutTimer,this.sendTimeout,function(){C.onSendingEnded.call(C)}),this.sendLogItems(this.batchBuffer,function(){C.batchBuffer.splice(0,C.nbrLogItemsBeingSent),C.nbrLogItemsSkipped>0&&(C.batchBuffer.push(M(P(),"Lost "+C.nbrLogItemsSkipped+" messages. Either connection with the server was down or logging was disabled via the enabled option. Reduce lost messages by increasing the ajaxAppender option maxBatchSize.",C.appenderName)),C.nbrLogItemsSkipped=0),C.onSendingEnded.call(C)})}},_}();r.Appender=p;var E=function(_){t(C,_);function C(O){return _.call(this,O,C.prototype.sendLogItemsAjax)||this}return C.prototype.setOptions=function(O){return i("url",O,this),i("beforeSend",O,this),_.prototype.setOptions.call(this,O),this},C.prototype.sendLogItemsAjax=function(O,F){try{if(!o(this))return;this.xhr&&this.xhr.readyState!=0&&this.xhr.readyState!=4&&this.xhr.abort(),this.xhr=r._createXMLHttpRequest();var W="/jsnlog.logger";r.defaultAjaxUrl!=null&&(W=r.defaultAjaxUrl),this.url&&(W=this.url),this.xhr.open("POST",W),this.xhr.setRequestHeader("Content-Type","application/json"),this.xhr.setRequestHeader("JSNLog-RequestId",r.requestId);var $=this;this.xhr.onreadystatechange=function(){$.xhr.readyState==4&&$.xhr.status>=200&&$.xhr.status<300&&F()};var q={r:r.requestId,lg:O};typeof this.beforeSend=="function"?this.beforeSend.call(this,this.xhr,q):typeof r.defaultBeforeSend=="function"&&r.defaultBeforeSend.call(this,this.xhr,q);var H=JSON.stringify(q);this.xhr.send(H)}catch{}},C}(p);r.AjaxAppender=E;var I=function(_){t(C,_);function C(O){return _.call(this,O,C.prototype.sendLogItemsConsole)||this}return C.prototype.clog=function(O){r._console.log(O)},C.prototype.cerror=function(O){r._console.error?r._console.error(O):this.clog(O)},C.prototype.cwarn=function(O){r._console.warn?r._console.warn(O):this.clog(O)},C.prototype.cinfo=function(O){r._console.info?r._console.info(O):this.clog(O)},C.prototype.cdebug=function(O){r._console.debug?r._console.debug(O):this.cinfo(O)},C.prototype.sendLogItemsConsole=function(O,F){try{if(!o(this)||!r._console)return;var W;for(W=0;W<O.length;++W){var $=O[W],q=$.n+": "+$.m;typeof window>"u"&&(q=new Date($.t)+" | "+q),$.l<=r.getDebugLevel()?this.cdebug(q):$.l<=r.getInfoLevel()?this.cinfo(q):$.l<=r.getWarnLevel()?this.cwarn(q):this.cerror(q)}}catch{}F()},C}(p);r.ConsoleAppender=I;var x=function(){function _(C){this.loggerName=C,this.seenRegexes=[]}return _.prototype.setOptions=function(C){return i("level",C,this),i("userAgentRegex",C,this),i("disallow",C,this),i("ipRegex",C,this),i("appenders",C,this),i("onceOnly",C,this),this.seenRegexes=[],this},_.prototype.buildExceptionObject=function(C){var O={};return C.stack?O.stack=C.stack:O.e=C,C.message&&(O.message=C.message),C.name&&(O.name=C.name),C.data&&(O.data=C.data),C.inner&&(O.inner=this.buildExceptionObject(C.inner)),O},_.prototype.log=function(C,O,F){var W=0,$,q;if(!this.appenders)return this;if(C>=this.level&&o(this)&&(F?(q=this.buildExceptionObject(F),q.logData=a(O)):q=O,$=l(q),s(this,$.finalString))){if(this.onceOnly)for(W=this.onceOnly.length-1;W>=0;){if(new RegExp(this.onceOnly[W]).test($.finalString)){if(this.seenRegexes[W])return this;this.seenRegexes[W]=!0}W--}for($.meta=$.meta||{},W=this.appenders.length-1;W>=0;)this.appenders[W].log(w(C),$.msg,$.meta,function(){},C,$.finalString,this.loggerName),W--}return this},_.prototype.trace=function(C){return this.log(m(),C)},_.prototype.debug=function(C){return this.log(g(),C)},_.prototype.info=function(C){return this.log(b(),C)},_.prototype.warn=function(C){return this.log(P(),C)},_.prototype.error=function(C){return this.log(k(),C)},_.prototype.fatal=function(C){return this.log(f(),C)},_.prototype.fatalException=function(C,O){return this.log(f(),C,O)},_}();r.Logger=x;function N(_){return new E(_)}r.createAjaxAppender=N;function j(_){return new I(_)}r.createConsoleAppender=j;var X;typeof window<"u"?X=new E(""):X=new I(""),r.__=new r.Logger(""),r.__.setOptions({level:r.getDebugLevel(),appenders:[X]})})(n||(n={})),e.__esModule=!0,e.JL=n,typeof __jsnlog_configure=="function"&&__jsnlog_configure(n),typeof window<"u"&&!window.onerror&&(window.onerror=function(r,i,o,s,a){return n("onerrorLogger").fatalException({msg:"Uncaught Exception",errorMsg:r?r.message||r:"",url:i,"line number":o,column:s},a),!1}),typeof window<"u"&&!window.onunhandledrejection&&(window.onunhandledrejection=function(r){n("onerrorLogger").fatalException({msg:"unhandledrejection",errorMsg:r.reason?r.reason.message:r.message||null},r.reason)})})(ed);var ja={},Lo={},td={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.LocalRecorderState=void 0,function(t){t.READY="READY",t.RECORDING="RECORDING",t.PAUSED="PAUSED",t.FINISHED="FINISHED"}(e.LocalRecorderState||(e.LocalRecorderState={}))})(td);var Ke={},Da={};Object.defineProperty(Da,"__esModule",{value:!0});Da.ConsoleLogger=void 0;var GE=function(){function e(t){this.logger=t,this.log=window.console.log,this.info=window.console.info,this.debug=window.console.debug,this.warn=window.console.warn,this.error=window.console.error}return e}();Da.ConsoleLogger=GE;var nd={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.OpenViduLoggerConfiguration=void 0,function(t){t.disabled="disabled",t.debug="debug",t.debug_app="debug_app"}(e.OpenViduLoggerConfiguration||(e.OpenViduLoggerConfiguration={}))})(nd);Object.defineProperty(Ke,"__esModule",{value:!0});Ke.OpenViduLogger=void 0;var Vt=ed,XE=Da,kl=nd,JE=function(){function e(){this.JSNLOG_URL="/openvidu/elk/openvidu-browser-logs",this.MAX_JSNLOG_BATCH_LOG_MESSAGES=100,this.MAX_MSECONDS_BATCH_MESSAGES=5e3,this.MAX_LENGTH_STRING_JSON=1e3,this.defaultConsoleLogger=new XE.ConsoleLogger(window.console),this.isProdMode=!1,this.isJSNLogSetup=!1}return e.configureJSNLog=function(t,n){var r=this;try{if(window.LOG_JSNLOG_RESULTS||this.instance&&t.isPro&&this.instance.isOpenViduBrowserLogsDebugActive(t)&&this.instance.canConfigureJSNLog(t,this.instance)){t.sendBrowserLogs===kl.OpenViduLoggerConfiguration.debug_app&&this.instance.replaceWindowConsole(),this.instance.isJSNLogSetup=!1,this.instance.info("Configuring JSNLogs.");var i=t.finalUserId,o=t.session.sessionId,s=function(c){var l=c.onreadystatechange;c.onreadystatechange=function(){r.isInvalidResponse(c)&&(Object.defineProperty(c,"readyState",{value:4}),Object.defineProperty(c,"status",{value:200}),r.instance.disableLogger()),l()},c.setRequestHeader("Authorization","Basic "+btoa(i+"%/%"+o+":"+n)),c.setRequestHeader("X-Requested-With","XMLHttpRequest"),c.setRequestHeader("OV-Final-User-Id",i),c.setRequestHeader("OV-Session-Id",o),c.setRequestHeader("OV-Token",n)};this.instance.currentAppender=Vt.JL.createAjaxAppender("appender-"+i+"-"+o),this.instance.currentAppender.setOptions({beforeSend:s,maxBatchSize:1e3,batchSize:this.instance.MAX_JSNLOG_BATCH_LOG_MESSAGES,batchTimeout:this.instance.MAX_MSECONDS_BATCH_MESSAGES});var a=function(c){var l=function(){var d=new WeakSet;return function(m,g){if(typeof g=="object"&&g!=null){if(d.has(g)||HTMLElement&&g instanceof HTMLElement)return;d.add(g)}return g}},u=JSON.stringify(c,l());return u.length>r.instance.MAX_LENGTH_STRING_JSON&&(u=u.substring(0,r.instance.MAX_LENGTH_STRING_JSON)+"..."),window.LOG_JSNLOG_RESULTS&&console.log(u),u};Vt.JL.setOptions({defaultAjaxUrl:t.httpUri+this.instance.JSNLOG_URL,serialize:a,enabled:!0}),Vt.JL().setOptions({appenders:[this.instance.currentAppender]}),this.instance.isJSNLogSetup=!0,this.instance.loggingSessionId=o,this.instance.info("JSNLog configured.")}}catch(c){console.error("Error configuring JSNLog: "),console.error(c),this.instance.disableLogger()}},e.getInstance=function(){return e.instance||(e.instance=new e),e.instance},e.isInvalidResponse=function(t){return t.status==401||t.status==403||t.status==404||t.status==0},e.prototype.canConfigureJSNLog=function(t,n){return t.session.sessionId!=n.loggingSessionId},e.prototype.isOpenViduBrowserLogsDebugActive=function(t){return t.sendBrowserLogs===kl.OpenViduLoggerConfiguration.debug||t.sendBrowserLogs===kl.OpenViduLoggerConfiguration.debug_app},e.prototype.getConsoleWithJSNLog=function(){return function(t){return{log:function(){t.defaultConsoleLogger.log.apply(t.defaultConsoleLogger.logger,arguments),t.isJSNLogSetup&&Vt.JL().info(arguments)},info:function(){t.defaultConsoleLogger.info.apply(t.defaultConsoleLogger.logger,arguments),t.isJSNLogSetup&&Vt.JL().info(arguments)},debug:function(){t.defaultConsoleLogger.debug.apply(t.defaultConsoleLogger.logger,arguments)},warn:function(){t.defaultConsoleLogger.warn.apply(t.defaultConsoleLogger.logger,arguments),t.isJSNLogSetup&&Vt.JL().warn(arguments)},error:function(){t.defaultConsoleLogger.error.apply(t.defaultConsoleLogger.logger,arguments),t.isJSNLogSetup&&Vt.JL().error(arguments)}}}(this)},e.prototype.replaceWindowConsole=function(){window.console=this.defaultConsoleLogger.logger,window.console.log=this.getConsoleWithJSNLog().log,window.console.info=this.getConsoleWithJSNLog().info,window.console.debug=this.getConsoleWithJSNLog().debug,window.console.warn=this.getConsoleWithJSNLog().warn,window.console.error=this.getConsoleWithJSNLog().error},e.prototype.disableLogger=function(){Vt.JL.setOptions({enabled:!1}),this.isJSNLogSetup=!1,this.loggingSessionId=void 0,this.currentAppender=void 0,window.console=this.defaultConsoleLogger.logger,window.console.log=this.defaultConsoleLogger.log,window.console.info=this.defaultConsoleLogger.info,window.console.debug=this.defaultConsoleLogger.debug,window.console.warn=this.defaultConsoleLogger.warn,window.console.error=this.defaultConsoleLogger.error},e.prototype.log=function(){this.isProdMode||this.defaultConsoleLogger.log.apply(this.defaultConsoleLogger.logger,arguments),this.isJSNLogSetup&&Vt.JL().info(arguments)},e.prototype.debug=function(){this.isProdMode||this.defaultConsoleLogger.debug.apply(this.defaultConsoleLogger.logger,arguments)},e.prototype.info=function(){this.isProdMode||this.defaultConsoleLogger.info.apply(this.defaultConsoleLogger.logger,arguments),this.isJSNLogSetup&&Vt.JL().info(arguments)},e.prototype.warn=function(){this.isProdMode||this.defaultConsoleLogger.warn.apply(this.defaultConsoleLogger.logger,arguments),this.isJSNLogSetup&&Vt.JL().warn(arguments)},e.prototype.error=function(){this.defaultConsoleLogger.error.apply(this.defaultConsoleLogger.logger,arguments),this.isJSNLogSetup&&Vt.JL().error(arguments)},e.prototype.flush=function(){this.isJSNLogSetup&&this.currentAppender!=null&&this.currentAppender.sendBatch()},e.prototype.enableProdMode=function(){this.isProdMode=!0},e}();Ke.OpenViduLogger=JE;var sn={},aa={exports:{}};/*!
 * Platform.js v1.3.6
 * Copyright 2014-2020 Benjamin Tan
 * Copyright 2011-2013 John-David Dalton
 * Available under MIT license
 */aa.exports;(function(e,t){(function(){var n={function:!0,object:!0},r=n[typeof window]&&window||this,i=t,o=e&&!e.nodeType&&e,s=i&&o&&typeof ue=="object"&&ue;s&&(s.global===s||s.window===s||s.self===s)&&(r=s);var a=Math.pow(2,53)-1,c=/\bOpera/,l=Object.prototype,u=l.hasOwnProperty,d=l.toString;function m(S){return S=String(S),S.charAt(0).toUpperCase()+S.slice(1)}function g(S,p,E){var I={"10.0":"10","6.4":"10 Technical Preview","6.3":"8.1","6.2":"8","6.1":"Server 2008 R2 / 7","6.0":"Server 2008 / Vista","5.2":"Server 2003 / XP 64-bit","5.1":"XP","5.01":"2000 SP1","5.0":"2000","4.0":"NT","4.90":"ME"};return p&&E&&/^Win/i.test(S)&&!/^Windows Phone /i.test(S)&&(I=I[/[\d.]+$/.exec(S)])&&(S="Windows "+I),S=String(S),p&&E&&(S=S.replace(RegExp(p,"i"),E)),S=P(S.replace(/ ce$/i," CE").replace(/\bhpw/i,"web").replace(/\bMacintosh\b/,"Mac OS").replace(/_PowerPC\b/i," OS").replace(/\b(OS X) [^ \d]+/i,"$1").replace(/\bMac (OS X)\b/,"$1").replace(/\/(\d)/," $1").replace(/_/g,".").replace(/(?: BePC|[ .]*fc[ \d.]+)$/i,"").replace(/\bx86\.64\b/gi,"x86_64").replace(/\b(Windows Phone) OS\b/,"$1").replace(/\b(Chrome OS \w+) [\d.]+\b/,"$1").split(" on ")[0]),S}function b(S,p){var E=-1,I=S?S.length:0;if(typeof I=="number"&&I>-1&&I<=a)for(;++E<I;)p(S[E],E,S);else k(S,p)}function P(S){return S=T(S),/^(?:webOS|i(?:OS|P))/.test(S)?S:m(S)}function k(S,p){for(var E in S)u.call(S,E)&&p(S[E],E,S)}function f(S){return S==null?m(S):d.call(S).slice(8,-1)}function v(S,p){var E=S!=null?typeof S[p]:"number";return!/^(?:boolean|number|string|undefined)$/.test(E)&&(E=="object"?!!S[p]:!0)}function w(S){return String(S).replace(/([ -])(?!$)/g,"$1?")}function y(S,p){var E=null;return b(S,function(I,x){E=p(E,I,x,S)}),E}function T(S){return String(S).replace(/^ +| +$/g,"")}function M(S){var p=r,E=S&&typeof S=="object"&&f(S)!="String";E&&(p=S,S=null);var I=p.navigator||{},x=I.userAgent||"";S||(S=x);var N=E?!!I.likeChrome:/\bChrome\b/.test(S)&&!/internal|\n/i.test(d.toString()),j="Object",X=E?j:"ScriptBridgingProxyObject",_=E?j:"Environment",C=E&&p.java?"JavaPackage":f(p.java),O=E?j:"RuntimeObject",F=/\bJava/.test(C)&&p.java,W=F&&f(p.environment)==_,$=F?"a":"α",q=F?"b":"β",H=p.document||{},Q=p.operamini||p.opera,Y=c.test(Y=E&&Q?Q["[[Class]]"]:f(Q))?Y:Q=null,L,J=S,ie=[],ee=null,ne=S==x,K=ne&&Q&&typeof Q.version=="function"&&Q.version(),be,de=qt([{label:"EdgeHTML",pattern:"Edge"},"Trident",{label:"WebKit",pattern:"AppleWebKit"},"iCab","Presto","NetFront","Tasman","KHTML","Gecko"]),G=_r(["Adobe AIR","Arora","Avant Browser","Breach","Camino","Electron","Epiphany","Fennec","Flock","Galeon","GreenBrowser","iCab","Iceweasel","K-Meleon","Konqueror","Lunascape","Maxthon",{label:"Microsoft Edge",pattern:"(?:Edge|Edg|EdgA|EdgiOS)"},"Midori","Nook Browser","PaleMoon","PhantomJS","Raven","Rekonq","RockMelt",{label:"Samsung Internet",pattern:"SamsungBrowser"},"SeaMonkey",{label:"Silk",pattern:"(?:Cloud9|Silk-Accelerated)"},"Sleipnir","SlimBrowser",{label:"SRWare Iron",pattern:"Iron"},"Sunrise","Swiftfox","Vivaldi","Waterfox","WebPositive",{label:"Yandex Browser",pattern:"YaBrowser"},{label:"UC Browser",pattern:"UCBrowser"},"Opera Mini",{label:"Opera Mini",pattern:"OPiOS"},"Opera",{label:"Opera",pattern:"OPR"},"Chromium","Chrome",{label:"Chrome",pattern:"(?:HeadlessChrome)"},{label:"Chrome Mobile",pattern:"(?:CriOS|CrMo)"},{label:"Firefox",pattern:"(?:Firefox|Minefield)"},{label:"Firefox for iOS",pattern:"FxiOS"},{label:"IE",pattern:"IEMobile"},{label:"IE",pattern:"MSIE"},"Safari"]),le=Ri([{label:"BlackBerry",pattern:"BB10"},"BlackBerry",{label:"Galaxy S",pattern:"GT-I9000"},{label:"Galaxy S2",pattern:"GT-I9100"},{label:"Galaxy S3",pattern:"GT-I9300"},{label:"Galaxy S4",pattern:"GT-I9500"},{label:"Galaxy S5",pattern:"SM-G900"},{label:"Galaxy S6",pattern:"SM-G920"},{label:"Galaxy S6 Edge",pattern:"SM-G925"},{label:"Galaxy S7",pattern:"SM-G930"},{label:"Galaxy S7 Edge",pattern:"SM-G935"},"Google TV","Lumia","iPad","iPod","iPhone","Kindle",{label:"Kindle Fire",pattern:"(?:Cloud9|Silk-Accelerated)"},"Nexus","Nook","PlayBook","PlayStation Vita","PlayStation","TouchPad","Transformer",{label:"Wii U",pattern:"WiiU"},"Wii","Xbox One",{label:"Xbox 360",pattern:"Xbox"},"Xoom"]),ve=Tn({Apple:{iPad:1,iPhone:1,iPod:1},Alcatel:{},Archos:{},Amazon:{Kindle:1,"Kindle Fire":1},Asus:{Transformer:1},"Barnes & Noble":{Nook:1},BlackBerry:{PlayBook:1},Google:{"Google TV":1,Nexus:1},HP:{TouchPad:1},HTC:{},Huawei:{},Lenovo:{},LG:{},Microsoft:{Xbox:1,"Xbox One":1},Motorola:{Xoom:1},Nintendo:{"Wii U":1,Wii:1},Nokia:{Lumia:1},Oppo:{},Samsung:{"Galaxy S":1,"Galaxy S2":1,"Galaxy S3":1,"Galaxy S4":1},Sony:{PlayStation:1,"PlayStation Vita":1},Xiaomi:{Mi:1,Redmi:1}}),Z=Ir(["Windows Phone","KaiOS","Android","CentOS",{label:"Chrome OS",pattern:"CrOS"},"Debian",{label:"DragonFly BSD",pattern:"DragonFly"},"Fedora","FreeBSD","Gentoo","Haiku","Kubuntu","Linux Mint","OpenBSD","Red Hat","SuSE","Ubuntu","Xubuntu","Cygwin","Symbian OS","hpwOS","webOS ","webOS","Tablet OS","Tizen","Linux","Mac OS X","Macintosh","Mac","Windows 98;","Windows "]);function qt(He){return y(He,function(_e,Se){return _e||RegExp("\\b"+(Se.pattern||w(Se))+"\\b","i").exec(S)&&(Se.label||Se)})}function Tn(He){return y(He,function(_e,Se,at){return _e||(Se[le]||Se[/^[a-z]+(?: +[a-z]+\b)*/i.exec(le)]||RegExp("\\b"+w(at)+"(?:\\b|\\w*\\d)","i").exec(S))&&at})}function _r(He){return y(He,function(_e,Se){return _e||RegExp("\\b"+(Se.pattern||w(Se))+"\\b","i").exec(S)&&(Se.label||Se)})}function Ir(He){return y(He,function(_e,Se){var at=Se.pattern||w(Se);return!_e&&(_e=RegExp("\\b"+at+"(?:/[\\d.]+|[ \\w.]*)","i").exec(S))&&(_e=g(_e,at,Se.label||Se)),_e})}function Ri(He){return y(He,function(_e,Se){var at=Se.pattern||w(Se);return!_e&&(_e=RegExp("\\b"+at+" *\\d+[.\\w_]*","i").exec(S)||RegExp("\\b"+at+" *\\w+-[\\w]*","i").exec(S)||RegExp("\\b"+at+"(?:; *(?:[a-z]+[_-])?[a-z]+\\d+|[^ ();-]*)","i").exec(S))&&((_e=String(Se.label&&!RegExp(at,"i").test(Se.label)?Se.label:_e).split("/"))[1]&&!/[\d.]+/.test(_e[0])&&(_e[0]+=" "+_e[1]),Se=Se.label||Se,_e=P(_e[0].replace(RegExp(at,"i"),Se).replace(RegExp("; *(?:"+Se+"[_-])?","i")," ").replace(RegExp("("+Se+")[-_.]?(\\w)","i"),"$1 $2"))),_e})}function _i(He){return y(He,function(_e,Se){return _e||(RegExp(Se+"(?:-[\\d.]+/|(?: for [\\w-]+)?[ /-])([\\d.]+[^ ();/_-]*)","i").exec(S)||0)[1]||null})}function zo(){return this.description||""}if(de&&(de=[de]),/\bAndroid\b/.test(Z)&&!le&&(L=/\bAndroid[^;]*;(.*?)(?:Build|\) AppleWebKit)\b/i.exec(S))&&(le=T(L[1]).replace(/^[a-z]{2}-[a-z]{2};\s*/i,"")||null),ve&&!le?le=Ri([ve]):ve&&le&&(le=le.replace(RegExp("^("+w(ve)+")[-_.\\s]","i"),ve+" ").replace(RegExp("^("+w(ve)+")[-_.]?(\\w)","i"),ve+" $2")),(L=/\bGoogle TV\b/.exec(le))&&(le=L[0]),/\bSimulator\b/i.test(S)&&(le=(le?le+" ":"")+"Simulator"),G=="Opera Mini"&&/\bOPiOS\b/.test(S)&&ie.push("running in Turbo/Uncompressed mode"),G=="IE"&&/\blike iPhone OS\b/.test(S)?(L=M(S.replace(/like iPhone OS/,"")),ve=L.manufacturer,le=L.product):/^iP/.test(le)?(G||(G="Safari"),Z="iOS"+((L=/ OS ([\d_]+)/i.exec(S))?" "+L[1].replace(/_/g,"."):"")):G=="Konqueror"&&/^Linux\b/i.test(Z)?Z="Kubuntu":ve&&ve!="Google"&&(/Chrome/.test(G)&&!/\bMobile Safari\b/i.test(S)||/\bVita\b/.test(le))||/\bAndroid\b/.test(Z)&&/^Chrome/.test(G)&&/\bVersion\//i.test(S)?(G="Android Browser",Z=/\bAndroid\b/.test(Z)?Z:"Android"):G=="Silk"?(/\bMobi/i.test(S)||(Z="Android",ie.unshift("desktop mode")),/Accelerated *= *true/i.test(S)&&ie.unshift("accelerated")):G=="UC Browser"&&/\bUCWEB\b/.test(S)?ie.push("speed mode"):G=="PaleMoon"&&(L=/\bFirefox\/([\d.]+)\b/.exec(S))?ie.push("identifying as Firefox "+L[1]):G=="Firefox"&&(L=/\b(Mobile|Tablet|TV)\b/i.exec(S))?(Z||(Z="Firefox OS"),le||(le=L[1])):!G||(L=!/\bMinefield\b/i.test(S)&&/\b(?:Firefox|Safari)\b/.exec(G))?(G&&!le&&/[\/,]|^[^(]+?\)/.test(S.slice(S.indexOf(L+"/")+8))&&(G=null),(L=le||ve||Z)&&(le||ve||/\b(?:Android|Symbian OS|Tablet OS|webOS)\b/.test(Z))&&(G=/[a-z]+(?: Hat)?/i.exec(/\bAndroid\b/.test(Z)?Z:L)+" Browser")):G=="Electron"&&(L=(/\bChrome\/([\d.]+)\b/.exec(S)||0)[1])&&ie.push("Chromium "+L),K||(K=_i(["(?:Cloud9|CriOS|CrMo|Edge|Edg|EdgA|EdgiOS|FxiOS|HeadlessChrome|IEMobile|Iron|Opera ?Mini|OPiOS|OPR|Raven|SamsungBrowser|Silk(?!/[\\d.]+$)|UCBrowser|YaBrowser)","Version",w(G),"(?:Firefox|Minefield|NetFront)"])),(L=de=="iCab"&&parseFloat(K)>3&&"WebKit"||/\bOpera\b/.test(G)&&(/\bOPR\b/.test(S)?"Blink":"Presto")||/\b(?:Midori|Nook|Safari)\b/i.test(S)&&!/^(?:Trident|EdgeHTML)$/.test(de)&&"WebKit"||!de&&/\bMSIE\b/i.test(S)&&(Z=="Mac OS"?"Tasman":"Trident")||de=="WebKit"&&/\bPlayStation\b(?! Vita\b)/i.test(G)&&"NetFront")&&(de=[L]),G=="IE"&&(L=(/; *(?:XBLWP|ZuneWP)(\d+)/i.exec(S)||0)[1])?(G+=" Mobile",Z="Windows Phone "+(/\+$/.test(L)?L:L+".x"),ie.unshift("desktop mode")):/\bWPDesktop\b/i.test(S)?(G="IE Mobile",Z="Windows Phone 8.x",ie.unshift("desktop mode"),K||(K=(/\brv:([\d.]+)/.exec(S)||0)[1])):G!="IE"&&de=="Trident"&&(L=/\brv:([\d.]+)/.exec(S))&&(G&&ie.push("identifying as "+G+(K?" "+K:"")),G="IE",K=L[1]),ne){if(v(p,"global"))if(F&&(L=F.lang.System,J=L.getProperty("os.arch"),Z=Z||L.getProperty("os.name")+" "+L.getProperty("os.version")),W){try{K=p.require("ringo/engine").version.join("."),G="RingoJS"}catch{(L=p.system)&&L.global.system==p.system&&(G="Narwhal",Z||(Z=L[0].os||null))}G||(G="Rhino")}else typeof p.process=="object"&&!p.process.browser&&(L=p.process)&&(typeof L.versions=="object"&&(typeof L.versions.electron=="string"?(ie.push("Node "+L.versions.node),G="Electron",K=L.versions.electron):typeof L.versions.nw=="string"&&(ie.push("Chromium "+K,"Node "+L.versions.node),G="NW.js",K=L.versions.nw)),G||(G="Node.js",J=L.arch,Z=L.platform,K=/[\d.]+/.exec(L.version),K=K?K[0]:null));else f(L=p.runtime)==X?(G="Adobe AIR",Z=L.flash.system.Capabilities.os):f(L=p.phantom)==O?(G="PhantomJS",K=(L=L.version||null)&&L.major+"."+L.minor+"."+L.patch):typeof H.documentMode=="number"&&(L=/\bTrident\/(\d+)/i.exec(S))?(K=[K,H.documentMode],(L=+L[1]+4)!=K[1]&&(ie.push("IE "+K[1]+" mode"),de&&(de[1]=""),K[1]=L),K=G=="IE"?String(K[1].toFixed(1)):K[0]):typeof H.documentMode=="number"&&/^(?:Chrome|Firefox)\b/.test(G)&&(ie.push("masking as "+G+" "+K),G="IE",K="11.0",de=["Trident"],Z="Windows");Z=Z&&P(Z)}if(K&&(L=/(?:[ab]|dp|pre|[ab]\d+pre)(?:\d+\+?)?$/i.exec(K)||/(?:alpha|beta)(?: ?\d)?/i.exec(S+";"+(ne&&I.appMinorVersion))||/\bMinefield\b/i.test(S)&&"a")&&(ee=/b/i.test(L)?"beta":"alpha",K=K.replace(RegExp(L+"\\+?$"),"")+(ee=="beta"?q:$)+(/\d+\+?/.exec(L)||"")),G=="Fennec"||G=="Firefox"&&/\b(?:Android|Firefox OS|KaiOS)\b/.test(Z))G="Firefox Mobile";else if(G=="Maxthon"&&K)K=K.replace(/\.[\d.]+/,".x");else if(/\bXbox\b/i.test(le))le=="Xbox 360"&&(Z=null),le=="Xbox 360"&&/\bIEMobile\b/.test(S)&&ie.unshift("mobile mode");else if((/^(?:Chrome|IE|Opera)$/.test(G)||G&&!le&&!/Browser|Mobi/.test(G))&&(Z=="Windows CE"||/Mobi/i.test(S)))G+=" Mobile";else if(G=="IE"&&ne)try{p.external===null&&ie.unshift("platform preview")}catch{ie.unshift("embedded")}else(/\bBlackBerry\b/.test(le)||/\bBB10\b/.test(S))&&(L=(RegExp(le.replace(/ +/g," *")+"/([.\\d]+)","i").exec(S)||0)[1]||K)?(L=[L,/BB10/.test(S)],Z=(L[1]?(le=null,ve="BlackBerry"):"Device Software")+" "+L[0],K=null):this!=k&&le!="Wii"&&(ne&&Q||/Opera/.test(G)&&/\b(?:MSIE|Firefox)\b/i.test(S)||G=="Firefox"&&/\bOS X (?:\d+\.){2,}/.test(Z)||G=="IE"&&(Z&&!/^Win/.test(Z)&&K>5.5||/\bWindows XP\b/.test(Z)&&K>8||K==8&&!/\bTrident\b/.test(S)))&&!c.test(L=M.call(k,S.replace(c,"")+";"))&&L.name&&(L="ing as "+L.name+((L=L.version)?" "+L:""),c.test(G)?(/\bIE\b/.test(L)&&Z=="Mac OS"&&(Z=null),L="identify"+L):(L="mask"+L,Y?G=P(Y.replace(/([a-z])([A-Z])/g,"$1 $2")):G="Opera",/\bIE\b/.test(L)&&(Z=null),ne||(K=null)),de=["Presto"],ie.push(L));(L=(/\bAppleWebKit\/([\d.]+\+?)/i.exec(S)||0)[1])&&(L=[parseFloat(L.replace(/\.(\d)$/,".0$1")),L],G=="Safari"&&L[1].slice(-1)=="+"?(G="WebKit Nightly",ee="alpha",K=L[1].slice(0,-1)):(K==L[1]||K==(L[2]=(/\bSafari\/([\d.]+\+?)/i.exec(S)||0)[1]))&&(K=null),L[1]=(/\b(?:Headless)?Chrome\/([\d.]+)/i.exec(S)||0)[1],L[0]==537.36&&L[2]==537.36&&parseFloat(L[1])>=28&&de=="WebKit"&&(de=["Blink"]),!ne||!N&&!L[1]?(de&&(de[1]="like Safari"),L=(L=L[0],L<400?1:L<500?2:L<526?3:L<533?4:L<534?"4+":L<535?5:L<537?6:L<538?7:L<601?8:L<602?9:L<604?10:L<606?11:L<608?12:"12")):(de&&(de[1]="like Chrome"),L=L[1]||(L=L[0],L<530?1:L<532?2:L<532.05?3:L<533?4:L<534.03?5:L<534.07?6:L<534.1?7:L<534.13?8:L<534.16?9:L<534.24?10:L<534.3?11:L<535.01?12:L<535.02?"13+":L<535.07?15:L<535.11?16:L<535.19?17:L<536.05?18:L<536.1?19:L<537.01?20:L<537.11?"21+":L<537.13?23:L<537.18?24:L<537.24?25:L<537.36?26:de!="Blink"?"27":"28")),de&&(de[1]+=" "+(L+=typeof L=="number"?".x":/[.+]/.test(L)?"":"+")),G=="Safari"&&(!K||parseInt(K)>45)?K=L:G=="Chrome"&&/\bHeadlessChrome/i.test(S)&&ie.unshift("headless")),G=="Opera"&&(L=/\bzbov|zvav$/.exec(Z))?(G+=" ",ie.unshift("desktop mode"),L=="zvav"?(G+="Mini",K=null):G+="Mobile",Z=Z.replace(RegExp(" *"+L+"$"),"")):G=="Safari"&&/\bChrome\b/.exec(de&&de[1])?(ie.unshift("desktop mode"),G="Chrome Mobile",K=null,/\bOS X\b/.test(Z)?(ve="Apple",Z="iOS 4.3+"):Z=null):/\bSRWare Iron\b/.test(G)&&!K&&(K=_i("Chrome")),K&&K.indexOf(L=/[\d.]+$/.exec(Z))==0&&S.indexOf("/"+L+"-")>-1&&(Z=T(Z.replace(L,""))),Z&&Z.indexOf(G)!=-1&&!RegExp(G+" OS").test(Z)&&(Z=Z.replace(RegExp(" *"+w(G)+" *"),"")),de&&!/\b(?:Avant|Nook)\b/.test(G)&&(/Browser|Lunascape|Maxthon/.test(G)||G!="Safari"&&/^iOS/.test(Z)&&/\bSafari\b/.test(de[1])||/^(?:Adobe|Arora|Breach|Midori|Opera|Phantom|Rekonq|Rock|Samsung Internet|Sleipnir|SRWare Iron|Vivaldi|Web)/.test(G)&&de[1])&&(L=de[de.length-1])&&ie.push(L),ie.length&&(ie=["("+ie.join("; ")+")"]),ve&&le&&le.indexOf(ve)<0&&ie.push("on "+ve),le&&ie.push((/^on /.test(ie[ie.length-1])?"":"on ")+le),Z&&(L=/ ([\d.+]+)$/.exec(Z),be=L&&Z.charAt(Z.length-L[0].length-1)=="/",Z={architecture:32,family:L&&!be?Z.replace(L[0],""):Z,version:L?L[1]:null,toString:function(){var He=this.version;return this.family+(He&&!be?" "+He:"")+(this.architecture==64?" 64-bit":"")}}),(L=/\b(?:AMD|IA|Win|WOW|x86_|x)64\b/i.exec(J))&&!/\bi686\b/i.test(J)?(Z&&(Z.architecture=64,Z.family=Z.family.replace(RegExp(" *"+L),"")),G&&(/\bWOW64\b/i.test(S)||ne&&/\w(?:86|32)$/.test(I.cpuClass||I.platform)&&!/\bWin64; x64\b/i.test(S))&&ie.unshift("32-bit")):Z&&/^OS X/.test(Z.family)&&G=="Chrome"&&parseFloat(K)>=39&&(Z.architecture=64),S||(S=null);var Qe={};return Qe.description=S,Qe.layout=de&&de[0],Qe.manufacturer=ve,Qe.name=G,Qe.prerelease=ee,Qe.product=le,Qe.ua=S,Qe.version=G&&K,Qe.os=Z||{architecture:null,family:null,version:null,toString:function(){return"null"}},Qe.parse=M,Qe.toString=zo,Qe.version&&ie.unshift(K),Qe.name&&ie.unshift(G),Z&&G&&!(Z==String(Z).split(" ")[0]&&(Z==G.split(" ")[0]||le))&&ie.push(le?"("+Z+")":"on "+Z),ie.length&&(Qe.description=ie.join(" ")),Qe}var U=M();i&&o?k(U,function(S,p){i[p]=S}):r.platform=U}).call(ue)})(aa,aa.exports);var KE=aa.exports;Object.defineProperty(sn,"__esModule",{value:!0});sn.PlatformUtils=void 0;var ye=KE,QE=function(){function e(){}return e.getInstance=function(){return this.instance||(this.instance=new e),e.instance},e.prototype.isChromeBrowser=function(){return ye.name==="Chrome"},e.prototype.isSafariBrowser=function(){return ye.name==="Safari"},e.prototype.isChromeMobileBrowser=function(){return ye.name==="Chrome Mobile"},e.prototype.isFirefoxBrowser=function(){return ye.name==="Firefox"},e.prototype.isFirefoxMobileBrowser=function(){return ye.name==="Firefox Mobile"||ye.name==="Firefox for iOS"},e.prototype.isOperaBrowser=function(){return ye.name==="Opera"},e.prototype.isOperaMobileBrowser=function(){return ye.name==="Opera Mobile"},e.prototype.isEdgeBrowser=function(){var t=ye?.version?parseFloat(ye.version):-1;return ye.name==="Microsoft Edge"&&t>=80},e.prototype.isEdgeMobileBrowser=function(){var t,n,r=ye?.version?parseFloat(ye.version):-1;return ye.name==="Microsoft Edge"&&(((t=ye.os)===null||t===void 0?void 0:t.family)==="Android"||((n=ye.os)===null||n===void 0?void 0:n.family)==="iOS")&&r>45},e.prototype.isAndroidBrowser=function(){return ye.name==="Android Browser"},e.prototype.isElectron=function(){return ye.name==="Electron"},e.prototype.isSamsungBrowser=function(){return ye.name==="Samsung Internet Mobile"||ye.name==="Samsung Internet"},e.prototype.isIPhoneOrIPad=function(){var t=ye.ua?ye.ua:navigator.userAgent,n="ontouchend"in document,r=/\b(\w*Macintosh\w*)\b/.test(t)&&n,i=/\b(\w*iPhone\w*)\b/.test(t)&&/\b(\w*Mobile\w*)\b/.test(t)&&n;return r||i},e.prototype.isIOSWithSafari=function(){var t=ye.ua?ye.ua:navigator.userAgent;return this.isIPhoneOrIPad()&&/\b(\w*Apple\w*)\b/.test(navigator.vendor)&&/\b(\w*Safari\w*)\b/.test(t)&&!/\b(\w*CriOS\w*)\b/.test(t)&&!/\b(\w*FxiOS\w*)\b/.test(t)},e.prototype.isIonicIos=function(){return this.isIPhoneOrIPad()&&ye.ua.indexOf("Safari")===-1},e.prototype.isIonicAndroid=function(){return ye.os.family==="Android"&&ye.name=="Android Browser"},e.prototype.isMobileDevice=function(){return ye.os.family==="iOS"||ye.os.family==="Android"},e.prototype.isReactNative=function(){return!1},e.prototype.isChromium=function(){return this.isChromeBrowser()||this.isChromeMobileBrowser()||this.isOperaBrowser()||this.isOperaMobileBrowser()||this.isEdgeBrowser()||this.isEdgeMobileBrowser()||this.isSamsungBrowser()||this.isIonicAndroid()||this.isIonicIos()||this.isElectron()},e.prototype.canScreenShare=function(){var t=ye?.version?parseFloat(ye.version):-1;return this.isMobileDevice()?!1:this.isChromeBrowser()||this.isFirefoxBrowser()||this.isOperaBrowser()||this.isElectron()||this.isEdgeBrowser()||this.isSafariBrowser()&&t>=13},e.prototype.getName=function(){return ye.name||""},e.prototype.getVersion=function(){return ye.version||""},e.prototype.getFamily=function(){return ye.os.family||""},e.prototype.getDescription=function(){return ye.description||""},e}();sn.PlatformUtils=QE;Object.defineProperty(Lo,"__esModule",{value:!0});Lo.LocalRecorder=void 0;var Ye=td,YE=Ke,ZE=sn,cn=YE.OpenViduLogger.getInstance(),qf,eb=function(){function e(t){this.stream=t,this.chunks=[],qf=ZE.PlatformUtils.getInstance(),this.connectionId=this.stream.connection?this.stream.connection.connectionId:"default-connection",this.id=this.stream.streamId+"_"+this.connectionId+"_localrecord",this.state=Ye.LocalRecorderState.READY}return e.prototype.record=function(t){var n=this;return new Promise(function(r,i){try{if(typeof MediaRecorder>"u")throw cn.error("MediaRecorder not supported on your browser. See compatibility in https://caniuse.com/#search=MediaRecorder"),Error("MediaRecorder not supported on your browser. See compatibility in https://caniuse.com/#search=MediaRecorder");if(n.state!==Ye.LocalRecorderState.READY)throw Error("'LocalRecord.record()' needs 'LocalRecord.state' to be 'READY' (current value: '"+n.state+"'). Call 'LocalRecorder.clean()' or init a new LocalRecorder before");cn.log("Starting local recording of stream '"+n.stream.streamId+"' of connection '"+n.connectionId+"'");var o={};typeof MediaRecorder.isTypeSupported=="function"?t?(MediaRecorder.isTypeSupported(t)||i(new Error('mimeType "'+t+'" is not supported')),o={mimeType:t}):cn.log("No mimeType parameter provided. Using default codecs"):cn.warn("MediaRecorder#isTypeSupported is not supported. Using default codecs"),n.mediaRecorder=new MediaRecorder(n.stream.getMediaStream(),o),n.mediaRecorder.start(10)}catch(s){i(s)}n.mediaRecorder.ondataavailable=function(s){n.chunks.push(s.data)},n.mediaRecorder.onerror=function(s){cn.error("MediaRecorder error: ",s)},n.mediaRecorder.onstart=function(){cn.log("MediaRecorder started (state="+n.mediaRecorder.state+")")},n.mediaRecorder.onstop=function(){n.onStopDefault()},n.mediaRecorder.onpause=function(){cn.log("MediaRecorder paused (state="+n.mediaRecorder.state+")")},n.mediaRecorder.onresume=function(){cn.log("MediaRecorder resumed (state="+n.mediaRecorder.state+")")},n.mediaRecorder.onwarning=function(s){cn.log("MediaRecorder warning: "+s)},n.state=Ye.LocalRecorderState.RECORDING,r()})},e.prototype.stop=function(){var t=this;return new Promise(function(n,r){try{if(t.state===Ye.LocalRecorderState.READY||t.state===Ye.LocalRecorderState.FINISHED)throw Error("'LocalRecord.stop()' needs 'LocalRecord.state' to be 'RECORDING' or 'PAUSED' (current value: '"+t.state+"'). Call 'LocalRecorder.start()' before");t.mediaRecorder.onstop=function(){t.onStopDefault(),n()},t.mediaRecorder.stop()}catch(i){r(i)}})},e.prototype.pause=function(){var t=this;return new Promise(function(n,r){try{t.state!==Ye.LocalRecorderState.RECORDING&&r(Error("'LocalRecord.pause()' needs 'LocalRecord.state' to be 'RECORDING' (current value: '"+t.state+"'). Call 'LocalRecorder.start()' or 'LocalRecorder.resume()' before")),t.mediaRecorder.pause(),t.state=Ye.LocalRecorderState.PAUSED,n()}catch(i){r(i)}})},e.prototype.resume=function(){var t=this;return new Promise(function(n,r){try{if(t.state!==Ye.LocalRecorderState.PAUSED)throw Error("'LocalRecord.resume()' needs 'LocalRecord.state' to be 'PAUSED' (current value: '"+t.state+"'). Call 'LocalRecorder.pause()' before");t.mediaRecorder.resume(),t.state=Ye.LocalRecorderState.RECORDING,n()}catch(i){r(i)}})},e.prototype.preview=function(t){if(this.state!==Ye.LocalRecorderState.FINISHED)throw Error("'LocalRecord.preview()' needs 'LocalRecord.state' to be 'FINISHED' (current value: '"+this.state+"'). Call 'LocalRecorder.stop()' before");if(this.videoPreview=document.createElement("video"),this.videoPreview.id=this.id,this.videoPreview.autoplay=!0,qf.isSafariBrowser()&&this.videoPreview.setAttribute("playsinline","true"),typeof t=="string"){var n=document.getElementById(t);n&&(this.videoPreview=n.appendChild(this.videoPreview))}else this.videoPreview=t.appendChild(this.videoPreview);return this.videoPreview.src=this.videoPreviewSrc,this.videoPreview},e.prototype.clean=function(){var t=this,n=function(){delete t.blob,t.chunks=[],delete t.mediaRecorder,t.state=Ye.LocalRecorderState.READY};this.state===Ye.LocalRecorderState.RECORDING||this.state===Ye.LocalRecorderState.PAUSED?this.stop().then(function(){return n()}).catch(function(){return n()}):n()},e.prototype.download=function(){if(this.state!==Ye.LocalRecorderState.FINISHED)throw Error("'LocalRecord.download()' needs 'LocalRecord.state' to be 'FINISHED' (current value: '"+this.state+"'). Call 'LocalRecorder.stop()' before");var t=document.createElement("a");t.style.display="none",document.body.appendChild(t);var n=window.URL.createObjectURL(this.blob);t.href=n,t.download=this.id+".webm",t.click(),window.URL.revokeObjectURL(n),document.body.removeChild(t)},e.prototype.getBlob=function(){if(this.state!==Ye.LocalRecorderState.FINISHED)throw Error("Call 'LocalRecord.stop()' before getting Blob file");return this.blob},e.prototype.uploadAsBinary=function(t,n){var r=this;return new Promise(function(i,o){if(r.state!==Ye.LocalRecorderState.FINISHED)o(Error("'LocalRecord.uploadAsBinary()' needs 'LocalRecord.state' to be 'FINISHED' (current value: '"+r.state+"'). Call 'LocalRecorder.stop()' before"));else{var s=new XMLHttpRequest;if(s.open("POST",t,!0),typeof n=="object")for(var a=0,c=Object.keys(n);a<c.length;a++){var l=c[a];s.setRequestHeader(l,n[l])}s.onreadystatechange=function(){s.readyState===4&&(s.status.toString().charAt(0)==="2"?i(s.responseText):o(s.status))},s.send(r.blob)}})},e.prototype.uploadAsMultipartfile=function(t,n){var r=this;return new Promise(function(i,o){if(r.state!==Ye.LocalRecorderState.FINISHED)o(Error("'LocalRecord.uploadAsMultipartfile()' needs 'LocalRecord.state' to be 'FINISHED' (current value: '"+r.state+"'). Call 'LocalRecorder.stop()' before"));else{var s=new XMLHttpRequest;if(s.open("POST",t,!0),typeof n=="object")for(var a=0,c=Object.keys(n);a<c.length;a++){var l=c[a];s.setRequestHeader(l,n[l])}var u=new FormData;u.append("file",r.blob,r.id+".webm"),s.onreadystatechange=function(){s.readyState===4&&(s.status.toString().charAt(0)==="2"?i(s.responseText):o(s.status))},s.send(u)}})},e.prototype.onStopDefault=function(){cn.log("MediaRecorder stopped  (state="+this.mediaRecorder.state+")"),this.blob=new Blob(this.chunks,{type:"video/webm"}),this.chunks=[],this.videoPreviewSrc=window.URL.createObjectURL(this.blob),this.state=Ye.LocalRecorderState.FINISHED},e}();Lo.LocalRecorder=eb;var Fi={},Ui={},Ao={},yi={},Si={},Nn={},st={};Object.defineProperty(st,"__esModule",{value:!0});st.Event=void 0;var tb=function(){function e(t,n,r){this.hasBeenPrevented=!1,this.cancelable=t,this.target=n,this.type=r}return e.prototype.isDefaultPrevented=function(){return this.hasBeenPrevented},e.prototype.preventDefault=function(){this.callDefaultBehavior=function(){},this.hasBeenPrevented=!0},e}();st.Event=tb;var nb=ue&&ue.__extends||function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},e(t,n)};return function(t,n){e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(Nn,"__esModule",{value:!0});Nn.StreamPropertyChangedEvent=void 0;var rb=st,ib=function(e){nb(t,e);function t(n,r,i,o,s,a){var c=e.call(this,!1,n,"streamPropertyChanged")||this;return c.stream=r,c.changedProperty=i,c.newValue=o,c.oldValue=s,c.reason=a,c}return t.prototype.callDefaultBehavior=function(){},t}(rb.Event);Nn.StreamPropertyChangedEvent=ib;var Rr={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.OpenViduError=e.OpenViduErrorName=void 0,function(n){n.BROWSER_NOT_SUPPORTED="BROWSER_NOT_SUPPORTED",n.DEVICE_ACCESS_DENIED="DEVICE_ACCESS_DENIED",n.DEVICE_ALREADY_IN_USE="DEVICE_ALREADY_IN_USE",n.SCREEN_CAPTURE_DENIED="SCREEN_CAPTURE_DENIED",n.SCREEN_SHARING_NOT_SUPPORTED="SCREEN_SHARING_NOT_SUPPORTED",n.SCREEN_EXTENSION_NOT_INSTALLED="SCREEN_EXTENSION_NOT_INSTALLED",n.SCREEN_EXTENSION_DISABLED="SCREEN_EXTENSION_DISABLED",n.INPUT_VIDEO_DEVICE_NOT_FOUND="INPUT_VIDEO_DEVICE_NOT_FOUND",n.INPUT_AUDIO_DEVICE_NOT_FOUND="INPUT_AUDIO_DEVICE_NOT_FOUND",n.INPUT_AUDIO_DEVICE_GENERIC_ERROR="INPUT_AUDIO_DEVICE_GENERIC_ERROR",n.NO_INPUT_SOURCE_SET="NO_INPUT_SOURCE_SET",n.PUBLISHER_PROPERTIES_ERROR="PUBLISHER_PROPERTIES_ERROR",n.OPENVIDU_PERMISSION_DENIED="OPENVIDU_PERMISSION_DENIED",n.OPENVIDU_NOT_CONNECTED="OPENVIDU_NOT_CONNECTED",n.GENERIC_ERROR="GENERIC_ERROR"}(e.OpenViduErrorName||(e.OpenViduErrorName={}));var t=function(){function n(r,i){this.name=r,this.message=i}return n}();e.OpenViduError=t})(Rr);Object.defineProperty(Si,"__esModule",{value:!0});Si.Filter=void 0;var Gf=Nn,Tr=Rr,ob=Ke,un=ob.OpenViduLogger.getInstance(),sb=function(){function e(t,n){this.handlers=new Map,this.type=t,this.options=n}return e.prototype.execMethod=function(t,n){var r=this;return new Promise(function(i,o){un.info("Executing filter method to stream "+r.stream.streamId);var s;if(typeof n!="string")try{s=JSON.stringify(n)}catch{var a="'params' property must be a JSON formatted object";un.error(a),o(a)}else s=n;r.stream.session.openvidu.sendRequest("execFilterMethod",{streamId:r.stream.streamId,method:t,params:s},function(c,l){if(c)un.error("Error executing filter method for Stream "+r.stream.streamId,c),c.code===401?o(new Tr.OpenViduError(Tr.OpenViduErrorName.OPENVIDU_PERMISSION_DENIED,"You don't have permissions to execute a filter method")):o(c);else{un.info("Filter method successfully executed on Stream "+r.stream.streamId);var u=Object.assign({},r.stream.filter);r.stream.filter.lastExecMethod={method:t,params:JSON.parse(s)},r.stream.session.emitEvent("streamPropertyChanged",[new Gf.StreamPropertyChangedEvent(r.stream.session,r.stream,"filter",r.stream.filter,u,"execFilterMethod")]),r.stream.streamManager.emitEvent("streamPropertyChanged",[new Gf.StreamPropertyChangedEvent(r.stream.streamManager,r.stream,"filter",r.stream.filter,u,"execFilterMethod")]),i()}})})},e.prototype.addEventListener=function(t,n){var r=this;return new Promise(function(i,o){un.info("Adding filter event listener to event "+t+" to stream "+r.stream.streamId),r.stream.session.openvidu.sendRequest("addFilterEventListener",{streamId:r.stream.streamId,eventType:t},function(s,a){s?(un.error("Error adding filter event listener to event "+t+"for Stream "+r.stream.streamId,s),s.code===401?o(new Tr.OpenViduError(Tr.OpenViduErrorName.OPENVIDU_PERMISSION_DENIED,"You don't have permissions to add a filter event listener")):o(s)):(r.handlers.set(t,n),un.info("Filter event listener to event "+t+" successfully applied on Stream "+r.stream.streamId),i())})})},e.prototype.removeEventListener=function(t){var n=this;return new Promise(function(r,i){un.info("Removing filter event listener to event "+t+" to stream "+n.stream.streamId),n.stream.session.openvidu.sendRequest("removeFilterEventListener",{streamId:n.stream.streamId,eventType:t},function(o,s){o?(un.error("Error removing filter event listener to event "+t+"for Stream "+n.stream.streamId,o),o.code===401?i(new Tr.OpenViduError(Tr.OpenViduErrorName.OPENVIDU_PERMISSION_DENIED,"You don't have permissions to add a filter event listener")):i(o)):(n.handlers.delete(t),un.info("Filter event listener to event "+t+" successfully removed on Stream "+n.stream.streamId),r())})})},e}();Si.Filter=sb;var wi={},Ei={},bi={},kv={exports:{}};/*!
 * EventEmitter v5.2.9 - git.io/ee
 * Unlicense - http://unlicense.org/
 * Oliver Caldwell - https://oli.me.uk/
 * @preserve
 */(function(e){(function(t){function n(){}var r=n.prototype,i=t.EventEmitter;function o(c,l){for(var u=c.length;u--;)if(c[u].listener===l)return u;return-1}function s(c){return function(){return this[c].apply(this,arguments)}}r.getListeners=function(l){var u=this._getEvents(),d,m;if(l instanceof RegExp){d={};for(m in u)u.hasOwnProperty(m)&&l.test(m)&&(d[m]=u[m])}else d=u[l]||(u[l]=[]);return d},r.flattenListeners=function(l){var u=[],d;for(d=0;d<l.length;d+=1)u.push(l[d].listener);return u},r.getListenersAsObject=function(l){var u=this.getListeners(l),d;return u instanceof Array&&(d={},d[l]=u),d||u};function a(c){return typeof c=="function"||c instanceof RegExp?!0:c&&typeof c=="object"?a(c.listener):!1}r.addListener=function(l,u){if(!a(u))throw new TypeError("listener must be a function");var d=this.getListenersAsObject(l),m=typeof u=="object",g;for(g in d)d.hasOwnProperty(g)&&o(d[g],u)===-1&&d[g].push(m?u:{listener:u,once:!1});return this},r.on=s("addListener"),r.addOnceListener=function(l,u){return this.addListener(l,{listener:u,once:!0})},r.once=s("addOnceListener"),r.defineEvent=function(l){return this.getListeners(l),this},r.defineEvents=function(l){for(var u=0;u<l.length;u+=1)this.defineEvent(l[u]);return this},r.removeListener=function(l,u){var d=this.getListenersAsObject(l),m,g;for(g in d)d.hasOwnProperty(g)&&(m=o(d[g],u),m!==-1&&d[g].splice(m,1));return this},r.off=s("removeListener"),r.addListeners=function(l,u){return this.manipulateListeners(!1,l,u)},r.removeListeners=function(l,u){return this.manipulateListeners(!0,l,u)},r.manipulateListeners=function(l,u,d){var m,g,b=l?this.removeListener:this.addListener,P=l?this.removeListeners:this.addListeners;if(typeof u=="object"&&!(u instanceof RegExp))for(m in u)u.hasOwnProperty(m)&&(g=u[m])&&(typeof g=="function"?b.call(this,m,g):P.call(this,m,g));else for(m=d.length;m--;)b.call(this,u,d[m]);return this},r.removeEvent=function(l){var u=typeof l,d=this._getEvents(),m;if(u==="string")delete d[l];else if(l instanceof RegExp)for(m in d)d.hasOwnProperty(m)&&l.test(m)&&delete d[m];else delete this._events;return this},r.removeAllListeners=s("removeEvent"),r.emitEvent=function(l,u){var d=this.getListenersAsObject(l),m,g,b,P,k;for(P in d)if(d.hasOwnProperty(P))for(m=d[P].slice(0),b=0;b<m.length;b++)g=m[b],g.once===!0&&this.removeListener(l,g.listener),k=g.listener.apply(this,u||[]),k===this._getOnceReturnValue()&&this.removeListener(l,g.listener);return this},r.trigger=s("emitEvent"),r.emit=function(l){var u=Array.prototype.slice.call(arguments,1);return this.emitEvent(l,u)},r.setOnceReturnValue=function(l){return this._onceReturnValue=l,this},r._getOnceReturnValue=function(){return this.hasOwnProperty("_onceReturnValue")?this._onceReturnValue:!0},r._getEvents=function(){return this._events||(this._events={})},n.noConflict=function(){return t.EventEmitter=i,n},e.exports?e.exports=n:t.EventEmitter=n})(typeof window<"u"?window:ue||{})})(kv);var rd=kv.exports;Object.defineProperty(bi,"__esModule",{value:!0});bi.EventDispatcher=void 0;var ab=rd,lb=Ke,ls=lb.OpenViduLogger.getInstance(),cb=function(){function e(){this.userHandlerArrowHandler=new WeakMap,this.ee=new ab}return e.prototype.off=function(t,n){if(!n)this.ee.removeAllListeners(t);else{var r=this.userHandlerArrowHandler.get(n);r&&this.ee.off(t,r),this.userHandlerArrowHandler.delete(n)}return this},e.prototype.onAux=function(t,n,r){var i=function(o){o?ls.info(n,o):ls.info(n),r(o)};return this.userHandlerArrowHandler.set(r,i),this.ee.on(t,i),this},e.prototype.onceAux=function(t,n,r){var i=this,o=function(s){s?ls.info(n,s):ls.info(n),r(s),i.userHandlerArrowHandler.delete(r)};return this.userHandlerArrowHandler.set(r,o),this.ee.once(t,o),this},e}();bi.EventDispatcher=cb;var Ci={},ub=ue&&ue.__extends||function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},e(t,n)};return function(t,n){e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(Ci,"__esModule",{value:!0});Ci.StreamManagerEvent=void 0;var db=st,fb=function(e){ub(t,e);function t(n,r,i){var o=e.call(this,!1,n,r)||this;return o.value=i,o}return t.prototype.callDefaultBehavior=function(){},t}(db.Event);Ci.StreamManagerEvent=fb;var xi={},pb=ue&&ue.__extends||function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},e(t,n)};return function(t,n){e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(xi,"__esModule",{value:!0});xi.VideoElementEvent=void 0;var hb=st,mb=function(e){pb(t,e);function t(n,r,i){var o=e.call(this,!1,r,i)||this;return o.element=n,o}return t.prototype.callDefaultBehavior=function(){},t}(hb.Event);xi.VideoElementEvent=mb;var Mo={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.VideoInsertMode=void 0,function(t){t.AFTER="AFTER",t.APPEND="APPEND",t.BEFORE="BEFORE",t.PREPEND="PREPEND",t.REPLACE="REPLACE"}(e.VideoInsertMode||(e.VideoInsertMode={}))})(Mo);var ki={};(function(e){var t=ue&&ue.__extends||function(){var i=function(o,s){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,c){a.__proto__=c}||function(a,c){for(var l in c)Object.prototype.hasOwnProperty.call(c,l)&&(a[l]=c[l])},i(o,s)};return function(o,s){i(o,s);function a(){this.constructor=o}o.prototype=s===null?Object.create(s):(a.prototype=s.prototype,new a)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.ExceptionEvent=e.ExceptionEventName=void 0;var n=st;(function(i){i.ICE_CANDIDATE_ERROR="ICE_CANDIDATE_ERROR",i.ICE_CONNECTION_FAILED="ICE_CONNECTION_FAILED",i.ICE_CONNECTION_DISCONNECTED="ICE_CONNECTION_DISCONNECTED",i.NO_STREAM_PLAYING_EVENT="NO_STREAM_PLAYING_EVENT"})(e.ExceptionEventName||(e.ExceptionEventName={}));var r=function(i){t(o,i);function o(s,a,c,l,u){var d=i.call(this,!1,s,"exception")||this;return d.name=a,d.origin=c,d.message=l,d.data=u,d}return o.prototype.callDefaultBehavior=function(){},o}(n.Event);e.ExceptionEvent=r})(ki);var vb=ue&&ue.__extends||function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},e(t,n)};return function(t,n){e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(Ei,"__esModule",{value:!0});Ei.StreamManager=void 0;var gb=bi,Pl=Ci,yn=xi,cr=Mo,yb=Ke,Sb=sn,Xf=ki,Lr=yb.OpenViduLogger.getInstance(),yt,wb=function(e){vb(t,e);function t(n,r){var i=e.call(this)||this;if(i.videos=[],i.lazyLaunchVideoElementCreatedEvent=!1,yt=Sb.PlatformUtils.getInstance(),i.stream=n,i.stream.streamManager=i,i.remote=!i.stream.isLocal(),r){var o=void 0;typeof r=="string"?o=document.getElementById(r):r instanceof HTMLElement&&(o=r),o&&(i.firstVideoElement={targetElement:o,video:document.createElement("video"),id:"",canplayListenerAdded:!1},(yt.isSafariBrowser()||yt.isIPhoneOrIPad()&&(yt.isChromeMobileBrowser()||yt.isEdgeMobileBrowser()||yt.isOperaMobileBrowser()||yt.isFirefoxMobileBrowser()))&&i.firstVideoElement.video.setAttribute("playsinline","true"),i.targetElement=o,i.element=o)}return i.canPlayListener=function(){i.deactivateStreamPlayingEventExceptionTimeout(),i.remote?(Lr.info("Remote 'Stream' with id ["+i.stream.streamId+"] video is now playing"),i.ee.emitEvent("videoPlaying",[new yn.VideoElementEvent(i.videos[0].video,i,"videoPlaying")])):i.stream.displayMyRemote()?(Lr.info("Your own remote 'Stream' with id ["+i.stream.streamId+"] video is now playing"),i.ee.emitEvent("remoteVideoPlaying",[new yn.VideoElementEvent(i.videos[0].video,i,"remoteVideoPlaying")])):(Lr.info("Your local 'Stream' with id ["+i.stream.streamId+"] video is now playing"),i.ee.emitEvent("videoPlaying",[new yn.VideoElementEvent(i.videos[0].video,i,"videoPlaying")])),i.ee.emitEvent("streamPlaying",[new Pl.StreamManagerEvent(i,"streamPlaying",void 0)])},i}return t.prototype.on=function(n,r){return e.prototype.onAux.call(this,n,"Event '"+n+"' triggered by '"+(this.remote?"Subscriber":"Publisher")+"'",r),n==="videoElementCreated"&&this.stream&&this.lazyLaunchVideoElementCreatedEvent&&(this.ee.emitEvent("videoElementCreated",[new yn.VideoElementEvent(this.videos[0].video,this,"videoElementCreated")]),this.lazyLaunchVideoElementCreatedEvent=!1),(n==="streamPlaying"||n==="videoPlaying")&&this.videos[0]&&this.videos[0].video&&this.videos[0].video.currentTime>0&&this.videos[0].video.paused===!1&&this.videos[0].video.ended===!1&&this.videos[0].video.readyState===4&&(this.ee.emitEvent("streamPlaying",[new Pl.StreamManagerEvent(this,"streamPlaying",void 0)]),this.ee.emitEvent("videoPlaying",[new yn.VideoElementEvent(this.videos[0].video,this,"videoPlaying")])),this.stream.hasAudio&&(n==="publisherStartSpeaking"&&this.stream.enableHarkSpeakingEvent(),n==="publisherStopSpeaking"&&this.stream.enableHarkStoppedSpeakingEvent(),n==="streamAudioVolumeChange"&&this.stream.enableHarkVolumeChangeEvent(!1)),this},t.prototype.once=function(n,r){return e.prototype.onceAux.call(this,n,"Event '"+n+"' triggered once by '"+(this.remote?"Subscriber":"Publisher")+"'",r),n==="videoElementCreated"&&this.stream&&this.lazyLaunchVideoElementCreatedEvent&&this.ee.emitEvent("videoElementCreated",[new yn.VideoElementEvent(this.videos[0].video,this,"videoElementCreated")]),(n==="streamPlaying"||n==="videoPlaying")&&this.videos[0]&&this.videos[0].video&&this.videos[0].video.currentTime>0&&this.videos[0].video.paused===!1&&this.videos[0].video.ended===!1&&this.videos[0].video.readyState===4&&(this.ee.emitEvent("streamPlaying",[new Pl.StreamManagerEvent(this,"streamPlaying",void 0)]),this.ee.emitEvent("videoPlaying",[new yn.VideoElementEvent(this.videos[0].video,this,"videoPlaying")])),this.stream.hasAudio&&(n==="publisherStartSpeaking"&&this.stream.enableOnceHarkSpeakingEvent(),n==="publisherStopSpeaking"&&this.stream.enableOnceHarkStoppedSpeakingEvent(),n==="streamAudioVolumeChange"&&this.stream.enableOnceHarkVolumeChangeEvent(!1)),this},t.prototype.off=function(n,r){if(e.prototype.off.call(this,n,r),n==="publisherStartSpeaking"){var i=this.ee.getListeners(n).length+this.stream.session.ee.getListeners(n).length;i===0&&this.stream.disableHarkSpeakingEvent(!1)}if(n==="publisherStopSpeaking"){var o=this.ee.getListeners(n).length+this.stream.session.ee.getListeners(n).length;o===0&&this.stream.disableHarkStoppedSpeakingEvent(!1)}if(n==="streamAudioVolumeChange"){var s=this.ee.getListeners(n).length;s===0&&this.stream.disableHarkVolumeChangeEvent(!1)}return this},t.prototype.addVideoElement=function(n){this.initializeVideoProperties(n),!this.remote&&this.stream.displayMyRemote()&&n.srcObject!==this.stream.getMediaStream()&&(n.srcObject=this.stream.getMediaStream());for(var r=0,i=this.videos;r<i.length;r++){var o=i[r];if(o.video===n)return 0}for(var s=1,a=0,c=this.stream.session.streamManagers;a<c.length;a++){var l=c[a];if(l.disassociateVideo(n)){s=-1;break}}return this.stream.session.streamManagers.forEach(function(u){u.disassociateVideo(n)}),this.pushNewStreamManagerVideo({video:n,id:n.id,canplayListenerAdded:!1}),Lr.info("New video element associated to ",this),s},t.prototype.createVideoElement=function(n,r){var i;if(typeof n=="string"){if(i=document.getElementById(n),!i)throw new Error("The provided 'targetElement' couldn't be resolved to any HTML element: "+n)}else if(n instanceof HTMLElement)i=n;else throw new Error("The provided 'targetElement' couldn't be resolved to any HTML element: "+n);var o=this.createVideo();this.initializeVideoProperties(o);var s=r||cr.VideoInsertMode.APPEND;switch(s){case cr.VideoInsertMode.AFTER:i.parentNode.insertBefore(o,i.nextSibling);break;case cr.VideoInsertMode.APPEND:i.appendChild(o);break;case cr.VideoInsertMode.BEFORE:i.parentNode.insertBefore(o,i);break;case cr.VideoInsertMode.PREPEND:i.insertBefore(o,i.childNodes[0]);break;case cr.VideoInsertMode.REPLACE:i.parentNode.replaceChild(o,i);break;default:s=cr.VideoInsertMode.APPEND,i.appendChild(o);break}var a={targetElement:i,video:o,insertMode:s,id:o.id,canplayListenerAdded:!1};return this.pushNewStreamManagerVideo(a),this.ee.emitEvent("videoElementCreated",[new yn.VideoElementEvent(a.video,this,"videoElementCreated")]),this.lazyLaunchVideoElementCreatedEvent=!!this.firstVideoElement,o},t.prototype.updatePublisherSpeakingEventsOptions=function(n){var r=this.stream.harkOptions?this.stream.harkOptions:this.stream.session.openvidu.advancedConfiguration.publisherSpeakingEventsOptions||{},i=typeof n.interval=="number"?n.interval:typeof r.interval=="number"?r.interval:100,o=typeof n.threshold=="number"?n.threshold:typeof r.threshold=="number"?r.threshold:-50;this.stream.harkOptions={interval:i,threshold:o},this.stream.speechEvent&&(this.stream.speechEvent.setInterval(i),this.stream.speechEvent.setThreshold(o))},t.prototype.initializeVideoProperties=function(n){!this.remote&&this.stream.displayMyRemote()||n.srcObject!==this.stream.getMediaStream()&&(n.srcObject=this.stream.getMediaStream()),n.autoplay=!0,n.controls=!1,(yt.isSafariBrowser()||yt.isIPhoneOrIPad()&&(yt.isChromeMobileBrowser()||yt.isEdgeMobileBrowser()||yt.isOperaMobileBrowser()||yt.isFirefoxMobileBrowser()))&&n.setAttribute("playsinline","true"),n.id||(n.id=(this.remote?"remote-":"local-")+"video-"+this.stream.streamId,!this.id&&this.targetElement&&(this.id=n.id)),!this.remote&&!this.stream.displayMyRemote()&&(n.muted=!0,n.style.transform==="rotateY(180deg)"&&!this.stream.outboundStreamOpts.publisherProperties.mirror?this.removeMirrorVideo(n):this.stream.outboundStreamOpts.publisherProperties.mirror&&!this.stream.isSendScreen()&&this.mirrorVideo(n))},t.prototype.removeAllVideos=function(){for(var n=this,r=this.stream.session.streamManagers.length-1;r>=0;--r)this.stream.session.streamManagers[r]===this&&this.stream.session.streamManagers.splice(r,1);this.videos.forEach(function(i){i.video&&i.video.removeEventListener&&i.video.removeEventListener("canplay",n.canPlayListener),i.canplayListenerAdded=!1,i.targetElement&&(i.video.parentNode.removeChild(i.video),n.ee.emitEvent("videoElementDestroyed",[new yn.VideoElementEvent(i.video,n,"videoElementDestroyed")])),n.removeSrcObject(i),n.videos.filter(function(o){return!o.targetElement})})},t.prototype.disassociateVideo=function(n){for(var r=!1,i=0;i<this.videos.length;i++)if(this.videos[i].video===n){this.videos[i].video.removeEventListener("canplay",this.canPlayListener),this.videos.splice(i,1),r=!0,Lr.info("Video element disassociated from ",this);break}return r},t.prototype.addPlayEventToFirstVideo=function(){this.videos[0]&&this.videos[0].video&&!this.videos[0].canplayListenerAdded&&(this.activateStreamPlayingEventExceptionTimeout(),this.videos[0].video.addEventListener("canplay",this.canPlayListener),this.videos[0].canplayListenerAdded=!0)},t.prototype.updateMediaStream=function(n){this.videos.forEach(function(r){if(r.video.srcObject=n,yt.isIonicIos()){var i=r.video.parentElement,o=r.video;i.replaceChild(o,r.video),r.video=o}})},t.prototype.emitEvent=function(n,r){this.ee.emitEvent(n,r)},t.prototype.createVideo=function(){return document.createElement("video")},t.prototype.removeSrcObject=function(n){n.video.srcObject=null,this.deactivateStreamPlayingEventExceptionTimeout()},t.prototype.pushNewStreamManagerVideo=function(n){this.videos.push(n),this.addPlayEventToFirstVideo(),this.stream.session.streamManagers.indexOf(this)===-1&&this.stream.session.streamManagers.push(this)},t.prototype.mirrorVideo=function(n){yt.isIonicIos()||(n.style.transform="rotateY(180deg)",n.style.webkitTransform="rotateY(180deg)")},t.prototype.removeMirrorVideo=function(n){n.style.transform="unset",n.style.webkitTransform="unset"},t.prototype.activateStreamPlayingEventExceptionTimeout=function(){var n=this;if(this.remote&&this.streamPlayingEventExceptionTimeout==null){var r=this.stream.session.openvidu.advancedConfiguration.noStreamPlayingEventExceptionTimeout||4e3;this.streamPlayingEventExceptionTimeout=setTimeout(function(){var i="StreamManager of Stream "+n.stream.streamId+" ("+(n.remote?"Subscriber":"Publisher")+') did not trigger "streamPlaying" event in '+r+" ms";Lr.warn(i),n.stream.session.emitEvent("exception",[new Xf.ExceptionEvent(n.stream.session,Xf.ExceptionEventName.NO_STREAM_PLAYING_EVENT,n,i)]),delete n.streamPlayingEventExceptionTimeout},r)}},t.prototype.deactivateStreamPlayingEventExceptionTimeout=function(){clearTimeout(this.streamPlayingEventExceptionTimeout),delete this.streamPlayingEventExceptionTimeout},t}(gb.EventDispatcher);Ei.StreamManager=wb;var Eb=ue&&ue.__extends||function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},e(t,n)};return function(t,n){e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(wi,"__esModule",{value:!0});wi.Subscriber=void 0;var bb=Ei,Cb=Ke,Jf=Cb.OpenViduLogger.getInstance(),xb=function(e){Eb(t,e);function t(n,r,i){var o=e.call(this,n,r)||this;return o.element=o.targetElement,o.stream=n,o.properties=i,o}return t.prototype.subscribeToAudio=function(n){return this.stream.getMediaStream().getAudioTracks().forEach(function(r){r.enabled=n}),this.stream.audioActive=n,Jf.info("'Subscriber' has "+(n?"subscribed to":"unsubscribed from")+" its audio stream"),this},t.prototype.subscribeToVideo=function(n){return this.stream.getMediaStream().getVideoTracks().forEach(function(r){r.enabled=n}),this.stream.videoActive=n,Jf.info("'Subscriber' has "+(n?"subscribed to":"unsubscribed from")+" its video stream"),this},t}(bb.StreamManager);wi.Subscriber=xb;var pn={},Kf=["stun:","turn:"],kb=function(e){var t=(e||{}).url||e,n,r,i={};return typeof t!="string"&&!(t instanceof String)||(t=t.trim(),n=Kf[Kf.indexOf(t.slice(0,5))],!n)?e:(t=t.slice(5),r=t.split("@"),i.username=e.username,i.credential=e.credential,r.length>1&&(t=r[1],r=r[0].split(":"),i.username=r[0],i.credential=(e||{}).credential||r[1]||""),i.url=n+t,i.urls=[i.url],i)};const Pb=["stun.l.google.com:19302","stun1.l.google.com:19302","stun2.l.google.com:19302","stun3.l.google.com:19302","stun4.l.google.com:19302","stun.ekiga.net","stun.ideasip.com","stun.schlund.de","stun.stunprotocol.org:3478","stun.voiparound.com","stun.voipbuster.com","stun.voipstunt.com","stun.voxgratia.org"],Ob=[];var Rb=kb,_b=function(e){var t={stun:(e||{}).stun||Pb,turn:(e||{}).turn||Ob},n=(e||{}).stunCount||2,r=(e||{}).turnCount||0,i;function o(s,a){for(var c=[],l=[].concat(t[s]),u;l.length&&c.length<a;)u=Math.random()*l.length|0,c=c.concat(l.splice(u,1));return c.map(function(d){return typeof d!="string"&&!(d instanceof String)?d:Rb(s+":"+d)})}return i=[].concat(o("stun",n)),r&&(i=i.concat(o("turn",r))),i},Ib=_b,cs,Nb=new Uint8Array(16);function Pv(){if(!cs&&(cs=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto<"u"&&typeof msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto),!cs))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return cs(Nb)}const Tb=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function Va(e){return typeof e=="string"&&Tb.test(e)}var nt=[];for(var Ol=0;Ol<256;++Ol)nt.push((Ol+256).toString(16).substr(1));function Fa(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=(nt[e[t+0]]+nt[e[t+1]]+nt[e[t+2]]+nt[e[t+3]]+"-"+nt[e[t+4]]+nt[e[t+5]]+"-"+nt[e[t+6]]+nt[e[t+7]]+"-"+nt[e[t+8]]+nt[e[t+9]]+"-"+nt[e[t+10]]+nt[e[t+11]]+nt[e[t+12]]+nt[e[t+13]]+nt[e[t+14]]+nt[e[t+15]]).toLowerCase();if(!Va(n))throw TypeError("Stringified UUID is invalid");return n}var Qf,Rl,_l=0,Il=0;function Lb(e,t,n){var r=t&&n||0,i=t||new Array(16);e=e||{};var o=e.node||Qf,s=e.clockseq!==void 0?e.clockseq:Rl;if(o==null||s==null){var a=e.random||(e.rng||Pv)();o==null&&(o=Qf=[a[0]|1,a[1],a[2],a[3],a[4],a[5]]),s==null&&(s=Rl=(a[6]<<8|a[7])&16383)}var c=e.msecs!==void 0?e.msecs:Date.now(),l=e.nsecs!==void 0?e.nsecs:Il+1,u=c-_l+(l-Il)/1e4;if(u<0&&e.clockseq===void 0&&(s=s+1&16383),(u<0||c>_l)&&e.nsecs===void 0&&(l=0),l>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");_l=c,Il=l,Rl=s,c+=122192928e5;var d=((c&268435455)*1e4+l)%4294967296;i[r++]=d>>>24&255,i[r++]=d>>>16&255,i[r++]=d>>>8&255,i[r++]=d&255;var m=c/4294967296*1e4&268435455;i[r++]=m>>>8&255,i[r++]=m&255,i[r++]=m>>>24&15|16,i[r++]=m>>>16&255,i[r++]=s>>>8|128,i[r++]=s&255;for(var g=0;g<6;++g)i[r+g]=o[g];return t||Fa(i)}function Ov(e){if(!Va(e))throw TypeError("Invalid UUID");var t,n=new Uint8Array(16);return n[0]=(t=parseInt(e.slice(0,8),16))>>>24,n[1]=t>>>16&255,n[2]=t>>>8&255,n[3]=t&255,n[4]=(t=parseInt(e.slice(9,13),16))>>>8,n[5]=t&255,n[6]=(t=parseInt(e.slice(14,18),16))>>>8,n[7]=t&255,n[8]=(t=parseInt(e.slice(19,23),16))>>>8,n[9]=t&255,n[10]=(t=parseInt(e.slice(24,36),16))/1099511627776&255,n[11]=t/4294967296&255,n[12]=t>>>24&255,n[13]=t>>>16&255,n[14]=t>>>8&255,n[15]=t&255,n}function Ab(e){e=unescape(encodeURIComponent(e));for(var t=[],n=0;n<e.length;++n)t.push(e.charCodeAt(n));return t}var Mb="6ba7b810-9dad-11d1-80b4-00c04fd430c8",jb="6ba7b811-9dad-11d1-80b4-00c04fd430c8";function Rv(e,t,n){function r(i,o,s,a){if(typeof i=="string"&&(i=Ab(i)),typeof o=="string"&&(o=Ov(o)),o.length!==16)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");var c=new Uint8Array(16+i.length);if(c.set(o),c.set(i,o.length),c=n(c),c[6]=c[6]&15|t,c[8]=c[8]&63|128,s){a=a||0;for(var l=0;l<16;++l)s[a+l]=c[l];return s}return Fa(c)}try{r.name=e}catch{}return r.DNS=Mb,r.URL=jb,r}function Db(e){if(typeof e=="string"){var t=unescape(encodeURIComponent(e));e=new Uint8Array(t.length);for(var n=0;n<t.length;++n)e[n]=t.charCodeAt(n)}return Vb(Fb(Ub(e),e.length*8))}function Vb(e){for(var t=[],n=e.length*32,r="0123456789abcdef",i=0;i<n;i+=8){var o=e[i>>5]>>>i%32&255,s=parseInt(r.charAt(o>>>4&15)+r.charAt(o&15),16);t.push(s)}return t}function _v(e){return(e+64>>>9<<4)+14+1}function Fb(e,t){e[t>>5]|=128<<t%32,e[_v(t)-1]=t;for(var n=1732584193,r=-271733879,i=-1732584194,o=271733878,s=0;s<e.length;s+=16){var a=n,c=r,l=i,u=o;n=dt(n,r,i,o,e[s],7,-680876936),o=dt(o,n,r,i,e[s+1],12,-389564586),i=dt(i,o,n,r,e[s+2],17,606105819),r=dt(r,i,o,n,e[s+3],22,-1044525330),n=dt(n,r,i,o,e[s+4],7,-176418897),o=dt(o,n,r,i,e[s+5],12,1200080426),i=dt(i,o,n,r,e[s+6],17,-1473231341),r=dt(r,i,o,n,e[s+7],22,-45705983),n=dt(n,r,i,o,e[s+8],7,1770035416),o=dt(o,n,r,i,e[s+9],12,-1958414417),i=dt(i,o,n,r,e[s+10],17,-42063),r=dt(r,i,o,n,e[s+11],22,-1990404162),n=dt(n,r,i,o,e[s+12],7,1804603682),o=dt(o,n,r,i,e[s+13],12,-40341101),i=dt(i,o,n,r,e[s+14],17,-1502002290),r=dt(r,i,o,n,e[s+15],22,1236535329),n=ft(n,r,i,o,e[s+1],5,-165796510),o=ft(o,n,r,i,e[s+6],9,-1069501632),i=ft(i,o,n,r,e[s+11],14,643717713),r=ft(r,i,o,n,e[s],20,-373897302),n=ft(n,r,i,o,e[s+5],5,-701558691),o=ft(o,n,r,i,e[s+10],9,38016083),i=ft(i,o,n,r,e[s+15],14,-660478335),r=ft(r,i,o,n,e[s+4],20,-405537848),n=ft(n,r,i,o,e[s+9],5,568446438),o=ft(o,n,r,i,e[s+14],9,-1019803690),i=ft(i,o,n,r,e[s+3],14,-187363961),r=ft(r,i,o,n,e[s+8],20,1163531501),n=ft(n,r,i,o,e[s+13],5,-1444681467),o=ft(o,n,r,i,e[s+2],9,-51403784),i=ft(i,o,n,r,e[s+7],14,1735328473),r=ft(r,i,o,n,e[s+12],20,-1926607734),n=pt(n,r,i,o,e[s+5],4,-378558),o=pt(o,n,r,i,e[s+8],11,-2022574463),i=pt(i,o,n,r,e[s+11],16,1839030562),r=pt(r,i,o,n,e[s+14],23,-35309556),n=pt(n,r,i,o,e[s+1],4,-1530992060),o=pt(o,n,r,i,e[s+4],11,1272893353),i=pt(i,o,n,r,e[s+7],16,-155497632),r=pt(r,i,o,n,e[s+10],23,-1094730640),n=pt(n,r,i,o,e[s+13],4,681279174),o=pt(o,n,r,i,e[s],11,-358537222),i=pt(i,o,n,r,e[s+3],16,-722521979),r=pt(r,i,o,n,e[s+6],23,76029189),n=pt(n,r,i,o,e[s+9],4,-640364487),o=pt(o,n,r,i,e[s+12],11,-421815835),i=pt(i,o,n,r,e[s+15],16,530742520),r=pt(r,i,o,n,e[s+2],23,-995338651),n=ht(n,r,i,o,e[s],6,-198630844),o=ht(o,n,r,i,e[s+7],10,1126891415),i=ht(i,o,n,r,e[s+14],15,-1416354905),r=ht(r,i,o,n,e[s+5],21,-57434055),n=ht(n,r,i,o,e[s+12],6,1700485571),o=ht(o,n,r,i,e[s+3],10,-1894986606),i=ht(i,o,n,r,e[s+10],15,-1051523),r=ht(r,i,o,n,e[s+1],21,-2054922799),n=ht(n,r,i,o,e[s+8],6,1873313359),o=ht(o,n,r,i,e[s+15],10,-30611744),i=ht(i,o,n,r,e[s+6],15,-1560198380),r=ht(r,i,o,n,e[s+13],21,1309151649),n=ht(n,r,i,o,e[s+4],6,-145523070),o=ht(o,n,r,i,e[s+11],10,-1120210379),i=ht(i,o,n,r,e[s+2],15,718787259),r=ht(r,i,o,n,e[s+9],21,-343485551),n=Wn(n,a),r=Wn(r,c),i=Wn(i,l),o=Wn(o,u)}return[n,r,i,o]}function Ub(e){if(e.length===0)return[];for(var t=e.length*8,n=new Uint32Array(_v(t)),r=0;r<t;r+=8)n[r>>5]|=(e[r/8]&255)<<r%32;return n}function Wn(e,t){var n=(e&65535)+(t&65535),r=(e>>16)+(t>>16)+(n>>16);return r<<16|n&65535}function $b(e,t){return e<<t|e>>>32-t}function Ua(e,t,n,r,i,o){return Wn($b(Wn(Wn(t,e),Wn(r,o)),i),n)}function dt(e,t,n,r,i,o,s){return Ua(t&n|~t&r,e,t,i,o,s)}function ft(e,t,n,r,i,o,s){return Ua(t&r|n&~r,e,t,i,o,s)}function pt(e,t,n,r,i,o,s){return Ua(t^n^r,e,t,i,o,s)}function ht(e,t,n,r,i,o,s){return Ua(n^(t|~r),e,t,i,o,s)}var Bb=Rv("v3",48,Db);const zb=Bb;function Wb(e,t,n){e=e||{};var r=e.random||(e.rng||Pv)();if(r[6]=r[6]&15|64,r[8]=r[8]&63|128,t){n=n||0;for(var i=0;i<16;++i)t[n+i]=r[i];return t}return Fa(r)}function Hb(e,t,n,r){switch(e){case 0:return t&n^~t&r;case 1:return t^n^r;case 2:return t&n^t&r^n&r;case 3:return t^n^r}}function Nl(e,t){return e<<t|e>>>32-t}function qb(e){var t=[1518500249,1859775393,2400959708,3395469782],n=[1732584193,4023233417,2562383102,271733878,3285377520];if(typeof e=="string"){var r=unescape(encodeURIComponent(e));e=[];for(var i=0;i<r.length;++i)e.push(r.charCodeAt(i))}else Array.isArray(e)||(e=Array.prototype.slice.call(e));e.push(128);for(var o=e.length/4+2,s=Math.ceil(o/16),a=new Array(s),c=0;c<s;++c){for(var l=new Uint32Array(16),u=0;u<16;++u)l[u]=e[c*64+u*4]<<24|e[c*64+u*4+1]<<16|e[c*64+u*4+2]<<8|e[c*64+u*4+3];a[c]=l}a[s-1][14]=(e.length-1)*8/Math.pow(2,32),a[s-1][14]=Math.floor(a[s-1][14]),a[s-1][15]=(e.length-1)*8&4294967295;for(var d=0;d<s;++d){for(var m=new Uint32Array(80),g=0;g<16;++g)m[g]=a[d][g];for(var b=16;b<80;++b)m[b]=Nl(m[b-3]^m[b-8]^m[b-14]^m[b-16],1);for(var P=n[0],k=n[1],f=n[2],v=n[3],w=n[4],y=0;y<80;++y){var T=Math.floor(y/20),M=Nl(P,5)+Hb(T,k,f,v)+w+t[T]+m[y]>>>0;w=v,v=f,f=Nl(k,30)>>>0,k=P,P=M}n[0]=n[0]+P>>>0,n[1]=n[1]+k>>>0,n[2]=n[2]+f>>>0,n[3]=n[3]+v>>>0,n[4]=n[4]+w>>>0}return[n[0]>>24&255,n[0]>>16&255,n[0]>>8&255,n[0]&255,n[1]>>24&255,n[1]>>16&255,n[1]>>8&255,n[1]&255,n[2]>>24&255,n[2]>>16&255,n[2]>>8&255,n[2]&255,n[3]>>24&255,n[3]>>16&255,n[3]>>8&255,n[3]&255,n[4]>>24&255,n[4]>>16&255,n[4]>>8&255,n[4]&255]}var Gb=Rv("v5",80,qb);const Xb=Gb,Jb="00000000-0000-0000-0000-000000000000";function Kb(e){if(!Va(e))throw TypeError("Invalid UUID");return parseInt(e.substr(14,1),16)}const Qb=Object.freeze(Object.defineProperty({__proto__:null,NIL:Jb,parse:Ov,stringify:Fa,v1:Lb,v3:zb,v4:Wb,v5:Xb,validate:Va,version:Kb},Symbol.toStringTag,{value:"Module"})),Yb=Jv(Qb);var id=ue&&ue.__extends||function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},e(t,n)};return function(t,n){e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),la=ue&&ue.__assign||function(){return la=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e},la.apply(this,arguments)},Yf=ue&&ue.__awaiter||function(e,t,n,r){function i(o){return o instanceof n?o:new n(function(s){s(o)})}return new(n||(n=Promise))(function(o,s){function a(u){try{l(r.next(u))}catch(d){s(d)}}function c(u){try{l(r.throw(u))}catch(d){s(d)}}function l(u){u.done?o(u.value):i(u.value).then(a,c)}l((r=r.apply(e,t||[])).next())})},Zf=ue&&ue.__generator||function(e,t){var n={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},r,i,o,s;return s={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function a(l){return function(u){return c([l,u])}}function c(l){if(r)throw new TypeError("Generator is already executing.");for(;n;)try{if(r=1,i&&(o=l[0]&2?i.return:l[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,l[1])).done)return o;switch(i=0,o&&(l=[l[0]&2,o.value]),l[0]){case 0:case 1:o=l;break;case 4:return n.label++,{value:l[1],done:!1};case 5:n.label++,i=l[1],l=[0];continue;case 7:l=n.ops.pop(),n.trys.pop();continue;default:if(o=n.trys,!(o=o.length>0&&o[o.length-1])&&(l[0]===6||l[0]===2)){n=0;continue}if(l[0]===3&&(!o||l[1]>o[0]&&l[1]<o[3])){n.label=l[1];break}if(l[0]===6&&n.label<o[1]){n.label=o[1],o=l;break}if(o&&n.label<o[2]){n.label=o[2],n.ops.push(l);break}o[2]&&n.ops.pop(),n.trys.pop();continue}l=t.call(e,n)}catch(u){l=[6,u],i=0}finally{r=o=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}};Object.defineProperty(pn,"__esModule",{value:!0});pn.WebRtcPeerSendrecv=pn.WebRtcPeerSendonly=pn.WebRtcPeerRecvonly=pn.WebRtcPeer=void 0;var Zb=Ib,e1=Yb,ep=ki,t1=Ke,n1=sn,tt=t1.OpenViduLogger.getInstance(),r1=[{rid:"r0",scaleResolutionDownBy:4},{rid:"r1",scaleResolutionDownBy:2},{rid:"r2",scaleResolutionDownBy:1}],$a=function(){function e(t){var n=this;this.remoteCandidatesQueue=[],this.localCandidatesQueue=[],this.iceCandidateList=[],this.candidategatheringdone=!1,n1.PlatformUtils.getInstance(),this.configuration=la(la({},t),{iceServers:t.iceServers&&t.iceServers.length>0?t.iceServers:Zb(),mediaStream:t.mediaStream!==void 0?t.mediaStream:null,mode:t.mode?t.mode:"sendrecv",id:t.id?t.id:this.generateUniqueId()}),this.pc=new RTCPeerConnection({iceServers:this.configuration.iceServers}),this.pc.addEventListener("icecandidate",function(r){if(r.candidate!=null){var i=r.candidate;n.configuration.onIceCandidate(i),i.candidate!==""&&n.localCandidatesQueue.push({candidate:i.candidate})}}),this.pc.addEventListener("signalingstatechange",function(){if(n.pc.signalingState==="stable")for(;n.iceCandidateList.length>0;){var r=n.iceCandidateList.shift();n.pc.addIceCandidate(r)}})}return e.prototype.getId=function(){return this.configuration.id},e.prototype.dispose=function(){if(tt.debug("Disposing WebRtcPeer"),this.pc){if(this.pc.signalingState==="closed")return;this.pc.close(),this.remoteCandidatesQueue=[],this.localCandidatesQueue=[]}},e.prototype.createOffer=function(){var t=this;return new Promise(function(n,r){return Yf(t,void 0,void 0,function(){var i,o,s,a,c,l,u,d,m,g,b,P;return Zf(this,function(k){switch(k.label){case 0:if(!("addTransceiver"in this.pc))return[3,7];if(tt.debug("[createOffer] Method RTCPeerConnection.addTransceiver() is available; using it"),this.configuration.mode==="recvonly")return[3,5];if(!this.configuration.mediaStream)return r(new Error(this.configuration.mode+" direction requested, but no stream was configured to be sent")),[2];i=0,o=this.configuration.mediaStream.getTracks(),k.label=1;case 1:return i<o.length?(s=o[i],a={direction:this.configuration.mode,streams:[this.configuration.mediaStream]},this.configuration.simulcast&&s.kind==="video"&&(a.sendEncodings=r1),c=this.pc.addTransceiver(s,a),this.configuration.simulcast&&s.kind==="video"?(l=c.sender.getParameters(),!("encodings"in l)||l.encodings.length!==a.sendEncodings.length?(l.encodings=a.sendEncodings,[4,c.sender.setParameters(l)]):[3,3]):[3,3]):[3,4];case 2:k.sent(),k.label=3;case 3:return i++,[3,1];case 4:return[3,6];case 5:for(u=0,d=["audio","video"];u<d.length;u++)m=d[u],this.configuration.mediaConstraints[m]&&(this.configuration.mediaStream=new MediaStream,this.pc.addTransceiver(m,{direction:this.configuration.mode,streams:[this.configuration.mediaStream]}));k.label=6;case 6:return this.pc.createOffer().then(function(f){return n(f)}).catch(function(f){return r(f)}),[3,8];case 7:tt.warn("[createOffer] Method RTCPeerConnection.addTransceiver() is NOT available; using LEGACY offerToReceive{Audio,Video}"),this.configuration.mediaStream&&this.deprecatedPeerConnectionTrackApi(),g=this.configuration.mediaConstraints.audio,b=this.configuration.mediaConstraints.video,P={offerToReceiveAudio:this.configuration.mode!=="sendonly"&&g,offerToReceiveVideo:this.configuration.mode!=="sendonly"&&b},tt.debug("RTCPeerConnection.createOffer() options:",JSON.stringify(P)),this.pc.createOffer(P).then(function(f){return n(f)}).catch(function(f){return r(f)}),k.label=8;case 8:return[2]}})})})},e.prototype.deprecatedPeerConnectionTrackApi=function(){for(var t=0,n=this.configuration.mediaStream.getTracks();t<n.length;t++){var r=n[t];this.pc.addTrack(r,this.configuration.mediaStream)}},e.prototype.createAnswer=function(){var t=this;return new Promise(function(n,r){if("getTransceivers"in t.pc){tt.debug("[createAnswer] Method RTCPeerConnection.getTransceivers() is available; using it");for(var i=function(d){if(!t.configuration.mediaConstraints[d])return"continue";var m=t.pc.getTransceivers().find(function(g){return g.receiver.track.kind===d});m?m.direction=t.configuration.mode:r(new Error(d+" requested, but no transceiver was created from remote description"))},o=0,s=["audio","video"];o<s.length;o++){var a=s[o];i(a)}t.pc.createAnswer().then(function(d){return n(d)}).catch(function(d){return r(d)})}else{var c=void 0,l=!0;if(t.configuration.mediaConstraints){c=typeof t.configuration.mediaConstraints.audio=="boolean"?t.configuration.mediaConstraints.audio:!0,l=typeof t.configuration.mediaConstraints.video=="boolean"?t.configuration.mediaConstraints.video:!0;var u={offerToReceiveAudio:c,offerToReceiveVideo:l};t.pc.createAnswer(u).then(function(d){n(d)}).catch(function(d){r(d)})}}})},e.prototype.processLocalOffer=function(t){var n=this;return new Promise(function(r,i){n.pc.setLocalDescription(t).then(function(){var o=n.pc.localDescription;o?(tt.debug("Local description set",o.sdp),r()):i("Local description is not defined")}).catch(function(o){i(o)})})},e.prototype.processRemoteOffer=function(t){var n=this;return new Promise(function(r,i){var o={type:"offer",sdp:t};tt.debug("SDP offer received, setting remote description",o),n.pc.signalingState==="closed"&&i("RTCPeerConnection is closed when trying to set remote description"),n.setRemoteDescription(o).then(function(){r()}).catch(function(s){i(s)})})},e.prototype.processLocalAnswer=function(t){var n=this;return new Promise(function(r,i){tt.debug("SDP answer created, setting local description"),n.pc.signalingState==="closed"&&i("RTCPeerConnection is closed when trying to set local description"),n.pc.setLocalDescription(t).then(function(){return r()}).catch(function(o){return i(o)})})},e.prototype.processRemoteAnswer=function(t){var n=this;return new Promise(function(r,i){var o={type:"answer",sdp:t};tt.debug("SDP answer received, setting remote description"),n.pc.signalingState==="closed"&&i("RTCPeerConnection is closed when trying to set remote description"),n.setRemoteDescription(o).then(function(){return r()}).catch(function(s){return i(s)})})},e.prototype.setRemoteDescription=function(t){return Yf(this,void 0,void 0,function(){return Zf(this,function(n){return[2,this.pc.setRemoteDescription(t)]})})},e.prototype.addIceCandidate=function(t){var n=this;return new Promise(function(r,i){switch(tt.debug("Remote ICE candidate received",t),n.remoteCandidatesQueue.push(t),n.pc.signalingState){case"closed":i(new Error("PeerConnection object is closed"));break;case"stable":n.pc.remoteDescription?n.pc.addIceCandidate(t).then(function(){return r()}).catch(function(o){return i(o)}):(n.iceCandidateList.push(t),r());break;default:n.iceCandidateList.push(t),r()}})},e.prototype.addIceConnectionStateChangeListener=function(t){var n=this;this.pc.addEventListener("iceconnectionstatechange",function(){var r=n.pc.iceConnectionState;switch(r){case"disconnected":var i="IceConnectionState of RTCPeerConnection "+n.configuration.id+" ("+t+') change to "disconnected". Possible network disconnection';tt.warn(i),n.configuration.onIceConnectionStateException(ep.ExceptionEventName.ICE_CONNECTION_DISCONNECTED,i);break;case"failed":var o="IceConnectionState of RTCPeerConnection "+n.configuration.id+" ("+t+') to "failed"';tt.error(o),n.configuration.onIceConnectionStateException(ep.ExceptionEventName.ICE_CONNECTION_FAILED,o);break;case"closed":tt.log("IceConnectionState of RTCPeerConnection "+n.configuration.id+" ("+t+') change to "closed"');break;case"new":tt.log("IceConnectionState of RTCPeerConnection "+n.configuration.id+" ("+t+') change to "new"');break;case"checking":tt.log("IceConnectionState of RTCPeerConnection "+n.configuration.id+" ("+t+') change to "checking"');break;case"connected":tt.log("IceConnectionState of RTCPeerConnection "+n.configuration.id+" ("+t+') change to "connected"');break;case"completed":tt.log("IceConnectionState of RTCPeerConnection "+n.configuration.id+" ("+t+') change to "completed"');break}})},e.prototype.generateUniqueId=function(){return e1.v4()},e}();pn.WebRtcPeer=$a;var i1=function(e){id(t,e);function t(n){var r=this;return n.mode="recvonly",r=e.call(this,n)||this,r}return t}($a);pn.WebRtcPeerRecvonly=i1;var o1=function(e){id(t,e);function t(n){var r=this;return n.mode="sendonly",r=e.call(this,n)||this,r}return t}($a);pn.WebRtcPeerSendonly=o1;var s1=function(e){id(t,e);function t(n){var r=this;return n.mode="sendrecv",r=e.call(this,n)||this,r}return t}($a);pn.WebRtcPeerSendrecv=s1;var Ba={},Ar=ue&&ue.__awaiter||function(e,t,n,r){function i(o){return o instanceof n?o:new n(function(s){s(o)})}return new(n||(n=Promise))(function(o,s){function a(u){try{l(r.next(u))}catch(d){s(d)}}function c(u){try{l(r.throw(u))}catch(d){s(d)}}function l(u){u.done?o(u.value):i(u.value).then(a,c)}l((r=r.apply(e,t||[])).next())})},Mr=ue&&ue.__generator||function(e,t){var n={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},r,i,o,s;return s={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function a(l){return function(u){return c([l,u])}}function c(l){if(r)throw new TypeError("Generator is already executing.");for(;n;)try{if(r=1,i&&(o=l[0]&2?i.return:l[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,l[1])).done)return o;switch(i=0,o&&(l=[l[0]&2,o.value]),l[0]){case 0:case 1:o=l;break;case 4:return n.label++,{value:l[1],done:!1};case 5:n.label++,i=l[1],l=[0];continue;case 7:l=n.ops.pop(),n.trys.pop();continue;default:if(o=n.trys,!(o=o.length>0&&o[o.length-1])&&(l[0]===6||l[0]===2)){n=0;continue}if(l[0]===3&&(!o||l[1]>o[0]&&l[1]<o[3])){n.label=l[1];break}if(l[0]===6&&n.label<o[1]){n.label=o[1],o=l;break}if(o&&n.label<o[2]){n.label=o[2],n.ops.push(l);break}o[2]&&n.ops.pop(),n.trys.pop();continue}l=t.call(e,n)}catch(u){l=[6,u],i=0}finally{r=o=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}};Object.defineProperty(Ba,"__esModule",{value:!0});Ba.WebRtcStats=void 0;var a1=Ke,l1=sn,ur=a1.OpenViduLogger.getInstance(),jr,c1=function(){function e(t){this.stream=t,this.STATS_ITEM_NAME="webrtc-stats-config",this.webRtcStatsEnabled=!1,this.statsInterval=1,jr=l1.PlatformUtils.getInstance()}return e.prototype.isEnabled=function(){return this.webRtcStatsEnabled},e.prototype.initWebRtcStats=function(){var t=this,n=localStorage.getItem(this.STATS_ITEM_NAME);if(n){this.webRtcStatsEnabled=!0;var r=JSON.parse(n);ur.warn("WebRtc stats enabled for stream "+this.stream.streamId+" of connection "+this.stream.connection.connectionId),ur.warn("localStorage item: "+JSON.stringify(r)),this.POST_URL=r.httpEndpoint,this.statsInterval=r.interval,this.webRtcStatsIntervalId=setInterval(function(){return Ar(t,void 0,void 0,function(){return Mr(this,function(i){switch(i.label){case 0:return[4,this.sendStatsToHttpEndpoint()];case 1:return i.sent(),[2]}})})},this.statsInterval*1e3)}else ur.debug("WebRtc stats not enabled")},e.prototype.getSelectedIceCandidateInfo=function(){var t=this;return new Promise(function(n,r){return Ar(t,void 0,void 0,function(){var i,o,s,a,c,l,u,d,m,g,b,P,k,f,T,M,v,w,p,y,T,M,U,S,p;return Mr(this,function(E){switch(E.label){case 0:return[4,this.stream.getRTCPeerConnection().getStats()];case 1:if(i=E.sent(),s=new Map,a=new Map,c=new Map,i.forEach(function(I){switch(I.type==="transport"&&(jr.isChromium()||jr.isSafariBrowser()||jr.isReactNative())&&(o=I),I.type){case"candidate-pair":s.set(I.id,I);break;case"local-candidate":a.set(I.id,I);break;case"remote-candidate":c.set(I.id,I);break}}),o!=null)u=o.selectedCandidatePairId,l=s.get(u);else for(d=s.size,m=s.values(),g=0;g<d;g++)if(b=m.next().value,b.selected){l=b;break}if(P=l.localCandidateId,k=l.remoteCandidateId,f=a.get(P),f)for(T=this.stream.getLocalIceCandidateList(),M=T.filter(function(I){return!!I.candidate&&(I.candidate.indexOf(f.ip)>=0||I.candidate.indexOf(f.address)>=0)&&I.candidate.indexOf(f.port)>=0}),f.raw=[],v=0,w=M;v<w.length;v++)p=w[v],f.raw.push(p.candidate);else f="ERROR: No active local ICE candidate. Probably ICE-TCP is being used";if(y=c.get(k),y)for(T=this.stream.getRemoteIceCandidateList(),M=T.filter(function(I){return!!I.candidate&&(I.candidate.indexOf(y.ip)>=0||I.candidate.indexOf(y.address)>=0)&&I.candidate.indexOf(y.port)>=0}),y.raw=[],U=0,S=M;U<S.length;U++)p=S[U],y.raw.push(p.candidate);else y="ERROR: No active remote ICE candidate. Probably ICE-TCP is being used";return n({localCandidate:f,remoteCandidate:y}),[2]}})})})},e.prototype.stopWebRtcStats=function(){this.webRtcStatsEnabled&&(clearInterval(this.webRtcStatsIntervalId),ur.warn("WebRtc stats stopped for disposed stream "+this.stream.streamId+" of connection "+this.stream.connection.connectionId))},e.prototype.sendStats=function(t,n){return Ar(this,void 0,void 0,function(){var r,i;return Mr(this,function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),r={headers:{"Content-type":"application/json"},body:JSON.stringify(n),method:"POST"},[4,fetch(t,r)];case 1:return o.sent(),[3,3];case 2:return i=o.sent(),ur.error("sendStats error: "+JSON.stringify(i)),[3,3];case 3:return[2]}})})},e.prototype.sendStatsToHttpEndpoint=function(){return Ar(this,void 0,void 0,function(){var t,n,r;return Mr(this,function(i){switch(i.label){case 0:return i.trys.push([0,3,,4]),[4,this.getCommonStats()];case 1:return t=i.sent(),n=this.generateJSONStatsResponse(t),[4,this.sendStats(this.POST_URL,n)];case 2:return i.sent(),[3,4];case 3:return r=i.sent(),ur.log(r),[3,4];case 4:return[2]}})})},e.prototype.getCommonStats=function(){return Ar(this,void 0,void 0,function(){var t=this;return Mr(this,function(n){return[2,new Promise(function(r,i){return Ar(t,void 0,void 0,function(){var o,s,a,c,l,u=this;return Mr(this,function(d){switch(d.label){case 0:return d.trys.push([0,2,,3]),[4,this.stream.getRTCPeerConnection().getStats()];case 1:return o=d.sent(),s=this.getWebRtcStatsResponseOutline(),a=["framesReceived","framesDropped","framesSent","frameHeight","frameWidth"],c=["availableOutgoingBitrate","currentRoundTripTime"],o.forEach(function(m){var g=m.mediaType!=null?m.mediaType:m.kind,b=function(P,k){m[k]!=null&&s[P]!=null&&(!g&&a.indexOf(k)>-1&&(g="video"),P!=null&&g!=null&&k!=null&&s[P][g]!=null?s[P][g][k]=Number(m[k]):P!=null&&k!=null&&c.includes(k)&&(s[P][k]=Number(m[k])))};switch(m.type){case"outbound-rtp":b("outbound","bytesSent"),b("outbound","packetsSent"),b("outbound","framesEncoded"),b("outbound","nackCount"),b("outbound","firCount"),b("outbound","pliCount"),b("outbound","qpSum");break;case"inbound-rtp":b("inbound","bytesReceived"),b("inbound","packetsReceived"),b("inbound","packetsLost"),b("inbound","jitter"),b("inbound","framesDecoded"),b("inbound","nackCount"),b("inbound","firCount"),b("inbound","pliCount");break;case"track":b("inbound","jitterBufferDelay"),b("inbound","framesReceived"),b("outbound","framesDropped"),b("outbound","framesSent"),b(u.stream.isLocal()?"outbound":"inbound","frameHeight"),b(u.stream.isLocal()?"outbound":"inbound","frameWidth");break;case"candidate-pair":b("candidatepair","currentRoundTripTime"),b("candidatepair","availableOutgoingBitrate");break}}),(!s?.candidatepair||Object.keys(s.candidatepair).length===0)&&delete s.candidatepair,[2,r(s)];case 2:return l=d.sent(),ur.error("Error getting common stats: ",l),[2,i(l)];case 3:return[2]}})})})]})})},e.prototype.generateJSONStatsResponse=function(t){return{"@timestamp":new Date().toISOString(),participant_id:this.stream.connection.data,session_id:this.stream.session.sessionId,platform:jr.getName(),platform_description:jr.getDescription(),stream:"webRTC",webrtc_stats:t}},e.prototype.getWebRtcStatsResponseOutline=function(){return this.stream.isLocal()?{outbound:{audio:{},video:{}},candidatepair:{}}:{inbound:{audio:{},video:{}}}},e}();Ba.WebRtcStats=c1;var jo={},u1=ue&&ue.__extends||function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},e(t,n)};return function(t,n){e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(jo,"__esModule",{value:!0});jo.PublisherSpeakingEvent=void 0;var d1=st,f1=function(e){u1(t,e);function t(n,r,i,o){var s=e.call(this,!1,n,r)||this;return s.type=r,s.connection=i,s.streamId=o,s}return t.prototype.callDefaultBehavior=function(){},t}(d1.Event);jo.PublisherSpeakingEvent=f1;var p1=ca;function ca(){}ca.mixin=function(e){var t=e.prototype||e;t.isWildEmitter=!0,t.on=function(n,r,i){this.callbacks=this.callbacks||{};var o=arguments.length===3,s=o?arguments[1]:void 0,a=o?arguments[2]:arguments[1];return a._groupName=s,(this.callbacks[n]=this.callbacks[n]||[]).push(a),this},t.once=function(n,r,i){var o=this,s=arguments.length===3,a=s?arguments[1]:void 0,c=s?arguments[2]:arguments[1];function l(){o.off(n,l),c.apply(this,arguments)}return this.on(n,a,l),this},t.releaseGroup=function(n){this.callbacks=this.callbacks||{};var r,i,o,s;for(r in this.callbacks)for(s=this.callbacks[r],i=0,o=s.length;i<o;i++)s[i]._groupName===n&&(s.splice(i,1),i--,o--);return this},t.off=function(n,r){this.callbacks=this.callbacks||{};var i=this.callbacks[n],o;return i?arguments.length===1?(delete this.callbacks[n],this):(o=i.indexOf(r),o!==-1&&(i.splice(o,1),i.length===0&&delete this.callbacks[n]),this):this},t.emit=function(n){this.callbacks=this.callbacks||{};var r=[].slice.call(arguments,1),i=this.callbacks[n],o=this.getWildcardCallbacks(n),s,a,c;if(i)for(c=i.slice(),s=0,a=c.length;s<a&&c[s];++s)c[s].apply(this,r);if(o)for(a=o.length,c=o.slice(),s=0,a=c.length;s<a&&c[s];++s)c[s].apply(this,[n].concat(r));return this},t.getWildcardCallbacks=function(n){this.callbacks=this.callbacks||{};var r,i,o=[];for(r in this.callbacks)i=r.split("*"),(r==="*"||i.length===2&&n.slice(0,i[0].length)===i[0])&&(o=o.concat(this.callbacks[r]));return o}};ca.mixin(ca);var h1=p1;function m1(e,t){var n=-1/0;e.getFloatFrequencyData(t);for(var r=4,i=t.length;r<i;r++)t[r]>n&&t[r]<0&&(n=t[r]);return n}var qc;typeof window<"u"&&(qc=window.AudioContext||window.webkitAudioContext);var Xt=null,v1=function(e,r){var n=new h1;if(!qc)return n;var r=r||{},i=r.smoothing||.1,o=r.interval||50,s=r.threshold,a=r.play,c=r.history||10,l=!0;Xt=r.audioContext||Xt||new qc;var u,d,m;m=Xt.createAnalyser(),m.fftSize=512,m.smoothingTimeConstant=i,d=new Float32Array(m.frequencyBinCount),e.jquery&&(e=e[0]),e instanceof HTMLAudioElement||e instanceof HTMLVideoElement?(u=Xt.createMediaElementSource(e),typeof a>"u"&&(a=!0),s=s||-50):(u=Xt.createMediaStreamSource(e),s=s||-50),u.connect(m),a&&m.connect(Xt.destination),n.speaking=!1,n.suspend=function(){return Xt.suspend()},n.resume=function(){return Xt.resume()},Object.defineProperty(n,"state",{get:function(){return Xt.state}}),Xt.onstatechange=function(){n.emit("state_change",Xt.state)},n.setThreshold=function(P){s=P},n.setInterval=function(P){o=P},n.stop=function(){l=!1,n.emit("volume_change",-100,s),n.speaking&&(n.speaking=!1,n.emit("stopped_speaking")),m.disconnect(),u.disconnect()},n.speakingHistory=[];for(var g=0;g<c;g++)n.speakingHistory.push(0);var b=function(){setTimeout(function(){if(l){var P=m1(m,d);n.emit("volume_change",P,s);var k=0;if(P>s&&!n.speaking){for(var f=n.speakingHistory.length-3;f<n.speakingHistory.length;f++)k+=n.speakingHistory[f];k>=2&&(n.speaking=!0,n.emit("speaking"))}else if(P<s&&n.speaking){for(var f=0;f<n.speakingHistory.length;f++)k+=n.speakingHistory[f];k==0&&(n.speaking=!1,n.emit("stopped_speaking"))}n.speakingHistory.shift(),n.speakingHistory.push(0+(P>s)),b()}},o)};return b(),n},us=ue&&ue.__awaiter||function(e,t,n,r){function i(o){return o instanceof n?o:new n(function(s){s(o)})}return new(n||(n=Promise))(function(o,s){function a(u){try{l(r.next(u))}catch(d){s(d)}}function c(u){try{l(r.throw(u))}catch(d){s(d)}}function l(u){u.done?o(u.value):i(u.value).then(a,c)}l((r=r.apply(e,t||[])).next())})},ds=ue&&ue.__generator||function(e,t){var n={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},r,i,o,s;return s={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function a(l){return function(u){return c([l,u])}}function c(l){if(r)throw new TypeError("Generator is already executing.");for(;n;)try{if(r=1,i&&(o=l[0]&2?i.return:l[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,l[1])).done)return o;switch(i=0,o&&(l=[l[0]&2,o.value]),l[0]){case 0:case 1:o=l;break;case 4:return n.label++,{value:l[1],done:!1};case 5:n.label++,i=l[1],l=[0];continue;case 7:l=n.ops.pop(),n.trys.pop();continue;default:if(o=n.trys,!(o=o.length>0&&o[o.length-1])&&(l[0]===6||l[0]===2)){n=0;continue}if(l[0]===3&&(!o||l[1]>o[0]&&l[1]<o[3])){n.label=l[1];break}if(l[0]===6&&n.label<o[1]){n.label=o[1],o=l;break}if(o&&n.label<o[2]){n.label=o[2],n.ops.push(l);break}o[2]&&n.ops.pop(),n.trys.pop();continue}l=t.call(e,n)}catch(u){l=[6,u],i=0}finally{r=o=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}};Object.defineProperty(yi,"__esModule",{value:!0});yi.Stream=void 0;var g1=Si,y1=wi,Tl=pn,S1=Ba,dr=ki,Mn=jo,tp=Ci,fs=Nn,Dr=Rr,w1=Ke,E1=sn,b1=v1,np=rd,Pe=w1.OpenViduLogger.getInstance(),rp,C1=function(){function e(t,n){var r=this;this.isSubscribeToRemote=!1,this.isLocalStreamReadyToPublish=!1,this.isLocalStreamPublished=!1,this.publishedOnce=!1,this.harkSpeakingEnabled=!1,this.harkSpeakingEnabledOnce=!1,this.harkStoppedSpeakingEnabled=!1,this.harkStoppedSpeakingEnabledOnce=!1,this.harkVolumeChangeEnabled=!1,this.harkVolumeChangeEnabledOnce=!1,this.ee=new np,rp=E1.PlatformUtils.getInstance(),this.session=t,n.hasOwnProperty("id")?(this.inboundStreamOpts=n,this.streamId=this.inboundStreamOpts.id,this.creationTime=this.inboundStreamOpts.createdAt,this.hasAudio=this.inboundStreamOpts.hasAudio,this.hasVideo=this.inboundStreamOpts.hasVideo,this.hasAudio&&(this.audioActive=this.inboundStreamOpts.audioActive),this.hasVideo&&(this.videoActive=this.inboundStreamOpts.videoActive,this.typeOfVideo=this.inboundStreamOpts.typeOfVideo?this.inboundStreamOpts.typeOfVideo:void 0,this.frameRate=this.inboundStreamOpts.frameRate===-1?void 0:this.inboundStreamOpts.frameRate,this.videoDimensions=this.inboundStreamOpts.videoDimensions),this.inboundStreamOpts.filter&&Object.keys(this.inboundStreamOpts.filter).length>0&&(this.inboundStreamOpts.filter.lastExecMethod&&Object.keys(this.inboundStreamOpts.filter.lastExecMethod).length===0&&delete this.inboundStreamOpts.filter.lastExecMethod,this.filter=this.inboundStreamOpts.filter)):(this.outboundStreamOpts=n,this.hasAudio=this.isSendAudio(),this.hasVideo=this.isSendVideo(),this.hasAudio&&(this.audioActive=!!this.outboundStreamOpts.publisherProperties.publishAudio),this.hasVideo&&(this.videoActive=!!this.outboundStreamOpts.publisherProperties.publishVideo,this.frameRate=this.outboundStreamOpts.publisherProperties.frameRate,typeof MediaStreamTrack<"u"&&this.outboundStreamOpts.publisherProperties.videoSource instanceof MediaStreamTrack?this.typeOfVideo="CUSTOM":this.typeOfVideo=this.isSendScreen()?"SCREEN":"CAMERA"),this.outboundStreamOpts.publisherProperties.filter&&(this.filter=this.outboundStreamOpts.publisherProperties.filter)),this.ee.on("mediastream-updated",function(){r.streamManager.updateMediaStream(r.mediaStream),Pe.debug("Video srcObject ["+r.mediaStream+"] updated in stream ["+r.streamId+"]")})}return e.prototype.reconnect=function(){return this.reconnectStream("API")},e.prototype.applyFilter=function(t,n){var r=this;return new Promise(function(i,o){r.session.sessionConnected()||o(r.session.notConnectedError()),Pe.info("Applying filter to stream "+r.streamId),n=n??{};var s=n;typeof s!="string"&&(s=JSON.stringify(s)),r.session.openvidu.sendRequest("applyFilter",{streamId:r.streamId,type:t,options:s},function(a,c){if(a)Pe.error("Error applying filter for Stream "+r.streamId,a),a.code===401?o(new Dr.OpenViduError(Dr.OpenViduErrorName.OPENVIDU_PERMISSION_DENIED,"You don't have permissions to apply a filter")):o(a);else{Pe.info("Filter successfully applied on Stream "+r.streamId);var l=r.filter;r.filter=new g1.Filter(t,n),r.filter.stream=r,r.session.emitEvent("streamPropertyChanged",[new fs.StreamPropertyChangedEvent(r.session,r,"filter",r.filter,l,"applyFilter")]),r.streamManager.emitEvent("streamPropertyChanged",[new fs.StreamPropertyChangedEvent(r.streamManager,r,"filter",r.filter,l,"applyFilter")]),i(r.filter)}})})},e.prototype.removeFilter=function(){var t=this;return new Promise(function(n,r){t.session.sessionConnected()||r(t.session.notConnectedError()),Pe.info("Removing filter of stream "+t.streamId),t.session.openvidu.sendRequest("removeFilter",{streamId:t.streamId},function(i,o){if(i)Pe.error("Error removing filter for Stream "+t.streamId,i),i.code===401?r(new Dr.OpenViduError(Dr.OpenViduErrorName.OPENVIDU_PERMISSION_DENIED,"You don't have permissions to remove a filter")):r(i);else{Pe.info("Filter successfully removed from Stream "+t.streamId);var s=t.filter;delete t.filter,t.session.emitEvent("streamPropertyChanged",[new fs.StreamPropertyChangedEvent(t.session,t,"filter",t.filter,s,"applyFilter")]),t.streamManager.emitEvent("streamPropertyChanged",[new fs.StreamPropertyChangedEvent(t.streamManager,t,"filter",t.filter,s,"applyFilter")]),n()}})})},e.prototype.getRTCPeerConnection=function(){return this.webRtcPeer.pc},e.prototype.getMediaStream=function(){return this.mediaStream},e.prototype.setMediaStream=function(t){this.mediaStream=t},e.prototype.updateMediaStreamInVideos=function(){this.ee.emitEvent("mediastream-updated",[])},e.prototype.getWebRtcPeer=function(){return this.webRtcPeer},e.prototype.subscribeToMyRemote=function(t){this.isSubscribeToRemote=t},e.prototype.setOutboundStreamOptions=function(t){this.outboundStreamOpts=t},e.prototype.subscribe=function(){var t=this;return new Promise(function(n,r){t.initWebRtcPeerReceive(!1).then(function(){n()}).catch(function(i){r(i)})})},e.prototype.publish=function(){var t=this;return new Promise(function(n,r){t.isLocalStreamReadyToPublish?t.initWebRtcPeerSend(!1).then(function(){n()}).catch(function(i){r(i)}):t.ee.once("stream-ready-to-publish",function(){t.publish().then(function(){n()}).catch(function(i){r(i)})})})},e.prototype.disposeWebRtcPeer=function(){var t;this.webRtcPeer&&(this.webRtcPeer.dispose(),t=this.webRtcPeer.getId()),this.stopWebRtcStats(),Pe.info((this.outboundStreamOpts?"Outbound ":"Inbound ")+"RTCPeerConnection with id ["+t+"] from 'Stream' with id ["+this.streamId+"] is now closed")},e.prototype.disposeMediaStream=function(){this.mediaStream&&(this.mediaStream.getAudioTracks().forEach(function(t){t.stop()}),this.mediaStream.getVideoTracks().forEach(function(t){t.stop()}),delete this.mediaStream),this.localMediaStreamWhenSubscribedToRemote&&(this.localMediaStreamWhenSubscribedToRemote.getAudioTracks().forEach(function(t){t.stop()}),this.localMediaStreamWhenSubscribedToRemote.getVideoTracks().forEach(function(t){t.stop()}),delete this.localMediaStreamWhenSubscribedToRemote),this.speechEvent&&(this.speechEvent.stop&&this.speechEvent.stop(),delete this.speechEvent),Pe.info((this.outboundStreamOpts?"Local ":"Remote ")+"MediaStream from 'Stream' with id ["+this.streamId+"] is now disposed")},e.prototype.displayMyRemote=function(){return this.isSubscribeToRemote},e.prototype.isSendAudio=function(){return!!this.outboundStreamOpts&&this.outboundStreamOpts.publisherProperties.audioSource!==null&&this.outboundStreamOpts.publisherProperties.audioSource!==!1},e.prototype.isSendVideo=function(){return!!this.outboundStreamOpts&&this.outboundStreamOpts.publisherProperties.videoSource!==null&&this.outboundStreamOpts.publisherProperties.videoSource!==!1},e.prototype.isSendScreen=function(){var t=this.outboundStreamOpts.publisherProperties.videoSource==="screen";return rp.isElectron()&&(t=typeof this.outboundStreamOpts.publisherProperties.videoSource=="string"&&this.outboundStreamOpts.publisherProperties.videoSource.startsWith("screen:")),!!this.outboundStreamOpts&&t},e.prototype.enableHarkSpeakingEvent=function(){var t=this;this.setHarkListenerIfNotExists(),this.harkSpeakingEnabled||(this.harkSpeakingEnabled=!0,this.speechEvent.on("speaking",function(){t.session.emitEvent("publisherStartSpeaking",[new Mn.PublisherSpeakingEvent(t.session,"publisherStartSpeaking",t.connection,t.streamId)]),t.streamManager.emitEvent("publisherStartSpeaking",[new Mn.PublisherSpeakingEvent(t.streamManager,"publisherStartSpeaking",t.connection,t.streamId)]),t.harkSpeakingEnabledOnce=!1}))},e.prototype.enableOnceHarkSpeakingEvent=function(){var t=this;this.setHarkListenerIfNotExists(),this.harkSpeakingEnabledOnce||(this.harkSpeakingEnabledOnce=!0,this.speechEvent.once("speaking",function(){t.harkSpeakingEnabledOnce&&(t.session.emitEvent("publisherStartSpeaking",[new Mn.PublisherSpeakingEvent(t.session,"publisherStartSpeaking",t.connection,t.streamId)]),t.streamManager.emitEvent("publisherStartSpeaking",[new Mn.PublisherSpeakingEvent(t.streamManager,"publisherStartSpeaking",t.connection,t.streamId)])),t.disableHarkSpeakingEvent(!0)}))},e.prototype.disableHarkSpeakingEvent=function(t){if(this.speechEvent){if(this.harkSpeakingEnabledOnce=!1,t){if(this.harkSpeakingEnabled)return}else this.harkSpeakingEnabled=!1;this.harkVolumeChangeEnabled||this.harkVolumeChangeEnabledOnce||this.harkStoppedSpeakingEnabled||this.harkStoppedSpeakingEnabledOnce?this.speechEvent.off("speaking"):(this.speechEvent.stop(),delete this.speechEvent)}},e.prototype.enableHarkStoppedSpeakingEvent=function(){var t=this;this.setHarkListenerIfNotExists(),this.harkStoppedSpeakingEnabled||(this.harkStoppedSpeakingEnabled=!0,this.speechEvent.on("stopped_speaking",function(){t.session.emitEvent("publisherStopSpeaking",[new Mn.PublisherSpeakingEvent(t.session,"publisherStopSpeaking",t.connection,t.streamId)]),t.streamManager.emitEvent("publisherStopSpeaking",[new Mn.PublisherSpeakingEvent(t.streamManager,"publisherStopSpeaking",t.connection,t.streamId)]),t.harkStoppedSpeakingEnabledOnce=!1}))},e.prototype.enableOnceHarkStoppedSpeakingEvent=function(){var t=this;this.setHarkListenerIfNotExists(),this.harkStoppedSpeakingEnabledOnce||(this.harkStoppedSpeakingEnabledOnce=!0,this.speechEvent.once("stopped_speaking",function(){t.harkStoppedSpeakingEnabledOnce&&(t.session.emitEvent("publisherStopSpeaking",[new Mn.PublisherSpeakingEvent(t.session,"publisherStopSpeaking",t.connection,t.streamId)]),t.streamManager.emitEvent("publisherStopSpeaking",[new Mn.PublisherSpeakingEvent(t.streamManager,"publisherStopSpeaking",t.connection,t.streamId)])),t.disableHarkStoppedSpeakingEvent(!0)}))},e.prototype.disableHarkStoppedSpeakingEvent=function(t){if(this.speechEvent){if(this.harkStoppedSpeakingEnabledOnce=!1,t){if(this.harkStoppedSpeakingEnabled)return}else this.harkStoppedSpeakingEnabled=!1;this.harkVolumeChangeEnabled||this.harkVolumeChangeEnabledOnce||this.harkSpeakingEnabled||this.harkSpeakingEnabledOnce?this.speechEvent.off("stopped_speaking"):(this.speechEvent.stop(),delete this.speechEvent)}},e.prototype.enableHarkVolumeChangeEvent=function(t){var n=this;this.setHarkListenerIfNotExists()?(!this.harkVolumeChangeEnabled||t)&&(this.harkVolumeChangeEnabled=!0,this.speechEvent.on("volume_change",function(r){var i=n.speechEvent.oldVolumeValue,o={newValue:r,oldValue:i};n.speechEvent.oldVolumeValue=r,n.streamManager.emitEvent("streamAudioVolumeChange",[new tp.StreamManagerEvent(n.streamManager,"streamAudioVolumeChange",o)])})):this.harkVolumeChangeEnabled=!0},e.prototype.enableOnceHarkVolumeChangeEvent=function(t){var n=this;this.setHarkListenerIfNotExists()?(!this.harkVolumeChangeEnabledOnce||t)&&(this.harkVolumeChangeEnabledOnce=!0,this.speechEvent.once("volume_change",function(r){var i=n.speechEvent.oldVolumeValue,o={newValue:r,oldValue:i};n.speechEvent.oldVolumeValue=r,n.disableHarkVolumeChangeEvent(!0),n.streamManager.emitEvent("streamAudioVolumeChange",[new tp.StreamManagerEvent(n.streamManager,"streamAudioVolumeChange",o)])})):this.harkVolumeChangeEnabledOnce=!0},e.prototype.disableHarkVolumeChangeEvent=function(t){if(this.speechEvent){if(this.harkVolumeChangeEnabledOnce=!1,t){if(this.harkVolumeChangeEnabled)return}else this.harkVolumeChangeEnabled=!1;this.harkSpeakingEnabled||this.harkSpeakingEnabledOnce||this.harkStoppedSpeakingEnabled||this.harkStoppedSpeakingEnabledOnce?this.speechEvent.off("volume_change"):(this.speechEvent.stop(),delete this.speechEvent)}},e.prototype.isLocal=function(){return!this.inboundStreamOpts&&!!this.outboundStreamOpts},e.prototype.getSelectedIceCandidate=function(){var t=this;return new Promise(function(n,r){t.webRtcStats.getSelectedIceCandidateInfo().then(function(i){return n(i)}).catch(function(i){return r(i)})})},e.prototype.getRemoteIceCandidateList=function(){return this.webRtcPeer.remoteCandidatesQueue},e.prototype.getLocalIceCandidateList=function(){return this.webRtcPeer.localCandidatesQueue},e.prototype.streamIceConnectionStateBroken=function(){if(!this.getWebRtcPeer()||!this.getRTCPeerConnection())return!1;if(this.isLocal()&&this.session.openvidu.advancedConfiguration.forceMediaReconnectionAfterNetworkDrop)return Pe.warn('OpenVidu Browser advanced configuration option "forceMediaReconnectionAfterNetworkDrop" is enabled. Stream '+this.streamId+" ("+(this.isLocal()?"Publisher":"Subscriber")+") will force a reconnection"),!0;var t=this.getRTCPeerConnection().iceConnectionState;return t!=="connected"&&t!=="completed"},e.prototype.setHarkListenerIfNotExists=function(){if(this.mediaStream){if(!this.speechEvent){var t=this.harkOptions?this.harkOptions:this.session.openvidu.advancedConfiguration.publisherSpeakingEventsOptions||{};t.interval=typeof t.interval=="number"?t.interval:100,t.threshold=typeof t.threshold=="number"?t.threshold:-50,this.speechEvent=b1(this.mediaStream,t)}return!0}return!1},e.prototype.setupReconnectionEventEmitter=function(t,n){return this.reconnectionEventEmitter==null?(this.reconnectionEventEmitter=new np,!1):(console.warn("Trying to reconnect stream "+this.streamId+" ("+(this.isLocal()?"Publisher":"Subscriber")+") but an ongoing reconnection process is active. Waiting for response..."),this.reconnectionEventEmitter.once("success",function(){t()}),this.reconnectionEventEmitter.once("error",function(r){n(r)}),!0)},e.prototype.initWebRtcPeerSend=function(t){var n=this;return new Promise(function(r,i){if(t){if(n.setupReconnectionEventEmitter(r,i))return}else n.initHarkEvents();var o=function(){var l;t&&((l=n.reconnectionEventEmitter)===null||l===void 0||l.emitEvent("success"),delete n.reconnectionEventEmitter),r()},s=function(l){var u;t&&((u=n.reconnectionEventEmitter)===null||u===void 0||u.emitEvent("error",[l]),delete n.reconnectionEventEmitter),i(l)},a=function(l){Pe.debug("Sending SDP offer to publish as "+n.streamId,l);var u=t?"reconnectStream":"publishVideo",d;if(t)d={stream:n.streamId,sdpString:l};else{var m="";n.isSendVideo()&&(m=typeof MediaStreamTrack<"u"&&n.outboundStreamOpts.publisherProperties.videoSource instanceof MediaStreamTrack?"CUSTOM":n.isSendScreen()?"SCREEN":"CAMERA"),d={doLoopback:n.displayMyRemote()||!1,hasAudio:n.isSendAudio(),hasVideo:n.isSendVideo(),audioActive:n.audioActive,videoActive:n.videoActive,typeOfVideo:m,frameRate:n.frameRate?n.frameRate:-1,videoDimensions:JSON.stringify(n.videoDimensions),filter:n.outboundStreamOpts.publisherProperties.filter,sdpOffer:l}}n.session.openvidu.sendRequest(u,d,function(g,b){g?g.code===401?s(new Dr.OpenViduError(Dr.OpenViduErrorName.OPENVIDU_PERMISSION_DENIED,"You don't have permissions to publish")):s("Error on publishVideo: "+JSON.stringify(g)):n.webRtcPeer.processRemoteAnswer(b.sdpAnswer).then(function(){n.streamId=b.id,n.creationTime=b.createdAt,n.isLocalStreamPublished=!0,n.publishedOnce=!0,n.displayMyRemote()&&(n.localMediaStreamWhenSubscribedToRemote=n.mediaStream,n.remotePeerSuccessfullyEstablished(t)),t?n.ee.emitEvent("stream-reconnected-by-publisher",[]):n.ee.emitEvent("stream-created-by-publisher",[]),n.initWebRtcStats(),Pe.info("'Publisher' ("+n.streamId+") successfully "+(t?"reconnected":"published")+" to session"),o()}).catch(function(P){s(P)})})},c={mediaConstraints:{audio:n.hasAudio,video:n.hasVideo},simulcast:n.session.openvidu.advancedConfiguration.enableSimulcastExperimental||!1,onIceCandidate:n.connection.sendIceCandidate.bind(n.connection),onIceConnectionStateException:function(l,u,d){n.session.emitEvent("exception",[new dr.ExceptionEvent(n.session,l,n,u,d)])},iceServers:n.getIceServersConf(),mediaStream:n.mediaStream,mediaServer:n.session.openvidu.mediaServer};t&&n.disposeWebRtcPeer(),n.displayMyRemote()?n.webRtcPeer=new Tl.WebRtcPeerSendrecv(c):n.webRtcPeer=new Tl.WebRtcPeerSendonly(c),n.webRtcPeer.addIceConnectionStateChangeListener("publisher of "+n.connection.connectionId),n.webRtcPeer.createOffer().then(function(l){n.webRtcPeer.processLocalOffer(l).then(function(){a(l.sdp)}).catch(function(u){s(new Error("(publish) SDP process local offer error: "+JSON.stringify(u)))})}).catch(function(l){s(new Error("(publish) SDP create offer error: "+JSON.stringify(l)))})})},e.prototype.finalResolveForSubscription=function(t,n){var r;Pe.info("'Subscriber' ("+this.streamId+") successfully "+(t?"reconnected":"subscribed")),this.remotePeerSuccessfullyEstablished(t),this.initWebRtcStats(),t&&((r=this.reconnectionEventEmitter)===null||r===void 0||r.emitEvent("success"),delete this.reconnectionEventEmitter),n()},e.prototype.finalRejectForSubscription=function(t,n,r){var i;Pe.error("Error for 'Subscriber' ("+this.streamId+") while trying to "+(t?"reconnect":"subscribe")+": "+n.toString()),t&&((i=this.reconnectionEventEmitter)===null||i===void 0||i.emitEvent("error",[n]),delete this.reconnectionEventEmitter),r(n)},e.prototype.initWebRtcPeerReceive=function(t){var n=this;return new Promise(function(r,i){t&&n.setupReconnectionEventEmitter(r,i)||(n.session.openvidu.mediaServer==="mediasoup"?n.initWebRtcPeerReceiveFromServer(t).then(function(){return n.finalResolveForSubscription(t,r)}).catch(function(o){return n.finalRejectForSubscription(t,o,i)}):n.initWebRtcPeerReceiveFromClient(t).then(function(){return n.finalResolveForSubscription(t,r)}).catch(function(o){return n.finalRejectForSubscription(t,o,i)}))})},e.prototype.initWebRtcPeerReceiveFromClient=function(t){var n=this;return new Promise(function(r,i){n.completeWebRtcPeerReceive(t,!1).then(function(o){n.webRtcPeer.processRemoteAnswer(o.sdpAnswer).then(function(){return r()}).catch(function(s){return i(s)})}).catch(function(o){return i(o)})})},e.prototype.initWebRtcPeerReceiveFromServer=function(t){var n=this;return new Promise(function(r,i){n.session.openvidu.sendRequest("prepareReceiveVideoFrom",{sender:n.streamId,reconnect:t},function(o,s){o?i(new Error("Error on prepareReceiveVideoFrom: "+JSON.stringify(o))):n.completeWebRtcPeerReceive(t,!1,s.sdpOffer).then(function(){return r()}).catch(function(a){return i(a)})})})},e.prototype.completeWebRtcPeerReceive=function(t,n,r){var i=this;return new Promise(function(o,s){Pe.debug("'Session.subscribe(Stream)' called");var a=function(l){Pe.debug("Sending local SDP "+(r?"answer":"offer")+" to subscribe to "+i.streamId,l);var u=t?"reconnectStream":"receiveVideoFrom",d={};d[t?"stream":"sender"]=i.streamId,r?d[t?"sdpString":"sdpAnswer"]=l:d.sdpOffer=l,t&&(d.forciblyReconnect=n),i.session.openvidu.sendRequest(u,d,function(m,g){m?s(new Error("Error on "+u+" : "+JSON.stringify(m))):o(g)})},c={mediaConstraints:{audio:i.hasAudio,video:i.hasVideo},simulcast:!1,onIceCandidate:i.connection.sendIceCandidate.bind(i.connection),onIceConnectionStateException:function(l,u,d){i.session.emitEvent("exception",[new dr.ExceptionEvent(i.session,l,i,u,d)])},iceServers:i.getIceServersConf(),mediaServer:i.session.openvidu.mediaServer};t&&i.disposeWebRtcPeer(),i.webRtcPeer=new Tl.WebRtcPeerRecvonly(c),i.webRtcPeer.addIceConnectionStateChangeListener(i.streamId),r?i.webRtcPeer.processRemoteOffer(r).then(function(){i.webRtcPeer.createAnswer().then(function(l){i.webRtcPeer.processLocalAnswer(l).then(function(){a(l.sdp)}).catch(function(u){s(new Error("(subscribe) SDP process local answer error: "+JSON.stringify(u)))})}).catch(function(l){s(new Error("(subscribe) SDP create answer error: "+JSON.stringify(l)))})}).catch(function(l){s(new Error("(subscribe) SDP process remote offer error: "+JSON.stringify(l)))}):i.webRtcPeer.createOffer().then(function(l){i.webRtcPeer.processLocalOffer(l).then(function(){a(l.sdp)}).catch(function(u){s(new Error("(subscribe) SDP process local offer error: "+JSON.stringify(u)))})}).catch(function(l){s(new Error("(subscribe) SDP create offer error: "+JSON.stringify(l)))})})},e.prototype.remotePeerSuccessfullyEstablished=function(t){t&&this.mediaStream!=null&&this.disposeMediaStream(),this.mediaStream=new MediaStream;for(var n,r=0,i=this.webRtcPeer.pc.getReceivers();r<i.length;r++)n=i[r],n.track&&this.mediaStream.addTrack(n.track);if(Pe.debug("Peer remote stream",this.mediaStream),this.mediaStream){if(this.streamManager instanceof y1.Subscriber){if(this.mediaStream.getAudioTracks()[0]){var o=t?this.audioActive:!!this.streamManager.properties.subscribeToAudio;this.mediaStream.getAudioTracks()[0].enabled=o}if(this.mediaStream.getVideoTracks()[0]){var o=t?this.videoActive:!!this.streamManager.properties.subscribeToVideo;this.mediaStream.getVideoTracks()[0].enabled=o}}this.updateMediaStreamInVideos(),this.initHarkEvents()}},e.prototype.initHarkEvents=function(){this.mediaStream.getAudioTracks()[0]&&(this.session.anySpeechEventListenerEnabled("publisherStartSpeaking",!0,this.streamManager)&&this.enableOnceHarkSpeakingEvent(),this.session.anySpeechEventListenerEnabled("publisherStartSpeaking",!1,this.streamManager)&&this.enableHarkSpeakingEvent(),this.session.anySpeechEventListenerEnabled("publisherStopSpeaking",!0,this.streamManager)&&this.enableOnceHarkStoppedSpeakingEvent(),this.session.anySpeechEventListenerEnabled("publisherStopSpeaking",!1,this.streamManager)&&this.enableHarkStoppedSpeakingEvent(),this.harkVolumeChangeEnabledOnce&&this.enableOnceHarkVolumeChangeEvent(!0),this.harkVolumeChangeEnabled&&this.enableHarkVolumeChangeEvent(!0))},e.prototype.onIceConnectionStateExceptionHandler=function(t,n,r){switch(t){case dr.ExceptionEventName.ICE_CONNECTION_FAILED:this.onIceConnectionFailed();break;case dr.ExceptionEventName.ICE_CONNECTION_DISCONNECTED:this.onIceConnectionDisconnected();break}this.session.emitEvent("exception",[new dr.ExceptionEvent(this.session,t,this,n,r)])},e.prototype.onIceConnectionFailed=function(){Pe.log("[ICE_CONNECTION_FAILED] Handling ICE_CONNECTION_FAILED event. Reconnecting stream "+this.streamId+" ("+(this.isLocal()?"Publisher":"Subscriber")+")"),this.reconnectStreamAndLogResultingIceConnectionState(dr.ExceptionEventName.ICE_CONNECTION_FAILED)},e.prototype.onIceConnectionDisconnected=function(){var t=this;Pe.log("[ICE_CONNECTION_DISCONNECTED] Handling ICE_CONNECTION_DISCONNECTED event. Waiting for ICE to be restored and reconnect stream "+this.streamId+" ("+(this.isLocal()?"Publisher":"Subscriber")+") if not possible");var n=this.session.openvidu.advancedConfiguration.iceConnectionDisconnectedExceptionTimeout||4e3;this.awaitWebRtcPeerConnectionState(n).then(function(r){switch(r){case"failed":Pe.warn("[ICE_CONNECTION_DISCONNECTED] ICE connection of stream "+t.streamId+" ("+(t.isLocal()?"Publisher":"Subscriber")+") is now failed after ICE_CONNECTION_DISCONNECTED");break;case"connected":case"completed":Pe.log("[ICE_CONNECTION_DISCONNECTED] ICE connection of stream "+t.streamId+" ("+(t.isLocal()?"Publisher":"Subscriber")+") automatically restored after ICE_CONNECTION_DISCONNECTED. Current ICE connection state: "+r);break;case"closed":case"checking":case"new":case"disconnected":Pe.warn("[ICE_CONNECTION_DISCONNECTED] ICE connection of stream "+t.streamId+" ("+(t.isLocal()?"Publisher":"Subscriber")+") couldn't be restored after ICE_CONNECTION_DISCONNECTED event. Current ICE connection state after "+n+" ms: "+r),t.reconnectStreamAndLogResultingIceConnectionState(dr.ExceptionEventName.ICE_CONNECTION_DISCONNECTED);break}})},e.prototype.reconnectStreamAndLogResultingIceConnectionState=function(t){return us(this,void 0,void 0,function(){var n,r;return ds(this,function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,this.reconnectStreamAndReturnIceConnectionState(t)];case 1:switch(n=i.sent(),n){case"connected":case"completed":Pe.log("["+t+"] Stream "+this.streamId+" ("+(this.isLocal()?"Publisher":"Subscriber")+") successfully reconnected after "+t+". Current ICE connection state: "+n);break;default:Pe.error("["+t+"] Stream "+this.streamId+" ("+(this.isLocal()?"Publisher":"Subscriber")+") failed to reconnect after "+t+". Current ICE connection state: "+n);break}return[3,3];case 2:return r=i.sent(),Pe.error("["+t+"] Error reconnecting stream "+this.streamId+" ("+(this.isLocal()?"Publisher":"Subscriber")+") after "+t+": "+r),[3,3];case 3:return[2]}})})},e.prototype.reconnectStreamAndReturnIceConnectionState=function(t){return us(this,void 0,void 0,function(){var n,r;return ds(this,function(i){switch(i.label){case 0:Pe.log("["+t+"] Reconnecting stream "+this.streamId+" ("+(this.isLocal()?"Publisher":"Subscriber")+") after event "+t),i.label=1;case 1:return i.trys.push([1,3,,4]),[4,this.reconnectStream(t)];case 2:return i.sent(),n=this.session.openvidu.advancedConfiguration.iceConnectionDisconnectedExceptionTimeout||4e3,[2,this.awaitWebRtcPeerConnectionState(n)];case 3:return r=i.sent(),Pe.warn("["+t+"] Error reconnecting stream "+this.streamId+" ("+(this.isLocal()?"Publisher":"Subscriber")+"). Reason: "+r),[2,this.awaitWebRtcPeerConnectionState(1)];case 4:return[2]}})})},e.prototype.reconnectStream=function(t){return us(this,void 0,void 0,function(){var n,r;return ds(this,function(i){switch(i.label){case 0:return[4,this.isWebsocketConnected(t,3e3)];case 1:if(n=i.sent(),n)return Pe.log("["+t+"] Trying to reconnect stream "+this.streamId+" ("+(this.isLocal()?"Publisher":"Subscriber")+") and the websocket is opened"),this.isLocal()?[2,this.initWebRtcPeerSend(!0)]:[2,this.initWebRtcPeerReceive(!0)];throw r="["+t+"] Trying to reconnect stream "+this.streamId+" ("+(this.isLocal()?"Publisher":"Subscriber")+") but the websocket wasn't opened",Pe.error(r),Error(r)}})})},e.prototype.isWebsocketConnected=function(t,n){var r=this;return new Promise(function(i,o){var s=r.session.openvidu.getWsReadyState();if(s===1){var a=setTimeout(function(){console.warn("["+t+"] Websocket timeout of "+n+"ms"),i(!1)},n);r.session.openvidu.sendRequest("echo",{},function(c,l){clearTimeout(a),c?(console.warn("["+t+"] Websocket 'echo' returned error: "+c),i(!1)):i(!0)})}else console.warn("["+t+"] Websocket readyState is "+s),i(!1)})},e.prototype.awaitWebRtcPeerConnectionState=function(t){return us(this,void 0,void 0,function(){var n,r,i,o;return ds(this,function(s){switch(s.label){case 0:n=this.getRTCPeerConnection().iceConnectionState,r=150,i=Math.ceil(t/r),o=0,s.label=1;case 1:return o<i?(n=this.getRTCPeerConnection().iceConnectionState,n==="connected"||n==="completed"?[3,4]:[4,new Promise(function(a){return setTimeout(a,r)})]):[3,4];case 2:s.sent(),s.label=3;case 3:return o++,[3,1];case 4:return[2,n]}})})},e.prototype.initWebRtcStats=function(){this.webRtcStats=new S1.WebRtcStats(this),this.webRtcStats.initWebRtcStats()},e.prototype.stopWebRtcStats=function(){this.webRtcStats&&this.webRtcStats.isEnabled()&&this.webRtcStats.stopWebRtcStats()},e.prototype.getIceServersConf=function(){var t;return this.session.openvidu.advancedConfiguration.iceServers?t=this.session.openvidu.advancedConfiguration.iceServers==="freeice"?void 0:this.session.openvidu.advancedConfiguration.iceServers:this.session.openvidu.iceServers?t=this.session.openvidu.iceServers:t=void 0,t},e.prototype.gatherStatsForPeer=function(){var t=this;return new Promise(function(n,r){t.isLocal()?t.getRTCPeerConnection().getSenders().forEach(function(i){return i.getStats().then(function(o){o.forEach(function(s){if(t.isReportWanted(s)){var a={};a.type=s.type,a.timestamp=s.timestamp,a.id=s.id,s.type==="outbound-rtp"&&(a.ssrc=s.ssrc,a.firCount=s.firCount,a.pliCount=s.pliCount,a.nackCount=s.nackCount,a.qpSum=s.qpSum,s.kind?a.mediaType=s.kind:s.mediaType?a.mediaType=s.mediaType:a.mediaType=s.id.indexOf("VideoStream")!==-1?"video":"audio",a.mediaType==="video"&&(a.framesEncoded=s.framesEncoded),a.packetsSent=s.packetsSent,a.bytesSent=s.bytesSent),s.type==="candidate-pair"&&s.totalRoundTripTime!==void 0&&(a.availableOutgoingBitrate=s.availableOutgoingBitrate,a.rtt=s.currentRoundTripTime,a.averageRtt=s.totalRoundTripTime/s.responsesReceived),s.type==="remote-inbound-rtp"||s.type,Pe.log(a)}})})}):t.getRTCPeerConnection().getReceivers().forEach(function(i){return i.getStats().then(function(o){o.forEach(function(s){if(t.isReportWanted(s)){var a={};a.type=s.type,a.timestamp=s.timestamp,a.id=s.id,s.type==="inbound-rtp"&&(a.ssrc=s.ssrc,a.firCount=s.firCount,a.pliCount=s.pliCount,a.nackCount=s.nackCount,a.qpSum=s.qpSum,s.kind?a.mediaType=s.kind:s.mediaType?a.mediaType=s.mediaType:a.mediaType=s.id.indexOf("VideoStream")!==-1?"video":"audio",a.mediaType==="video"&&(a.framesDecoded=s.framesDecoded),a.packetsReceived=s.packetsReceived,a.packetsLost=s.packetsLost,a.jitter=s.jitter,a.bytesReceived=s.bytesReceived),s.type==="candidate-pair"&&s.totalRoundTripTime!==void 0&&(a.availableIncomingBitrate=s.availableIncomingBitrate,a.rtt=s.currentRoundTripTime,a.averageRtt=s.totalRoundTripTime/s.responsesReceived),s.type==="remote-inbound-rtp"||s.type,Pe.log(a)}})})})})},e.prototype.isReportWanted=function(t){return t.type==="inbound-rtp"&&!this.isLocal()||t.type==="outbound-rtp"&&this.isLocal()||t.type==="candidate-pair"&&t.nominated&&t.bytesSent>0},e}();yi.Stream=C1;Object.defineProperty(Ao,"__esModule",{value:!0});Ao.Connection=void 0;var x1=yi,k1=Ke,ip=ki,ps=k1.OpenViduLogger.getInstance(),P1=function(){function e(t,n){this.session=t,this.disposed=!1;var r="'Connection' created ";n.role?(this.localOptions=n,this.connectionId=this.localOptions.id,this.creationTime=this.localOptions.createdAt,this.data=this.localOptions.metadata,this.rpcSessionId=this.localOptions.sessionId,this.role=this.localOptions.role,this.record=this.localOptions.record,r+="(local)"):(this.remoteOptions=n,this.connectionId=this.remoteOptions.id,this.creationTime=this.remoteOptions.createdAt,this.remoteOptions.metadata&&(this.data=this.remoteOptions.metadata),this.remoteOptions.streams&&this.initRemoteStreams(this.remoteOptions.streams),r+="(remote) with 'connectionId' ["+this.remoteOptions.id+"]"),ps.info(r)}return e.prototype.sendIceCandidate=function(t){var n=this;ps.debug((this.stream.outboundStreamOpts?"Local":"Remote")+"candidate for"+this.connectionId,t),this.session.openvidu.sendRequest("onIceCandidate",{endpointName:this.connectionId,candidate:t.candidate,sdpMid:t.sdpMid,sdpMLineIndex:t.sdpMLineIndex},function(r,i){r&&(ps.error("Error sending ICE candidate: "+JSON.stringify(r)),n.session.emitEvent("exception",[new ip.ExceptionEvent(n.session,ip.ExceptionEventName.ICE_CANDIDATE_ERROR,n.session,"There was an unexpected error on the server-side processing an ICE candidate generated and sent by the client-side",r)]))})},e.prototype.initRemoteStreams=function(t){var n=this;t.forEach(function(r){var i={id:r.id,createdAt:r.createdAt,connection:n,hasAudio:r.hasAudio,hasVideo:r.hasVideo,audioActive:r.audioActive,videoActive:r.videoActive,typeOfVideo:r.typeOfVideo,frameRate:r.frameRate,videoDimensions:r.videoDimensions?JSON.parse(r.videoDimensions):void 0,filter:r.filter?r.filter:void 0},o=new x1.Stream(n.session,i);n.addStream(o)}),ps.info("Remote 'Connection' with 'connectionId' ["+this.connectionId+"] is now configured for receiving Streams with options: ",this.stream.inboundStreamOpts)},e.prototype.addStream=function(t){t.connection=this,this.stream=t},e.prototype.removeStream=function(t){delete this.stream},e.prototype.dispose=function(){this.stream&&delete this.stream,this.disposed=!0},e}();Ao.Connection=P1;var Do={},O1=ue&&ue.__extends||function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},e(t,n)};return function(t,n){e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(Do,"__esModule",{value:!0});Do.ConnectionEvent=void 0;var R1=st,_1=function(e){O1(t,e);function t(n,r,i,o,s){var a=e.call(this,n,r,i)||this;return a.connection=o,a.reason=s,a}return t.prototype.callDefaultBehavior=function(){},t}(R1.Event);Do.ConnectionEvent=_1;var Vo={},I1=ue&&ue.__extends||function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},e(t,n)};return function(t,n){e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(Vo,"__esModule",{value:!0});Vo.FilterEvent=void 0;var N1=st,T1=function(e){I1(t,e);function t(n,r,i){var o=e.call(this,!1,n,r)||this;return o.data=i,o}return t.prototype.callDefaultBehavior=function(){},t}(N1.Event);Vo.FilterEvent=T1;var Fo={},L1=ue&&ue.__extends||function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},e(t,n)};return function(t,n){e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(Fo,"__esModule",{value:!0});Fo.RecordingEvent=void 0;var A1=st,M1=function(e){L1(t,e);function t(n,r,i,o,s){var a=e.call(this,!1,n,r)||this;return a.id=i,o!==i&&(a.name=o),a.reason=s,a}return t.prototype.callDefaultBehavior=function(){},t}(A1.Event);Fo.RecordingEvent=M1;var Pi={},j1=ue&&ue.__extends||function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},e(t,n)};return function(t,n){e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(Pi,"__esModule",{value:!0});Pi.SessionDisconnectedEvent=void 0;var D1=st,V1=Ke,F1=V1.OpenViduLogger.getInstance(),U1=function(e){j1(t,e);function t(n,r){var i=e.call(this,!0,n,"sessionDisconnected")||this;return i.reason=r,i}return t.prototype.callDefaultBehavior=function(){F1.info("Calling default behavior upon '"+this.type+"' event dispatched by 'Session'");var n=this.target;n.remoteConnections.forEach(function(r){var i,o,s,a,c,l,u,d,m=r.connectionId;if(!((i=n.remoteConnections.get(m))===null||i===void 0)&&i.stream){(o=n.remoteConnections.get(m))===null||o===void 0||o.stream.disposeWebRtcPeer(),(s=n.remoteConnections.get(m))===null||s===void 0||s.stream.disposeMediaStream(),!((a=n.remoteConnections.get(m))===null||a===void 0)&&a.stream.streamManager&&((c=n.remoteConnections.get(m))===null||c===void 0||c.stream.streamManager.removeAllVideos());var g=(u=(l=n.remoteConnections.get(m))===null||l===void 0?void 0:l.stream)===null||u===void 0?void 0:u.streamId;g&&n.remoteStreamsCreated.delete(g),(d=n.remoteConnections.get(m))===null||d===void 0||d.dispose()}n.remoteConnections.delete(m)})},t}(D1.Event);Pi.SessionDisconnectedEvent=U1;var Uo={},$1=ue&&ue.__extends||function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},e(t,n)};return function(t,n){e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(Uo,"__esModule",{value:!0});Uo.SignalEvent=void 0;var B1=st,z1=function(e){$1(t,e);function t(n,r,i,o){var s=e.call(this,!1,n,"signal")||this;return r&&(s.type="signal:"+r),s.data=i,s.from=o,s}return t.prototype.callDefaultBehavior=function(){},t}(B1.Event);Uo.SignalEvent=z1;var $i={},op;function od(){if(op)return $i;op=1;var e=ue&&ue.__extends||function(){var a=function(c,l){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(u,d){u.__proto__=d}||function(u,d){for(var m in d)Object.prototype.hasOwnProperty.call(d,m)&&(u[m]=d[m])},a(c,l)};return function(c,l){a(c,l);function u(){this.constructor=c}c.prototype=l===null?Object.create(l):(u.prototype=l.prototype,new u)}}();Object.defineProperty($i,"__esModule",{value:!0}),$i.StreamEvent=void 0;var t=st,n=sd(),r=za(),i=Ke,o=i.OpenViduLogger.getInstance(),s=function(a){e(c,a);function c(l,u,d,m,g){var b=a.call(this,l,u,d)||this;return b.stream=m,b.reason=g,b}return c.prototype.callDefaultBehavior=function(){if(this.type==="streamDestroyed"){if(this.target instanceof r.Session)o.info("Calling default behavior upon '"+this.type+"' event dispatched by 'Session'"),this.stream.disposeWebRtcPeer();else if(this.target instanceof n.Publisher){o.info("Calling default behavior upon '"+this.type+"' event dispatched by 'Publisher'"),clearInterval(this.target.screenShareResizeInterval),this.stream.isLocalStreamReadyToPublish=!1;for(var l=this.target.openvidu.publishers,u=0;u<l.length;u++)if(l[u]===this.target){l.splice(u,1);break}}this.stream.disposeMediaStream(),this.stream.streamManager&&this.stream.streamManager.removeAllVideos(),this.stream.session.remoteStreamsCreated.delete(this.stream.streamId);var d=this.stream.session.remoteConnections.get(this.stream.connection.connectionId);if(d&&d.remoteOptions)for(var m=d.remoteOptions.streams,u=m.length-1;u>=0;--u)m[u].id===this.stream.streamId&&m.splice(u,1)}},c}(t.Event);return $i.StreamEvent=s,$i}var $o={},W1=ue&&ue.__extends||function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},e(t,n)};return function(t,n){e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty($o,"__esModule",{value:!0});$o.ConnectionPropertyChangedEvent=void 0;var H1=st,q1=function(e){W1(t,e);function t(n,r,i,o,s){var a=e.call(this,!1,n,"connectionPropertyChanged")||this;return a.connection=r,a.changedProperty=i,a.newValue=o,a.oldValue=s,a}return t.prototype.callDefaultBehavior=function(){},t}(H1.Event);$o.ConnectionPropertyChangedEvent=q1;var Bo={},G1=ue&&ue.__extends||function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},e(t,n)};return function(t,n){e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(Bo,"__esModule",{value:!0});Bo.NetworkQualityLevelChangedEvent=void 0;var X1=st,J1=function(e){G1(t,e);function t(n,r,i,o){var s=e.call(this,!1,n,"networkQualityLevelChanged")||this;return s.newValue=r,s.oldValue=i,s.connection=o,s}return t.prototype.callDefaultBehavior=function(){},t}(X1.Event);Bo.NetworkQualityLevelChangedEvent=J1;var sp;function za(){if(sp)return Ui;sp=1;var e=ue&&ue.__extends||function(){var U=function(S,p){return U=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(E,I){E.__proto__=I}||function(E,I){for(var x in I)Object.prototype.hasOwnProperty.call(I,x)&&(E[x]=I[x])},U(S,p)};return function(S,p){U(S,p);function E(){this.constructor=S}S.prototype=p===null?Object.create(p):(E.prototype=p.prototype,new E)}}(),t=ue&&ue.__awaiter||function(U,S,p,E){function I(x){return x instanceof p?x:new p(function(N){N(x)})}return new(p||(p=Promise))(function(x,N){function j(C){try{_(E.next(C))}catch(O){N(O)}}function X(C){try{_(E.throw(C))}catch(O){N(O)}}function _(C){C.done?x(C.value):I(C.value).then(j,X)}_((E=E.apply(U,S||[])).next())})},n=ue&&ue.__generator||function(U,S){var p={label:0,sent:function(){if(x[0]&1)throw x[1];return x[1]},trys:[],ops:[]},E,I,x,N;return N={next:j(0),throw:j(1),return:j(2)},typeof Symbol=="function"&&(N[Symbol.iterator]=function(){return this}),N;function j(_){return function(C){return X([_,C])}}function X(_){if(E)throw new TypeError("Generator is already executing.");for(;p;)try{if(E=1,I&&(x=_[0]&2?I.return:_[0]?I.throw||((x=I.return)&&x.call(I),0):I.next)&&!(x=x.call(I,_[1])).done)return x;switch(I=0,x&&(_=[_[0]&2,x.value]),_[0]){case 0:case 1:x=_;break;case 4:return p.label++,{value:_[1],done:!1};case 5:p.label++,I=_[1],_=[0];continue;case 7:_=p.ops.pop(),p.trys.pop();continue;default:if(x=p.trys,!(x=x.length>0&&x[x.length-1])&&(_[0]===6||_[0]===2)){p=0;continue}if(_[0]===3&&(!x||_[1]>x[0]&&_[1]<x[3])){p.label=_[1];break}if(_[0]===6&&p.label<x[1]){p.label=x[1],x=_;break}if(x&&p.label<x[2]){p.label=x[2],p.ops.push(_);break}x[2]&&p.ops.pop(),p.trys.pop();continue}_=S.call(U,p)}catch(C){_=[6,C],I=0}finally{E=x=0}if(_[0]&5)throw _[1];return{value:_[0]?_[1]:void 0,done:!0}}};Object.defineProperty(Ui,"__esModule",{value:!0}),Ui.Session=void 0;var r=Ao,i=Si,o=wi,s=bi,a=Do,c=Vo,l=Fo,u=Pi,d=Uo,m=od(),g=Nn,b=$o,P=Bo,k=Rr,f=Mo,v=Ke,w=sn,y=v.OpenViduLogger.getInstance(),T,M=function(U){e(S,U);function S(p){var E=U.call(this)||this;return E.streamManagers=[],E.remoteStreamsCreated=new Map,E.remoteConnections=new Map,T=w.PlatformUtils.getInstance(),E.openvidu=p,E}return S.prototype.connect=function(p,E){var I=this;return new Promise(function(x,N){I.processToken(p),I.openvidu.checkSystemRequirements()?(I.options={sessionId:I.sessionId,participantId:p,metadata:E?I.stringClientMetadata(E):""},I.connectAux(p).then(function(){x()}).catch(function(j){N(j)})):N(new k.OpenViduError(k.OpenViduErrorName.BROWSER_NOT_SUPPORTED,"Browser "+T.getName()+" (version "+T.getVersion()+") for "+T.getFamily()+" is not supported in OpenVidu"))})},S.prototype.disconnect=function(){this.leave(!1,"disconnect")},S.prototype.subscribe=function(p,E,I,x){var N={};I&&typeof I!="function"?N={insertMode:typeof I.insertMode<"u"?typeof I.insertMode=="string"?f.VideoInsertMode[I.insertMode]:N.insertMode:f.VideoInsertMode.APPEND,subscribeToAudio:typeof I.subscribeToAudio<"u"?I.subscribeToAudio:!0,subscribeToVideo:typeof I.subscribeToVideo<"u"?I.subscribeToVideo:!0}:N={insertMode:f.VideoInsertMode.APPEND,subscribeToAudio:!0,subscribeToVideo:!0};var j=void 0;if(I&&typeof I=="function"?j=I:x&&(j=x),!this.sessionConnected())throw j!==void 0&&j(this.notConnectedError()),this.notConnectedError();y.info("Subscribing to "+p.connection.connectionId),p.subscribe().then(function(){y.info("Subscribed correctly to "+p.connection.connectionId),j!==void 0&&j(void 0)}).catch(function(_){j!==void 0&&j(_)});var X=new o.Subscriber(p,E,N);return X.targetElement&&p.streamManager.createVideoElement(X.targetElement,N.insertMode),X},S.prototype.subscribeAsync=function(p,E,I){var x=this;return new Promise(function(N,j){x.sessionConnected()||j(x.notConnectedError());var X,_=function(C){C?j(C):N(X)};I?X=x.subscribe(p,E,I,_):X=x.subscribe(p,E,_)})},S.prototype.unsubscribe=function(p){var E=this;return new Promise(function(I,x){if(!E.sessionConnected())x(E.notConnectedError());else{var N=p.stream.connection.connectionId;y.info("Unsubscribing from "+N),E.openvidu.sendRequest("unsubscribeFromVideo",{sender:p.stream.connection.connectionId},function(j,X){j?(y.error("Error unsubscribing from "+N),x(j)):(y.info("Unsubscribed correctly from "+N),p.stream.streamManager.removeAllVideos(),p.stream.disposeWebRtcPeer(),p.stream.disposeMediaStream(),I())})}})},S.prototype.publish=function(p){var E=this;return new Promise(function(I,x){E.sessionConnected()||x(E.notConnectedError()),p.session=E,p.stream.session=E,p.stream.publishedOnce?p.initialize().then(function(){E.connection.addStream(p.stream),p.reestablishStreamPlayingEvent(),p.stream.publish().then(function(){E.sendVideoData(p,8,!0,5),I()}).catch(function(N){x(N)})}).catch(function(N){x(N)}):(E.connection.addStream(p.stream),p.stream.publish().then(function(){E.sendVideoData(p,8,!0,5),I()}).catch(function(N){x(N)}))})},S.prototype.unpublish=function(p){var E=this;return new Promise(function(I,x){if(!E.sessionConnected())throw E.notConnectedError();var N=p.stream;N.connection?N.connection!==E.connection?x(new Error("The associated Connection object of this Publisher is not your local Connection.Only moderators can force unpublish on remote Streams via 'forceUnpublish' method")):(y.info("Unpublishing local media ("+N.connection.connectionId+")"),E.openvidu.sendRequest("unpublishVideo",function(j,X){if(j)x(j);else{y.info("Media unpublished correctly"),N.disposeWebRtcPeer(),N.connection.stream==N&&delete N.connection.stream;var _=new m.StreamEvent(!0,p,"streamDestroyed",p.stream,"unpublish");p.emitEvent("streamDestroyed",[_]),_.callDefaultBehavior(),I()}})):x(new Error("The associated Connection object of this Publisher is null"))})},S.prototype.forceDisconnect=function(p){var E=this;return new Promise(function(I,x){E.sessionConnected()||x(E.notConnectedError()),y.info("Forcing disconnect for connection "+p.connectionId),E.openvidu.sendRequest("forceDisconnect",{connectionId:p.connectionId},function(N,j){N?(y.error("Error forcing disconnect for Connection "+p.connectionId,N),N.code===401?x(new k.OpenViduError(k.OpenViduErrorName.OPENVIDU_PERMISSION_DENIED,"You don't have permissions to force a disconnection")):x(N)):(y.info("Forcing disconnect correctly for Connection "+p.connectionId),I())})})},S.prototype.forceUnpublish=function(p){var E=this;return new Promise(function(I,x){E.sessionConnected()||x(E.notConnectedError()),y.info("Forcing unpublish for stream "+p.streamId),E.openvidu.sendRequest("forceUnpublish",{streamId:p.streamId},function(N,j){N?(y.error("Error forcing unpublish for Stream "+p.streamId,N),N.code===401?x(new k.OpenViduError(k.OpenViduErrorName.OPENVIDU_PERMISSION_DENIED,"You don't have permissions to force an unpublishing")):x(N)):(y.info("Forcing unpublish correctly for Stream "+p.streamId),I())})})},S.prototype.signal=function(p){var E=this;return new Promise(function(I,x){E.sessionConnected()||x(E.notConnectedError());var N={};if(p.to&&p.to.length>0){var j=[];p.to.forEach(function(_){_.connectionId&&j.push(_.connectionId)}),N.to=j}else N.to=[];N.data=p.data?p.data:"";var X=p.type?p.type:"signal";X&&X.substring(0,7)!=="signal:"&&(X="signal:"+X),N.type=X,E.openvidu.sendRequest("sendMessage",{message:JSON.stringify(N)},function(_,C){_?x(_):I()})})},S.prototype.on=function(p,E){var I,x,N,j;return U.prototype.onAux.call(this,p,"Event '"+p+"' triggered by 'Session'",E),p==="publisherStartSpeaking"&&(this.remoteConnections.forEach(function(X){var _;!((_=X.stream)===null||_===void 0)&&_.hasAudio&&X.stream.enableHarkSpeakingEvent()}),!((x=(I=this.connection)===null||I===void 0?void 0:I.stream)===null||x===void 0)&&x.hasAudio&&this.connection.stream.enableHarkSpeakingEvent()),p==="publisherStopSpeaking"&&(this.remoteConnections.forEach(function(X){var _;!((_=X.stream)===null||_===void 0)&&_.hasAudio&&X.stream.enableHarkStoppedSpeakingEvent()}),!((j=(N=this.connection)===null||N===void 0?void 0:N.stream)===null||j===void 0)&&j.hasAudio&&this.connection.stream.enableHarkStoppedSpeakingEvent()),this},S.prototype.once=function(p,E){var I,x,N,j;return U.prototype.onceAux.call(this,p,"Event '"+p+"' triggered once by 'Session'",E),p==="publisherStartSpeaking"&&(this.remoteConnections.forEach(function(X){var _;!((_=X.stream)===null||_===void 0)&&_.hasAudio&&X.stream.enableOnceHarkSpeakingEvent()}),!((x=(I=this.connection)===null||I===void 0?void 0:I.stream)===null||x===void 0)&&x.hasAudio&&this.connection.stream.enableOnceHarkSpeakingEvent()),p==="publisherStopSpeaking"&&(this.remoteConnections.forEach(function(X){var _;!((_=X.stream)===null||_===void 0)&&_.hasAudio&&X.stream.enableOnceHarkStoppedSpeakingEvent()}),!((j=(N=this.connection)===null||N===void 0?void 0:N.stream)===null||j===void 0)&&j.hasAudio&&this.connection.stream.enableOnceHarkStoppedSpeakingEvent()),this},S.prototype.off=function(p,E){var I=this,x,N,j,X;return U.prototype.off.call(this,p,E),p==="publisherStartSpeaking"&&(this.anySpeechEventListenerEnabled("publisherStartSpeaking",!1)||(this.remoteConnections.forEach(function(_){var C;!((C=_.stream)===null||C===void 0)&&C.streamManager&&(I.anySpeechEventListenerEnabled("publisherStartSpeaking",!1,_.stream.streamManager)||_.stream.disableHarkSpeakingEvent(!1))}),!((N=(x=this.connection)===null||x===void 0?void 0:x.stream)===null||N===void 0)&&N.streamManager&&(this.anySpeechEventListenerEnabled("publisherStartSpeaking",!1,this.connection.stream.streamManager)||this.connection.stream.disableHarkSpeakingEvent(!1)))),p==="publisherStopSpeaking"&&(this.anySpeechEventListenerEnabled("publisherStopSpeaking",!1)||(this.remoteConnections.forEach(function(_){var C;!((C=_.stream)===null||C===void 0)&&C.streamManager&&(I.anySpeechEventListenerEnabled("publisherStopSpeaking",!1,_.stream.streamManager)||_.stream.disableHarkStoppedSpeakingEvent(!1))}),!((X=(j=this.connection)===null||j===void 0?void 0:j.stream)===null||X===void 0)&&X.streamManager&&(this.anySpeechEventListenerEnabled("publisherStopSpeaking",!1,this.connection.stream.streamManager)||this.connection.stream.disableHarkStoppedSpeakingEvent(!1)))),this},S.prototype.onParticipantJoined=function(p){var E=this;this.getConnection(p.id,"").then(function(I){y.warn("Connection "+I.connectionId+" already exists in connections list")}).catch(function(I){var x=new r.Connection(E,p);E.remoteConnections.set(p.id,x),E.ee.emitEvent("connectionCreated",[new a.ConnectionEvent(!1,E,"connectionCreated",x,"")])})},S.prototype.onParticipantLeft=function(p){var E=this;this.getRemoteConnection(p.connectionId,"onParticipantLeft").then(function(I){if(I.stream){var x=I.stream,N=new m.StreamEvent(!0,E,"streamDestroyed",x,p.reason);E.ee.emitEvent("streamDestroyed",[N]),N.callDefaultBehavior(),E.remoteStreamsCreated.delete(x.streamId)}E.remoteConnections.delete(I.connectionId),E.ee.emitEvent("connectionDestroyed",[new a.ConnectionEvent(!1,E,"connectionDestroyed",I,p.reason)])}).catch(function(I){y.error(I)})},S.prototype.onParticipantPublished=function(p){var E=this,I=function(N){E.remoteConnections.set(N.connectionId,N),E.remoteStreamsCreated.get(N.stream.streamId)||E.ee.emitEvent("streamCreated",[new m.StreamEvent(!1,E,"streamCreated",N.stream,"")]),E.remoteStreamsCreated.set(N.stream.streamId,!0)},x;this.getRemoteConnection(p.id,"onParticipantPublished").then(function(N){x=N,p.metadata=N.data,x.remoteOptions=p,x.initRemoteStreams(p.streams),I(x)}).catch(function(N){x=new r.Connection(E,p),I(x)})},S.prototype.onParticipantUnpublished=function(p){var E=this;p.connectionId===this.connection.connectionId?this.stopPublisherStream(p.reason):this.getRemoteConnection(p.connectionId,"onParticipantUnpublished").then(function(I){var x=new m.StreamEvent(!0,E,"streamDestroyed",I.stream,p.reason);E.ee.emitEvent("streamDestroyed",[x]),x.callDefaultBehavior();var N=I.stream.streamId;E.remoteStreamsCreated.delete(N),I.removeStream(N)}).catch(function(I){y.error(I)})},S.prototype.onParticipantEvicted=function(p){p.connectionId===this.connection.connectionId&&this.sessionId&&!this.connection.disposed&&this.leave(!0,p.reason)},S.prototype.onNewMessage=function(p){var E=this;y.info("New signal: "+JSON.stringify(p));var I=p.type?p.type.replace(/^(signal:)/,""):void 0;p.from?this.getConnection(p.from,"Connection '"+p.from+"' unknown when 'onNewMessage'. Existing remote connections: "+JSON.stringify(this.remoteConnections.keys())+". Existing local connection: "+this.connection.connectionId).then(function(x){E.ee.emitEvent("signal",[new d.SignalEvent(E,I,p.data,x)]),p.type&&p.type!=="signal"&&E.ee.emitEvent(p.type,[new d.SignalEvent(E,I,p.data,x)])}).catch(function(x){y.error(x)}):(this.ee.emitEvent("signal",[new d.SignalEvent(this,I,p.data,void 0)]),p.type&&p.type!=="signal"&&this.ee.emitEvent(p.type,[new d.SignalEvent(this,I,p.data,void 0)]))},S.prototype.onStreamPropertyChanged=function(p){var E=this,I=function(x){if(x.stream&&x.stream.streamId===p.streamId){var N=x.stream,j=void 0;switch(p.property){case"audioActive":j=N.audioActive,p.newValue=p.newValue==="true",N.audioActive=p.newValue;break;case"videoActive":j=N.videoActive,p.newValue=p.newValue==="true",N.videoActive=p.newValue;break;case"videoDimensions":j=N.videoDimensions,p.newValue=JSON.parse(JSON.parse(p.newValue)),N.videoDimensions=p.newValue;break;case"filter":j=N.filter,p.newValue=Object.keys(p.newValue).length>0?p.newValue:void 0,p.newValue!==void 0?(N.filter=new i.Filter(p.newValue.type,p.newValue.options),N.filter.stream=N,p.newValue.lastExecMethod&&(N.filter.lastExecMethod=p.newValue.lastExecMethod)):delete N.filter,p.newValue=N.filter;break}E.ee.emitEvent("streamPropertyChanged",[new g.StreamPropertyChangedEvent(E,N,p.property,p.newValue,j,p.reason)]),N.streamManager&&N.streamManager.emitEvent("streamPropertyChanged",[new g.StreamPropertyChangedEvent(N.streamManager,N,p.property,p.newValue,j,p.reason)])}else y.error("No stream with streamId '"+p.streamId+"' found for connection '"+p.connectionId+"' on 'streamPropertyChanged' event")};p.connectionId===this.connection.connectionId?I(this.connection):this.getRemoteConnection(p.connectionId,"onStreamPropertyChanged").then(function(x){I(x)}).catch(function(x){y.error(x)})},S.prototype.onConnectionPropertyChanged=function(p){var E;switch(p.property){case"role":E=this.connection.role.slice(),this.connection.role=p.newValue,this.connection.localOptions.role=p.newValue;break;case"record":E=this.connection.record,p.newValue=p.newValue==="true",this.connection.record=p.newValue,this.connection.localOptions.record=p.newValue;break}this.ee.emitEvent("connectionPropertyChanged",[new b.ConnectionPropertyChangedEvent(this,this.connection,p.property,p.newValue,E)])},S.prototype.onNetworkQualityLevelChangedChanged=function(p){var E=this;p.connectionId===this.connection.connectionId?this.ee.emitEvent("networkQualityLevelChanged",[new P.NetworkQualityLevelChangedEvent(this,p.newValue,p.oldValue,this.connection)]):this.getConnection(p.connectionId,"Connection not found for connectionId "+p.connectionId).then(function(I){E.ee.emitEvent("networkQualityLevelChanged",[new P.NetworkQualityLevelChangedEvent(E,p.newValue,p.oldValue,I)])}).catch(function(I){y.error(I)})},S.prototype.recvIceCandidate=function(p){var E={candidate:p.candidate,sdpMid:p.sdpMid,sdpMLineIndex:p.sdpMLineIndex,component:null,foundation:null,port:null,priority:null,protocol:null,relatedAddress:null,relatedPort:null,tcpType:null,usernameFragment:null,type:null,toJSON:function(){return{candidate:p.candidate}}};this.getConnection(p.senderConnectionId,"Connection not found for connectionId "+p.senderConnectionId+" owning endpoint "+p.endpointName+". Ice candidate will be ignored: "+E).then(function(I){var x=I.stream;x.getWebRtcPeer().addIceCandidate(E).catch(function(N){y.error("Error adding candidate for "+x.streamId+" stream of endpoint "+p.endpointName+": "+N)})}).catch(function(I){y.error(I)})},S.prototype.onSessionClosed=function(p){y.info("Session closed: "+JSON.stringify(p));var E=p.sessionId;E!==void 0?this.ee.emitEvent("session-closed",[{session:E}]):y.warn("Session undefined on session closed",p)},S.prototype.onLostConnection=function(p){y.warn("Lost connection in Session "+this.sessionId),this.sessionId&&this.connection&&!this.connection.disposed&&this.leave(!0,p)},S.prototype.onRecoveredConnection=function(){y.info("Recovered connection in Session "+this.sessionId),this.reconnectBrokenStreams(),this.ee.emitEvent("reconnected",[])},S.prototype.onMediaError=function(p){y.error("Media error: "+JSON.stringify(p));var E=p.error;E?this.ee.emitEvent("error-media",[{error:E}]):y.warn("Received undefined media error:",p)},S.prototype.onRecordingStarted=function(p){this.ee.emitEvent("recordingStarted",[new l.RecordingEvent(this,"recordingStarted",p.id,p.name)])},S.prototype.onRecordingStopped=function(p){this.ee.emitEvent("recordingStopped",[new l.RecordingEvent(this,"recordingStopped",p.id,p.name,p.reason)])},S.prototype.onFilterEventDispatched=function(p){var E=this,I=p.connectionId;this.getConnection(I,"No connection found for connectionId "+I).then(function(x){var N;y.info("Filter event dispatched");var j=x.stream;(N=j.filter.handlers.get(p.eventType))===null||N===void 0||N.call(E,new c.FilterEvent(j.filter,p.eventType,p.data))})},S.prototype.onForciblyReconnectSubscriber=function(p){var E=this;return new Promise(function(I,x){E.getRemoteConnection(p.connectionId,"onForciblyReconnectSubscriber").then(function(N){if(N.stream&&N.stream.streamId===p.streamId){var j=N.stream;if(j.setupReconnectionEventEmitter(I,x)){if(j.reconnectionEventEmitter.onForciblyReconnectSubscriberLastEvent!=null)j.reconnectionEventEmitter.onForciblyReconnectSubscriberLastEvent=p,x("Ongoing forced subscriber reconnection");else{j.reconnectionEventEmitter.onForciblyReconnectSubscriberLastEvent=p;var X=function(){var C=j.reconnectionEventEmitter.onForciblyReconnectSubscriberLastEvent;delete j.reconnectionEventEmitter.onForciblyReconnectSubscriberLastEvent,E.onForciblyReconnectSubscriber(C)};j.reconnectionEventEmitter.once("success",function(){X()}),j.reconnectionEventEmitter.once("error",function(){X()})}return}j.completeWebRtcPeerReceive(!0,!0,p.sdpOffer).then(function(){return j.finalResolveForSubscription(!0,I)}).catch(function(C){return j.finalRejectForSubscription(!0,"Error while forcibly reconnecting remote stream "+p.streamId+": "+C.toString(),x)})}else{var _="No stream with streamId '"+p.streamId+"' found for connection '"+p.connectionId+"' on 'streamPropertyChanged' event";y.error(_),x(_)}}).catch(function(N){y.error(N),x(N)})})},S.prototype.reconnectBrokenStreams=function(){y.info("Re-establishing media connections...");var p=!1;this.connection.stream&&this.connection.stream.streamIceConnectionStateBroken()&&(y.warn("Re-establishing Publisher "+this.connection.stream.streamId),this.connection.stream.initWebRtcPeerSend(!0),p=!0),this.remoteConnections.forEach(function(E){E.stream&&E.stream.streamIceConnectionStateBroken()&&(y.warn("Re-establishing Subscriber "+E.stream.streamId),E.stream.initWebRtcPeerReceive(!0),p=!0)}),p||y.info("There were no media streams in need of a reconnection")},S.prototype.emitEvent=function(p,E){this.ee.emitEvent(p,E)},S.prototype.leave=function(p,E){var I=this;if(p=!!p,y.info("Leaving Session (forced="+p+")"),this.stopVideoDataIntervals(),this.connection){if(!this.connection.disposed&&!p?this.openvidu.sendRequest("leaveRoom",function(N,j){N&&y.error("leaveRoom error: "+JSON.stringify(N)),I.openvidu.closeWs()}):this.openvidu.closeWs(),this.stopPublisherStream(E),!this.connection.disposed){var x=new u.SessionDisconnectedEvent(this,E);this.ee.emitEvent("sessionDisconnected",[x]),x.callDefaultBehavior()}}else y.warn("You were not connected to the session "+this.sessionId);y.flush()},S.prototype.initializeParams=function(p){var E={token:p||"",session:this.sessionId,platform:T.getDescription()?T.getDescription():"unknown",metadata:this.options.metadata?this.options.metadata:"",secret:this.openvidu.getSecret(),recorder:this.openvidu.getRecorder()};return E},S.prototype.sendVideoData=function(p,E,I,x){var N=this,j,X;if(E===void 0&&(E=1),I===void 0&&(I=!1),x===void 0&&(x=1),T.isChromeBrowser()||T.isChromeMobileBrowser()||T.isOperaBrowser()||T.isOperaMobileBrowser()||T.isEdgeBrowser()||T.isEdgeMobileBrowser()||T.isElectron()||T.isSafariBrowser()&&!T.isIonicIos()||T.isAndroidBrowser()||T.isSamsungBrowser()||T.isIonicAndroid()||T.isIOSWithSafari()){var _=function(){return t(N,void 0,void 0,function(){var O,F,W;return n(this,function($){switch($.label){case 0:return O=p.stream.getRTCPeerConnection(),O.connectionState!=="connected"?[3,2]:[4,O.getStats()];case 1:F=$.sent(),W=[],F.forEach(function(q){"frameWidth"in q&&"frameHeight"in q&&W.length===0&&W.push(q)}),W.length>0&&this.openvidu.sendRequest("videoData",{height:W[0].frameHeight,width:W[0].frameWidth,videoActive:p.stream.videoActive!=null?p.stream.videoActive:!1,audioActive:p.stream.audioActive!=null?p.stream.audioActive:!1},function(q,H){q&&y.error("Error sending 'videoData' event",q)}),$.label=2;case 2:return[2]}})})};if(I){var C=1;this.videoDataInterval=setInterval(function(){C<x?(C++,_()):clearInterval(N.videoDataInterval)},E*1e3)}else this.videoDataTimeout=setTimeout(_,E*1e3)}else T.isFirefoxBrowser()||T.isFirefoxMobileBrowser()||T.isIonicIos()||T.isReactNative()?this.openvidu.sendRequest("videoData",{height:((j=p.stream.videoDimensions)===null||j===void 0?void 0:j.height)||0,width:((X=p.stream.videoDimensions)===null||X===void 0?void 0:X.width)||0,videoActive:p.stream.videoActive!=null?p.stream.videoActive:!1,audioActive:p.stream.audioActive!=null?p.stream.audioActive:!1},function(O,F){O&&y.error("Error sending 'videoData' event",O)}):y.error("Browser "+T.getName()+" (version "+T.getVersion()+") for "+T.getFamily()+" is not supported in OpenVidu for Network Quality")},S.prototype.sessionConnected=function(){return this.connection!=null},S.prototype.notConnectedError=function(){return new k.OpenViduError(k.OpenViduErrorName.OPENVIDU_NOT_CONNECTED,"There is no connection to the session. Method 'Session.connect' must be successfully completed first")},S.prototype.anySpeechEventListenerEnabled=function(p,E,I){var x=this.ee.getListeners(p);E&&(x=x.filter(function(_){return _.once}));var N=x.length;if(N>0)return!0;var j=0;if(I){var X=I.ee.getListeners(p);E&&(X=X.filter(function(_){return _.once})),j=X.length}return j>0},S.prototype.connectAux=function(p){var E=this;return new Promise(function(I,x){E.openvidu.startWs(function(N){if(N)x(N);else{var j=E.initializeParams(p);E.openvidu.sendRequest("joinRoom",j,function(X,_){if(X)x(X);else{E.processJoinRoomResponse(_),v.OpenViduLogger.configureJSNLog(E.openvidu,p),E.connection=new r.Connection(E,_);var C={connections:new Array,streams:new Array},O=_.value;O.forEach(function(F){var W=new r.Connection(E,F);E.remoteConnections.set(W.connectionId,W),C.connections.push(W),W.stream&&(E.remoteStreamsCreated.set(W.stream.streamId,!0),C.streams.push(W.stream))}),E.ee.emitEvent("connectionCreated",[new a.ConnectionEvent(!1,E,"connectionCreated",E.connection,"")]),C.connections.forEach(function(F){E.ee.emitEvent("connectionCreated",[new a.ConnectionEvent(!1,E,"connectionCreated",F,"")])}),C.streams.forEach(function(F){E.ee.emitEvent("streamCreated",[new m.StreamEvent(!1,E,"streamCreated",F,"")])}),I()}})}})})},S.prototype.stopPublisherStream=function(p){this.connection.stream&&(this.connection.stream.disposeWebRtcPeer(),this.connection.stream.isLocalStreamPublished&&this.connection.stream.ee.emitEvent("local-stream-destroyed",[p]))},S.prototype.stopVideoDataIntervals=function(){clearInterval(this.videoDataInterval),clearTimeout(this.videoDataTimeout)},S.prototype.stringClientMetadata=function(p){return typeof p!="string"?JSON.stringify(p):p},S.prototype.getConnection=function(p,E){var I=this;return new Promise(function(x,N){var j=I.remoteConnections.get(p);j?x(j):I.connection.connectionId===p?x(I.connection):N(new k.OpenViduError(k.OpenViduErrorName.GENERIC_ERROR,E))})},S.prototype.getRemoteConnection=function(p,E){var I=this;return new Promise(function(x,N){var j=I.remoteConnections.get(p);if(j)x(j);else{var X="Remote connection "+p+" unknown when '"+E+"'. Existing remote connections: "+JSON.stringify(I.remoteConnections.keys());N(new k.OpenViduError(k.OpenViduErrorName.GENERIC_ERROR,X))}})},S.prototype.processToken=function(p){var E=p.match(/^(wss?\:)\/\/(([^:\/?#]*)(?:\:([0-9]+))?)([\/]{0,1}[^?#]*)(\?[^#]*|)(#.*|)$/);if(E){var I={protocol:E[1],host:E[2],hostname:E[3],port:E[4],pathname:E[5],search:E[6],hash:E[7]},x=p.split("?"),N=decodeURI(x[1]).split("&").map(function(O){return O.split("=")}).reduce(function(O,F){var W=F[0],$=F[1];return O[W]=$,O},{});this.sessionId=N.sessionId;var j=N.secret,X=N.recorder,_=N.webrtcStatsInterval,C=N.sendBrowserLogs;j&&(this.openvidu.secret=j),X&&(this.openvidu.recorder=!0),_&&(this.openvidu.webrtcStatsInterval=+_),C&&(this.openvidu.sendBrowserLogs=C),this.openvidu.isPro=!!_&&!!C,this.openvidu.wsUri="wss://"+I.host+"/openvidu",this.openvidu.httpUri="https://"+I.host}else y.error('Token "'+p+'" is not valid')},S.prototype.processJoinRoomResponse=function(p){if(this.sessionId=p.session,p.coturnIp!=null&&p.turnUsername!=null&&p.turnCredential!=null){var E="turn:"+p.coturnIp+":3478";this.openvidu.iceServers=[{urls:[E],username:p.turnUsername,credential:p.turnCredential}],y.log("STUN/TURN server IP: "+p.coturnIp),y.log("TURN temp credentials ["+p.turnUsername+":"+p.turnCredential+"]")}this.openvidu.role=p.role,this.openvidu.finalUserId=p.finalUserId,this.openvidu.mediaServer=p.mediaServer,this.capabilities={subscribe:!0,publish:this.openvidu.role!=="SUBSCRIBER",forceUnpublish:this.openvidu.role==="MODERATOR",forceDisconnect:this.openvidu.role==="MODERATOR"},y.info("openvidu-server version: "+p.version),p.life!=null&&(this.openvidu.life=p.life),p.version!==this.openvidu.libraryVersion&&y.warn("OpenVidu Server ("+p.version+") and OpenVidu Browser ("+this.openvidu.libraryVersion+") versions do NOT match. There may be incompatibilities")},S}(s.EventDispatcher);return Ui.Session=M,Ui}var ap;function sd(){if(ap)return Fi;ap=1;var e=ue&&ue.__extends||function(){var P=function(k,f){return P=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(v,w){v.__proto__=w}||function(v,w){for(var y in w)Object.prototype.hasOwnProperty.call(w,y)&&(v[y]=w[y])},P(k,f)};return function(k,f){P(k,f);function v(){this.constructor=k}k.prototype=f===null?Object.create(f):(v.prototype=f.prototype,new v)}}(),t=ue&&ue.__awaiter||function(P,k,f,v){function w(y){return y instanceof f?y:new f(function(T){T(y)})}return new(f||(f=Promise))(function(y,T){function M(p){try{S(v.next(p))}catch(E){T(E)}}function U(p){try{S(v.throw(p))}catch(E){T(E)}}function S(p){p.done?y(p.value):w(p.value).then(M,U)}S((v=v.apply(P,k||[])).next())})},n=ue&&ue.__generator||function(P,k){var f={label:0,sent:function(){if(y[0]&1)throw y[1];return y[1]},trys:[],ops:[]},v,w,y,T;return T={next:M(0),throw:M(1),return:M(2)},typeof Symbol=="function"&&(T[Symbol.iterator]=function(){return this}),T;function M(S){return function(p){return U([S,p])}}function U(S){if(v)throw new TypeError("Generator is already executing.");for(;f;)try{if(v=1,w&&(y=S[0]&2?w.return:S[0]?w.throw||((y=w.return)&&y.call(w),0):w.next)&&!(y=y.call(w,S[1])).done)return y;switch(w=0,y&&(S=[S[0]&2,y.value]),S[0]){case 0:case 1:y=S;break;case 4:return f.label++,{value:S[1],done:!1};case 5:f.label++,w=S[1],S=[0];continue;case 7:S=f.ops.pop(),f.trys.pop();continue;default:if(y=f.trys,!(y=y.length>0&&y[y.length-1])&&(S[0]===6||S[0]===2)){f=0;continue}if(S[0]===3&&(!y||S[1]>y[0]&&S[1]<y[3])){f.label=S[1];break}if(S[0]===6&&f.label<y[1]){f.label=y[1],y=S;break}if(y&&f.label<y[2]){f.label=y[2],f.ops.push(S);break}y[2]&&f.ops.pop(),f.trys.pop();continue}S=k.call(P,f)}catch(p){S=[6,p],w=0}finally{v=y=0}if(S[0]&5)throw S[1];return{value:S[0]?S[1]:void 0,done:!0}}};Object.defineProperty(Fi,"__esModule",{value:!0}),Fi.Publisher=void 0;var r=za(),i=yi,o=Ei,s=od(),a=Nn,c=xi,l=Rr,u=Ke,d=sn,m=u.OpenViduLogger.getInstance(),g,b=function(P){e(k,P);function k(f,v,w){var y=P.call(this,new i.Stream(w.session?w.session:new r.Session(w),{publisherProperties:v,mediaConstraints:{}}),f)||this;return y.accessAllowed=!1,y.isSubscribedToRemote=!1,y.accessDenied=!1,g=d.PlatformUtils.getInstance(),y.properties=v,y.openvidu=w,y.stream.ee.on("local-stream-destroyed",function(T){y.stream.isLocalStreamPublished=!1;var M=new s.StreamEvent(!0,y,"streamDestroyed",y.stream,T);y.emitEvent("streamDestroyed",[M]),M.callDefaultBehavior()}),y}return k.prototype.publishAudio=function(f){var v=this;if(this.stream.audioActive!==f){var w=this.stream.displayMyRemote()?this.stream.localMediaStreamWhenSubscribedToRemote:this.stream.getMediaStream();w.getAudioTracks().forEach(function(y){y.enabled=f}),this.session&&this.stream.streamId&&this.session.openvidu.sendRequest("streamPropertyChanged",{streamId:this.stream.streamId,property:"audioActive",newValue:f,reason:"publishAudio"},function(y,T){y?m.error("Error sending 'streamPropertyChanged' event",y):(v.session.emitEvent("streamPropertyChanged",[new a.StreamPropertyChangedEvent(v.session,v.stream,"audioActive",f,!f,"publishAudio")]),v.emitEvent("streamPropertyChanged",[new a.StreamPropertyChangedEvent(v,v.stream,"audioActive",f,!f,"publishAudio")]),v.session.sendVideoData(v.stream.streamManager))}),this.stream.audioActive=f,m.info("'Publisher' has "+(f?"published":"unpublished")+" its audio stream")}},k.prototype.publishVideo=function(f){var v=this;if(this.stream.videoActive!==f){var w=this.stream.displayMyRemote()?this.stream.localMediaStreamWhenSubscribedToRemote:this.stream.getMediaStream();w.getVideoTracks().forEach(function(y){y.enabled=f}),this.session&&this.stream.streamId&&this.session.openvidu.sendRequest("streamPropertyChanged",{streamId:this.stream.streamId,property:"videoActive",newValue:f,reason:"publishVideo"},function(y,T){y?m.error("Error sending 'streamPropertyChanged' event",y):(v.session.emitEvent("streamPropertyChanged",[new a.StreamPropertyChangedEvent(v.session,v.stream,"videoActive",f,!f,"publishVideo")]),v.emitEvent("streamPropertyChanged",[new a.StreamPropertyChangedEvent(v,v.stream,"videoActive",f,!f,"publishVideo")]),v.session.sendVideoData(v.stream.streamManager))}),this.stream.videoActive=f,m.info("'Publisher' has "+(f?"published":"unpublished")+" its video stream")}},k.prototype.subscribeToRemote=function(f){f=f!==void 0?f:!0,this.isSubscribedToRemote=f,this.stream.subscribeToMyRemote(f)},k.prototype.on=function(f,v){var w=this;return P.prototype.on.call(this,f,v),f==="streamCreated"&&(this.stream&&this.stream.isLocalStreamPublished?this.emitEvent("streamCreated",[new s.StreamEvent(!1,this,"streamCreated",this.stream,"")]):this.stream.ee.on("stream-created-by-publisher",function(){w.emitEvent("streamCreated",[new s.StreamEvent(!1,w,"streamCreated",w.stream,"")])})),f==="remoteVideoPlaying"&&this.stream.displayMyRemote()&&this.videos[0]&&this.videos[0].video&&this.videos[0].video.currentTime>0&&this.videos[0].video.paused===!1&&this.videos[0].video.ended===!1&&this.videos[0].video.readyState===4&&this.emitEvent("remoteVideoPlaying",[new c.VideoElementEvent(this.videos[0].video,this,"remoteVideoPlaying")]),f==="accessAllowed"&&this.accessAllowed&&this.emitEvent("accessAllowed",[]),f==="accessDenied"&&this.accessDenied&&this.emitEvent("accessDenied",[]),this},k.prototype.once=function(f,v){var w=this;return P.prototype.once.call(this,f,v),f==="streamCreated"&&(this.stream&&this.stream.isLocalStreamPublished?this.emitEvent("streamCreated",[new s.StreamEvent(!1,this,"streamCreated",this.stream,"")]):this.stream.ee.once("stream-created-by-publisher",function(){w.emitEvent("streamCreated",[new s.StreamEvent(!1,w,"streamCreated",w.stream,"")])})),f==="remoteVideoPlaying"&&this.stream.displayMyRemote()&&this.videos[0]&&this.videos[0].video&&this.videos[0].video.currentTime>0&&this.videos[0].video.paused===!1&&this.videos[0].video.ended===!1&&this.videos[0].video.readyState===4&&this.emitEvent("remoteVideoPlaying",[new c.VideoElementEvent(this.videos[0].video,this,"remoteVideoPlaying")]),f==="accessAllowed"&&this.accessAllowed&&this.emitEvent("accessAllowed",[]),f==="accessDenied"&&this.accessDenied&&this.emitEvent("accessDenied",[]),this},k.prototype.replaceTrack=function(f){return t(this,void 0,void 0,function(){var v,w,y,T,M=this;return n(this,function(U){switch(U.label){case 0:v=function(){return new Promise(function(S,p){var E=M.stream.displayMyRemote()?M.stream.localMediaStreamWhenSubscribedToRemote:M.stream.getMediaStream(),I;f.kind==="video"?I=E.getVideoTracks()[0]:I=E.getAudioTracks()[0],E.removeTrack(I),I.stop(),E.addTrack(f),f.kind==="video"&&M.stream.isLocalStreamPublished&&(M.openvidu.sendNewVideoDimensionsIfRequired(M,"trackReplaced",50,30),M.session.sendVideoData(M.stream.streamManager,5,!0,5)),S()})},w=function(){return new Promise(function(S,p){var E=M.stream.getRTCPeerConnection().getSenders(),I;if(f.kind==="video"){if(I=E.find(function(x){return!!x.track&&x.track.kind==="video"}),!I){p(new Error("There's no replaceable track for that kind of MediaStreamTrack in this Publisher object"));return}}else if(f.kind==="audio"){if(I=E.find(function(x){return!!x.track&&x.track.kind==="audio"}),!I){p(new Error("There's no replaceable track for that kind of MediaStreamTrack in this Publisher object"));return}}else{p(new Error("Unknown track kind "+f.kind));return}I.replaceTrack(f).then(function(){S()}).catch(function(x){p(x)})})},y=f.enabled,f.kind==="video"?f.enabled=this.stream.videoActive:f.kind==="audio"&&(f.enabled=this.stream.audioActive),U.label=1;case 1:return U.trys.push([1,7,,8]),this.stream.isLocalStreamPublished?[4,w()]:[3,4];case 2:return U.sent(),[4,v()];case 3:return[2,U.sent()];case 4:return[4,v()];case 5:return[2,U.sent()];case 6:return[3,8];case 7:throw T=U.sent(),f.enabled=y,T;case 8:return[2]}})})},k.prototype.initialize=function(){var f=this;return new Promise(function(v,w){var y={},T={},M=1500,U,S=function(x){f.accessDenied=!0,f.accessAllowed=!1,m.error("Publisher initialization failed. "+x.name+": "+x.message),w(x)},p=function(x){if(f.accessAllowed=!0,f.accessDenied=!1,typeof MediaStreamTrack<"u"&&f.properties.audioSource instanceof MediaStreamTrack&&(x.removeTrack(x.getAudioTracks()[0]),x.addTrack(f.properties.audioSource)),typeof MediaStreamTrack<"u"&&f.properties.videoSource instanceof MediaStreamTrack&&(x.removeTrack(x.getVideoTracks()[0]),x.addTrack(f.properties.videoSource)),x.getAudioTracks()[0]){var N=f.stream.audioActive!==void 0&&f.stream.audioActive!==null?f.stream.audioActive:!!f.stream.outboundStreamOpts.publisherProperties.publishAudio;x.getAudioTracks()[0].enabled=N}if(x.getVideoTracks()[0]){var N=f.stream.videoActive!==void 0&&f.stream.videoActive!==null?f.stream.videoActive:!!f.stream.outboundStreamOpts.publisherProperties.publishVideo;x.getVideoTracks()[0].enabled=N}f.initializeVideoReference(x),f.stream.displayMyRemote()||f.stream.updateMediaStreamInVideos(),delete f.firstVideoElement,f.stream.isSendVideo()?f.getVideoDimensions(x).then(function(j){f.stream.videoDimensions={width:j.width,height:j.height},f.stream.isSendScreen()&&(f.screenShareResizeInterval=setInterval(function(){var X=x.getVideoTracks()[0].getSettings(),_=X.width,C=X.height;f.stream.isLocalStreamPublished&&(_!==f.stream.videoDimensions.width||C!==f.stream.videoDimensions.height)&&f.openvidu.sendVideoDimensionsChangedEvent(f,"screenResized",f.stream.videoDimensions.width,f.stream.videoDimensions.height,_||0,C||0)},650)),f.stream.isLocalStreamReadyToPublish=!0,f.stream.ee.emitEvent("stream-ready-to-publish",[])}):(f.stream.isLocalStreamReadyToPublish=!0,f.stream.ee.emitEvent("stream-ready-to-publish",[])),v()},E=function(x,N){f.clearPermissionDialogTimer(U,M),f.stream.isSendScreen()&&f.stream.isSendAudio()?(T.audio=N,T.video=!1,U=Date.now(),f.setPermissionDialogTimer(M),navigator.mediaDevices.getUserMedia(T).then(function(j){f.clearPermissionDialogTimer(U,M),x.addTrack(j.getAudioTracks()[0]),p(x)}).catch(function(j){f.clearPermissionDialogTimer(U,M),x.getAudioTracks().forEach(function(X){X.stop()}),x.getVideoTracks().forEach(function(X){X.stop()}),S(f.openvidu.generateAudioDeviceError(j,y))})):p(x)},I=function(x){m.error("getMediaError: "+x.toString()),f.clearPermissionDialogTimer(U,M),x.name==="Error"&&(x.name=x.constructor.name);var N,j;switch(x.name.toLowerCase()){case"notfounderror":navigator.mediaDevices.getUserMedia({audio:!1,video:y.video}).then(function(X){X.getVideoTracks().forEach(function(_){_.stop()}),N=l.OpenViduErrorName.INPUT_AUDIO_DEVICE_NOT_FOUND,j=x.toString(),S(new l.OpenViduError(N,j))}).catch(function(X){N=l.OpenViduErrorName.INPUT_VIDEO_DEVICE_NOT_FOUND,j=x.toString(),S(new l.OpenViduError(N,j))});break;case"notallowederror":N=f.stream.isSendScreen()?l.OpenViduErrorName.SCREEN_CAPTURE_DENIED:l.OpenViduErrorName.DEVICE_ACCESS_DENIED,j=x.toString(),S(new l.OpenViduError(N,j));break;case"overconstrainederror":navigator.mediaDevices.getUserMedia({audio:!1,video:y.video}).then(function(X){X.getVideoTracks().forEach(function(_){_.stop()}),x.constraint.toLowerCase()==="deviceid"?(N=l.OpenViduErrorName.INPUT_AUDIO_DEVICE_NOT_FOUND,j="Audio input device with deviceId '"+y.audio.deviceId.exact+"' not found"):(N=l.OpenViduErrorName.PUBLISHER_PROPERTIES_ERROR,j="Audio input device doesn't support the value passed for constraint '"+x.constraint+"'"),S(new l.OpenViduError(N,j))}).catch(function(X){x.constraint.toLowerCase()==="deviceid"?(N=l.OpenViduErrorName.INPUT_VIDEO_DEVICE_NOT_FOUND,j="Video input device with deviceId '"+y.video.deviceId.exact+"' not found"):(N=l.OpenViduErrorName.PUBLISHER_PROPERTIES_ERROR,j="Video input device doesn't support the value passed for constraint '"+x.constraint+"'"),S(new l.OpenViduError(N,j))});break;case"aborterror":case"notreadableerror":N=l.OpenViduErrorName.DEVICE_ALREADY_IN_USE,j=x.toString(),S(new l.OpenViduError(N,j));break;default:N=l.OpenViduErrorName.GENERIC_ERROR,j=x.toString(),S(new l.OpenViduError(N,j));break}};f.openvidu.generateMediaConstraints(f.properties).then(function(x){var N,j;if(x.videoTrack&&x.audioTrack||x.audioTrack&&((N=x.constraints)===null||N===void 0?void 0:N.video)===!1||x.videoTrack&&((j=x.constraints)===null||j===void 0?void 0:j.audio)===!1){p(f.openvidu.addAlreadyProvidedTracks(x,new MediaStream));return}y=x.constraints;var X={mediaConstraints:y,publisherProperties:f.properties};f.stream.setOutboundStreamOptions(X);var _=y.audio===void 0?!0:y.audio;T.audio=f.stream.isSendScreen()?!1:_,T.video=y.video,U=Date.now(),f.setPermissionDialogTimer(M),f.stream.isSendScreen()&&navigator.mediaDevices.getDisplayMedia&&!g.isElectron()?navigator.mediaDevices.getDisplayMedia({video:!0}).then(function(C){f.openvidu.addAlreadyProvidedTracks(x,C),E(C,_)}).catch(function(C){I(C)}):navigator.mediaDevices.getUserMedia(T).then(function(C){f.openvidu.addAlreadyProvidedTracks(x,C),E(C,_)}).catch(function(C){I(C)})}).catch(function(x){S(x)})})},k.prototype.getVideoDimensions=function(f){var v=this;return new Promise(function(w,y){var T=g.isIonicIos()||g.isIOSWithSafari(),M,U=function(){var S,p;if(typeof v.stream.getMediaStream().getVideoTracks()[0].getSettings=="function"){var E=v.stream.getMediaStream().getVideoTracks()[0].getSettings();S=E.width||v.videoReference.videoWidth,p=E.height||v.videoReference.videoHeight}else m.warn("MediaStreamTrack does not have getSettings method on "+g.getDescription()),S=v.videoReference.videoWidth,p=v.videoReference.videoHeight;M!=null&&v.videoReference.removeEventListener("loadedmetadata",M),T&&document.body.removeChild(v.videoReference),w({width:S,height:p})};v.videoReference.readyState>=1?U():(M=function(){if(v.videoReference.videoWidth)U();else var S=setInterval(function(){v.videoReference.videoWidth&&(clearInterval(S),U())},40)},v.videoReference.addEventListener("loadedmetadata",M),T&&document.body.appendChild(v.videoReference))})},k.prototype.reestablishStreamPlayingEvent=function(){this.ee.getListeners("streamPlaying").length>0&&this.addPlayEventToFirstVideo()},k.prototype.initializeVideoReference=function(f){this.videoReference=document.createElement("video"),this.videoReference.setAttribute("muted","true"),this.videoReference.style.display="none",(g.isSafariBrowser()||g.isIPhoneOrIPad()&&(g.isChromeMobileBrowser()||g.isEdgeMobileBrowser()||g.isOperaMobileBrowser()||g.isFirefoxMobileBrowser()))&&this.videoReference.setAttribute("playsinline","true"),this.stream.setMediaStream(f),this.firstVideoElement&&this.createVideoElement(this.firstVideoElement.targetElement,this.properties.insertMode),this.videoReference.srcObject=f},k.prototype.setPermissionDialogTimer=function(f){var v=this;this.permissionDialogTimeout=setTimeout(function(){v.emitEvent("accessDialogOpened",[])},f)},k.prototype.clearPermissionDialogTimer=function(f,v){clearTimeout(this.permissionDialogTimeout),Date.now()-f>v&&this.emitEvent("accessDialogClosed",[])},k}(o.StreamManager);return Fi.Publisher=b,Fi}var Iv={};window.getScreenId=function(e,t,n){if(navigator.userAgent.indexOf("Edge")!==-1&&(navigator.msSaveOrOpenBlob||navigator.msSaveBlob)){t({video:!0});return}if(navigator.mozGetUserMedia){t(null,"firefox",{video:{mozMediaSource:e,mediaSource:e}});return}window.addEventListener("message",r);function r(i){i.data&&(i.data.chromeMediaSourceId&&(i.data.chromeMediaSourceId==="PermissionDeniedError"?t("permission-denied"):t(null,i.data.chromeMediaSourceId,lp(null,i.data.chromeMediaSourceId,i.data.canRequestAudioTrack)),window.removeEventListener("message",r)),i.data.chromeExtensionStatus&&(t(i.data.chromeExtensionStatus,null,lp(i.data.chromeExtensionStatus)),window.removeEventListener("message",r)))}setTimeout(n?function(){ua(n)}:ua,100)};function lp(e,t,n){var r={audio:!1,video:{mandatory:{chromeMediaSource:e?"screen":"desktop",maxWidth:window.screen.width>1920?window.screen.width:1920,maxHeight:window.screen.height>1080?window.screen.height:1080},optional:[]}};return n&&(r.audio={mandatory:{chromeMediaSource:e?"screen":"desktop"},optional:[]}),t&&(r.video.mandatory.chromeMediaSourceId=t,r.audio&&r.audio.mandatory&&(r.audio.mandatory.chromeMediaSourceId=t)),r}function ua(e){if(!wt){ad(function(){ua(e)});return}if(!wt.isLoaded){setTimeout(function(){ua(e)},100);return}e?e.forEach?wt.contentWindow.postMessage({captureCustomSourceId:e},"*"):wt.contentWindow.postMessage({captureSourceIdWithAudio:!0},"*"):wt.contentWindow.postMessage({captureSourceId:!0},"*")}var wt;window.getScreenConstraints=function(e){ad(function(){getScreenId(function(t,n,r){r||(r={video:!0}),e(t,r.video)})})};function ad(e){if(wt){e();return}wt=document.createElement("iframe"),wt.onload=function(){wt.isLoaded=!0,e()},wt.src="https://openvidu.github.io/openvidu-screen-sharing-chrome-extension/",wt.style.display="none",(document.body||document.documentElement).appendChild(wt)}window.getChromeExtensionStatus=function(e){if(navigator.mozGetUserMedia){e("installed-enabled");return}window.addEventListener("message",t);function t(n){n.data&&n.data.chromeExtensionStatus&&(e(n.data.chromeExtensionStatus),window.removeEventListener("message",t))}setTimeout(Gc,100)};function Gc(){if(!wt){ad(Gc);return}if(!wt.isLoaded){setTimeout(Gc,100);return}wt.contentWindow.postMessage({getChromeExtensionStatus:!0},"*")}Iv.getScreenId=window.getScreenId;var Oi={},er="screen",tr,Kr;if(typeof window<"u"&&typeof navigator<"u"&&typeof navigator.userAgent<"u"){var Nv=typeof window.InstallTrigger<"u";window.opera||navigator.userAgent.indexOf(" OPR/")>=0,window.addEventListener("message",function(e){e.origin==window.location.origin&&K1(e.data)})}function K1(e){if(e=="PermissionDeniedError"){if(Kr)return Kr("PermissionDeniedError");throw new Error("PermissionDeniedError")}e=="rtcmulticonnection-extension-loaded"&&(er="desktop"),e.sourceId&&Kr&&Kr(tr=e.sourceId,e.canRequestAudioTrack===!0)}function Q1(e){if(e){if(er=="desktop")return e(!0);window.postMessage("are-you-there","*"),setTimeout(function(){er=="screen"?e(!1):e(!0)},2e3)}}function Tv(e){if(!e)throw'"callback" parameter is mandatory.';if(tr)return e(tr);Kr=e,window.postMessage("get-sourceId","*")}function Y1(e){if(!e)throw'"callback" parameter is mandatory.';if(tr)return e(tr);Kr=e,window.postMessage("audio-plus-tab","*")}function Z1(e,t){if(Nv)return t("not-chrome");arguments.length!=2&&(t=e,e="lfcgfepafnobdloecchnfaclibenjold");var n=document.createElement("img");n.src="chrome-extension://"+e+"/icon.png",n.onload=function(){er="screen",window.postMessage("are-you-there","*"),setTimeout(function(){er=="screen"?t("installed-disabled"):t("installed-enabled")},2e3)},n.onerror=function(){t("not-installed")}}function eC(e){Lv(e,!0)}function Lv(e,t){tr="";var n={mozMediaSource:"window",mediaSource:"window"};if(Nv)return e(null,n);var r={mandatory:{chromeMediaSource:er,maxWidth:screen.width>1920?screen.width:1920,maxHeight:screen.height>1080?screen.height:1080},optional:[]};if(er=="desktop"&&!tr){t?Y1(function(i,o){r.mandatory.chromeMediaSourceId=i,o&&(r.canRequestAudioTrack=!0),e(i=="PermissionDeniedError"?i:null,r)}):Tv(function(i){r.mandatory.chromeMediaSourceId=i,e(i=="PermissionDeniedError"?i:null,r)});return}er=="desktop"&&(r.mandatory.chromeMediaSourceId=tr),e(null,r)}Oi.getScreenConstraints=Lv;Oi.getScreenConstraintsWithAudio=eC;Oi.isChromeExtensionAvailable=Q1;Oi.getChromeExtensionStatus=Z1;Oi.getSourceId=Tv;var ld={exports:{}},ri=typeof Reflect=="object"?Reflect:null,cp=ri&&typeof ri.apply=="function"?ri.apply:function(t,n,r){return Function.prototype.apply.call(t,n,r)},Is;ri&&typeof ri.ownKeys=="function"?Is=ri.ownKeys:Object.getOwnPropertySymbols?Is=function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:Is=function(t){return Object.getOwnPropertyNames(t)};function tC(e){console&&console.warn&&console.warn(e)}var Av=Number.isNaN||function(t){return t!==t};function Ne(){Ne.init.call(this)}ld.exports=Ne;ld.exports.once=oC;Ne.EventEmitter=Ne;Ne.prototype._events=void 0;Ne.prototype._eventsCount=0;Ne.prototype._maxListeners=void 0;var up=10;function Wa(e){if(typeof e!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}Object.defineProperty(Ne,"defaultMaxListeners",{enumerable:!0,get:function(){return up},set:function(e){if(typeof e!="number"||e<0||Av(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");up=e}});Ne.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};Ne.prototype.setMaxListeners=function(t){if(typeof t!="number"||t<0||Av(t))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+t+".");return this._maxListeners=t,this};function Mv(e){return e._maxListeners===void 0?Ne.defaultMaxListeners:e._maxListeners}Ne.prototype.getMaxListeners=function(){return Mv(this)};Ne.prototype.emit=function(t){for(var n=[],r=1;r<arguments.length;r++)n.push(arguments[r]);var i=t==="error",o=this._events;if(o!==void 0)i=i&&o.error===void 0;else if(!i)return!1;if(i){var s;if(n.length>0&&(s=n[0]),s instanceof Error)throw s;var a=new Error("Unhandled error."+(s?" ("+s.message+")":""));throw a.context=s,a}var c=o[t];if(c===void 0)return!1;if(typeof c=="function")cp(c,this,n);else for(var l=c.length,u=Uv(c,l),r=0;r<l;++r)cp(u[r],this,n);return!0};function jv(e,t,n,r){var i,o,s;if(Wa(n),o=e._events,o===void 0?(o=e._events=Object.create(null),e._eventsCount=0):(o.newListener!==void 0&&(e.emit("newListener",t,n.listener?n.listener:n),o=e._events),s=o[t]),s===void 0)s=o[t]=n,++e._eventsCount;else if(typeof s=="function"?s=o[t]=r?[n,s]:[s,n]:r?s.unshift(n):s.push(n),i=Mv(e),i>0&&s.length>i&&!s.warned){s.warned=!0;var a=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");a.name="MaxListenersExceededWarning",a.emitter=e,a.type=t,a.count=s.length,tC(a)}return e}Ne.prototype.addListener=function(t,n){return jv(this,t,n,!1)};Ne.prototype.on=Ne.prototype.addListener;Ne.prototype.prependListener=function(t,n){return jv(this,t,n,!0)};function nC(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function Dv(e,t,n){var r={fired:!1,wrapFn:void 0,target:e,type:t,listener:n},i=nC.bind(r);return i.listener=n,r.wrapFn=i,i}Ne.prototype.once=function(t,n){return Wa(n),this.on(t,Dv(this,t,n)),this};Ne.prototype.prependOnceListener=function(t,n){return Wa(n),this.prependListener(t,Dv(this,t,n)),this};Ne.prototype.removeListener=function(t,n){var r,i,o,s,a;if(Wa(n),i=this._events,i===void 0)return this;if(r=i[t],r===void 0)return this;if(r===n||r.listener===n)--this._eventsCount===0?this._events=Object.create(null):(delete i[t],i.removeListener&&this.emit("removeListener",t,r.listener||n));else if(typeof r!="function"){for(o=-1,s=r.length-1;s>=0;s--)if(r[s]===n||r[s].listener===n){a=r[s].listener,o=s;break}if(o<0)return this;o===0?r.shift():rC(r,o),r.length===1&&(i[t]=r[0]),i.removeListener!==void 0&&this.emit("removeListener",t,a||n)}return this};Ne.prototype.off=Ne.prototype.removeListener;Ne.prototype.removeAllListeners=function(t){var n,r,i;if(r=this._events,r===void 0)return this;if(r.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):r[t]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete r[t]),this;if(arguments.length===0){var o=Object.keys(r),s;for(i=0;i<o.length;++i)s=o[i],s!=="removeListener"&&this.removeAllListeners(s);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(n=r[t],typeof n=="function")this.removeListener(t,n);else if(n!==void 0)for(i=n.length-1;i>=0;i--)this.removeListener(t,n[i]);return this};function Vv(e,t,n){var r=e._events;if(r===void 0)return[];var i=r[t];return i===void 0?[]:typeof i=="function"?n?[i.listener||i]:[i]:n?iC(i):Uv(i,i.length)}Ne.prototype.listeners=function(t){return Vv(this,t,!0)};Ne.prototype.rawListeners=function(t){return Vv(this,t,!1)};Ne.listenerCount=function(e,t){return typeof e.listenerCount=="function"?e.listenerCount(t):Fv.call(e,t)};Ne.prototype.listenerCount=Fv;function Fv(e){var t=this._events;if(t!==void 0){var n=t[e];if(typeof n=="function")return 1;if(n!==void 0)return n.length}return 0}Ne.prototype.eventNames=function(){return this._eventsCount>0?Is(this._events):[]};function Uv(e,t){for(var n=new Array(t),r=0;r<t;++r)n[r]=e[r];return n}function rC(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}function iC(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}function oC(e,t){return new Promise(function(n,r){function i(s){e.removeListener(t,o),r(s)}function o(){typeof e.removeListener=="function"&&e.removeListener("error",i),n([].slice.call(arguments))}$v(e,t,o,{once:!0}),t!=="error"&&sC(e,i,{once:!0})})}function sC(e,t,n){typeof e.on=="function"&&$v(e,"error",t,n)}function $v(e,t,n,r){if(typeof e.on=="function")r.once?e.once(t,n):e.on(t,n);else if(typeof e.addEventListener=="function")e.addEventListener(t,function i(o){r.once&&e.removeEventListener(t,i),n(o)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e)}var aC=ld.exports,Xc={exports:{}};typeof Object.create=="function"?Xc.exports=function(t,n){n&&(t.super_=n,t.prototype=Object.create(n.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}))}:Xc.exports=function(t,n){if(n){t.super_=n;var r=function(){};r.prototype=n.prototype,t.prototype=new r,t.prototype.constructor=t}};var lC=Xc.exports,cd={},ud={};function cC(e,t){var n={jsonrpc:"2.0"};if(e.method)n.method=e.method,e.params&&(n.params=e.params),t!=null&&(n.id=t);else if(t!=null){if(e.error){if(e.result!==void 0)throw new TypeError("Both result and error are defined");n.error=e.error}else if(e.result!==void 0)n.result=e.result;else throw new TypeError("No result or error is defined");n.id=t}return JSON.stringify(n)}function uC(e){var t=e;(typeof e=="string"||e instanceof String)&&(t=JSON.parse(e));var n=t.jsonrpc;if(n!=="2.0")throw new TypeError("Invalid JsonRPC version '"+n+"': "+e);if(t.method==null){if(t.id==null)throw new TypeError("Invalid message: "+e);var r=t.result!==void 0,i=t.error!==void 0;if(r&&i)throw new TypeError("Both result and error are defined: "+e);if(!r&&!i)throw new TypeError("No result or error is defined: "+e);t.ack=t.id,delete t.id}return t}ud.pack=cC;ud.unpack=uC;var dd={};function dC(e){throw new TypeError("Not yet implemented")}function fC(e){throw new TypeError("Not yet implemented")}dd.pack=dC;dd.unpack=fC;var pC=ud,hC=dd;cd.JsonRPC=pC;cd.XmlRPC=hC;function Bv(){var e={};this.forEach=function(t){for(var n in e){var r=e[n];for(var i in r)t(r[i])}},this.get=function(t,n){var r=e[n];if(r!=null)return r[t]},this.remove=function(t,n){var r=e[n];if(r!=null){delete r[t];for(var i in r)return!1;delete e[n]}},this.set=function(t,n,r){if(t==null)return this.remove(n,r);var i=e[r];i==null&&(e[r]=i={}),i[n]=t}}Bv.prototype.pop=function(e,t){var n=this.get(e,t);if(n!=null)return this.remove(e,t),n};var mC=Bv,Ll={},Al,dp;function zv(){if(dp)return Al;dp=1;var e=Ke.OpenViduLogger,t=e.getInstance(),n=2e3,r=3e3,i=3;function o(s){var a=!1,c,l=s.uri,u=!1,d=new WebSocket(l);d.onopen=function(){t.debug("WebSocket connected to "+l),s.onconnected&&s.onconnected()},d.onerror=function(P){t.error("Could not connect to "+l+" (invoking onerror if defined)",P),s.onerror&&s.onerror(P)};var m=function(){d.readyState===i?a?t.debug("Connection closed by user"):s.ismasternodecrashed()?t.error("Master Node has crashed. Stopping reconnection process"):(t.debug("Connection closed unexpectedly. Reconnecting..."),g(n,1)):t.debug("Close callback from previous websocket. Ignoring it")};d.onclose=m;function g(P,k){if(t.debug("reconnect (attempt #"+k+", max="+P+")"),k===1){if(u){t.warn("Trying to reconnect when already reconnecting... Ignoring this reconnection.");return}else u=!0;s.onreconnecting&&s.onreconnecting()}b(P,k)}function b(P,k){t.debug("Reconnection attempt #"+k),d.close(),d=new WebSocket(l),d.onopen=function(){t.debug("Reconnected to "+l+" after "+k+" attempts..."),u=!1,c(),s.onreconnected()&&s.onreconnected(),d.onclose=m},d.onerror=function(f){t.warn("Reconnection error: ",f),k===P?s.ondisconnect&&s.ondisconnect():setTimeout(function(){g(P,k+1)},r)}}this.close=function(){a=!0,d.close()},this.forceClose=function(){d.close()},this.reconnectWs=function(){t.debug("reconnectWs"),g(n,1)},this.send=function(P){d.send(P)},this.addEventListener=function(P,k){c=function(){d.addEventListener(P,k)},c()},this.getReadyState=function(){return d.readyState}}return Al=o,Al}var Ml,fp;function vC(){if(fp)return Ml;fp=1;var e=Wv(),t=zv(),n=Ke.OpenViduLogger;Date.now=Date.now||function(){return+new Date};var r=5e3,i="RECONNECTING",o="CONNECTED",s="DISCONNECTED",a=n.getInstance();function c(l){var u=this,d=l.ws,m=-1,g=0,b=!0,P=!1,k,f=s,v=d.onreconnecting,w=d.onreconnected,y=d.onconnected,T=d.onerror;l.rpc.pull=function(N,j){j.reply(null,"push")},d.onreconnecting=function(){if(a.debug("--------- ONRECONNECTING -----------"),f===i){a.error("Websocket already in RECONNECTING state when receiving a new ONRECONNECTING message. Ignoring it");return}x(),f=i,v&&v()},d.onreconnected=function(){if(a.debug("--------- ONRECONNECTED -----------"),f===o){a.error("Websocket already in CONNECTED state when receiving a new ONRECONNECTED message. Ignoring it");return}f=o,p(),w&&w()},d.onconnected=function(){if(a.debug("--------- ONCONNECTED -----------"),f===o){a.error("Websocket already in CONNECTED state when receiving a new ONCONNECTED message. Ignoring it");return}f=o,b=!0,I(),y&&y()},d.onerror=function(N){a.debug("--------- ONERROR -----------"),f=s,x(),T&&T(N)};var M=new t(d);a.debug("Connecting websocket to URI: "+d.uri);var U={request_timeout:l.rpc.requestTimeout,ping_request_timeout:l.rpc.heartbeatRequestTimeout},S=new e(e.packers.JsonRPC,U,M,function(N){a.debug("Received request: "+JSON.stringify(N));try{var j=l.rpc[N.method];j===void 0?a.error("Method "+N.method+" not registered in client"):j(N.params,N)}catch(X){a.error("Exception processing request: "+JSON.stringify(N)),a.error(X)}});this.send=function(N,j,X){var _=Date.now();S.encode(N,j,function(C,O){if(C){try{a.error("ERROR:"+C.message+" in Request: method:"+N+" params:"+JSON.stringify(j)+" request:"+C.request),C.data&&a.error("ERROR DATA:"+JSON.stringify(C.data))}catch{}C.requestTime=_}X&&(O!=null&&O.value!=="pong"&&a.debug("Response: "+JSON.stringify(O)),X(C,O))})};function p(){a.debug("notReconnectIfNumLessThan = "+g+" (old="+m+")"),m=g}function E(){if(b){var N=null;(g==0||g==m)&&(N={interval:l.heartbeat||r}),g++,u.send("ping",N,function(j){return function(X,_){X&&(a.debug("Error in ping request #"+j+" ("+X.message+")"),j>m&&(b=!1,p(),a.debug("Server did not respond to ping message #"+j+". Reconnecting... "),M.reconnectWs()))}}(g))}else a.debug("Trying to send ping, but ping is not enabled")}function I(){P||(a.debug("Starting ping (if configured)"),P=!0,l.heartbeat!=null&&(k=setInterval(E,l.heartbeat),E()))}function x(){clearInterval(k),P=!1,b=!1,g=-1,S.cancel()}this.close=function(N,j){a.debug("Closing  with code: "+N+" because: "+j),k!=null&&(a.debug("Clearing ping interval"),clearInterval(k)),P=!1,b=!1,M.close(N,j)},this.forceClose=function(N){M.forceClose(N)},this.reconnect=function(){M.reconnectWs()},this.resetPing=function(){b=!0,g=0,I()},this.getReadyState=function(){return M.getReadyState()}}return Ml=c,Ml}var pp;function gC(){if(pp)return Ll;pp=1;var e=vC();return Ll.JsonRpcClient=e,Ll}var jl={},hp;function yC(){if(hp)return jl;hp=1;var e=zv();return jl.WebSocketWithReconnection=e,jl}var Dl,mp;function Wv(){if(mp)return Dl;mp=1;var e=!1;if(Object.defineProperty)try{Object.defineProperty({},"x",{})}catch{e=!0}Function.prototype.bind||(Function.prototype.bind=function(m){if(typeof this!="function")throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var g=Array.prototype.slice.call(arguments,1),b=this,P=function(){},k=function(){return b.apply(this instanceof P&&m?this:m,g.concat(Array.prototype.slice.call(arguments)))};return P.prototype=this.prototype,k.prototype=new P,k});var t=aC.EventEmitter,n=lC,r=cd,i=mC,o=5e3;function s(m){if(!m)return{};for(var g in m){var b=m[g];typeof b=="string"&&(m[g]={response:b})}return m}function a(m){if(m){if(m instanceof Function)return{send:m};if(m.send instanceof Function)return m;if(m.postMessage instanceof Function)return m.send=m.postMessage,m;if(m.write instanceof Function)return m.send=m.write,m;if(m.onmessage===void 0&&!(m.pause instanceof Function))throw new SyntaxError("Transport is not a function nor a valid object")}}function c(m,g){e?(this.method=m,this.params=g):(Object.defineProperty(this,"method",{value:m,enumerable:!0}),Object.defineProperty(this,"params",{value:g,enumerable:!0}))}function l(m,g,b,P){var k=this;if(!m)throw new SyntaxError("Packer is not defined");if(!m.pack||!m.unpack)throw new SyntaxError("Packer is invalid");var f=s(m.responseMethods);if(g instanceof Function){if(b!=null)throw new SyntaxError("There can't be parameters after onRequest");P=g,b=void 0,g=void 0}if(g&&g.send instanceof Function){if(b&&!(b instanceof Function))throw new SyntaxError("Only a function can be after transport");P=b,b=g,g=void 0}if(b instanceof Function){if(P!=null)throw new SyntaxError("There can't be parameters after onRequest");P=b,b=void 0}if(b&&b.send instanceof Function&&P&&!(P instanceof Function))throw new SyntaxError("Only a function can be after transport");g=g||{},t.call(this),P&&this.on("request",P),e?this.peerID=g.peerID:Object.defineProperty(this,"peerID",{value:g.peerID});var v=g.max_retries||0;function w(C){k.decode(C.data||C)}this.getTransport=function(){return b},this.setTransport=function(C){b&&(b.removeEventListener?b.removeEventListener("message",w):b.removeListener&&b.removeListener("data",w)),C&&(C.addEventListener?C.addEventListener("message",w):C.addListener&&C.addListener("data",w)),b=a(C)},e||Object.defineProperty(this,"transport",{get:this.getTransport.bind(this),set:this.setTransport.bind(this)}),this.setTransport(b);var y=g.request_timeout||o,T=g.ping_request_timeout||y,M=g.response_timeout||o,U=g.duplicates_timeout||o,S=0,p=new i,E=new i,I=new i,x={};function N(C,O,F){var W={message:C,timeout:setTimeout(function(){E.remove(O,F)},M)};E.set(W,O,F)}function j(C,O){var F=setTimeout(function(){I.remove(C,O)},U);I.set(F,C,O)}function X(C,O,F,W,$){c.call(this,C,O),this.getTransport=function(){return $},this.setTransport=function(Q){$=a(Q)},e||Object.defineProperty(this,"transport",{get:this.getTransport.bind(this),set:this.setTransport.bind(this)});var q=E.get(F,W);$||k.getTransport()||(e?this.duplicated=!!q:Object.defineProperty(this,"duplicated",{value:!!q}));var H=f[C];this.pack=m.pack.bind(m,this,F),this.reply=function(Q,Y,L){if(Q instanceof Function||Q&&Q.send instanceof Function){if(Y!=null)throw new SyntaxError("There can't be parameters after callback");L=Q,Y=null,Q=void 0}else if(Y instanceof Function||Y&&Y.send instanceof Function){if(L!=null)throw new SyntaxError("There can't be parameters after callback");L=Y,Y=null}L=a(L),q&&clearTimeout(q.timeout),W!=null&&(Q&&(Q.dest=W),Y&&(Y.dest=W));var J;if(Q||Y!=null){if(k.peerID!=null&&(Q?Q.from=k.peerID:Y.from=k.peerID),H)if(H.error==null&&Q)J={error:Q};else{var ie=Q?H.error:H.response;J={method:ie,params:Q||Y}}else J={error:Q,result:Y};J=m.pack(J,F)}else q?J=q.message:J=m.pack({result:null},F);return N(J,F,W),L=L||this.getTransport()||k.getTransport(),L?L.send(J):J}}n(X,c);function _(C){var O=x[C];if(O){delete x[C];var F=p.pop(O.id,O.dest);F&&(clearTimeout(F.timeout),j(O.id,O.dest))}}this.cancel=function(C){if(C)return _(C);for(var C in x)_(C)},this.close=function(){var C=this.getTransport();C&&C.close&&C.close(4003,"Cancel request"),this.cancel(),I.forEach(clearTimeout),E.forEach(function(O){clearTimeout(O.timeout)})},this.encode=function(C,O,F,W,$){if(O instanceof Function){if(F!=null)throw new SyntaxError("There can't be parameters after callback");$=O,W=void 0,F=void 0,O=void 0}else if(F instanceof Function){if(W!=null)throw new SyntaxError("There can't be parameters after callback");$=F,W=void 0,F=void 0}else if(W instanceof Function){if($!=null)throw new SyntaxError("There can't be parameters after callback");$=W,W=void 0}k.peerID!=null&&(O=O||{},O.from=k.peerID),F!=null&&(O=O||{},O.dest=F);var q={method:C,params:O};if($){let J=function(K,be){k.cancel(q),$(K,be)},ie=function(K){var be=C==="ping"?T:y;return Y.timeout=setTimeout(ne,be*Math.pow(2,Q++)),x[q]={id:H,dest:F},p.set(Y,H,F),K=K||L||k.getTransport(),K?K.send(q):q},ee=function(K){K=a(K),console.warn(Q+" retry for request message:",q);var be=I.pop(H,F);return clearTimeout(be),ie(K)},ne=function(){if(Q<v)return ee(W);var K=new Error("Request has timed out");K.request=q,K.retry=ee,J(K)};var H=S++,Q=0;q=m.pack(q,H);var Y={message:q,callback:J,responseMethods:f[C]||{}},L=a(W);return ie(W)}return q=m.pack(q),W=W||this.getTransport(),W?W.send(q):q},this.decode=function(C,O){if(!C)throw new TypeError("Message is not defined");try{C=m.unpack(C)}catch(G){return console.debug(G,C)}var F=C.id,W=C.ack,$=C.method,q=C.params||{},H=q.from,Q=q.dest;if(k.peerID!=null&&H==k.peerID)return;if(F==null&&W==null){var Y=new c($,q);return k.emit("request",Y)?void 0:Y}function L(){if(O=a(O)||k.getTransport(),O){var G=E.get(F,H);if(G)return O.send(G.message)}var le=F??W,ve=new X($,q,le,H,O);if(!k.emit("request",ve))return ve}function J(G,le,ve){G.callback(le,ve)}function ie(G){console.warn("Response already processed",C),clearTimeout(G),j(W,H)}if($){if(Q==null||Q==k.peerID){var de=p.get(W,H);if(de){var ee=de.responseMethods;return $==ee.error?J(de,q):$==ee.response?J(de,null,q):L()}var ne=I.get(W,H);if(ne)return ie(ne)}return L()}var K=C.error,be=C.result;if(!(K&&K.dest&&K.dest!=k.peerID)&&!(be&&be.dest&&be.dest!=k.peerID)){var de=p.get(W,H);if(!de){var ne=I.get(W,H);return ne?ie(ne):console.warn("No callback was defined for this message",C)}J(de,K,be)}}}n(l,t),l.RpcNotification=c,Dl=l;var u=gC(),d=yC();return l.clients=u,l.clients.transports=d,l.packers=r,Dl}const SC="OpenVidu",wC={freeice:"2.2.2",hark:"1.2.3",jsnlog:"2.30.0",platform:"1.3.6",uuid:"8.3.2","wolfy87-eventemitter":"5.2.9"},EC="OpenVidu Browser",bC={"@types/node":"15.12.2","@types/platform":"1.3.3",browserify:"17.0.0",grunt:"1.4.1","grunt-cli":"1.4.3","grunt-contrib-copy":"1.0.0","grunt-contrib-sass":"2.0.0","grunt-contrib-uglify":"5.0.1","grunt-contrib-watch":"1.1.0","grunt-postcss":"0.9.0","grunt-string-replace":"1.3.1","grunt-ts":"6.0.0-beta.22",terser:"5.7.0",tsify:"5.0.4",tslint:"6.1.3",typedoc:"0.19.2",typescript:"4.0.7"},CC="Apache-2.0",xC="lib/index.js",kC="openvidu-browser",PC={type:"git",url:"git://github.com/OpenVidu/openvidu"},OC={browserify:"VERSION=${VERSION:-dev}; mkdir -p static/js/ && cd src && ../node_modules/browserify/bin/cmd.js Main.ts -p [ tsify ] --exclude kurento-browser-extensions --debug -o ../static/js/openvidu-browser-$VERSION.js -v","browserify-prod":"VERSION=${VERSION:-dev}; mkdir -p static/js/ && cd src && ../node_modules/browserify/bin/cmd.js --debug Main.ts -p [ tsify ] --exclude kurento-browser-extensions | ../node_modules/terser/bin/terser --source-map content=inline --output ../static/js/openvidu-browser-$VERSION.min.js",build:"cd src/OpenVidu && ./../../node_modules/typescript/bin/tsc && cd ../.. && ./node_modules/typescript/bin/tsc --declaration src/index.ts --outDir ./lib --sourceMap --target es5 --lib dom,es5,es2015.promise,scripthost",docs:"./generate-docs.sh"},RC="lib/index.d.ts",_C="2.20.0",IC={author:SC,dependencies:wC,description:EC,devDependencies:bC,license:CC,main:xC,name:kC,repository:PC,scripts:OC,types:RC,version:_C};Object.defineProperty(ja,"__esModule",{value:!0});ja.OpenVidu=void 0;var NC=Lo,TC=sd(),vp=za(),LC=Pi,gp=Nn,xe=Rr,Vl=Mo,AC=Ke,MC=sn,jC=Iv,yp=Oi,DC=nd,VC=rd,FC=Wv(),UC=IC,Ae=AC.OpenViduLogger.getInstance(),Ce,$C=function(){function e(){var t=this;this.masterNodeHasCrashed=!1,this.publishers=[],this.secret="",this.recorder=!1,this.life=-1,this.advancedConfiguration={},this.webrtcStatsInterval=-1,this.sendBrowserLogs=DC.OpenViduLoggerConfiguration.disabled,this.isPro=!1,this.ee=new VC,Ce=MC.PlatformUtils.getInstance(),this.libraryVersion=UC.version,Ae.info("OpenVidu initialized"),Ae.info("Platform detected: "+Ce.getDescription()),Ae.info("openvidu-browser version: "+this.libraryVersion),(Ce.isMobileDevice()||Ce.isReactNative())&&this.onOrientationChanged(function(){t.publishers.forEach(function(n){n.stream.isLocalStreamPublished&&n.stream&&n.stream.hasVideo&&t.sendNewVideoDimensionsIfRequired(n,"deviceRotated",75,10)})})}return e.prototype.onOrientationChanged=function(t){window.addEventListener("orientationchange",t)},e.prototype.sendNewVideoDimensionsIfRequired=function(t,n,r,i){var o=this,s=0,a=t.stream.videoDimensions.width,c=t.stream.videoDimensions.height,l=setInterval(function(){s++,s>i&&clearTimeout(l),t.getVideoDimensions(t.stream.getMediaStream()).then(function(u){(u.width!==a||u.height!==c)&&(clearTimeout(l),o.sendVideoDimensionsChangedEvent(t,n,a,c,u.width,u.height))})},r)},e.prototype.sendVideoDimensionsChangedEvent=function(t,n,r,i,o,s){var a=this;t.stream.videoDimensions={width:o||0,height:s||0},this.sendRequest("streamPropertyChanged",{streamId:t.stream.streamId,property:"videoDimensions",newValue:JSON.stringify(t.stream.videoDimensions),reason:n},function(c,l){c?Ae.error("Error sending 'streamPropertyChanged' event",c):(a.session.emitEvent("streamPropertyChanged",[new gp.StreamPropertyChangedEvent(a.session,t.stream,"videoDimensions",t.stream.videoDimensions,{width:r,height:i},n)]),t.emitEvent("streamPropertyChanged",[new gp.StreamPropertyChangedEvent(t,t.stream,"videoDimensions",t.stream.videoDimensions,{width:r,height:i},n)]),a.session.sendVideoData(t))})},e.prototype.initSession=function(){return this.session=new vp.Session(this),this.session},e.prototype.initPublisher=function(t,n,r){var i;n&&typeof n!="function"?(i=n,i={audioSource:typeof i.audioSource<"u"?i.audioSource:void 0,frameRate:typeof MediaStreamTrack<"u"&&i.videoSource instanceof MediaStreamTrack?void 0:typeof i.frameRate<"u"?i.frameRate:void 0,insertMode:typeof i.insertMode<"u"?typeof i.insertMode=="string"?Vl.VideoInsertMode[i.insertMode]:i.insertMode:Vl.VideoInsertMode.APPEND,mirror:typeof i.mirror<"u"?i.mirror:!0,publishAudio:typeof i.publishAudio<"u"?i.publishAudio:!0,publishVideo:typeof i.publishVideo<"u"?i.publishVideo:!0,resolution:typeof MediaStreamTrack<"u"&&i.videoSource instanceof MediaStreamTrack?void 0:typeof i.resolution<"u"?i.resolution:"640x480",videoSource:typeof i.videoSource<"u"?i.videoSource:void 0,filter:i.filter}):i={insertMode:Vl.VideoInsertMode.APPEND,mirror:!0,publishAudio:!0,publishVideo:!0,resolution:"640x480"};var o=new TC.Publisher(t,i,this),s;return n&&typeof n=="function"?s=n:r&&(s=r),o.initialize().then(function(){s!==void 0&&s(void 0),o.emitEvent("accessAllowed",[])}).catch(function(a){s!==void 0&&s(a),o.emitEvent("accessDenied",[a])}),this.publishers.push(o),o},e.prototype.initPublisherAsync=function(t,n){var r=this;return new Promise(function(i,o){var s,a=function(c){c?o(c):i(s)};n?s=r.initPublisher(t,n,a):s=r.initPublisher(t,a)})},e.prototype.initLocalRecorder=function(t){return new NC.LocalRecorder(t)},e.prototype.checkSystemRequirements=function(){return Ce.isIPhoneOrIPad()?Ce.isIOSWithSafari()||Ce.isIonicIos()||Ce.isChromeMobileBrowser()||Ce.isEdgeMobileBrowser()||Ce.isOperaMobileBrowser()||Ce.isFirefoxMobileBrowser()?1:0:Ce.isChromeBrowser()||Ce.isChromeMobileBrowser()||Ce.isFirefoxBrowser()||Ce.isFirefoxMobileBrowser()||Ce.isOperaBrowser()||Ce.isOperaMobileBrowser()||Ce.isEdgeBrowser()||Ce.isEdgeMobileBrowser()||Ce.isSafariBrowser()||Ce.isAndroidBrowser()||Ce.isElectron()||Ce.isSamsungBrowser()?1:0},e.prototype.checkScreenSharingCapabilities=function(){return Ce.canScreenShare()},e.prototype.getDevices=function(){return new Promise(function(t,n){navigator.mediaDevices.enumerateDevices().then(function(r){var i,o=[];Ce.isIonicAndroid()&&typeof cordova<"u"&&(!((i=cordova==null?void 0:cordova.plugins)===null||i===void 0)&&i.EnumerateDevicesPlugin)?cordova.plugins.EnumerateDevicesPlugin.getEnumerateDevices().then(function(s){var a=[],c=[],l=[];a=s.filter(function(u){return u.kind==="audioinput"}),c=r.filter(function(u){return u.kind==="videoinput"}),l=r.filter(function(u){return u.kind==="audioinput"}),c.forEach(function(u,d){if(u.label)o.push({kind:u.kind,deviceId:u.deviceId,label:u.label});else{var m="";d===0?m="Front Camera":d===1?m="Back Camera":m="Unknown Camera",o.push({kind:u.kind,deviceId:u.deviceId,label:m})}}),l.forEach(function(u,d){if(u.label)o.push({kind:u.kind,deviceId:u.deviceId,label:u.label});else{var m="";switch(d){case 0:m="Default";break;case 1:var g=a.filter(function(k){return k.label.includes("Built")})[0];m=g?g.label:"Built-in Microphone";break;case 2:var b=a.filter(function(k){return k.label.includes("Wired")})[0];b?m=b.label:m="Headset earpiece";break;case 3:var P=a.filter(function(k){return k.label.includes("Bluetooth")})[0];m=P?P.label:"Wireless";break;default:m="Unknown Microphone";break}o.push({kind:u.kind,deviceId:u.deviceId,label:m})}}),t(o)}):(r.forEach(function(s){(s.kind==="audioinput"||s.kind==="videoinput")&&o.push({kind:s.kind,deviceId:s.deviceId,label:s.label})}),t(o))}).catch(function(r){Ae.error("Error getting devices",r),n(r)})})},e.prototype.getUserMedia=function(t){var n=this;return new Promise(function(r,i){var o=function(s,a){var c=a.audio===void 0?!0:a.audio,l={audio:c,video:!1};navigator.mediaDevices.getUserMedia(l).then(function(u){s.addTrack(u.getAudioTracks()[0]),r(s)}).catch(function(u){s.getAudioTracks().forEach(function(d){d.stop()}),s.getVideoTracks().forEach(function(d){d.stop()}),i(n.generateAudioDeviceError(u,l))})};n.generateMediaConstraints(t).then(function(s){var a,c;if(s.videoTrack&&s.audioTrack||s.audioTrack&&((a=s.constraints)===null||a===void 0?void 0:a.video)===!1||s.videoTrack&&((c=s.constraints)===null||c===void 0?void 0:c.audio)===!1)r(n.addAlreadyProvidedTracks(s,new MediaStream));else{s.videoTrack&&delete s.constraints.video,s.audioTrack&&delete s.constraints.audio;var l=!1;if(typeof t.videoSource=="string"&&(t.videoSource==="screen"||t.videoSource==="window"||Ce.isElectron()&&t.videoSource.startsWith("screen:"))&&(l=!s.audioTrack&&t.audioSource!==null&&t.audioSource!==!1,navigator.mediaDevices.getDisplayMedia&&!Ce.isElectron())){navigator.mediaDevices.getDisplayMedia({video:!0}).then(function(d){if(n.addAlreadyProvidedTracks(s,d),l){o(d,s.constraints);return}else r(d)}).catch(function(d){var m=xe.OpenViduErrorName.SCREEN_CAPTURE_DENIED,g=d.toString();i(new xe.OpenViduError(m,g))});return}var u=l?{video:s.constraints.video}:s.constraints;navigator.mediaDevices.getUserMedia(u).then(function(d){if(n.addAlreadyProvidedTracks(s,d),l){o(d,s.constraints);return}else r(d)}).catch(function(d){var m,g=d.toString();t.videoSource!=="screen"?m=xe.OpenViduErrorName.DEVICE_ACCESS_DENIED:m=xe.OpenViduErrorName.SCREEN_CAPTURE_DENIED,i(new xe.OpenViduError(m,g))})}}).catch(function(s){i(s)})})},e.prototype.enableProdMode=function(){Ae.enableProdMode()},e.prototype.setAdvancedConfiguration=function(t){this.advancedConfiguration=t},e.prototype.generateMediaConstraints=function(t){var n=this;return new Promise(function(r,i){var o={audioTrack:void 0,videoTrack:void 0,constraints:{audio:void 0,video:void 0}},s=t.audioSource,a=t.videoSource;if((s===null||s===!1)&&(o.constraints.audio=!1),(a===null||a===!1)&&(o.constraints.video=!1),o.constraints.audio===!1&&o.constraints.video===!1&&i(new xe.OpenViduError(xe.OpenViduErrorName.NO_INPUT_SOURCE_SET,"Properties 'audioSource' and 'videoSource' cannot be set to false or null at the same time")),typeof MediaStreamTrack<"u"&&s instanceof MediaStreamTrack&&(o.audioTrack=s),typeof MediaStreamTrack<"u"&&a instanceof MediaStreamTrack&&(o.videoTrack=a),s===void 0&&(o.constraints.audio=!0),a===void 0&&(o.constraints.video={width:{ideal:640},height:{ideal:480}}),a!==null&&a!==!1){if(t.resolution){var c=t.resolution.toLowerCase().split("x"),l=Number(c[0]),u=Number(c[1]);o.constraints.video={width:{ideal:l},height:{ideal:u}}}t.frameRate&&(o.constraints.video.frameRate={ideal:t.frameRate})}n.configureDeviceIdOrScreensharing(o,t,r,i),r(o)})},e.prototype.startWs=function(t){var n={heartbeat:5e3,ws:{uri:this.wsUri+"?sessionId="+this.session.sessionId,onconnected:t,ondisconnect:this.disconnectCallback.bind(this),onreconnecting:this.reconnectingCallback.bind(this),onreconnected:this.reconnectedCallback.bind(this),ismasternodecrashed:this.isMasterNodeCrashed.bind(this)},rpc:{requestTimeout:1e4,participantJoined:this.session.onParticipantJoined.bind(this.session),participantPublished:this.session.onParticipantPublished.bind(this.session),participantUnpublished:this.session.onParticipantUnpublished.bind(this.session),participantLeft:this.session.onParticipantLeft.bind(this.session),participantEvicted:this.session.onParticipantEvicted.bind(this.session),recordingStarted:this.session.onRecordingStarted.bind(this.session),recordingStopped:this.session.onRecordingStopped.bind(this.session),sendMessage:this.session.onNewMessage.bind(this.session),streamPropertyChanged:this.session.onStreamPropertyChanged.bind(this.session),connectionPropertyChanged:this.session.onConnectionPropertyChanged.bind(this.session),networkQualityLevelChanged:this.session.onNetworkQualityLevelChangedChanged.bind(this.session),filterEventDispatched:this.session.onFilterEventDispatched.bind(this.session),iceCandidate:this.session.recvIceCandidate.bind(this.session),mediaError:this.session.onMediaError.bind(this.session),masterNodeCrashedNotification:this.onMasterNodeCrashedNotification.bind(this),forciblyReconnectSubscriber:this.session.onForciblyReconnectSubscriber.bind(this.session)}};this.jsonRpcClient=new FC.clients.JsonRpcClient(n)},e.prototype.onMasterNodeCrashedNotification=function(t){console.error("Master Node has crashed"),this.masterNodeHasCrashed=!0,this.session.onLostConnection("nodeCrashed"),this.jsonRpcClient.close(4103,"Master Node has crashed")},e.prototype.getWsReadyState=function(){return this.jsonRpcClient.getReadyState()},e.prototype.closeWs=function(){this.jsonRpcClient.close(4102,"Connection closed by client")},e.prototype.sendRequest=function(t,n,r){n&&n instanceof Function&&(r=n,n={}),Ae.debug('Sending request: {method:"'+t+'", params: '+JSON.stringify(n)+"}"),this.jsonRpcClient.send(t,n,r)},e.prototype.getWsUri=function(){return this.wsUri},e.prototype.getSecret=function(){return this.secret},e.prototype.getRecorder=function(){return this.recorder},e.prototype.generateAudioDeviceError=function(t,n){t.name==="Error"&&(t.name=t.constructor.name);var r,i;switch(t.name.toLowerCase()){case"notfounderror":return r=xe.OpenViduErrorName.INPUT_AUDIO_DEVICE_NOT_FOUND,i=t.toString(),new xe.OpenViduError(r,i);case"notallowederror":return r=xe.OpenViduErrorName.DEVICE_ACCESS_DENIED,i=t.toString(),new xe.OpenViduError(r,i);case"overconstrainederror":return t.constraint.toLowerCase()==="deviceid"?(r=xe.OpenViduErrorName.INPUT_AUDIO_DEVICE_NOT_FOUND,i="Audio input device with deviceId '"+n.audio.deviceId.exact+"' not found"):(r=xe.OpenViduErrorName.PUBLISHER_PROPERTIES_ERROR,i="Audio input device doesn't support the value passed for constraint '"+t.constraint+"'"),new xe.OpenViduError(r,i);case"notreadableerror":return r=xe.OpenViduErrorName.DEVICE_ALREADY_IN_USE,i=t.toString(),new xe.OpenViduError(r,i);default:return new xe.OpenViduError(xe.OpenViduErrorName.INPUT_AUDIO_DEVICE_GENERIC_ERROR,t.toString())}},e.prototype.addAlreadyProvidedTracks=function(t,n){return t.videoTrack&&n.addTrack(t.videoTrack),t.audioTrack&&n.addTrack(t.audioTrack),n},e.prototype.configureDeviceIdOrScreensharing=function(t,n,r,i){var o=this,s=n.audioSource,a=n.videoSource;if(typeof s=="string"&&(t.constraints.audio={deviceId:{exact:s}}),typeof a=="string")if(!this.isScreenShare(a))this.setVideoSource(t,a);else if(this.checkScreenSharingCapabilities())if(Ce.isElectron()){var l="screen:",u=a,d=u.substr(u.indexOf(l)+l.length);t.constraints.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:d}},r(t)}else if(this.advancedConfiguration.screenShareChromeExtension&&!(Ce.isFirefoxBrowser()||Ce.isFirefoxMobileBrowser())&&!navigator.mediaDevices.getDisplayMedia){yp.getScreenConstraints(function(g,b){if(g||b.mandatory&&b.mandatory.chromeMediaSource==="screen")if(g==="permission-denied"||g==="PermissionDeniedError"){var P=new xe.OpenViduError(xe.OpenViduErrorName.SCREEN_CAPTURE_DENIED,"You must allow access to one window of your desktop");Ae.error(P),i(P)}else{var k=o.advancedConfiguration.screenShareChromeExtension.split("/").pop().trim();yp.getChromeExtensionStatus(k,function(f){if(f==="installed-disabled"){var v=new xe.OpenViduError(xe.OpenViduErrorName.SCREEN_EXTENSION_DISABLED,"You must enable the screen extension");Ae.error(v),i(v)}if(f==="not-installed"){var w=new xe.OpenViduError(xe.OpenViduErrorName.SCREEN_EXTENSION_NOT_INSTALLED,o.advancedConfiguration.screenShareChromeExtension);Ae.error(w),i(w)}});return}else t.constraints.video=b,r(t)});return}else if(navigator.mediaDevices.getDisplayMedia)r(t);else{var m=Ce.isFirefoxBrowser()||Ce.isFirefoxMobileBrowser()?n.videoSource:void 0;jC.getScreenId(m,function(g,b,P){if(g)if(g==="not-installed"){var k=o.advancedConfiguration.screenShareChromeExtension?o.advancedConfiguration.screenShareChromeExtension:"https://chrome.google.com/webstore/detail/openvidu-screensharing/lfcgfepafnobdloecchnfaclibenjold",f=new xe.OpenViduError(xe.OpenViduErrorName.SCREEN_EXTENSION_NOT_INSTALLED,k);Ae.error(f),i(f)}else if(g==="installed-disabled"){var f=new xe.OpenViduError(xe.OpenViduErrorName.SCREEN_EXTENSION_DISABLED,"You must enable the screen extension");Ae.error(f),i(f)}else if(g==="permission-denied"){var f=new xe.OpenViduError(xe.OpenViduErrorName.SCREEN_CAPTURE_DENIED,"You must allow access to one window of your desktop");Ae.error(f),i(f)}else{var f=new xe.OpenViduError(xe.OpenViduErrorName.GENERIC_ERROR,"Unknown error when accessing screen share");Ae.error(f),Ae.error(g),i(f)}else t.constraints.video=P.video,r(t)});return}else{var c=new xe.OpenViduError(xe.OpenViduErrorName.SCREEN_SHARING_NOT_SUPPORTED,"You can only screen share in desktop Chrome, Firefox, Opera, Safari (>=13.0), Edge (>= 80) or Electron. Detected client: "+Ce.getName()+" "+Ce.getVersion());Ae.error(c),i(c)}},e.prototype.setVideoSource=function(t,n){t.constraints.video||(t.constraints.video={}),t.constraints.video.deviceId={exact:n}},e.prototype.disconnectCallback=function(){Ae.warn("Websocket connection lost"),this.isRoomAvailable()?this.session.onLostConnection("networkDisconnect"):alert("Connection error. Please reload page.")},e.prototype.reconnectingCallback=function(){Ae.warn("Websocket connection lost (reconnecting)"),this.isRoomAvailable()?this.session.emitEvent("reconnecting",[]):alert("Connection error. Please reload page.")},e.prototype.reconnectedCallback=function(){var t=this;if(Ae.warn("Websocket reconnected"),this.isRoomAvailable())if(this.session.connection)this.sendRequest("connect",{sessionId:this.session.connection.rpcSessionId},function(r,i){if(r)if(t.isMasterNodeCrashed())Ae.warn("Master Node has crashed!");else{Ae.error(r);var o=function(s){Ae.warn("Websocket was able to reconnect to OpenVidu Server, but your Connection was already destroyed due to timeout. You are no longer a participant of the Session and your media streams have been destroyed"),t.session.onLostConnection("networkDisconnect"),t.jsonRpcClient.close(4101,"Reconnection fault")};t.life===-1?o(r):t.sendRequest("sessionStatus",{sessionId:t.session.sessionId},function(s,a){t.life===a.life?o(s):(Ae.warn("Websocket was able to reconnect to OpenVidu Server, but your Master Node crashed."),t.session.onLostConnection("nodeCrashed"),t.jsonRpcClient.close(4101,"Reconnection fault"))})}else t.jsonRpcClient.resetPing(),t.session.onRecoveredConnection()});else{Ae.warn("There was no previous connection when running reconnection callback");var n=new LC.SessionDisconnectedEvent(this.session,"networkDisconnect");this.session.ee.emitEvent("sessionDisconnected",[n]),n.callDefaultBehavior()}else alert("Connection error. Please reload page.")},e.prototype.isMasterNodeCrashed=function(){return this.masterNodeHasCrashed},e.prototype.isRoomAvailable=function(){return this.session!==void 0&&this.session instanceof vp.Session?!0:(Ae.warn("Session instance not found"),!1)},e.prototype.isScreenShare=function(t){return t==="screen"||t==="window"||Ce.isElectron()&&t.startsWith("screen:")},e}();ja.OpenVidu=$C;(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.EventDispatcher=e.ExceptionEvent=e.NetworkQualityLevelChangedEvent=e.FilterEvent=e.ConnectionPropertyChangedEvent=e.StreamPropertyChangedEvent=e.VideoElementEvent=e.StreamManagerEvent=e.StreamEvent=e.SignalEvent=e.SessionDisconnectedEvent=e.RecordingEvent=e.PublisherSpeakingEvent=e.ConnectionEvent=e.Event=e.VideoInsertMode=e.OpenViduError=e.LocalRecorderState=e.Filter=e.LocalRecorder=e.Connection=e.Stream=e.StreamManager=e.Subscriber=e.Publisher=e.Session=e.OpenVidu=void 0;var t=ed,n=ja;Object.defineProperty(e,"OpenVidu",{enumerable:!0,get:function(){return n.OpenVidu}});var r=za();Object.defineProperty(e,"Session",{enumerable:!0,get:function(){return r.Session}});var i=sd();Object.defineProperty(e,"Publisher",{enumerable:!0,get:function(){return i.Publisher}});var o=wi;Object.defineProperty(e,"Subscriber",{enumerable:!0,get:function(){return o.Subscriber}});var s=Ei;Object.defineProperty(e,"StreamManager",{enumerable:!0,get:function(){return s.StreamManager}});var a=yi;Object.defineProperty(e,"Stream",{enumerable:!0,get:function(){return a.Stream}});var c=Ao;Object.defineProperty(e,"Connection",{enumerable:!0,get:function(){return c.Connection}});var l=Lo;Object.defineProperty(e,"LocalRecorder",{enumerable:!0,get:function(){return l.LocalRecorder}});var u=Si;Object.defineProperty(e,"Filter",{enumerable:!0,get:function(){return u.Filter}});var d=td;Object.defineProperty(e,"LocalRecorderState",{enumerable:!0,get:function(){return d.LocalRecorderState}});var m=Rr;Object.defineProperty(e,"OpenViduError",{enumerable:!0,get:function(){return m.OpenViduError}});var g=Mo;Object.defineProperty(e,"VideoInsertMode",{enumerable:!0,get:function(){return g.VideoInsertMode}});var b=st;Object.defineProperty(e,"Event",{enumerable:!0,get:function(){return b.Event}});var P=Do;Object.defineProperty(e,"ConnectionEvent",{enumerable:!0,get:function(){return P.ConnectionEvent}});var k=jo;Object.defineProperty(e,"PublisherSpeakingEvent",{enumerable:!0,get:function(){return k.PublisherSpeakingEvent}});var f=Fo;Object.defineProperty(e,"RecordingEvent",{enumerable:!0,get:function(){return f.RecordingEvent}});var v=Pi;Object.defineProperty(e,"SessionDisconnectedEvent",{enumerable:!0,get:function(){return v.SessionDisconnectedEvent}});var w=Uo;Object.defineProperty(e,"SignalEvent",{enumerable:!0,get:function(){return w.SignalEvent}});var y=od();Object.defineProperty(e,"StreamEvent",{enumerable:!0,get:function(){return y.StreamEvent}});var T=Ci;Object.defineProperty(e,"StreamManagerEvent",{enumerable:!0,get:function(){return T.StreamManagerEvent}});var M=xi;Object.defineProperty(e,"VideoElementEvent",{enumerable:!0,get:function(){return M.VideoElementEvent}});var U=Nn;Object.defineProperty(e,"StreamPropertyChangedEvent",{enumerable:!0,get:function(){return U.StreamPropertyChangedEvent}});var S=$o;Object.defineProperty(e,"ConnectionPropertyChangedEvent",{enumerable:!0,get:function(){return S.ConnectionPropertyChangedEvent}});var p=Vo;Object.defineProperty(e,"FilterEvent",{enumerable:!0,get:function(){return p.FilterEvent}});var E=Bo;Object.defineProperty(e,"NetworkQualityLevelChangedEvent",{enumerable:!0,get:function(){return E.NetworkQualityLevelChangedEvent}});var I=ki;Object.defineProperty(e,"ExceptionEvent",{enumerable:!0,get:function(){return I.ExceptionEvent}});var x=bi;Object.defineProperty(e,"EventDispatcher",{enumerable:!0,get:function(){return x.EventDispatcher}}),t.JL.setOptions({enabled:!1})})(xv);typeof window<"u"&&window.addEventListener("error",e=>{if(e.message&&e.message.includes("Still in CONNECTING state"))return console.warn("⚠️ WebSocket CONNECTING 에러 감지 - 무시됨"),e.preventDefault(),e.stopPropagation(),!1},!0);const BC=({user:e})=>{const[t,n]=R.useState(null),[r,i]=R.useState(null),[o,s]=R.useState([]),[a,c]=R.useState(!0),[l,u]=R.useState(!1),[d,m]=R.useState(!1),[g,b]=R.useState(null),[P,k]=R.useState(null),f=R.useRef(null),v=R.useRef(null),w=R.useRef(null);R.useEffect(()=>(w.current=new xv.OpenVidu,w.current.configuration&&(w.current.configuration.webrtcStatsInterval=3e3,w.current.configuration.iceConnectionTimeout=3e4),w.current.wsUri&&(w.current.wsReconnectionTimeout=5e3,w.current.wsReconnectionRetries=5),w.current.enableProdMode(),w.current.setAdvancedConfiguration({publisherSpeakingEventsOptions:{interval:100,threshold:-60},iceConnectionLostInterval:1e4,iceConnectionDisconnectedInterval:5e3,noStreamPlayingEventEnabled:!1}),()=>{f.current&&clearInterval(f.current),v.current&&clearInterval(v.current),t&&t.disconnect()}),[]);const y=R.useCallback(async(p,E=null,I=0)=>{let x=null,N=!1,j=null,X=null,_=null;try{console.log("🎥 [OpenVidu Hook] startGroupCall 호출됨:",{mapId:p,areaId:E,hasSession:!!t}),t&&await T(),_=E?"area":"global",console.log(`🎥 [OpenVidu] ${_} 통화 시작:`,{mapId:p,areaId:E});const C=E?"/api/openvidu/session/area":"/api/openvidu/session/global",O=E?{metaverseId:p,areaId:E}:{metaverseId:p};console.log("🎥 [OpenVidu] API 요청:",C,O);const F=await Ie.post(C,O,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});if(console.log("🎥 [OpenVidu] API 응답:",F.data),!F.data.success)throw new Error(F.data.message);let{sessionId:W,token:$}=F.data;if(X=W,$&&$.includes("localhost")){const J=window.location.hostname;$=$.replace("localhost",J),console.log("🎥 [OpenVidu] 토큰 주소 변경:",J)}if(window.location.protocol==="https:"&&$&&$.startsWith("ws://")&&(console.warn("⚠️ [OpenVidu] HTTPS 페이지에서 WS 연결 시도 - Mixed Content 문제 발생"),console.warn("해결 방법: HTTP로 접속하거나 OpenVidu를 HTTPS로 실행하세요."),console.warn(`HTTP로 접속: http://${window.location.hostname}:5173`),"https://192.168.200.106:8443".startsWith("https://")?($=$.replace("ws://","wss://"),console.log("🎥 [OpenVidu] WSS로 변경 (OpenVidu HTTPS 모드)")):fe("화상통화를 사용하려면 HTTP로 접속해주세요.",{icon:"⚠️"})),x=w.current.initSession(),N=!0,x.openvidu&&x.openvidu.jsonRpcClient){const J=3e4+I*1e4;x.openvidu.jsonRpcClient.requestTimeout=J,console.log(`🎥 [OpenVidu] JSON-RPC 타임아웃 ${J/1e3}초로 설정`)}const q=[{urls:"stun:stun.l.google.com:19302"},{urls:"stun:stun1.l.google.com:19302"},{urls:"stun:stun2.l.google.com:19302"},{urls:"stun:stun3.l.google.com:19302"},{urls:"stun:stun4.l.google.com:19302"},{urls:"turn:openrelay.metered.ca:80",username:"openrelayproject",credential:"openrelayproject"},{urls:"turn:openrelay.metered.ca:443",username:"openrelayproject",credential:"openrelayproject"},{urls:"turn:openrelay.metered.ca:443?transport=tcp",username:"openrelayproject",credential:"openrelayproject"}];x.capabilities&&(x.capabilities.iceServers=q),x.on("streamCreated",J=>{console.log("🎥 [OpenVidu] 스트림 생성됨:",J.stream.streamId);const ie=x.subscribe(J.stream,void 0);s(ee=>[...ee,ie])}),x.on("streamDestroyed",J=>{console.log("🎥 [OpenVidu] 스트림 삭제됨:",J.stream.streamId),s(ie=>ie.filter(ee=>ee.stream.streamId!==J.stream.streamId))}),x.on("sessionDisconnected",J=>{console.warn("⚠️ [OpenVidu] 세션 연결 끊김:",J.reason),J.reason==="networkDisconnect"||J.reason==="forceDisconnectByServer"?(console.log("🔄 [OpenVidu] 네트워크 문제로 연결 끊김"),fe("화상통화 연결이 끊겼습니다. 재연결 시도 중...",{icon:"🔄"}),m(!1)):(console.warn("⚠️ [OpenVidu] 세션 종료:",J.reason),m(!1)),i(null),s([])}),x.on("connectionDestroyed",J=>{console.warn("⚠️ [OpenVidu] 연결 삭제됨:",J.connection.connectionId),J.connection===x.connection&&(console.error("❌ [OpenVidu] 내 연결이 끊김!"),m(!1))}),x.on("exception",J=>{console.error("❌ [OpenVidu] 예외 발생:",J),J.name==="ICE_CONNECTION_FAILED"&&fe("화상통화 연결이 불안정합니다.",{icon:"⚠️"})});let H=!1,Q=0;const Y=7,L=[{name:"Standard",timeout:1e4,delay:500},{name:"Extended",timeout:2e4,delay:1e3},{name:"LongTimeout",timeout:3e4,delay:2e3},{name:"UltraLong",timeout:45e3,delay:3e3},{name:"Persistent",timeout:6e4,delay:4e3},{name:"LastChance",timeout:9e4,delay:5e3},{name:"ForceConnect",timeout:12e4,delay:6e3}];for(;!H&&Q<Y;){const J=L[Math.min(Q,L.length-1)];try{if(console.log(`🎯 [OpenVidu] 연결 전략: ${J.name} (시도 ${Q+1}/${Y})`),Q>0&&(console.log(`⏳ [OpenVidu] ${J.delay}ms 대기 후 재시도...`),await new Promise(ne=>setTimeout(ne,J.delay))),x.openvidu&&x.openvidu.jsonRpcClient&&(x.openvidu.jsonRpcClient.requestTimeout=J.timeout,console.log(`🎥 [OpenVidu] 타임아웃 설정: ${J.timeout}ms`)),Q>2&&x.openvidu&&x.openvidu.webSocket){const ne=x.openvidu.webSocket;(ne.readyState===WebSocket.CONNECTING||ne.readyState===WebSocket.CLOSING)&&(console.log("♾️ [OpenVidu] WebSocket 강제 재설정"),ne.close(),await new Promise(K=>setTimeout(K,1e3)))}const ie=x.connect($),ee=new Promise((ne,K)=>setTimeout(()=>K(new Error(`Connection timeout (${J.name})`)),J.timeout));await Promise.race([ie,ee]),console.log("🎥 [OpenVidu] 세션 연결 성공!"),H=!0}catch(ie){Q++;const ee=ie.toString();if(console.warn(`⚠️ [OpenVidu] 연결 실패 (${J.name}):`,ee.substring(0,150)),Q>=Y&&(console.error("❌ [OpenVidu] 모든 연결 시도 실패"),console.warn("🆘 [OpenVidu] 강제 수신 전용 모드 활성화"),H=!0,j=null,fe("화상통화 송신이 불가능합니다. 수신만 가능합니다.",{icon:"📡"})),ee.includes("ICE")||ee.includes("candidate"))console.log("🧊 [OpenVidu] ICE 연결 문제 - TURN 서버 사용 시도");else if((ee.includes("404")||ee.includes("Not Found"))&&(console.log("🔄 [OpenVidu] 세션이 없음 - 새 세션 요청 필요"),Q<Y-1)){const ne=await Ie.post(C,O,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});ne.data.success&&($=ne.data.token,X=ne.data.sessionId,console.log("🆕 [OpenVidu] 새 토큰 획득"))}}}if(console.log("🎥 [OpenVidu] 퍼블리셔 초기화 시작..."),H&&!j){console.log("🎦 [OpenVidu] 퍼블리셔 생성 시작...");const J=/iPhone|iPad|iPod|Android/i.test(navigator.userAgent),ie=/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream,ee=/Android/i.test(navigator.userAgent),ne=/iPad|Android.*Tablet|Tablet.*Android/i.test(navigator.userAgent),K=window.isSecureContext,be=window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1",de=window.location.hostname.match(/^192\.168\.|^10\.|^172\.(1[6-9]|2[0-9]|3[01])\./);console.log("📱 [OpenVidu] 디바이스 정보:",{isMobile:J,isIOS:ie,isAndroid:ee,isTablet:ne,isSecureContext:K,isLocalhost:be,isPrivateIP:de,protocol:window.location.protocol,hostname:window.location.hostname,userAgent:navigator.userAgent});try{const G={audioSource:void 0,videoSource:void 0,publishAudio:!1,publishVideo:!0,resolution:J?"320x240":"640x480",frameRate:J?15:30,insertMode:"APPEND",mirror:!0};!K&&!be&&!de&&(J||ne)?(console.warn("⚠️ [OpenVidu] HTTP 연결에서 모바일/태블릿 - 비디오/오디오 비활성화"),G.publishVideo=!1,G.publishAudio=!1):de&&console.log("📱 [OpenVidu] Private IP 네트워크 감지 - 카메라 시도"),ie&&console.log("📱 [OpenVidu] iOS 디바이스 감지 - 특별 처리 적용"),ee&&(console.log("📱 [OpenVidu] Android 디바이스 감지"),G.resolution="480x360"),console.log("🎥 [OpenVidu] 퍼블리셔 설정:",G);try{if(console.log("📱 [OpenVidu] 미디어 권한 요청...",{isMobile:J,isIOS:ie,isTablet:ne,protocol:window.location.protocol,host:window.location.host,isSecureContext:K,isLocalhost:be}),!K&&!be&&!de&&(console.warn("⚠️ [OpenVidu] 비보안 컨텍스트에서 실행 중! getUserMedia가 작동하지 않을 수 있습니다."),console.warn("HTTPS를 사용하거나 localhost에서 테스트하세요.")),!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia)if(console.error("❌ [OpenVidu] getUserMedia API가 지원되지 않습니다!"),console.error("HTTPS 연결 여부:",window.location.protocol==="https:"),console.error("Secure Context:",window.isSecureContext),!K&&!be&&!de)fe.error("카메라를 사용하려면 HTTPS로 접속하거나 서버 IP를 사용해주세요."),console.warn("⚠️ [OpenVidu] 카메라 없이 세션 참가를 시도합니다."),G.publishVideo=!1,G.publishAudio=!1;else if(de)console.warn("⚠️ [OpenVidu] Private IP에서 getUserMedia API 미지원 - 폴리필 시도");else throw fe.error("이 브라우저는 카메라를 지원하지 않습니다."),new Error("getUserMedia not supported");if(navigator.mediaDevices&&navigator.mediaDevices.getUserMedia)try{const Z=await navigator.mediaDevices.enumerateDevices(),qt=Z.filter(Tn=>Tn.kind==="videoinput");if(console.log("📷 [OpenVidu] 사용 가능한 카메라:",qt),console.log("📷 [OpenVidu] 전체 미디어 장치:",Z),qt.length===0&&!ne&&(console.warn("⚠️ [OpenVidu] 카메라를 찾을 수 없습니다!"),!J))throw fe.error("카메라를 찾을 수 없습니다."),new Error("No camera found")}catch(Z){console.warn("⚠️ [OpenVidu] 디바이스 목록 가져오기 실패:",Z)}let le;!K&&!be&&!de&&(J||ne)?(console.warn("⚠️ [OpenVidu] 비보안 연결에서 모바일/태블릿 카메라 접근 불가"),console.warn("카메라 없이 세션 참가를 시도합니다.")):ne?le={video:!0,audio:!1}:ie?le={video:{facingMode:"user",width:{min:320,ideal:320,max:640},height:{min:240,ideal:240,max:480}},audio:!1}:J?le={video:{facingMode:{ideal:"user"},width:{min:320,ideal:480,max:640},height:{min:240,ideal:360,max:480}},audio:!0}:le={video:{width:{ideal:640},height:{ideal:480}},audio:!0},console.log("📱 [OpenVidu] 미디어 제약 조건:",le);let ve;if(le&&navigator.mediaDevices&&navigator.mediaDevices.getUserMedia)try{ve=await navigator.mediaDevices.getUserMedia(le)}catch(Z){console.warn("⚠️ [OpenVidu] 첫 번째 시도 실패, 기본 제약조건으로 재시도:",Z);const qt={video:!0,audio:!ie};try{ve=await navigator.mediaDevices.getUserMedia(qt)}catch(Tn){console.warn("⚠️ [OpenVidu] 두 번째 시도도 실패:",Tn);try{ve=await navigator.mediaDevices.getUserMedia({video:!0,audio:!1})}catch(_r){console.error("❌ [OpenVidu] 모든 미디어 권한 요청 실패:",_r)}}}if(ve){const Z=ve.getVideoTracks()[0];Z&&console.log("✅ [OpenVidu] 비디오 트랙 획득:",{label:Z.label,enabled:Z.enabled,settings:Z.getSettings()}),ve.getTracks().forEach(qt=>qt.stop()),console.log("✅ [OpenVidu] 미디어 권한 획득 성공")}else console.warn("⚠️ [OpenVidu] 미디어 스트림을 획득하지 못했습니다.")}catch(le){console.error("❌ [OpenVidu] 미디어 권한 획득 실패:",{name:le.name,message:le.message,constraint:le.constraint}),le.name==="NotAllowedError"?fe.error("카메라/마이크 권한을 허용해주세요."):le.name==="NotFoundError"?fe.error("카메라를 찾을 수 없습니다."):le.name==="OverconstrainedError"&&console.warn("⚠️ [OpenVidu] 제약 조건이 너무 엄격합니다. 기본값으로 재시도...")}try{if((de||J||ne)&&!navigator.mediaDevices)console.log("📱 [OpenVidu] 미디어 장치 미지원 - 수신 전용 모드"),j=null;else if(de||J||ne){console.log("📱 [OpenVidu] 모바일/태블릿 간단한 설정 사용");try{const le={audioSource:!1,videoSource:void 0,publishAudio:!1,publishVideo:!0,resolution:"320x240",frameRate:15,insertMode:"APPEND"};j=await w.current.initPublisherAsync(void 0,le),console.log("🎥 [OpenVidu] 모바일 퍼블리셔 생성 완료")}catch(le){console.warn("⚠️ [OpenVidu] 모바일 퍼블리셔 실패, 수신 전용 모드:",le),j=null}}else j=await w.current.initPublisherAsync(void 0,G),console.log("🎥 [OpenVidu] 퍼블리셔 생성 완료:",j)}catch(le){console.warn("⚠️ [OpenVidu] 초기 설정으로 퍼블리셔 생성 실패, 기본 설정으로 재시도:",le);const ve={audioSource:void 0,videoSource:void 0,publishAudio:!1,publishVideo:!1,insertMode:"APPEND",mirror:!0};try{j=await w.current.initPublisherAsync(void 0,ve),console.log("🎥 [OpenVidu] 기본 설정으로 퍼블리셔 생성 성공")}catch(Z){console.error("❌ [OpenVidu] 퍼블리셔 생성 완전 실패:",Z),j=null}if(J&&j&&j.stream){const Z=j.stream.getMediaStream()?.getVideoTracks()[0];Z&&(console.log("📱 [OpenVidu] 비디오 트랙 설정:",Z.getSettings()),console.log("📱 [OpenVidu] 비디오 트랙 상태:",{enabled:Z.enabled,muted:Z.muted,readyState:Z.readyState}))}}}catch(G){throw console.error("❌ [OpenVidu] 퍼블리셔 생성 실패:",G),console.error("카메라/마이크 권한을 확인해주세요."),J&&(console.error("📱 [OpenVidu] 모바일 에러 상세:",{name:G.name,message:G.message,stack:G.stack}),G.name==="NotAllowedError"?fe.error("카메라/마이크 권한을 허용해주세요. 브라우저 설정을 확인하세요."):G.name==="NotFoundError"?fe.error("카메라를 찾을 수 없습니다. 디바이스를 확인해주세요."):G.name==="NotReadableError"&&fe.error("카메라가 다른 앱에서 사용 중입니다.")),G}}if(j){let J=!1,ie=0;const ee=3;for(;!J&&ie<ee;)try{const ne=400+ie*300;console.log(`⏳ [OpenVidu] 발행 대기: ${ne}ms`),await new Promise(K=>setTimeout(K,ne));try{x.openvidu&&x.openvidu.webSocket&&x.openvidu.webSocket.readyState===WebSocket.CONNECTING&&(console.warn("⚠️ [OpenVidu] WebSocket이 아직 연결 중, 추가 대기..."),await new Promise(be=>setTimeout(be,800)))}catch{}await x.publish(j),console.log("🎥 [OpenVidu] 스트림 발행 성공"),J=!0}catch(ne){ie++;const K=ne.toString(),be=JSON.stringify(ne);if(console.warn(`⚠️ [OpenVidu] 발행 실패 (시도 ${ie}/${ee}):`,K.substring(0,100)),be.includes("IceComponentStateChange")||be.includes("Kurento")||K.includes("WebSocket")&&K.includes("CONNECTING"))console.warn("⚠️ [OpenVidu] 알려진 호환성 문제 - 무시하고 진행"),J=!0;else if(ie>=ee){console.error("❌ [OpenVidu] 스트림 발행 최종 실패"),fe("카메라 연결이 불안정합니다.",{icon:"⚠️"});break}}}else console.warn("⚠️ [OpenVidu] 퍼블리셔 없이 세션 참가");return n(x),i(j),s([]),b(X),k(_),m(!0),u(!1),f.current&&clearInterval(f.current),f.current=setInterval(()=>{if(x&&x.connection)try{x.openvidu&&x.openvidu.sendRequest&&x.openvidu.sendRequest("ping",{},J=>{J?console.warn("⚠️ [OpenVidu] Keepalive ping 실패:",J):console.log("🎯 [OpenVidu] Keepalive ping 성공")})}catch(J){console.warn("⚠️ [OpenVidu] Keepalive 에러:",J)}},2e4),v.current&&clearInterval(v.current),v.current=setInterval(()=>{if(x&&x.connection&&x.openvidu&&x.openvidu.webSocket){const J=x.openvidu.webSocket;J.readyState!==WebSocket.OPEN&&(console.warn("⚠️ [OpenVidu] WebSocket 연결 끊김 감지:",J.readyState),J.readyState===WebSocket.CLOSED&&(m(!1),fe("화상통화 연결이 끊겼습니다.",{icon:"❌"})))}},5e3),j?fe.success(`${_==="area"?"구역":"전체"} 화상통화가 연결되었습니다.`):fe.info("화상통화 수신 모드로 연결되었습니다."),!0}catch(C){if(console.error("❌ [OpenVidu] 통화 시작 실패:",C),C.message&&(C.message.includes("timeout")||C.message.includes("Request has timed out")))return console.warn("📡 [OpenVidu] 타임아웃 - 수신 전용 모드로 전환 시도"),N&&x?j?(console.log("📡 [OpenVidu] 세션 및 퍼블리셔 유지 - 부분 연결"),n(x),i(j),s([]),b(X),k(_),m(!0),u(!1),fe("화상통화 연결이 불안정할 수 있습니다.",{icon:"⚠️"}),!0):(console.log("📡 [OpenVidu] 세션 유지 - 수신 전용 모드"),n(x),i(null),s([]),b(X),k(_),m(!0),u(!1),fe("카메라 연결이 불안정합니다. 다른 참가자만 볼 수 있습니다.",{icon:"⚠️"}),!0):(console.log("📡 [OpenVidu] 세션 생성 실패 - 재시도 필요"),fe("화상통화 연결이 불안정합니다. 잠시 후 다시 시도해주세요.",{icon:"⚠️"}),m(!1),!1);if(x)try{x.disconnect()}catch{}return fe.error("화상통화 연결에 실패했습니다."),m(!1),!1}},[t]),T=R.useCallback(async()=>{try{return f.current&&(clearInterval(f.current),f.current=null),v.current&&(clearInterval(v.current),v.current=null),t&&(t.disconnect(),console.log("🎥 [OpenVidu] 세션 연결 해제"),g&&await Ie.post("/api/openvidu/session/leave",{sessionId:g},{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}})),n(null),i(null),s([]),b(null),k(null),m(!1),console.log("🎥 [OpenVidu] 통화 종료 완료"),!0}catch(p){return console.error("❌ [OpenVidu] 통화 종료 실패:",p),!1}},[t,g]),M=R.useCallback(()=>{if(r){const p=!a;r.publishVideo(p),c(p),console.log(`🎥 [OpenVidu] 비디오 ${p?"켜짐":"꺼짐"}`)}},[r,a]),U=R.useCallback(()=>{if(r){const p=!l;r.publishAudio(p),u(p),console.log(`🎤 [OpenVidu] 오디오 ${p?"켜짐":"꺼짐"}`)}},[r,l]),S=R.useCallback(async(p,E=null)=>d?(await T(),!1):await y(p,E),[d,y,T]);return{session:t,publisher:r,subscribers:o,isVideoEnabled:a,isAudioEnabled:l,isConnected:d,currentCallType:P,participants:o.length+(r?1:0),participantsList:[...o,...r?[r]:[]],startGroupCall:y,startVideoCall:y,endVideoCall:T,leaveCall:T,toggleVideo:M,toggleAudio:U,toggleVideoCall:S}},Sp=50,zC=.2;class wp{constructor(t){this.id=t.userId||t.socketId,this.username=t.username,this.socketId=t.socketId,this.serverPosition={...t.position},this.displayPosition={...t.position},this.targetPosition={...t.position},this.previousPosition={...t.position},this.direction=t.direction||"down",this.isMoving=!1,this.characterInfo=t.characterInfo,this.lastUpdate=Date.now(),this.lastServerUpdate=Date.now()}updateFromServer(t){this.previousPosition={...this.serverPosition},this.serverPosition={...t.position},this.targetPosition={...t.position},this.direction=t.direction||this.direction,this.characterInfo=t.characterInfo||this.characterInfo,this.lastServerUpdate=Date.now(),this.lastUpdate=Date.now();const n=this.serverPosition.x-this.previousPosition.x,r=this.serverPosition.y-this.previousPosition.y;this.isMoving=Math.abs(n)>1||Math.abs(r)>1}interpolate(t){const n=Math.min(1,zC*(t/16));this.displayPosition.x+=(this.targetPosition.x-this.displayPosition.x)*n,this.displayPosition.y+=(this.targetPosition.y-this.displayPosition.y)*n,Math.hypot(this.targetPosition.x-this.displayPosition.x,this.targetPosition.y-this.displayPosition.y)<1&&(this.displayPosition={...this.targetPosition},this.isMoving=!1)}isStale(){return!1}}const WC=(e,t)=>{const{user:n}=on(),[r,i]=R.useState({x:200,y:200}),[o,s]=R.useState("down"),[a,c]=R.useState(new Map),[l,u]=R.useState([]),d=R.useRef(new Map),m=R.useRef(0),g=R.useRef(null),b=R.useRef(Date.now()),P=R.useRef(r),k=R.useRef(o);R.useRef([]);const f=R.useRef(null);R.useEffect(()=>{P.current=r},[r]),R.useEffect(()=>{k.current=o},[o]),R.useEffect(()=>{if(t?.spawnPoints?.length>0){const T=t.spawnPoints.find(M=>M.isDefault)||t.spawnPoints[0];i({x:T.x||200,y:T.y||200})}else t?.startPoint&&i({x:t.startPoint.x||200,y:t.startPoint.y||200})},[t?.id]);const v=R.useCallback((y,T)=>{if(!t?.walls||t.walls.length===0)return!1;for(const M of t.walls){const U=M.start?.x??M.x1??0,S=M.start?.y??M.y1??0,p=M.end?.x??M.x2??0,E=M.end?.y??M.y2??0,I=(T.x-y.x)*(E-S)-(T.y-y.y)*(p-U);if(Math.abs(I)<1e-4)continue;const x=((U-y.x)*(E-S)-(S-y.y)*(p-U))/I,N=((U-y.x)*(T.y-y.y)-(S-y.y)*(T.x-y.x))/I;if(x>=0&&x<=1&&N>=0&&N<=1)return!0}return!1},[t]);R.useCallback((y,T)=>{if(!t)return[T];t.walls;const M=10,U=Math.hypot(T.x-y.x,T.y-y.y),S=Math.ceil(U/M)*2,p=[];let E={...y},I=0;for(;I<S;){I++;const x={x:E.x+(T.x-E.x)*.1,y:E.y+(T.y-E.y)*.1};if(v(E,x)){const N=[Math.PI/4,-Math.PI/4,Math.PI/2,-Math.PI/2,Math.PI*3/4,-Math.PI*3/4];let j=!1;for(const X of N){const _=Math.cos(X)*M*2,C=Math.sin(X)*M*2,O={x:E.x+_,y:E.y+C};if(!v(E,O)){p.push(O),E=O,j=!0;break}}if(!j){p.push(T);break}}else if(p.push(x),E=x,Math.hypot(T.x-E.x,T.y-E.y)<M){p.push(T);break}}return p.length>0?p:[T]},[t,v]);const w=R.useCallback(y=>{console.log("🎯 클릭 이동: 직선 이동 시작",y),console.log("📍 현재 위치:",r),f.current=y;const T=300;let M=null;const U=S=>{if(!f.current)return;const p=M?(S-M)/1e3:.016;M=S;const E=P.current,I=f.current,x=I.x-E.x,N=I.y-E.y,j=Math.hypot(x,N);if(j<5){console.log("🏁 목적지 도착"),i(I),u([]),f.current=null;return}const X=x/j,_=N/j,C=T*p,O=E.x+X*Math.min(C,j),F=E.y+_*Math.min(C,j),W={x:O,y:F};if(v(E,W))console.log("⛔ 벽과 충돌 - 이동 중지"),f.current=null,u([]);else{let $=k.current;Math.abs(x)>Math.abs(N)?$=x>0?"right":"left":Math.abs(N)>0&&($=N>0?"down":"up"),i(W),s($),k.current=$,u([r,I]),requestAnimationFrame(U)}};requestAnimationFrame(U)},[v,r]);return R.useEffect(()=>{if(!e||!t||!n)return;const y=()=>{const M=Date.now();M-m.current>=Sp&&(e.emit("update-position",{mapId:t.id,position:P.current,direction:k.current,username:n.username,timestamp:M}),m.current=M)},T=setInterval(y,Sp);return y(),()=>clearInterval(T)},[e,t,n]),R.useEffect(()=>{if(!e||!n)return;const y=S=>{if(S.userId===n.id||S.username===n.username)return;const p=S.userId||S.socketId;d.current.has(p)?d.current.get(p).updateFromServer(S):d.current.set(p,new wp(S))},T=S=>{const{users:p,mapId:E}=S;if(!p||E!==t?.id)return;const I=new Set;p.forEach(x=>{if(x.userId===n.id||x.username===n.username)return;const N=x.userId||x.socketId;I.add(N),d.current.has(N)?d.current.get(N).updateFromServer(x):d.current.set(N,new wp(x))})},M=S=>{const p=S.userId||S.socketId;d.current.delete(p),console.log(`👋 [CharSync] 사용자 퇴장: ${p}`)},U=S=>{if(S.mapId!==t?.id)return;const p=new Set(S.participants.filter(E=>E.userId!==n.id).map(E=>E.userId||E.socketId));d.current.forEach((E,I)=>{p.has(I)||(d.current.delete(I),console.log(`👋 [CharSync] 참가자 목록에서 제거: ${I}`))})};return e.on("user-position",y),e.on("all-users-update",T),e.on("user-left",M),e.on("update-participants",U),()=>{e.off("user-position",y),e.off("all-users-update",T),e.off("user-left",M),e.off("update-participants",U)}},[e,n,t?.id]),R.useEffect(()=>{const y=()=>{const T=Date.now(),M=T-b.current;b.current=T;const U=new Map;d.current.forEach((p,E)=>{p.isStale()||(p.interpolate(M),U.set(E,{id:p.id,username:p.username,position:{...p.displayPosition},direction:p.direction,isMoving:p.isMoving,characterInfo:p.characterInfo}))});const S=[];d.current.forEach((p,E)=>{p.isStale()&&S.push(E)}),S.forEach(p=>d.current.delete(p)),c(U),g.current=requestAnimationFrame(y)};return g.current=requestAnimationFrame(y),()=>{g.current&&cancelAnimationFrame(g.current)}},[]),R.useEffect(()=>{console.log("🔍 맵 정보 초기화 시도, currentMap:",t);let y=t?.size?.width||t?.width||1e3,T=t?.size?.height||t?.height||1e3;(t?.backgroundImage||t?.backgroundLayer?.image)&&(y=t?.imageSize?.width||y,T=t?.imageSize?.height||T),console.log(`📐 맵 크기: ${y} x ${T}`),t?.walls&&console.log(`🧱 벽 설정: ${t.walls.length}개`),console.log("✅ 맵 정보 초기화 완료")},[t]),R.useEffect(()=>{d.current.clear(),c(new Map),u([])},[t?.id]),{myPosition:r,myDirection:o,otherCharacters:a,currentPath:l,moveCharacterTo:w,setMyPosition:i,setMyDirection:s}};const HC=({onSendMessage:e,isVisible:t=!0})=>{const[n,r]=R.useState(""),[i,o]=R.useState(!1),s=R.useRef(null);R.useEffect(()=>{i&&s.current&&s.current.focus()},[i]);const a=l=>{l.preventDefault(),n.trim()&&(e(n.trim()),r(""),o(!1))},c=l=>{l.key==="Enter"&&!l.shiftKey?(l.preventDefault(),a(l)):l.key==="Escape"&&(r(""),o(!1),s.current?.blur())};return t?h.jsx("div",{className:`chat-input-container ${i?"expanded":"collapsed"}`,children:i?h.jsxs("form",{className:"chat-input-form",onSubmit:a,children:[h.jsx("input",{ref:s,type:"text",value:n,onChange:l=>r(l.target.value),onKeyDown:c,placeholder:"메시지 입력... (Enter로 전송, Esc로 닫기)",className:"chat-input-field",maxLength:100}),h.jsx("button",{type:"submit",className:"chat-send-btn",disabled:!n.trim(),children:"전송"}),h.jsx("button",{type:"button",className:"chat-close-btn",onClick:()=>{o(!1),r("")},title:"닫기 (Esc)",children:"✕"})]}):h.jsx("button",{className:"chat-expand-btn",onClick:()=>o(!0),title:"메시지 입력 (Enter)",children:"💬 채팅"})}):null};const qC=({posts:e,onPostCreate:t,onPostLike:n,onPostComment:r})=>{const[i,o]=R.useState(""),[s,a]=R.useState({}),c=()=>{if(!i.trim())return;const g={id:Date.now(),content:i,author:"사용자",timestamp:new Date().toISOString(),likes:0,comments:[],hashtags:d(i)};t(g),o("")},l=g=>{n(g)},u=g=>{const b=s[g];b?.trim()&&(r(g,b),a(P=>({...P,[g]:""})))},d=g=>{const b=/#[\w가-힣]+/g;return g.match(b)||[]},m=g=>{const b=new Date(g),k=new Date-b;return k<6e4?"방금 전":k<36e5?`${Math.floor(k/6e4)}분 전`:k<864e5?`${Math.floor(k/36e5)}시간 전`:b.toLocaleDateString()};return h.jsxs("div",{className:"sns-board",children:[h.jsxs("div",{className:"sns-header",children:[h.jsx("h2",{children:"📱 SNS 게시판"}),h.jsx("p",{children:"mini area에서의 경험을 공유해보세요!"})]}),h.jsxs("div",{className:"post-create",children:[h.jsx("textarea",{value:i,onChange:g=>o(g.target.value),placeholder:"무엇을 공유하고 싶으신가요? #해시태그도 사용할 수 있어요!",rows:3}),h.jsxs("div",{className:"post-create-footer",children:[h.jsxs("div",{className:"hashtag-suggestions",children:[h.jsx("span",{className:"hashtag-hint",children:"추천 해시태그: "}),h.jsx("button",{onClick:()=>o(g=>g+" #miniarea"),children:"#miniarea"}),h.jsx("button",{onClick:()=>o(g=>g+" #화상통화"),children:"#화상통화"}),h.jsx("button",{onClick:()=>o(g=>g+" #캐릭터"),children:"#캐릭터"})]}),h.jsx("button",{className:"post-submit-btn",onClick:c,disabled:!i.trim(),children:"게시하기"})]})]}),h.jsx("div",{className:"posts-list",children:e.length===0?h.jsxs("div",{className:"empty-posts",children:[h.jsx("div",{className:"empty-icon",children:"📝"}),h.jsx("p",{children:"아직 게시글이 없어요!"}),h.jsx("p",{children:"첫 번째 게시글을 작성해보세요."})]}):e.map(g=>h.jsxs("div",{className:"post-item",children:[h.jsx("div",{className:"post-header",children:h.jsxs("div",{className:"post-author",children:[h.jsx("div",{className:"author-avatar",children:"👤"}),h.jsxs("div",{className:"author-info",children:[h.jsx("div",{className:"author-name",children:g.author}),h.jsx("div",{className:"post-time",children:m(g.timestamp)})]})]})}),h.jsx("div",{className:"post-content",children:g.content.split(" ").map((b,P)=>b.startsWith("#")?h.jsx("span",{className:"hashtag",children:b},P):b+" ")}),h.jsxs("div",{className:"post-actions",children:[h.jsxs("button",{className:"action-btn like-btn",onClick:()=>l(g.id),children:["❤️ 좋아요 (",g.likes,")"]}),h.jsxs("button",{className:"action-btn",children:["💬 댓글 (",g.comments?.length||0,")"]}),h.jsx("button",{className:"action-btn",children:"🔄 공유"})]}),h.jsxs("div",{className:"comments-section",children:[g.comments?.map((b,P)=>h.jsxs("div",{className:"comment-item",children:[h.jsx("div",{className:"comment-author",children:b.author}),h.jsx("div",{className:"comment-content",children:b.content}),h.jsx("div",{className:"comment-time",children:m(b.timestamp)})]},P)),h.jsxs("div",{className:"comment-input",children:[h.jsx("input",{type:"text",value:s[g.id]||"",onChange:b=>a(P=>({...P,[g.id]:b.target.value})),placeholder:"댓글을 입력하세요...",onKeyPress:b=>b.key==="Enter"&&u(g.id)}),h.jsx("button",{onClick:()=>u(g.id),disabled:!s[g.id]?.trim(),children:"댓글"})]})]})]},g.id))})]})};const GC=({currentView:e,onViewChange:t,currentArea:n,onReturnToLobby:r,onToggleGroupCall:i,groupCallActive:o,onOpenUserList:s,roomName:a})=>{const[c,l]=R.useState(!1);R.useEffect(()=>{const d=()=>{l(!!document.fullscreenElement)};return document.addEventListener("fullscreenchange",d),()=>document.removeEventListener("fullscreenchange",d)},[]);const u=()=>{document.fullscreenElement?document.exitFullscreen():document.documentElement.requestFullscreen().catch(d=>{console.error("전체화면 전환 실패:",d)})};return h.jsxs("div",{className:"navigation-bar",children:[h.jsxs("div",{className:"nav-left",children:[a&&h.jsxs("span",{className:"room-name-display",style:{color:"#fff",fontSize:"16px",fontWeight:"bold",marginRight:"15px",padding:"5px 10px",background:"rgba(255, 255, 255, 0.1)",borderRadius:"8px"},children:["🐢 ",a]}),h.jsx("button",{className:`nav-button ${e==="metaverse"?"active":""}`,onClick:()=>t("metaverse"),children:"🎮 mini area"}),h.jsx("button",{className:`nav-button ${e==="sns"?"active":""}`,onClick:()=>t("sns"),children:"📱 SNS"})]}),h.jsx("div",{className:"nav-center"}),h.jsxs("div",{className:"nav-right",children:[h.jsxs("button",{className:"nav-button",onClick:u,title:c?"전체화면 종료":"전체화면",children:[c?"🔳":"🔲"," 전체화면"]}),h.jsx("button",{className:"nav-button return-button",onClick:r,children:"🏠 로비로"})]})]})};const Ep=({streamManager:e,isLocal:t=!1})=>{const n=R.useRef(null),[r,i]=R.useState(!1),[o,s]=R.useState(!1);return R.useEffect(()=>{if(e&&n.current)try{if(e.addVideoElement(n.current),/iPhone|iPad|iPod|Android/i.test(navigator.userAgent)){console.log("📱 [VideoDisplay] 모바일 디바이스에서 비디오 설정"),n.current.setAttribute("playsinline","true"),n.current.setAttribute("webkit-playsinline","true"),n.current.setAttribute("x5-playsinline","true"),n.current.setAttribute("x5-video-player-type","h5"),n.current.setAttribute("x5-video-player-fullscreen","false"),/iPad|iPhone|iPod/.test(navigator.userAgent)&&(n.current.style.width="100%",n.current.style.height="100%");const c=e.stream?.getMediaStream();if(c){n.current.srcObject=c;const l=n.current.play();l!==void 0&&l.then(()=>{console.log("✅ [VideoDisplay] 비디오 재생 시작"),s(!0)}).catch(u=>{console.error("❌ [VideoDisplay] 비디오 재생 실패:",u),u.name==="NotAllowedError"&&console.log("📱 [VideoDisplay] 사용자 상호작용 필요 - 터치 이벤트 대기")})}}n.current.addEventListener("loadedmetadata",()=>{console.log("📹 [VideoDisplay] 비디오 메타데이터 로드됨"),s(!0)}),n.current.addEventListener("error",c=>{console.error("❌ [VideoDisplay] 비디오 에러:",c),i(!0)})}catch(a){console.error("❌ [VideoDisplay] 스트림 매니저 에러:",a),i(!0)}return()=>{n.current&&(n.current.srcObject=null)}},[e]),h.jsxs("div",{className:`openvidu-video-container ${t?"local":"remote"}`,children:[h.jsx("video",{ref:n,autoPlay:!0,playsInline:!0,muted:t,className:"openvidu-video",style:{opacity:o?1:.3,backgroundColor:r?"#ff0000":"#000"}}),r&&h.jsx("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",color:"white",fontSize:"12px",textAlign:"center"},children:"비디오 로드 실패"})]})};const XC=R.forwardRef(({currentMap:e,mapImage:t,characters:n,currentCharacter:r,isEditMode:i=!1,onReturnToLobby:o},s)=>{const{user:a,socket:c,localStream:l}=on();To();const[u,d]=R.useState("metaverse"),[m,g]=R.useState({type:"public",name:"퍼블릭 영역"}),[b,P]=R.useState(!1),[k,f]=R.useState({width:1e3,height:1e3}),[v,w]=R.useState(1),[y,T]=R.useState({x:0,y:0}),M=BC({user:a});R.useState(new Map),R.useState([]),R.useState([]);const[U,S]=R.useState([]),[p,E]=R.useState(!1),[I,x]=R.useState(0);R.useState(!1);const[N,j]=R.useState([]),[X,_]=R.useState(!0),[C,O]=R.useState(new Map),[F,W]=R.useState(!1),[$,q]=R.useState({x:0,y:0}),[H,Q]=R.useState({x:0,y:0}),[Y,L]=R.useState(!1),J=R.useRef(null),ie=R.useRef(null);R.useRef(null);const ee=R.useRef(null),ne=WC(c,e),K=R.useRef(!1),be=R.useRef(new Map);R.useEffect(()=>{console.log("🗺️ [MetaverseScene] currentMap 변경:",{hasCurrentMap:!!e,mapId:e?.id,map_id:e?._id,mapName:e?.name})},[e]);const de=e?.id||e?._id||null;R.useEffect(()=>{console.log("🆔 [MetaverseScene] metaverseId 변경:",de)},[de]),R.useEffect(()=>{const B=UE();console.log("🎥 [Global Video Chat] WebRTC 지원 상태:",B);const V=/iPhone|iPad|iPod|Android/i.test(navigator.userAgent),re=/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream,ce=/Android/i.test(navigator.userAgent);if(console.log("📱 [Global Video Chat] 디바이스 정보:",{isMobile:V,isIOS:re,isAndroid:ce,userAgent:navigator.userAgent,protocol:window.location.protocol,hostname:window.location.hostname,https:window.location.protocol==="https:"}),!B.getUserMedia||!B.RTCPeerConnection){console.error("❌ [Global Video Chat] WebRTC가 지원되지 않습니다!"),fe.error("이 브라우저는 화상통화를 지원하지 않습니다.");return}if(B.https||(console.warn("⚠️ [Global Video Chat] HTTPS가 아닙니다. 카메라가 작동하지 않을 수 있습니다."),V&&fe.error("모바일에서는 HTTPS 연결이 필요합니다.")),console.log("🎥 [Global Video Chat] useEffect 실행됨:",{metaverseId:de,isConnected:M.isConnected,publisher:M.publisher,startVideoCall:typeof M.startVideoCall}),!de){console.log("🎥 [Global Video Chat] metaverseId가 없음 - 대기");return}const Oe=async()=>{try{console.log(`🎥 [Map Video Chat] 맵 전체 화상 채팅 시작 (metaverseId: ${de})`);const Te=await M.startVideoCall(de,null);console.log("🎥 [Map Video Chat] 맵 전체 화상 채팅 연결 성공:",Te),_(!0),fe.success("맵 화상 채팅방에 입장했습니다.")}catch(Te){console.error("🎥 [Global Video Chat] 화상 채팅 시작 실패:",Te),console.error("에러 상세:",Te.message,Te.stack)}};M.isConnected?console.log("🎥 [Global Video Chat] 기존 세션 있음 - 재사용"):(console.log("🎥 [Global Video Chat] 새 글로벌 세션 시작"),Oe())},[de]);const{participants:G,participantsList:le,isVideoEnabled:ve,isAudioEnabled:Z,isConnected:qt,currentCallType:Tn,startVideoCall:_r,endVideoCall:Ir,toggleVideoCall:Ri,toggleVideo:_i,toggleAudio:zo}=M;m.type==="private"&&m.name;const He=B=>{if(!e?.privateAreas||!Array.isArray(e.privateAreas))return null;const V=re=>{const ce=re.position?.x??re.x??re.x1??0,Oe=re.position?.y??re.y??re.y1??0,Te=re.size?.width??re.width??(re.x2!==void 0&&re.x1!==void 0?re.x2-re.x1:0),lt=re.size?.height??re.height??(re.y2!==void 0&&re.y1!==void 0?re.y2-re.y1:0);return{x:ce,y:Oe,width:Te,height:lt}};for(const re of e.privateAreas){const ce=V(re);if(B.x>=ce.x&&B.x<=ce.x+ce.width&&B.y>=ce.y&&B.y<=ce.y+ce.height)return{type:"private",id:re.id,name:re.name||`프라이빗 영역 ${re.id}`}}return{type:"public",name:"퍼블릭 영역"}},_e=B=>{if(!B){console.log("⚠️ handleAreaChange: newArea is null");return}console.log(`📍 영역 변경: ${m?.type||"없음"} -> ${B.type}${B.id?` (ID: ${B.id})`:""}`),g(B),c&&(B.type==="private"?c.emit("join-private-area",{privateAreaId:B.id,mapId:e?.id}):c.emit("leave-private-area",{mapId:e?.id}))},Se=R.useRef(null),at=R.useCallback(async B=>{Se.current&&clearTimeout(Se.current),Se.current=setTimeout(()=>{if(console.log("👥 참가자 업데이트 처리:",B),e&&B.mapId===e.id){if(console.log(`👥 현재 맵 ${B.mapId}의 참가자:`,B.participants),B.privateAreaUpdate){const V=B.privateAreaUpdate;console.log(`🎬 프라이빗 영역 변경: ${V.username} ${V.action==="joined"?"진입":"퇴장"} → 영역 ${V.privateAreaId}`),V.remainingParticipants&&console.log(`👥 남은 참가자: ${V.remainingParticipants.length}명`)}B.participants&&Array.isArray(B.participants)&&j(B.participants)}},100)},[e]),Ha=B=>{const V=B.username||B.userId;m.type==="private"&&(console.log(`🎬 프라이빗 영역에서 ${V}가 나갔습니다`),N.filter(ce=>ce.userId!==a.id&&ce.userId!==B.userId&&ce.privateAreaId===m.id).length===0&&console.log("🎬 프라이빗 영역에 혼자 남음 - 본인 화면만 표시"))},Wo=B=>{if(!ie.current||i)return;const V=B.target;if(V.closest(".chat-window")||V.closest(".chat-container")||V.closest(".chat-input-form")||V.closest(".chat-messages")||V.closest(".modal")||V.closest(".modal-content")||V.closest("button")||V.closest("input")||V.closest("textarea")||V.tagName==="BUTTON"||V.tagName==="INPUT"||V.tagName==="TEXTAREA")return;const ce=ie.current.getBoundingClientRect(),Oe=(B.clientX-ce.left)/v,Te=(B.clientY-ce.top)/v;ne.moveCharacterTo&&(console.log("🎯 더블클릭 이동: 목표 위치",{x:Math.round(Oe),y:Math.round(Te)},"zoom:",v),ne.moveCharacterTo({x:Oe,y:Te}))},A=B=>{i||(B.button===0?(W(!0),q({x:B.clientX,y:B.clientY}),Q({x:y.x,y:y.y}),L(!1)):B.button===2&&(B.preventDefault(),W(!0),Q({x:B.clientX-y.x,y:B.clientY-y.y}),L(!0)))},D=B=>{if(i||!F)return;const V=B.clientX-$.x,re=B.clientY-$.y,ce=Math.sqrt(V*V+re*re);if(ce>5&&L(!0),Y||ce>5){const Oe={x:H.x+V,y:H.y+re};T(Oe)}},we=B=>{if(i)return;const V=B.target;V.closest(".chat-window")||V.closest(".chat-container")||V.closest(".chat-input-form")||V.closest(".chat-messages")||V.closest(".modal")||V.closest(".modal-content")||V.closest("button")||V.closest("input")||V.closest("textarea")||V.tagName==="BUTTON"||V.tagName==="INPUT"||V.tagName,W(!1),L(!1)},oe=B=>{if(i)return;const V=B.deltaY>0?.9:1.1,re=Math.max(.1,Math.min(5,v*V)),ce=B.clientX,Oe=B.clientY,Te=re/v,lt=ce-(ce-y.x)*Te,qa=Oe-(Oe-y.y)*Te;w(re),T({x:lt,y:qa})},pe=()=>{T({x:0,y:0}),w(1)},se=B=>{B.preventDefault()},he=B=>{P(!0),f({width:B.target.naturalWidth,height:B.target.naturalHeight})};if(R.useEffect(()=>{ee.current=Ir},[Ir]),R.useEffect(()=>{K.current=p,p&&x(0)},[p]),R.useEffect(()=>{ve&&console.log("📹 [OpenVidu] 화상통화 활성화됨")},[ve]),R.useEffect(()=>{if(!c||!e)return;c.on("update-participants",V=>{console.log("👥 참가자 목록 업데이트:",V),at(V)}),c.on("user-left",V=>{console.log("👋 사용자 퇴장:",V),Ha(V)}),c.on("user-joined-private-area",async V=>{if(console.log("🎬 [user-joined-private-area] 프라이빗 영역에 사용자 진입:",V),V.currentParticipants&&console.log(`👥 현재 영역 참가자: ${V.currentParticipants.length}명`,V.currentParticipants),m.type==="private"&&m.id===V.privateAreaId&&V.userId!==a.id){const re=V.username||V.userId;console.log(`🆕 새 사용자 ${re}가 내 프라이빗 영역에 진입`),ve||(console.log("📹 프라이빗 영역 - 카메라 자동 시작"),_(!0),setIsCallVisible(!0)),ve?console.log(`✅ ${re}는 이미 연결되어 있음`):(console.log(`🎬 ${re}와 화상통화 연결 시작`),setTimeout(async()=>{},1e3)),console.log("📊 [OpenVidu] 화상통화 참가자 업데이트")}}),c.on("user-left-private-area",V=>{if(console.log("🎬 사용자가 프라이빗 영역을 떠났습니다:",V),m.type==="private"){const re=V.username||V.userId,ce=`👋 ${re}님이 프라이빗 영역을 떠났습니다`,Oe={userId:a.id,username:a.username,message:ce,timestamp:new Date().toISOString()};O(Te=>new Map(Te).set(a.id,Oe)),setTimeout(()=>{O(Te=>{const lt=new Map(Te);return lt.get(a.id)?.message===ce&&lt.delete(a.id),lt})},3e3),console.log(`🎬 ${re}의 화면을 제거했습니다`)}}),c.on("private-area-participants",async V=>{if(console.log("👥 프라이빗 영역 참가자 목록:",V),m.type==="private"&&V.participants&&V.participants.length>0){const re=V.participants.filter(ce=>ce.userId!==a.id);if(re.length>0){ve||(console.log(`📹 프라이빗 영역에 ${re.length}명 발견 - 카메라 시작`),_(!0),setIsCallVisible(!0));for(const ce of re){const Oe=ce.username||ce.userId;ve||console.log(`🎬 ${Oe}와 화상통화 연결 시도`)}}}}),c.on("channel-participants-update",async V=>{if(console.log("📡 채널 참가자 업데이트:",V),V.participants&&Array.isArray(V.participants)){const re=V.participants.filter(ce=>ce.userId!==a.id);if(re.length>0&&m.type==="private"){ve||(_(!0),setIsCallVisible(!0));for(const ce of re)ce.username||ce.userId}}}),c.on("user-joined",V=>{console.log("👋 사용자 입장:",V)}),c.on("existing-users",V=>{console.log("📋 기존 사용자 정보 수신:",V)}),c.on("private-areas-status",V=>{console.log("🎬 프라이빗 영역 상태 업데이트:",V),V.privateAreas&&V.privateAreas.length>0?V.privateAreas.forEach(re=>{console.log(`  영역 ${re.areaId}: ${re.participantCount}명 참가중`),re.participants&&re.participants.forEach(ce=>{console.log(`    - ${ce.username} (${ce.userId})`)})}):console.log("  프라이빗 영역에 아무도 없음")}),c.on("private-area-status-changed",V=>{e&&V.mapId===e.id&&console.log(`📍 맵 ${V.mapId}의 프라이빗 영역 ${V.areaId} 상태 변화:`,{사용자수:V.userCount,변화타입:V.changeType})}),c.on("chat-message",V=>{if(console.log("💬 채팅 메시지 수신:",V),!V.content||V.content.trim()===""){console.log("빈 메시지 무시");return}if(V.type==="area"||!V.type){const re={userId:V.userId,username:V.username,message:V.content,timestamp:new Date().toISOString()};O(ce=>new Map(ce).set(V.userId,re)),setTimeout(()=>{O(ce=>{const Oe=new Map(ce);return Oe.get(V.userId)?.message===V.content&&Oe.delete(V.userId),Oe})},3e4)}}),c.on("auto-rejoin",V=>{console.log("🔄 자동 재입장 처리:",V),e&&V.mapId===e.id&&(ne.setMyPosition(V.position),ne.setMyDirection(V.direction))}),c.on("error",V=>{console.error("🚨 서버 에러:",V),V.message&&alert(`오류: ${V.message}`)});const B={mapId:e?.id,characterId:r?.id,userId:a?.id,username:a?.username,position:ne.myPosition||{x:500,y:500},characterInfo:r};return console.log("🏠 맵 입장 요청:",B),c.emit("join-map",B),()=>{console.log("🏠 맵 퇴장 처리"),c.off("update-participants"),c.off("user-left"),c.off("user-joined-private-area"),c.off("user-left-private-area"),c.off("private-area-participants"),c.off("channel-participants-update"),c.off("private-areas-status"),c.off("private-area-status-changed"),c.off("user-joined"),c.off("existing-users"),c.off("chat-message"),c.off("auto-rejoin"),c.off("error"),c.emit("leave-map"),Se.current&&clearTimeout(Se.current),be.current.forEach(V=>{clearTimeout(V)}),be.current.clear()}},[c,e,r,a.id]),R.useEffect(()=>{e?.size?.width&&e?.size?.height&&f({width:e.size.width,height:e.size.height})},[e?.size?.width,e?.size?.height]),R.useEffect(()=>()=>{M.isConnected&&(console.log("🎥 [Global Video Chat] 컴포넌트 언마운트 - 화상통화 종료"),M.endVideoCall())},[]),R.useImperativeHandle(s,()=>({leaveMapAndReturnToLobby:B=>{c&&B&&c.emit("leave-map")}}),[c]),R.useEffect(()=>{if(!ne.myPosition||!e)return;const B=He(ne.myPosition);(!m||B?.type!==m?.type||B?.id!==m?.id)&&_e(B)},[ne.myPosition,m,e]),R.useEffect(()=>{const B=()=>{F&&W(!1)};return F&&(document.addEventListener("mouseup",B),document.addEventListener("mouseleave",B)),()=>{document.removeEventListener("mouseup",B),document.removeEventListener("mouseleave",B)}},[F]),R.useEffect(()=>{const B=V=>{if(V.target.tagName==="INPUT"||V.target.tagName==="TEXTAREA")return;const re=10;let ce={...ne.myPosition},Oe=ne.myDirection,Te=!1;switch(V.key){case"ArrowUp":V.preventDefault(),ce.y=Math.max(0,ce.y-re),Oe="up",Te=!0;break;case"ArrowDown":V.preventDefault(),ce.y=Math.min(k.height-20,ce.y+re),Oe="down",Te=!0;break;case"ArrowLeft":V.preventDefault(),ce.x=Math.max(0,ce.x-re),Oe="left",Te=!0;break;case"ArrowRight":V.preventDefault(),ce.x=Math.min(k.width-20,ce.x+re),Oe="right",Te=!0;break}if(Te&&(ne.setMyPosition(ce),ne.setMyDirection(Oe)),V.key==="+"||V.key==="="){V.preventDefault();const lt=Math.min(5,v*1.2);w(lt)}else if(V.key==="-"||V.key==="_"){V.preventDefault();const lt=Math.max(.1,v*.8);w(lt)}else V.key==="0"&&(V.preventDefault(),pe())};return document.addEventListener("keydown",B),()=>{document.removeEventListener("keydown",B)}},[v,ne,k]),!e)return h.jsxs("div",{className:"metaverse-container metaverse-lobby-message",children:[h.jsx("h2",{children:"맵이 선택되지 않았습니다."}),h.jsx("p",{children:"로비로 돌아가서 맵을 선택해주세요."}),h.jsx("button",{onClick:o,children:"로비로 돌아가기"})]});const me=B=>{const V=B&&B.appearance||{},re=V.head||"😊",ce=V.body||"👕",Oe=V.arms||V.hands||"💪",Te=V.legs||V.feet||"👖";return{head:re,body:ce,arms:Oe,legs:Te}},Be=({body:B,arms:V,direction:re})=>h.jsxs("div",{style:{position:"relative",display:"inline-block",textAlign:"center"},children:[h.jsx("span",{style:{fontSize:10.5},children:B}),re==="left"&&h.jsx("span",{style:{position:"absolute",right:"100%",marginRight:3,top:0,fontSize:10.5},children:V}),re==="right"&&h.jsx("span",{style:{position:"absolute",left:"100%",marginLeft:3,top:0,fontSize:10.5,transform:"scaleX(-1)",display:"inline-block"},children:V})]}),Ln=({info:B,isCurrent:V,chatBubble:re,style:ce={}})=>{const Oe=B.position||{x:0,y:0},Te=B.direction||"down",lt=me(B);re&&console.log("💬 Rendering chat bubble for:",B.name||B.username,re);const qa=xt=>{xt&&(xt.stopPropagation(),xt.preventDefault());const fd=B.userId||a.id;console.log("🗑️ Deleting bubble for user:",fd),console.log("Current bubbles before delete:",Array.from(C.entries())),O(Hv=>{const Ga=new Map(Hv);return Ga.delete(fd),console.log("Bubbles after delete:",Array.from(Ga.entries())),Ga})};return h.jsxs("div",{className:`dom-character ${V?"current":""}`,style:{position:"absolute",left:`${Oe.x}px`,top:`${Oe.y}px`,transform:"translate(-50%, -50%)",zIndex:10,userSelect:"none",pointerEvents:"none",background:"rgba(255, 255, 255, 0.1)",borderRadius:"8px",padding:"2px",border:V?"2px solid #4CAF50":"1px solid rgba(255, 255, 255, 0.3)",transition:"all 0.15s ease-out",minWidth:"50px",minHeight:"50px",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",...ce},children:[re&&h.jsxs("div",{style:{position:"absolute",bottom:"80px",left:"50%",transform:"translateX(-50%)",background:V?"rgba(52, 152, 219, 0.95)":"rgba(255, 255, 255, 0.95)",color:V?"white":"#333",padding:"10px 15px",borderRadius:"15px",fontSize:"14px",minWidth:"120px",maxWidth:"500px",width:"max-content",wordBreak:"keep-all",boxShadow:"0 4px 12px rgba(0, 0, 0, 0.3)",border:"2px solid rgba(255, 255, 255, 0.2)",whiteSpace:"pre-wrap",overflowWrap:"break-word",zIndex:100,pointerEvents:"auto",display:"flex",alignItems:"center",gap:"8px"},children:[h.jsx("span",{style:{flex:1},children:re.message}),V&&h.jsx("button",{type:"button",onClick:xt=>{console.log("🔴 Delete button clicked!"),qa(xt)},onMouseDown:xt=>{xt.stopPropagation(),xt.preventDefault()},style:{position:"relative",width:"22px",height:"22px",borderRadius:"50%",background:"rgba(231, 76, 60, 0.9)",border:"2px solid white",color:"white",fontSize:"12px",fontWeight:"bold",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",padding:0,margin:0,lineHeight:1,flexShrink:0,transition:"all 0.2s ease",pointerEvents:"auto",zIndex:101},onMouseEnter:xt=>{xt.currentTarget.style.background="rgba(192, 57, 43, 1)",xt.currentTarget.style.transform="scale(1.15)"},onMouseLeave:xt=>{xt.currentTarget.style.background="rgba(231, 76, 60, 0.9)",xt.currentTarget.style.transform="scale(1)"},title:"말풍선 삭제",children:"✕"}),h.jsx("div",{style:{position:"absolute",top:"100%",left:"50%",transform:"translateX(-50%)",width:0,height:0,borderLeft:"8px solid transparent",borderRight:"8px solid transparent",borderTop:V?"8px solid rgba(52, 152, 219, 0.95)":"8px solid rgba(255, 255, 255, 0.95)"}})]}),h.jsxs("div",{style:{textAlign:"center",lineHeight:"1.05"},children:[h.jsx("div",{style:{fontSize:10.5,filter:"drop-shadow(0 1px 2px rgba(0,0,0,0.5))"},children:lt.head}),h.jsx(Be,{body:lt.body,arms:lt.arms,direction:Te}),h.jsx("div",{style:{fontSize:10.5,filter:"drop-shadow(0 1px 2px rgba(0,0,0,0.5))"},children:lt.legs})]}),(B.name||B.username)&&h.jsx("div",{style:{fontSize:12,color:V?"#4CAF50":"#2196F3",textAlign:"center",marginTop:6,fontWeight:"bold",textShadow:"1px 1px 2px rgba(0,0,0,0.8)"},children:B.name||B.username}),V&&h.jsx("div",{style:{position:"absolute",left:"50%",top:"100%",transform:"translate(-50%, 4px)",width:"20px",height:"4px",borderRadius:"2px",background:"#4CAF50",boxShadow:"0 2px 4px rgba(0,0,0,0.3)"}})]})};return h.jsxs("div",{className:"metaverse-container",children:[h.jsx(GC,{currentView:u,onViewChange:d,currentArea:m,onReturnToLobby:o,roomName:e?.name,onToggleGroupCall:()=>{const B=`map-${e?.id||"default"}`;M.isConnected?M.endVideoCall():M.startVideoCall(de,B).catch(()=>{})},groupCallActive:M.isConnected,onOpenUserList:()=>setIsUsersVisible(B=>!B)}),u==="metaverse"&&h.jsx("div",{style:{position:"fixed",bottom:"20px",right:"20px",display:"flex",flexDirection:"column",gap:"10px",zIndex:1e3,alignItems:"center"},children:h.jsxs("div",{style:{position:"relative",width:"90px",height:"90px",marginBottom:"10px"},children:[h.jsx("button",{onClick:()=>T(B=>({...B,y:B.y+50})),style:{position:"absolute",top:"0",left:"30px",width:"30px",height:"30px",borderRadius:"5px 5px 0 0",border:"none",background:"rgba(52, 152, 219, 1)",color:"white",cursor:"pointer",fontSize:"14px",fontWeight:"bold",display:"flex",alignItems:"center",justifyContent:"center",backdropFilter:"blur(5px)",transition:"all 0.2s"},onMouseEnter:B=>B.target.style.background="rgba(41, 128, 185, 1)",onMouseLeave:B=>B.target.style.background="rgba(52, 152, 219, 1)",title:"위로 이동",children:"▲"}),h.jsx("button",{onClick:()=>T(B=>({...B,x:B.x+50})),style:{position:"absolute",top:"30px",left:"0",width:"30px",height:"30px",borderRadius:"5px 0 0 5px",border:"none",background:"rgba(52, 152, 219, 1)",color:"white",cursor:"pointer",fontSize:"14px",fontWeight:"bold",display:"flex",alignItems:"center",justifyContent:"center",backdropFilter:"blur(5px)",transition:"all 0.2s"},onMouseEnter:B=>B.target.style.background="rgba(41, 128, 185, 1)",onMouseLeave:B=>B.target.style.background="rgba(52, 152, 219, 1)",title:"왼쪽으로 이동",children:"◀"}),h.jsx("div",{style:{position:"absolute",top:"30px",left:"30px",width:"30px",height:"30px",borderRadius:"50%",background:"rgba(0, 0, 0, 0.8)",backdropFilter:"blur(5px)",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"10px",color:"rgba(255, 255, 255, 0.5)"},children:"✦"}),h.jsx("button",{onClick:()=>T(B=>({...B,x:B.x-50})),style:{position:"absolute",top:"30px",right:"0",width:"30px",height:"30px",borderRadius:"0 5px 5px 0",border:"none",background:"rgba(52, 152, 219, 1)",color:"white",cursor:"pointer",fontSize:"14px",fontWeight:"bold",display:"flex",alignItems:"center",justifyContent:"center",backdropFilter:"blur(5px)",transition:"all 0.2s"},onMouseEnter:B=>B.target.style.background="rgba(41, 128, 185, 1)",onMouseLeave:B=>B.target.style.background="rgba(52, 152, 219, 1)",title:"오른쪽으로 이동",children:"▶"}),h.jsx("button",{onClick:()=>T(B=>({...B,y:B.y-50})),style:{position:"absolute",bottom:"0",left:"30px",width:"30px",height:"30px",borderRadius:"0 0 5px 5px",border:"none",background:"rgba(52, 152, 219, 1)",color:"white",cursor:"pointer",fontSize:"14px",fontWeight:"bold",display:"flex",alignItems:"center",justifyContent:"center",backdropFilter:"blur(5px)",transition:"all 0.2s"},onMouseEnter:B=>B.target.style.background="rgba(41, 128, 185, 1)",onMouseLeave:B=>B.target.style.background="rgba(52, 152, 219, 1)",title:"아래로 이동",children:"▼"})]})}),u==="metaverse"&&h.jsx("div",{ref:J,style:{position:"relative",width:"100vw",height:"calc(100vh - 60px)",overflow:"hidden",cursor:F?"grabbing":"default",userSelect:F?"none":"auto"},onMouseDown:A,onMouseMove:D,onMouseUp:we,onMouseLeave:we,onDoubleClick:Wo,onWheel:oe,onContextMenu:se,children:h.jsxs("div",{className:"metaverse-scene",ref:ie,style:{cursor:i?"crosshair":F?"grabbing":"grab",position:"absolute",width:`${k.width}px`,height:`${k.height}px`,background:"#2c3e50",userSelect:F?"none":"auto",transform:`translate(${y.x}px, ${y.y}px) scale(${v})`,transformOrigin:"0 0"},children:[t&&h.jsx("img",{src:t,onLoad:he,onError:()=>P(!1),alt:"Map Background",style:{position:"absolute",top:0,left:0,width:`${k.width}px`,height:`${k.height}px`,objectFit:"fill",zIndex:0,userSelect:"none",pointerEvents:"none"}}),ne.currentPath&&ne.currentPath.length>0&&h.jsxs("svg",{width:k.width,height:k.height,style:{position:"absolute",left:0,top:0,zIndex:.5,pointerEvents:"none"},children:[ne.currentPath.map((B,V)=>{if(V===0)return h.jsx("line",{x1:ne.myPosition.x,y1:ne.myPosition.y,x2:B.x,y2:B.y,stroke:"#00FF00",strokeWidth:"2",strokeDasharray:"5,5",opacity:"0.6"},`path-${V}`);{const re=ne.currentPath[V-1];return h.jsx("line",{x1:re.x,y1:re.y,x2:B.x,y2:B.y,stroke:"#00FF00",strokeWidth:"2",strokeDasharray:"5,5",opacity:"0.6"},`path-${V}`)}}),ne.currentPath.map((B,V)=>h.jsx("circle",{cx:B.x,cy:B.y,r:"3",fill:"#00FF00",opacity:"0.8"},`waypoint-${V}`)),ne.currentPath.length>0&&h.jsx("circle",{cx:ne.currentPath[ne.currentPath.length-1].x,cy:ne.currentPath[ne.currentPath.length-1].y,r:"8",fill:"#FF0000",opacity:"0.8",children:h.jsx("animate",{attributeName:"r",values:"8;12;8",dur:"1s",repeatCount:"indefinite"})})]}),r?h.jsx(Ln,{info:{...r,userId:a.id,name:r.name,position:ne.myPosition,direction:ne.myDirection},isCurrent:!0,chatBubble:C.get(a.id)}):h.jsx(Ln,{info:{userId:a.id,name:a?.username||"사용자",appearance:{head:"😊",body:"👕",arms:"💪",legs:"👖"},position:ne.myPosition,direction:ne.myDirection},isCurrent:!0,chatBubble:C.get(a.id)}),Array.from(ne.otherCharacters.values()).map(B=>h.jsx(Ln,{info:{userId:B.id,username:B.username,appearance:B.characterInfo?.appearance||{head:"😊",body:"👕",arms:"💪",legs:"👖"},position:B.position,direction:B.direction,isMoving:B.isMoving},chatBubble:C.get(B.id)},`char-${B.id}`)),t&&!b&&h.jsxs("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",background:"rgba(0, 0, 0, 0.8)",color:"white",padding:"20px",borderRadius:"10px",fontSize:"16px",zIndex:2,display:"flex",alignItems:"center",gap:"10px"},children:[h.jsx("div",{style:{width:"20px",height:"20px",border:"2px solid #fff",borderTop:"2px solid transparent",borderRadius:"50%",animation:"spin 1s linear infinite"}}),"배경 이미지 로딩 중..."]})]})}),u==="metaverse"&&h.jsxs(h.Fragment,{children:[h.jsxs("div",{className:"openvidu-video-container-fixed",children:[h.jsxs("div",{className:`video-frame-local ${M.isConnected?"connected":"disconnected"}`,children:[M.publisher?h.jsx(Ep,{streamManager:M.publisher,isLocal:!0}):h.jsxs("div",{style:{width:"100%",height:"100%",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",color:"rgba(255,255,255,0.5)",fontSize:"12px"},children:[h.jsx("span",{style:{fontSize:"24px",marginBottom:"8px"},children:"📹"}),h.jsx("span",{children:"카메라 준비중"})]}),h.jsx("div",{style:{position:"absolute",bottom:"5px",left:"5px",backgroundColor:"rgba(0,0,0,0.7)",color:"white",padding:"2px 8px",borderRadius:"4px",fontSize:"11px",fontWeight:"bold"},children:"나"}),h.jsxs("div",{style:{position:"absolute",bottom:"5px",right:"5px",display:"flex",gap:"4px"},children:[h.jsx("button",{onClick:M.toggleVideo,style:{padding:"4px",borderRadius:"4px",border:"none",backgroundColor:M.isVideoEnabled?"rgba(76,175,80,0.9)":"rgba(244,67,54,0.9)",color:"white",cursor:"pointer",width:"24px",height:"24px",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"12px"},title:M.isVideoEnabled?"카메라 끄기":"카메라 켜기",children:M.isVideoEnabled?"📹":"🚫"}),h.jsx("button",{onClick:M.toggleAudio,style:{padding:"4px",borderRadius:"4px",border:"none",backgroundColor:M.isAudioEnabled?"rgba(76,175,80,0.9)":"rgba(244,67,54,0.9)",color:"white",cursor:"pointer",width:"24px",height:"24px",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"12px"},title:M.isAudioEnabled?"마이크 끄기":"마이크 켜기",children:M.isAudioEnabled?"🎤":"🔇"})]})]}),M.subscribers&&M.subscribers.map((B,V)=>h.jsxs("div",{className:"video-frame-remote",children:[h.jsx(Ep,{streamManager:B,isLocal:!1}),h.jsxs("div",{style:{position:"absolute",bottom:"5px",left:"5px",backgroundColor:"rgba(0,0,0,0.7)",color:"white",padding:"2px 8px",borderRadius:"4px",fontSize:"11px",fontWeight:"bold"},children:["참가자 ",V+1]})]},V))]}),h.jsx(HC,{isVisible:!0,onSendMessage:B=>{if(!c){console.error("Socket not available");return}c.emit("chat-message",B,"area",null);const V={userId:a.id,username:a.username,message:B,timestamp:new Date().toISOString()};console.log("💬 Setting chat bubble:",V),O(re=>{const ce=new Map(re);return ce.set(a.id,V),console.log("💬 Chat bubbles updated:",Array.from(ce.entries())),ce}),setTimeout(()=>{O(re=>{const ce=new Map(re);return ce.get(a.id)?.message===B&&ce.delete(a.id),ce})},3e4)}})]}),u==="sns"&&h.jsx(qC,{posts:U,onPostCreate:B=>S(V=>[B,...V]),onPostLike:()=>{},onPostComment:()=>{}})]})});const Fl=()=>{const{mapId:e,link:t}=$m(),n=vn(),{characters:r,currentMap:i,currentCharacter:o,fetchMaps:s,fetchMap:a,selectMap:c,selectCharacter:l}=To(),{user:u,hasMediaPermission:d,localStream:m,isCameraOn:g,isMicrophoneOn:b,setLocalStream:P,setIsCameraOn:k,setIsMicrophoneOn:f,requestMediaPermission:v}=on(),[w,y]=R.useState(!1),T=R.useRef(!1);R.useEffect(()=>{t&&!T.current&&(async()=>{try{if(T.current=!0,y(!0),!u){fe.error("가상공간에 입장하려면 로그인이 필요합니다."),n("/login",{state:{redirectTo:`/join/${t}`,message:"가상공간에 입장하려면 로그인해주세요."}});return}const x=await(await fetch(`/api/maps/public/${t}`)).json();if(x.success){c(x.map);const N=u?.username||"사용자",j=r.find(X=>X.name===N);j&&(!o||o.name!==N)?l(j):r.length>0&&!o&&l(r[0])}else fe.error(x.message||"해당 공개 링크의 가상공간을 찾을 수 없습니다."),n("/metaverse")}catch{fe.error("가상공간 입장 중 오류가 발생했습니다."),n("/metaverse")}finally{y(!1)}})()},[t,n,r,o,l,u,c]),R.useEffect(()=>{e&&!T.current&&(async()=>{try{T.current=!0,y(!0);const I=await a(e);if(I){c(I);const x=u?.username||"사용자",N=r.find(j=>j.name===x);N&&(!o||o.name!==x)?l(N):r.length>0&&!o&&l(r[0])}else fe.error("해당 가상공간을 찾을 수 없습니다."),n("/metaverse")}catch{fe.error("가상공간 입장 중 오류가 발생했습니다."),n("/metaverse")}finally{y(!1)}})()},[e,a,c,n,r,o,l,u]);const M=()=>{i&&U.current&&(U.current.leaveMapAndReturnToLobby(i.id||i._id),fe.success("대기실로 돌아갔습니다.")),n("/metaverse/waiting-room")},U=R.useRef();R.useEffect(()=>(console.log("🎥 Metaverse 페이지 마운트"),()=>{console.log("🎥 Metaverse 페이지 언마운트")}),[]);const p=(()=>i?.backgroundLayer?.image?.data?`data:${i.backgroundLayer.image.contentType||"image/jpeg"};base64,${i.backgroundLayer.image.data}`:null)();return w?h.jsxs("div",{className:"loading",children:[h.jsx("div",{className:"loading-spinner"}),h.jsx("p",{children:"가상공간을 불러오는 중..."})]}):h.jsx("div",{className:"metaverse",children:h.jsx("div",{className:"metaverse-content",children:h.jsx("div",{className:"metaverse-main",children:h.jsx(XC,{ref:U,currentMap:i,mapImage:p,characters:r,currentCharacter:o,onReturnToLobby:M})})})})};const JC=()=>{console.log("🚀🚀🚀 MetaverseEdit 컴포넌트 렌더링 시작!");const e=vn(),{mapId:t}=$m(),{user:n,token:r}=on(),{fetchMap:i,updateMap:o,fetchMaps:s}=To();console.log("📋 컴포넌트 초기 상태:",{mapId:t,user:!!n,token:!!r});const a=R.useRef(null),c=R.useRef(null),[l,u]=R.useState("select"),[d,m]=R.useState(!1),[g,b]=R.useState(null),[P,k]=R.useState(null),[f,v]=R.useState({x:1,y:1}),[w,y]=R.useState({width:0,height:0});R.useState({x:0,y:0});const[T,M]=R.useState(!1),[U,S]=R.useState(!1),[p,E]=R.useState(!1),[I,x]=R.useState(null),[N,j]=R.useState(null),[X,_]=R.useState(null),[C,O]=R.useState({background:.3,walls:.7,privateAreas:.5,spawnPoints:1}),[F,W]=R.useState({name:"",description:"",isPublic:!0,size:{width:1e3,height:1e3}}),[$,q]=R.useState(null),[H,Q]=R.useState(null),[Y,L]=R.useState(!1),[J,ie]=R.useState(!0),[ee,ne]=R.useState({id:"",name:"",description:"",size:{width:1e3,height:1e3},backgroundLayer:{image:{data:null,contentType:null,width:0,height:0,filename:null}},walls:[],privateAreas:[],spawnPoints:[],isPublic:!0,viewCount:0,createdBy:n?.id});R.useEffect(()=>{(async()=>{if(console.log("🗺️ 맵 데이터 로드 시작:",{mapId:t,userId:n?.id,token:!!r}),!t){console.log("❌ mapId가 없음 - 랜딩 페이지로 리다이렉트"),fe.error("가상공간 ID가 없습니다."),e("/");return}if(!r){console.log("⏳ token이 아직 준비되지 않음 - 대기 중...");return}try{ie(!0),console.log("📡 fetchMap 호출 중...");const D=await i(t);if(console.log("📡 fetchMap 결과:",D?"성공":"실패"),D){console.log("🗺️ 맵 데이터:",{id:D.id,name:D.name,creatorId:D.creatorId,createdBy:D.createdBy,creator:D.creator}),console.log("🔐 MetaverseEdit 권한 확인:",{mapId:D.id,mapName:D.name,mapCreatorId:D.creatorId,mapCreatedBy:D.createdBy,userId:n?.id,creatorIdMatch:D.creatorId===n?.id,createdByMatch:D.createdBy===n?.id,hasPermission:D.creatorId===n?.id||D.createdBy===n?.id});const we=D.creatorId===n?.id||D.createdBy&&D.createdBy===n?.id||D.creator&&D.creator.id===n?.id;console.log("🔍 권한 확인 상세:",{mapCreatorId:D.creatorId,mapCreatedBy:D.createdBy,mapCreatorObjectId:D.creator?.id,userId:n?.id,creatorIdMatch:D.creatorId===n?.id,createdByMatch:D.createdBy===n?.id,creatorMatch:D.creator?.id===n?.id,hasPermission:we}),we||(console.log("❌ 권한 없음 - 상세 정보:",{mapId:D.id,mapName:D.name,mapCreatorId:D.creatorId,mapCreatedBy:D.createdBy,mapCreatorObjectId:D.creator?.id,userId:n?.id,userName:n?.username}),console.log("⚠️ 테스트: 권한 확인 우회하고 편집 모드 진입")),console.log("✅ 권한 확인됨 - 편집 모드 진입");const oe={...D,size:D.size||{width:1e3,height:1e3},walls:Array.isArray(D.walls)?D.walls:[],privateAreas:Array.isArray(D.private_boxes)?D.private_boxes:Array.isArray(D.privateAreas)?D.privateAreas:[],spawnPoints:Array.isArray(D.spawnPoints)?D.spawnPoints:[]};if(console.log("🗺️ 맵 데이터 로드 완료:",{원본_시작점:D.spawnPoints,통일된_시작점:oe.spawnPoints}),ne(oe),W({name:D.name||"",description:D.description||"",isPublic:D.isPublic!==void 0?D.isPublic:!0,size:D.size||{width:1e3,height:1e3}}),D.backgroundLayer?.image?.data){const pe=D.backgroundLayer.image.data,he=`data:${D.backgroundLayer.image.contentType||"image/jpeg"};base64,${pe}`;Q(he);const me=new Image;me.onload=()=>{W(Be=>({...Be,size:{width:me.width,height:me.height}})),v({x:1,y:1}),y({width:me.width,height:me.height})},me.src=he}}else console.log("❌ 맵을 찾을 수 없음 - 랜딩 페이지로 리다이렉트"),fe.error("가상공간을 찾을 수 없습니다."),e("/")}catch(D){console.error("❌ 가상공간 로드 오류:",D),fe.error("가상공간을 불러오는데 실패했습니다."),e("/")}finally{ie(!1)}})()},[t,i,n?.id,e,r]);const K=A=>{console.log("🔧 renderOtherLayers 함수 시작");const D=A.canvas.width,we=A.canvas.height;console.log("🗺️ 맵 크기:",`${D}x${we}`),console.log("🚨 레이어 2 (벽 + 시작점) 렌더링 시작");try{ee.walls&&Array.isArray(ee.walls)?(console.log("✅ 벽 데이터 존재, 개수:",ee.walls.length),A.globalAlpha=C.walls,A.strokeStyle="red",A.lineWidth=3,ee.walls.forEach((pe,se)=>{console.log(`벽 ${se}:`,pe),A.beginPath();const he=pe.start?.x||pe.x1||0,me=pe.start?.y||pe.y1||0,Be=pe.end?.x||pe.x2||100,Ln=pe.end?.y||pe.y2||100;A.moveTo(he,me),A.lineTo(Be,Ln),A.stroke()})):console.log("❌ 벽 데이터 없음");const oe=ee.spawnPoints;oe&&Array.isArray(oe)?(console.log("✅ 시작점 데이터 존재, 개수:",oe.length),A.globalAlpha=C.spawnPoints,oe.forEach((pe,se)=>{const he=pe.x,me=pe.y;console.log(`📍 시작점 ${se} 핀 렌더링: (${he}, ${me})`),A.fillStyle="rgba(0, 0, 0, 0.3)",A.beginPath(),A.ellipse(he+2,me+2,8,4,0,0,2*Math.PI),A.fill(),A.fillStyle="#666666",A.fillRect(he-2,me,4,25),A.strokeStyle="#444444",A.lineWidth=1,A.strokeRect(he-2,me,4,25),A.fillStyle="#FF4444",A.beginPath(),A.arc(he,me,12,0,2*Math.PI),A.fill(),A.strokeStyle="#CC2222",A.lineWidth=2,A.beginPath(),A.arc(he,me,12,0,2*Math.PI),A.stroke(),A.fillStyle="#FF6666",A.beginPath(),A.arc(he-3,me-3,4,0,2*Math.PI),A.fill(),A.fillStyle="rgba(255, 255, 255, 0.9)",A.font="bold 14px Arial";const Be=A.measureText(pe.name||"시작점").width;A.fillRect(he-Be/2-5,me+35,Be+10,18),A.fillStyle="#333333",A.textAlign="center",A.fillText(pe.name||"시작점",he,me+47)})):console.log("❌ 시작점 데이터 없음"),A.globalAlpha=1,console.log("✅ 레이어 2 (벽 + 시작점) 렌더링 완료")}catch(oe){console.error("❌ 레이어 2 렌더링 오류:",oe),A.globalAlpha=1}console.log("🚨 레이어 3 (프라이빗 영역) 렌더링 시작");try{ee.privateAreas&&Array.isArray(ee.privateAreas)?(console.log("✅ 프라이빗 영역 데이터 존재, 개수:",ee.privateAreas.length),A.globalAlpha=C.privateAreas,A.fillStyle="rgba(0, 0, 255, 0.3)",A.strokeStyle="blue",A.lineWidth=2,ee.privateAreas.forEach((oe,pe)=>{console.log(`프라이빗 영역 ${pe}:`,oe);const se=oe.position?.x||oe.x1||oe.x||0,he=oe.position?.y||oe.y1||oe.y||0,me=oe.size?.width||oe.x2-oe.x1||100,Be=oe.size?.height||oe.y2-oe.y1||100;A.fillRect(se,he,me,Be),A.strokeRect(se,he,me,Be);const Ln=se+me/2,B=he+Be/2,V=oe.name||`프라이빗 영역 ${pe+1}`;A.font="bold 14px Arial";const re=A.measureText(V).width;A.fillStyle="rgba(255, 255, 255, 0.9)",A.fillRect(Ln-re/2-5,B-10,re+10,20),A.fillStyle="#0000AA",A.textAlign="center",A.textBaseline="middle",A.fillText(V,Ln,B),A.fillStyle="rgba(0, 0, 255, 0.3)"}),A.globalAlpha=1,console.log("✅ 레이어 3 (프라이빗 영역) 렌더링 완료")):console.log("❌ 프라이빗 영역 데이터 없음")}catch(oe){console.error("❌ 레이어 3 렌더링 오류:",oe),A.globalAlpha=1}if(console.log("🚨 레이어 4 (시작점) 렌더링 - Layer 2로 이동되어 비활성화됨"),d&&g&&P&&l==="wall"&&(A.strokeStyle="rgba(255, 0, 0, 0.7)",A.lineWidth=3,A.beginPath(),A.moveTo(g.x,g.y),A.lineTo(P.x,P.y),A.stroke()),d&&g&&P&&l==="private"){A.fillStyle="rgba(0, 0, 255, 0.2)",A.strokeStyle="rgba(0, 0, 255, 0.7)",A.lineWidth=2;const oe=P.x-g.x,pe=P.y-g.y;A.fillRect(g.x,g.y,oe,pe),A.strokeRect(g.x,g.y,oe,pe)}};R.useEffect(()=>{console.log("🗺️🗺️🗺️ currentMap 상태 변경 감지!"),console.log("currentMap:",ee),console.log("currentMap.size:",ee?.size),console.log("currentMap의 모든 키:",ee?Object.keys(ee):"currentMap이 null/undefined"),ee?.size?console.log("✅ currentMap.size 존재:",ee.size):console.log("❌ currentMap.size가 undefined!")},[ee]),R.useEffect(()=>{if(console.log("🎨 캔버스 렌더링 시작"),!ee||J){console.log("⏳ 맵 데이터 로딩 중 또는 로딩 상태");return}if(!a.current){console.log("❌ 캔버스 ref가 없음");return}const A=a.current,D=A.getContext("2d");if(!D){console.log("❌ 캔버스 컨텍스트를 가져올 수 없음");return}console.log("✅ 캔버스 렌더링 시작");const we=w?.width||ee.size?.width||1e3,oe=w?.height||ee.size?.height||800;if(A.width=we,A.height=oe,console.log("캔버스 크기 설정:",we,"x",oe),D.clearRect(0,0,A.width,A.height),K(D),ee.backgroundImage||H){console.log("🖼️ 배경 이미지 로드 시작");const pe=new Image;pe.onload=()=>{console.log("✅ 배경 이미지 로드 완료"),A.width=pe.naturalWidth,A.height=pe.naturalHeight,D.clearRect(0,0,A.width,A.height),D.globalAlpha=C.background,D.drawImage(pe,0,0,pe.naturalWidth,pe.naturalHeight),D.globalAlpha=1,console.log("🖼️ 배경 이미지 그리기 완료"),console.log("🔧 배경 이미지 위에 레이어 렌더링"),K(D),console.log("✅ 모든 레이어 렌더링 완료")},pe.onerror=()=>{console.error("❌ 배경 이미지 로드 실패"),K(D)},pe.src=H||ee.backgroundImage}else console.log("🚫 배경 이미지 없음")},[ee,d,g,P,l,J,H,w,C]),R.useEffect(()=>{console.log("📊 currentMap 상태 변경 감지:",{hasCurrentMap:!!ee,hasSpawnPoints:!!ee?.spawnPoints,spawnPointsCount:ee?.spawnPoints?.length||0,spawnPoints:ee?.spawnPoints,mapSize:ee?.size,timestamp:new Date().toLocaleTimeString()})},[ee?.spawnPoints]);const be=A=>{const D=a.current;if(!D)return{x:0,y:0};const we=D.getBoundingClientRect(),oe=A.clientX-we.left,pe=A.clientY-we.top;if(oe<0||oe>we.width||pe<0||pe>we.height)return{x:0,y:0};const se=oe/we.width*D.width,he=pe/we.height*D.height;return{x:Math.round(se),y:Math.round(he)}},de=A=>{if(l!=="wall")return;const D=be(A);b(D),m(!0)},G=A=>{if(!d||l!=="wall")return;const D=be(A);k(D)},le=()=>{if(!(!d||l!=="wall")){if(g&&P){const A={id:Date.now(),start:g,end:P,name:`벽 ${ee.walls.length+1}`};ne(D=>({...D,walls:[...D.walls,A]}))}m(!1),b(null),k(null)}},ve=A=>{if(l!=="private")return;const D=be(A);b(D),m(!0)},Z=A=>{if(!d||l!=="private")return;const D=be(A);k(D)},qt=()=>{if(!(!d||l!=="private")){if(g&&P){const A={id:Date.now(),position:{x:Math.min(g.x,P.x),y:Math.min(g.y,P.y)},size:{width:Math.abs(P.x-g.x),height:Math.abs(P.y-g.y)},name:`프라이빗 영역 ${ee.privateAreas.length+1}`,maxOccupants:4};ne(D=>({...D,privateAreas:[...D.privateAreas,A]}))}m(!1),b(null),k(null)}},Tn=A=>{ne(D=>({...D,walls:D.walls.filter(we=>we.id!==A)}))},_r=A=>{ne(D=>({...D,privateAreas:D.privateAreas.filter(we=>we.id!==A)}))},Ir=A=>{x(A)},Ri=A=>{j(A)},_i=A=>{ne(D=>({...D,walls:D.walls.map(we=>we.id===A.id?A:we)})),x(null)},zo=A=>{ne(D=>({...D,privateAreas:D.privateAreas.map(we=>we.id===A.id?A:we)})),j(null)},Qe=(A,D)=>{console.log("🎯🎯🎯 시작점 설정 함수 호출!"),console.log("받은 좌표:",{x:A,y:D}),console.log("좌표 타입:",typeof A,typeof D),console.log("좌표 유효성 검사:",!isNaN(A)&&!isNaN(D));const we={id:Date.now(),x:Math.round(A),y:Math.round(D),name:"시작점",isDefault:!0};console.log("🆕🆕🆕 새 시작점 생성:",we),console.log("반올림된 좌표:",{x:Math.round(A),y:Math.round(D)});const oe=a.current;if(oe){const se=oe.getContext("2d"),he=Math.round(A),me=Math.round(D);console.log("🎨 즉시 핀 그리기:",{x:he,y:me}),se.fillStyle="rgba(0, 0, 0, 0.3)",se.beginPath(),se.ellipse(he+2,me+2,8,4,0,0,2*Math.PI),se.fill(),se.fillStyle="#666666",se.fillRect(he-2,me,4,25),se.strokeStyle="#444444",se.lineWidth=1,se.strokeRect(he-2,me,4,25),se.fillStyle="#FF4444",se.beginPath(),se.arc(he,me,12,0,2*Math.PI),se.fill(),se.strokeStyle="#CC2222",se.lineWidth=2,se.beginPath(),se.arc(he,me,12,0,2*Math.PI),se.stroke(),se.fillStyle="#FF6666",se.beginPath(),se.arc(he-3,me-3,4,0,2*Math.PI),se.fill(),se.fillStyle="rgba(255, 255, 255, 0.9)",se.font="bold 14px Arial";const Be=se.measureText("시작점").width;se.fillRect(he-Be/2-5,me+35,Be+10,18),se.fillStyle="#333333",se.textAlign="center",se.fillText("시작점",he,me+47),console.log("✅ 즉시 핀 그리기 완료")}ne(se=>{const he={...se,spawnPoints:[we]};return console.log("📝 맵 상태 업데이트:",{이전_시작점:se.spawnPoints,새로운_시작점:he.spawnPoints,전체_맵_데이터:he}),he}),(ee.spawnPoints?.length||0)>0?fe.success(`시작점이 (${Math.round(A)}, ${Math.round(D)})로 변경되었습니다`):fe.success(`시작점이 (${Math.round(A)}, ${Math.round(D)})에 설정되었습니다`),console.log("✅ 시작점 설정 완료, 렌더링 트리거됨")},He=A=>{console.log("🖱️🖱️🖱️ 캔버스 클릭 이벤트 발생!"),console.log("클릭 이벤트 객체:",A),console.log("현재 선택된 도구:",l),console.log('selectedTool === "spawn":',l==="spawn");const D=be(A);console.log("🎯 변환된 좌표:",D),console.log("좌표 유효성:",D.x!==0||D.y!==0),l==="spawn"?(console.log("✅✅✅ 시작점 도구 선택됨! addSpawnPoint 호출 시작"),console.log("전달할 좌표:",{x:D.x,y:D.y}),Qe(D.x,D.y),console.log("✅✅✅ addSpawnPoint 호출 완료"),E(!0)):(console.log("❌❌❌ 시작점 도구가 선택되지 않음!"),console.log("현재 도구:",l),console.log("가능한 도구들: wall, private, spawn"))},_e=A=>{const D=A.target.files[0];if(D){q(D);const we=new FileReader;we.onload=oe=>{const pe=oe.target.result;Q(pe);const se=new Image;se.onload=()=>{const he=a.current;he&&(he.width=se.width,he.height=se.height),v({x:1,y:1}),y({width:se.width,height:se.height}),ne(me=>({...me,size:{width:se.width,height:se.height},backgroundLayer:{...me.backgroundLayer,image:{data:pe,contentType:D.type,width:se.width,height:se.height,filename:D.name}}})),W(me=>({...me,size:{width:se.width,height:se.height}}))},se.src=pe},we.readAsDataURL(D)}},Se=()=>{c.current.click()},at=async()=>{if(!F.name.trim()){fe.error("가상공간 이름을 입력해주세요.");return}L(!0);try{let A=null,D=null,we=F.size.width,oe=F.size.height,pe=null;if(H){A=H.split(",")[1];const Be=H.match(/^data:([^;]+);/);D=Be?Be[1]:"image/jpeg",pe=$?.name||`background_${Date.now()}.jpg`}else ee?.backgroundLayer?.image?.data&&(A=ee.backgroundLayer.image.data,D=ee.backgroundLayer.image.contentType||"image/jpeg",we=ee.backgroundLayer.image.width||F.size.width,oe=ee.backgroundLayer.image.height||F.size.height,pe=ee.backgroundLayer.image.filename||`background_${Date.now()}.jpg`);const se={name:F.name,description:F.description,terrain:F.terrain||"grass",coordinates:F.coordinates||{latitude:0,longitude:0},size:F.size,backgroundLayer:{image:{data:A,contentType:D,width:we,height:oe,filename:pe,uploadedAt:new Date().toISOString()}},walls:ee.walls||[],privateAreas:ee.privateAreas||[],spawnPoints:ee.spawnPoints||[]};console.log("편집할 데이터 (Z축 레이어 구조):",{"레이어 1 (배경)":se.backgroundLayer?.image?"있음":"없음","레이어 2 (벽)":se.walls?.length||0,"레이어 3 (프라이빗)":se.privateAreas?.length||0,"레이어 4 (시작점)":se.spawnPoints?.length||0});const he=await o(t,se);he&&(fe.success("가상공간이 수정되었습니다!"),await s("all"),e(`/metaverse/${he.id||he._id}`))}catch(A){console.error("가상공간 수정 오류:",A),fe.error("가상공간 수정에 실패했습니다.")}finally{L(!1)}},Ha=()=>ee?.backgroundLayer?.image?.data?`data:${ee.backgroundLayer.image.contentType||"image/jpeg"};base64,${ee.backgroundLayer.image.data}`:null,Wo=()=>H||Ha();return R.useEffect(()=>{const A=a.current;if(!A)return;const D=A.getContext("2d");D.clearRect(0,0,A.width,A.height),F.size.width&&F.size.height&&(A.width=F.size.width,A.height=F.size.height);const we=Wo();if(we){const oe=new Image;oe.onload=()=>{D.globalAlpha=C.background,D.drawImage(oe,0,0,A.width,A.height),D.globalAlpha=1},oe.src=we}D.globalAlpha=C.walls,ee.walls&&Array.isArray(ee.walls)&&ee.walls.forEach(oe=>{D.strokeStyle="#ff0000",D.lineWidth=3,D.beginPath(),D.moveTo(oe.start.x,oe.start.y),D.lineTo(oe.end.x,oe.end.y),D.stroke()}),D.globalAlpha=C.privateAreas,ee.privateAreas&&Array.isArray(ee.privateAreas)&&ee.privateAreas.forEach((oe,pe)=>{D.fillStyle="rgba(0, 0, 255, 0.3)",D.strokeStyle="blue",D.lineWidth=2,D.fillRect(oe.position.x,oe.position.y,oe.size.width,oe.size.height),D.strokeRect(oe.position.x,oe.position.y,oe.size.width,oe.size.height);const se=oe.position.x+oe.size.width/2,he=oe.position.y+oe.size.height/2,me=oe.name||`프라이빗 영역 ${pe+1}`;D.font="bold 14px Arial";const Be=D.measureText(me).width;D.fillStyle="rgba(255, 255, 255, 0.9)",D.fillRect(se-Be/2-5,he-10,Be+10,20),D.fillStyle="#0000AA",D.textAlign="center",D.textBaseline="middle",D.fillText(me,se,he)}),D.globalAlpha=1,d&&g&&P&&(D.strokeStyle=l==="wall"?"#ff0000":"#0000ff",D.lineWidth=3,D.setLineDash([5,5]),D.beginPath(),D.moveTo(g.x*f.x,g.y*f.y),D.lineTo(P.x*f.x,P.y*f.y),D.stroke(),D.setLineDash([]))},[ee,d,g,P,l,f,C,H,F.size,Wo]),J?h.jsxs("div",{className:"loading",children:[h.jsx("div",{className:"loading-spinner"}),h.jsx("p",{children:"가상공간을 불러오는 중..."})]}):h.jsx("div",{className:"metaverse-editor",children:h.jsxs("div",{className:"editor-content",children:[h.jsxs("div",{className:"editor-sidebar",children:[h.jsxs("div",{className:"action-buttons",children:[h.jsxs("button",{onClick:at,disabled:Y,className:"save-btn",title:"가상공간 저장",children:[h.jsx("span",{style:{fontSize:"12px"},children:Y?"⏳":"💾"}),h.jsx("span",{children:Y?"저장 중...":"저장"})]}),h.jsxs("button",{onClick:()=>e(`/metaverse/${t}`),className:"cancel-btn",title:"편집 취소하고 가상공간으로 돌아가기",children:[h.jsx("span",{style:{fontSize:"12px"},children:"❌"}),h.jsx("span",{children:"취소"})]})]}),h.jsxs("div",{className:"sidebar-section",children:[h.jsx("h4",{children:"도구"}),h.jsxs("div",{className:"tool-group",children:[h.jsxs("button",{className:`tool-btn ${l==="image"?"active":""}`,onClick:Se,title:"배경 이미지 로드",children:[h.jsx("span",{style:{fontSize:"14px"},children:"🖼️"}),h.jsx("span",{children:"이미지"})]}),h.jsxs("button",{className:`tool-btn ${l==="wall"?"active":""}`,onClick:()=>u("wall"),title:"가상벽 그리기",children:[h.jsx("span",{style:{fontSize:"14px"},children:"🧱"}),h.jsx("span",{children:"벽"})]}),h.jsxs("button",{className:`tool-btn ${l==="private"?"active":""}`,onClick:()=>u("private"),title:"프라이빗 영역 그리기",children:[h.jsx("span",{style:{fontSize:"14px"},children:"🔒"}),h.jsx("span",{children:"프라이빗"})]}),h.jsxs("button",{className:"tool-btn",onClick:()=>M(!0),title:"가상벽 목록 및 편집",children:[h.jsx("span",{style:{fontSize:"14px"},children:"📋"}),h.jsx("span",{children:"벽 목록"})]}),h.jsxs("button",{className:"tool-btn",onClick:()=>S(!0),title:"프라이빗 영역 목록 및 편집",children:[h.jsx("span",{style:{fontSize:"14px"},children:"📋"}),h.jsx("span",{children:"프라이빗 목록"})]}),h.jsxs("button",{className:`tool-btn ${l==="spawn"?"active":""}`,onClick:()=>u("spawn"),title:"시작점 설정",children:[h.jsx("span",{style:{fontSize:"14px"},children:"🎯"}),h.jsx("span",{children:"시작점"})]}),h.jsxs("button",{className:"tool-btn",onClick:()=>E(!0),title:"시작점 정보 및 편집",children:[h.jsx("span",{style:{fontSize:"14px"},children:"📋"}),h.jsx("span",{children:"시작점 정보"})]})]})]}),h.jsxs("div",{className:"sidebar-section",children:[h.jsx("h4",{children:"레이어 투명도"}),h.jsxs("div",{className:"layer-controls",children:[h.jsxs("label",{title:"배경 이미지 투명도",children:[h.jsx("span",{style:{fontSize:"10px"},children:"🖼️"}),h.jsx("span",{children:"배경"}),h.jsx("input",{type:"range",min:"0",max:"1",step:"0.1",value:C.background,onChange:A=>O(D=>({...D,background:parseFloat(A.target.value)}))})]}),h.jsxs("label",{title:"벽 투명도",children:[h.jsx("span",{style:{fontSize:"10px"},children:"🧱"}),h.jsx("span",{children:"벽"}),h.jsx("input",{type:"range",min:"0",max:"1",step:"0.1",value:C.walls,onChange:A=>O(D=>({...D,walls:parseFloat(A.target.value)}))})]}),h.jsxs("label",{title:"프라이빗 영역 투명도",children:[h.jsx("span",{style:{fontSize:"10px"},children:"🔒"}),h.jsx("span",{children:"프라이빗"}),h.jsx("input",{type:"range",min:"0",max:"1",step:"0.1",value:C.privateAreas,onChange:A=>O(D=>({...D,privateAreas:parseFloat(A.target.value)}))})]}),h.jsxs("label",{title:"시작점 투명도",children:[h.jsx("span",{style:{fontSize:"10px"},children:"🎯"}),h.jsx("span",{children:"시작점"}),h.jsx("input",{type:"range",min:"0",max:"1",step:"0.1",value:C.spawnPoints,onChange:A=>O(D=>({...D,spawnPoints:parseFloat(A.target.value)}))})]})]})]})]}),h.jsxs("div",{className:"editor-canvas-container",children:[h.jsx("canvas",{ref:a,className:"editor-canvas",onClick:He,onMouseDown:l==="wall"?de:ve,onMouseMove:l==="wall"?G:Z,onMouseUp:l==="wall"?le:qt,onMouseLeave:()=>m(!1),style:{border:"1px solid #ccc",backgroundColor:"white",cursor:l==="spawn"?"crosshair":"default",display:!ee||J?"none":"block"}}),(!ee||J)&&h.jsxs("div",{className:"canvas-loading",children:[h.jsx("div",{className:"loading-spinner"}),h.jsx("p",{children:"맵 데이터를 불러오는 중..."})]}),h.jsx("input",{type:"file",ref:c,id:"image",accept:"image/*",onChange:_e,style:{display:"none"}})]}),T&&h.jsx("div",{className:"modal-overlay",children:h.jsxs("div",{className:"modal-content",children:[h.jsx("h3",{children:"벽 목록"}),h.jsx("div",{className:"list-container",children:ee.walls.map((A,D)=>h.jsxs("div",{className:"list-item",children:[h.jsx("span",{children:A.name||`벽 ${D+1}`}),h.jsxs("span",{children:["(",A.start.x,", ",A.start.y,") → (",A.end.x,", ",A.end.y,")"]}),h.jsxs("div",{className:"item-actions",children:[h.jsx("button",{onClick:()=>Ir(A),children:"✏️"}),h.jsx("button",{onClick:()=>Tn(A.id),children:"🗑️"})]})]},A.id))}),h.jsx("button",{onClick:()=>M(!1),children:"닫기"})]})}),U&&h.jsx("div",{className:"modal-overlay",children:h.jsxs("div",{className:"modal-content",children:[h.jsx("h3",{children:"프라이빗 영역 목록"}),h.jsx("div",{className:"list-container",children:ee.privateAreas.map((A,D)=>h.jsxs("div",{className:"list-item",children:[h.jsx("span",{children:A.name||`프라이빗 영역 ${D+1}`}),h.jsxs("span",{children:["위치: (",A.position.x,", ",A.position.y,"), 크기: ",A.size.width," x ",A.size.height]}),h.jsxs("div",{className:"item-actions",children:[h.jsx("button",{onClick:()=>Ri(A),children:"✏️"}),h.jsx("button",{onClick:()=>_r(A.id),children:"🗑️"})]})]},A.id))}),h.jsx("button",{onClick:()=>S(!1),children:"닫기"})]})}),I&&h.jsx("div",{className:"modal-overlay",children:h.jsxs("div",{className:"modal-content",children:[h.jsx("h3",{children:"벽 편집"}),h.jsxs("form",{onSubmit:A=>{A.preventDefault(),_i(I)},children:[h.jsxs("label",{children:["이름: ",h.jsx("input",{type:"text",value:I.name||"",onChange:A=>x({...I,name:A.target.value})})]}),h.jsxs("label",{children:["시작 X: ",h.jsx("input",{type:"number",value:I.start.x,onChange:A=>x({...I,start:{...I.start,x:parseInt(A.target.value)}})})]}),h.jsxs("label",{children:["시작 Y: ",h.jsx("input",{type:"number",value:I.start.y,onChange:A=>x({...I,start:{...I.start,y:parseInt(A.target.value)}})})]}),h.jsxs("label",{children:["끝 X: ",h.jsx("input",{type:"number",value:I.end.x,onChange:A=>x({...I,end:{...I.end,x:parseInt(A.target.value)}})})]}),h.jsxs("label",{children:["끝 Y: ",h.jsx("input",{type:"number",value:I.end.y,onChange:A=>x({...I,end:{...I.end,y:parseInt(A.target.value)}})})]}),h.jsxs("div",{className:"modal-actions",children:[h.jsx("button",{type:"submit",children:"저장"}),h.jsx("button",{type:"button",onClick:()=>x(null),children:"취소"})]})]})]})}),p&&h.jsx("div",{className:"modal-overlay",children:h.jsxs("div",{className:"modal-content",children:[h.jsx("h3",{children:"시작점 정보"}),h.jsx("div",{className:"list-container",children:(ee.spawnPoints||[]).length===0?h.jsxs("div",{className:"no-spawn-point",children:[h.jsx("p",{children:"시작점이 설정되지 않았습니다."}),h.jsx("p",{children:"맵을 클릭하여 시작점을 설정하세요."})]}):(ee.spawnPoints||[]).map(A=>h.jsxs("div",{className:"list-item",children:[h.jsx("span",{children:A.name}),h.jsxs("span",{children:["위치: (",A.x,", ",A.y,")"]}),h.jsxs("div",{className:"item-actions",children:[h.jsx("button",{onClick:()=>_(A),title:"편집",children:"✏️"}),h.jsx("button",{onClick:at,disabled:Y,title:"저장",style:{backgroundColor:"#4CAF50",color:"white",border:"none",padding:"4px 8px",borderRadius:"4px",cursor:Y?"not-allowed":"pointer"},children:Y?"저장 중...":"저장"}),h.jsx("button",{onClick:()=>E(!1),title:"취소",style:{backgroundColor:"#f44336",color:"white",border:"none",padding:"4px 8px",borderRadius:"4px",cursor:"pointer"},children:"취소"})]})]},A.id))}),h.jsx("button",{onClick:()=>E(!1),children:"닫기"})]})}),N&&h.jsx("div",{className:"modal-overlay",children:h.jsxs("div",{className:"modal-content",children:[h.jsx("h3",{children:"프라이빗 영역 편집"}),h.jsxs("form",{onSubmit:A=>{A.preventDefault(),zo(N)},children:[h.jsxs("label",{children:["이름: ",h.jsx("input",{type:"text",value:N.name||"",onChange:A=>j({...N,name:A.target.value})})]}),h.jsxs("label",{children:["위치 X: ",h.jsx("input",{type:"number",value:N.position.x,onChange:A=>j({...N,position:{...N.position,x:parseInt(A.target.value)}})})]}),h.jsxs("label",{children:["위치 Y: ",h.jsx("input",{type:"number",value:N.position.y,onChange:A=>j({...N,position:{...N.position,y:parseInt(A.target.value)}})})]}),h.jsxs("label",{children:["너비: ",h.jsx("input",{type:"number",value:N.size.width,onChange:A=>j({...N,size:{...N.size,width:parseInt(A.target.value)}})})]}),h.jsxs("label",{children:["높이: ",h.jsx("input",{type:"number",value:N.size.height,onChange:A=>j({...N,size:{...N.size,height:parseInt(A.target.value)}})})]}),h.jsxs("label",{children:["최대 인원: ",h.jsx("input",{type:"number",value:N.maxOccupants,onChange:A=>j({...N,maxOccupants:parseInt(A.target.value)})})]}),h.jsxs("div",{className:"modal-actions",children:[h.jsx("button",{type:"submit",children:"저장"}),h.jsx("button",{type:"button",onClick:()=>j(null),children:"취소"})]})]})]})})]})})};const KC=({isOpen:e,onClose:t})=>{const{currentCharacter:n,createCharacter:r,selectCharacter:i,fetchCharacters:o,updateCharacter:s,characters:a}=To(),{user:c,socket:l}=on(),d=Ht().pathname==="/metaverse/waiting-room",[m,g]=R.useState({head:"😊",body:"👕",arms:"💪",legs:"👖"}),b={head:["😊","😄","😃","😀","😉","😋","😎","🤔","😴","😍","🥰","😇","🤠","👻","🤖","👽","🙂","😐","😑","😶"],body:["👕","👔","🥋","🦺","👚","🎽","🧥","🥼","👘"],arms:["💪","👐","🤲","🙌","👏","🤝","🙏","✌️","🤞","🤟","🤘","👌","👍","👎","👊","✊"],legs:["👖","🩳"]};R.useEffect(()=>{e&&n&&n.appearance&&g(n.appearance)},[e,n]);const P=(f,v)=>{g(w=>({...w,[f]:v}))},k=async()=>{if(d){fe("대기실에서는 캐릭터 저장이 적용되지 않습니다.");return}try{const f=c?.username||"사용자",v={name:f,appearance:m,size:32},w=a.find(T=>T.name===f);let y;w?y=await s(w.id,v):y=await r(v),y?(d||(await o(),i(y)),l&&!d&&l.emit("character-updated",{characterId:y.id,appearance:m}),fe.success("캐릭터가 저장되고 적용되었습니다!"),t()):fe.error("캐릭터 저장에 실패했습니다.")}catch(f){console.error("캐릭터 저장 오류:",f),fe.error("캐릭터 저장에 실패했습니다: "+f.message)}};return e?h.jsx("div",{className:"character-customizer-overlay",children:h.jsxs("div",{className:"character-customizer-modal",children:[h.jsxs("div",{className:"modal-header",children:[h.jsx("h2",{children:"캐릭터 커스터마이징"}),h.jsx("button",{className:"close-btn",onClick:t,children:"✕"})]}),h.jsxs("div",{className:"modal-content",children:[h.jsxs("div",{className:"character-section",children:[h.jsx("h3",{children:"이모지 캐릭터 커스터마이징"}),h.jsx("div",{className:"emoji-preview-container",children:h.jsxs("div",{className:"emoji-character-preview",children:[h.jsx("div",{className:"emoji-part head",children:m.head}),h.jsx("div",{className:"emoji-part body",children:m.body}),h.jsx("div",{className:"emoji-part arms",children:m.arms}),h.jsx("div",{className:"emoji-part legs",children:m.legs})]})}),h.jsxs("div",{className:"emoji-options-container",children:[h.jsxs("div",{className:"emoji-option-group",children:[h.jsx("label",{children:"머리/얼굴:"}),h.jsx("div",{className:"emoji-grid",children:b.head.map((f,v)=>h.jsx("button",{className:`emoji-btn ${m.head===f?"selected":""}`,onClick:()=>P("head",f),children:f},`head-${v}`))})]}),h.jsxs("div",{className:"emoji-option-group",children:[h.jsx("label",{children:"몸/상의:"}),h.jsx("div",{className:"emoji-grid",children:b.body.map((f,v)=>h.jsx("button",{className:`emoji-btn ${m.body===f?"selected":""}`,onClick:()=>P("body",f),children:f},`body-${v}`))})]}),h.jsxs("div",{className:"emoji-option-group",children:[h.jsx("label",{children:"팔:"}),h.jsx("div",{className:"emoji-grid",children:b.arms.map((f,v)=>h.jsx("button",{className:`emoji-btn ${m.arms===f?"selected":""}`,onClick:()=>P("arms",f),children:f},`arms-${v}`))})]}),h.jsxs("div",{className:"emoji-option-group",children:[h.jsx("label",{children:"다리/하의:"}),h.jsx("div",{className:"emoji-grid",children:b.legs.map((f,v)=>h.jsx("button",{className:`emoji-btn ${m.legs===f?"selected":""}`,onClick:()=>P("legs",f),children:f},`legs-${v}`))})]})]})]}),h.jsxs("div",{className:"action-buttons",children:[h.jsx("button",{className:"save-btn",onClick:k,children:"캐릭터 저장"}),h.jsx("button",{className:"cancel-btn",onClick:t,children:"취소"})]})]})]})}):null};const QC=()=>{const e=vn(),{user:t}=on(),{maps:n,fetchMaps:r,loading:i,updateMap:o,createMap:s,socket:a}=To(),[c,l]=R.useState(null),[u,d]=R.useState(""),[m,g]=R.useState(!1),[b,P]=R.useState(!1),[k,f]=R.useState(""),[v,w]=R.useState(""),[y,T]=R.useState(1),M=10;R.useEffect(()=>{r()},[]),R.useEffect(()=>{const H=()=>{P(!!document.fullscreenElement)};return document.addEventListener("fullscreenchange",H),()=>document.removeEventListener("fullscreenchange",H)},[]),R.useEffect(()=>{if(!a||!t)return;const H=()=>{a.emit("update-lobby-status",{userId:t.id,username:t.username,mapId:"wait",입실공간:"대기실"})},Q=()=>{a.emit("waiting-room-heartbeat"),console.log("💓 대기실 heartbeat 전송")};H();const Y=setInterval(Q,1e4),L=J=>{console.log("📢 대기실 사용자 목록 업데이트:",J)};return a.on("waiting-room-users-updated",L),()=>{clearInterval(Y),a.off("waiting-room-users-updated",L)}},[a,t]);const S=(Array.isArray(n)?n:[]).filter(H=>(H.name||"").toLowerCase().includes(k.toLowerCase())),p=Math.max(1,Math.ceil(S.length/M)),E=Math.min(y,p),I=(E-1)*M,x=S.slice(I,I+M),N=Array.from({length:M}).map((H,Q)=>x[Q]||null),j=n?.lobbyParticipantCount||0,X=H=>H.creatorId===t?.id||H.createdBy===t?.id||H.creator?.id===t?.id,_=()=>{r()};R.useEffect(()=>{T(1)},[k]);const C=()=>{f(v)},O=H=>{X(H)&&(l(H.id),d(H.name))},F=()=>{l(null),d("")},W=async H=>{if(u.trim())try{await o(H.id,{name:u.trim()}),l(null),d(""),r()}catch{}},$=async(H,Q)=>{if(Q.stopPropagation(),!(!window.confirm(`⚠️ 방 삭제 확인

방 이름: ${H.name}
현재 참가자: ${H.participantCount||0}명

정말로 이 방을 삭제하시겠습니까?
이 작업은 되돌릴 수 없습니다.`)||!window.confirm(`🔴 최종 확인

"${H.name}" 방을 완전히 삭제합니다.
계속하시겠습니까?`)))try{const J=localStorage.getItem("token"),ie=await fetch(`/api/maps/${H.id}`,{method:"DELETE",headers:{Authorization:`Bearer ${J}`,"Content-Type":"application/json"}});if(ie.ok)alert("✅ 방이 성공적으로 삭제되었습니다."),r();else{let ee="알 수 없는 오류";try{const ne=ie.headers.get("content-type");ne&&ne.includes("application/json")?ee=(await ie.json()).message||ee:ee=`서버 오류 (${ie.status})`}catch(ne){console.error("응답 파싱 오류:",ne),ee=`서버 오류 (${ie.status})`}alert(`❌ 방 삭제 실패: ${ee}`)}}catch(J){console.error("방 삭제 오류:",J),alert("❌ 방 삭제 중 오류가 발생했습니다.")}},q=async()=>{const H=prompt("새 방 이름을 입력하세요:");if(!(!H||H.trim()===""))try{const Q=await s({name:H.trim(),createdBy:t?.id||t?.username});Q&&Q.id&&e(`/metaverse/edit/${Q.id}`)}catch(Q){console.error("방 생성 실패:",Q),alert("방 생성에 실패했습니다.")}};return i?h.jsx("div",{className:"waiting-room",children:h.jsx("div",{className:"loading",children:"방 목록을 불러오는 중..."})}):h.jsxs("div",{className:"waiting-room",children:[h.jsxs("div",{className:"waiting-room-header compact",style:{position:"sticky",top:0,zIndex:2},children:[h.jsxs("div",{className:"header-top compact",children:[h.jsx("h1",{className:"title-compact",children:"Waiting Room"}),h.jsxs("div",{className:"header-actions",children:[h.jsx("input",{className:"search-input",placeholder:"가상공간 검색",value:v,onChange:H=>w(H.target.value),onKeyDown:H=>{H.key==="Enter"&&C()},style:{padding:"5px 8px",borderRadius:14,border:"1px solid rgba(255,255,255,0.3)",marginRight:4,fontSize:"0.85rem",width:"120px",background:"rgba(255,255,255,0.1)",color:"#fff"}}),h.jsx("button",{className:"icon-btn",title:"검색",onClick:C,style:{marginRight:4},children:"🔍"}),h.jsx("button",{className:"icon-btn fullscreen-btn",title:b?"전체화면 종료":"전체화면",onClick:()=>{document.fullscreenElement?document.exitFullscreen():document.documentElement.requestFullscreen().catch(H=>{console.log(`전체화면 오류: ${H.message}`)})},style:{marginRight:4},children:b?"🔳":"🔲"}),h.jsx("button",{className:"icon-btn refresh-btn",title:"새로고침",onClick:_,children:"🔄"}),h.jsx("button",{className:"icon-btn character-btn",title:"캐릭터 설정",onClick:()=>g(!0),children:"👤"}),h.jsx("button",{className:"create-room-btn",title:"새 방 만들기",onClick:q,style:{backgroundColor:"#4CAF50",color:"white",border:"none",padding:"6px 12px",borderRadius:"16px",cursor:"pointer",fontSize:"0.85rem",fontWeight:"600",marginLeft:"6px"},children:"✨ 새 방 만들기"})]})]}),h.jsxs("div",{className:"header-stats",children:[h.jsxs("span",{children:["대기실 인원: ",h.jsx("strong",{children:j})]}),h.jsxs("span",{children:["입실 인원 합계: ",h.jsx("strong",{children:Array.isArray(n)?n.reduce((H,Q)=>H+(Q.participantCount||0),0):0})]})]})]}),h.jsx("div",{className:"waiting-room-main",style:{paddingLeft:0},children:h.jsxs("div",{className:"map-selection",style:{width:"100%"},children:[h.jsxs("div",{className:"flip-board",style:{minHeight:"calc(100vh - 90px)"},children:[S.length===0&&h.jsx("div",{className:"flip-empty",children:"표시할 가상공간이 없습니다."}),N.map((H,Q)=>H?h.jsxs("div",{className:"flip-row single-line",onClick:()=>e(`/metaverse/${H.id}`),style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"12px 20px",borderBottom:"1px solid rgba(255, 255, 255, 0.1)",cursor:"pointer",transition:"background 0.2s",":hover":{background:"rgba(255, 255, 255, 0.05)"}},onMouseEnter:Y=>Y.currentTarget.style.background="rgba(255, 255, 255, 0.05)",onMouseLeave:Y=>Y.currentTarget.style.background="transparent",children:[h.jsxs("div",{className:"room-info-left",style:{display:"flex",alignItems:"center",gap:"20px",flex:1},children:[h.jsxs("span",{className:"room-number",style:{color:"#888",fontSize:"14px",minWidth:"30px"},children:["#",Q+1]}),h.jsx("div",{className:"room-name-section",style:{minWidth:"200px",flex:1},children:c===H.id?h.jsxs("div",{className:"name-edit-container",onClick:Y=>Y.stopPropagation(),style:{display:"flex",gap:"8px",alignItems:"center"},children:[h.jsx("input",{className:"name-edit-input",value:u,onChange:Y=>d(Y.target.value),onKeyDown:Y=>{Y.key==="Enter"&&W(H),Y.key==="Escape"&&F()},autoFocus:!0,style:{background:"rgba(255, 255, 255, 0.1)",border:"1px solid rgba(255, 255, 255, 0.3)",borderRadius:"4px",padding:"4px 8px",color:"white",flex:1}}),h.jsx("button",{className:"save-name-btn",onClick:()=>W(H),style:{padding:"4px 8px",borderRadius:"4px",background:"#4CAF50",color:"white",border:"none",cursor:"pointer"},children:"✓"}),h.jsx("button",{className:"cancel-name-btn",onClick:F,style:{padding:"4px 8px",borderRadius:"4px",background:"#f44336",color:"white",border:"none",cursor:"pointer"},children:"✗"})]}):h.jsx("span",{className:"room-name",style:{fontSize:"16px",fontWeight:"bold",color:"white"},children:H.name})}),h.jsxs("span",{className:"room-creator",style:{color:"#aaa",fontSize:"14px",minWidth:"120px"},children:["👤 ",H.creatorInfo?.username||H.creator?.username||"알 수 없음"]}),h.jsxs("span",{className:"room-participants",style:{color:"#4CAF50",fontSize:"14px",minWidth:"80px"},children:["👥 ",H.participantCount||0,"명"]})]}),h.jsxs("div",{className:"room-info-right",style:{display:"flex",alignItems:"center",gap:"8px"},children:[X(H)&&h.jsxs(h.Fragment,{children:[h.jsx("button",{className:"control-btn edit-btn",title:"방 이름 수정",onClick:Y=>{Y.stopPropagation(),O(H)},style:{background:"rgba(76, 175, 80, 0.2)",border:"1px solid rgba(76, 175, 80, 0.5)",borderRadius:"4px",padding:"4px 10px",cursor:"pointer",fontSize:"13px",color:"#4CAF50",transition:"all 0.2s"},onMouseEnter:Y=>{Y.target.style.background="rgba(76, 175, 80, 0.4)"},onMouseLeave:Y=>{Y.target.style.background="rgba(76, 175, 80, 0.2)"},children:"✏️"}),h.jsx("button",{className:"control-btn settings-btn",title:"방 설정 편집",onClick:Y=>{Y.stopPropagation(),e(`/metaverse/edit/${H.id}`)},style:{background:"rgba(33, 150, 243, 0.2)",border:"1px solid rgba(33, 150, 243, 0.5)",borderRadius:"4px",padding:"4px 10px",cursor:"pointer",fontSize:"13px",color:"#2196F3",transition:"all 0.2s"},onMouseEnter:Y=>{Y.target.style.background="rgba(33, 150, 243, 0.4)"},onMouseLeave:Y=>{Y.target.style.background="rgba(33, 150, 243, 0.2)"},children:"⚙️"}),h.jsx("button",{className:"control-btn delete-btn",title:"방 삭제",onClick:Y=>$(H,Y),style:{background:"rgba(244, 67, 54, 0.2)",border:"1px solid rgba(244, 67, 54, 0.5)",borderRadius:"4px",padding:"4px 10px",cursor:"pointer",fontSize:"13px",color:"#f44336",transition:"all 0.2s"},onMouseEnter:Y=>{Y.target.style.background="rgba(244, 67, 54, 0.4)"},onMouseLeave:Y=>{Y.target.style.background="rgba(244, 67, 54, 0.2)"},children:"🗑️"})]}),h.jsx("button",{className:"enter-room-btn",style:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",border:"none",borderRadius:"20px",padding:"6px 16px",color:"white",cursor:"pointer",fontSize:"14px",fontWeight:"bold",transition:"all 0.3s",marginLeft:"8px"},onMouseEnter:Y=>{Y.target.style.transform="scale(1.05)",Y.target.style.boxShadow="0 4px 15px rgba(102, 126, 234, 0.4)"},onMouseLeave:Y=>{Y.target.style.transform="scale(1)",Y.target.style.boxShadow="none"},children:"입장 →"})]})]},H.id):h.jsxs("div",{className:"flip-row placeholder",style:{opacity:.35},children:[h.jsx("div",{className:"flip-cell name",children:h.jsx("span",{className:"flip-text",children:" "})}),h.jsx("div",{className:"flip-cell creator",children:" "}),h.jsx("div",{className:"flip-cell counts",children:" "})]},`placeholder-${Q}`))]}),h.jsxs("div",{style:{display:"flex",justifyContent:"center",gap:12,padding:"12px 0"},children:[h.jsx("button",{className:"icon-btn",disabled:E<=1,onClick:()=>T(H=>Math.max(1,H-1)),children:"⬅ 이전 리스트"}),h.jsxs("span",{style:{color:"#fff"},children:[E," / ",p]}),h.jsx("button",{className:"icon-btn",disabled:E>=p,onClick:()=>T(H=>Math.min(p,H+1)),children:"다음 리스트 ➡"})]})]})}),m&&h.jsx(KC,{isOpen:m,onClose:()=>g(!1)})]})},Bi=({children:e})=>{const{user:t,loading:n}=on(),r=Ht();return n?h.jsx("div",{className:"loading",children:"로딩 중..."}):t?e:h.jsx(Hm,{to:"/login",replace:!0,state:{from:r}})};function YC(){const e=vn(),{user:t,logout:n}=on(),r=()=>{n(),e("/login")},i=()=>{window.location.href="/metaverse/waiting-room"};return h.jsx("div",{className:"main-page",children:h.jsxs("div",{className:"sky-background",children:[h.jsxs("div",{className:"clouds",children:[h.jsx("div",{className:"cloud cloud1"}),h.jsx("div",{className:"cloud cloud2"}),h.jsx("div",{className:"cloud cloud3"})]}),h.jsxs("div",{className:"mini-area-text",children:[h.jsx("h1",{children:"MINI AREA"}),h.jsx("p",{children:"당신만의 가상공간을 만들어보세요"})]}),h.jsxs("div",{className:"main-buttons",children:[h.jsx("button",{className:"enter-metaverse-btn",onClick:i,children:"가상공간 입장"}),h.jsx("button",{className:"logout-btn",onClick:r,children:"로그아웃"})]}),h.jsx("div",{className:"user-info",children:h.jsxs("p",{children:["환영합니다, ",t?.username||"사용자","님!"]})})]})})}const ZC=()=>h.jsx($E,{children:h.jsx(zE,{children:h.jsx("div",{className:"App",children:h.jsxs(fS,{children:[h.jsx(Jt,{path:"/login",element:h.jsx(WE,{})}),h.jsx(Jt,{path:"/register",element:h.jsx(HE,{})}),h.jsx(Jt,{path:"/verify-email",element:h.jsx(qE,{})}),h.jsx(Jt,{path:"/metaverse",element:h.jsx(Hm,{to:"/"})}),h.jsx(Jt,{path:"/metaverse/waiting-room",element:h.jsx(Bi,{children:h.jsx(QC,{})})}),h.jsx(Jt,{path:"/metaverse/lobby",element:h.jsx(Bi,{children:h.jsx(Fl,{})})}),h.jsx(Jt,{path:"/metaverse/:mapId",element:h.jsx(Bi,{children:h.jsx(Fl,{})})}),h.jsx(Jt,{path:"/join/:link",element:h.jsx(Fl,{})}),h.jsx(Jt,{path:"/metaverse/edit/:mapId",element:h.jsx(Bi,{children:h.jsx(JC,{})})}),h.jsx(Jt,{path:"/",element:h.jsx(Bi,{children:h.jsx(YC,{})})})]})})})});Ul.createRoot(document.getElementById("root")).render(h.jsx(Tp.StrictMode,{children:h.jsx(wS,{children:h.jsx(ZC,{})})}));
